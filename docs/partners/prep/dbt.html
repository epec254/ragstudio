

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en-US" > <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en-US"> <!--<![endif]-->

<head>
  <!-- cookie consent -->
  
    <!-- Combined Onetrust and Rudderstack Implementation Scripts -->
    <!-- Onetrust Initialization -->
    <script type="text/javascript" src="https://cdn.cookielaw.org/consent/92466579-1717-44d3-809d-a05fb02843ed-test/OtAutoBlock.js"></script>
    <script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" data-document-language="true" type="text/javascript" charset="UTF-8" data-domain-script="92466579-1717-44d3-809d-a05fb02843ed-test"></script>
    <link rel="stylesheet" id="db-onetrust-style" href="https://www.databricks.com/wp-content/uploads/db_onetrust.css" media="all" />
    <!-- Setting Rudderstack Write Key -->
    <script>window.rudderstackKey = "2SOR9fvSr5Fi6tN2ihPbVHnX1SZ" </script>
    <!-- Rudderstack Initialization + Onetrust Integration + Rudderstack Custom Events -->
    <script type="text/javascript" src="https://www.databricks.com/sites/default/files/rudderstack/v1/db-rudderstack-events.js"></script>

  <!-- cookie consent -->

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="X-UA-Compatible" content="IE=9" />
  <meta content="Learn how to connect your Databricks workspace to dbt Core, an open-source command line tool that enables data teams to transform data." name="description" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
  <meta property="og:image" content="https://www.databricks.com/wp-content/uploads/2020/04/og-databricks.png">
  <meta property="og:image:type" content="image/png">
  <meta property="og:title" content="Connect to dbt Core">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://docs.databricks.com">
  <meta property="og:description" content="" id="og-description">
  <meta name="twitter:image" content="https://www.databricks.com/wp-content/uploads/2020/04/og-databricks.png">
  <meta name="twitter:site" content="@databricks">
  <meta name="twitter:creator" content="@databricks">
  <meta property="twitter:description" content="">
  
  <title>Connect to dbt Core &#124; Databricks on AWS</title>
  
  
  <link rel="canonical" href="https://docs.databricks.com/en/partners/prep/dbt.html">
  <!-- Start hreflang tag -->
  <link rel="alternate" hreflang="en" href="https://docs.databricks.com/en/partners/prep/dbt.html" />
<link rel="alternate" hreflang="x-default" href="https://docs.databricks.com/en/partners/prep/dbt.html" />
  <!-- End hreflang tag -->
  
  
  <link rel="shortcut icon" href="../../_static/favicon.ico" />
  

  

  

  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;
j.setAttributeNode(d.createAttribute('data-ot-ignore'));
f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-T85FQ33');</script>
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;
j.setAttributeNode(d.createAttribute('data-ot-ignore'));
f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-TWTKQQ');</script>
    
  <!-- End Google Tag Manager -->


  <!-- MaxMind / GEO IP -->
  <script src="//js.maxmind.com/js/apis/geoip2/v2.1/geoip2.js" type="text/javascript"></script>
  <!-- End MaxMind / GEO IP -->

  
  
  <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600&display=swap" rel="stylesheet">
  <link rel="preload" href="../../_static/fonts/DMSans-Bold.ttf" as="font">
  <link rel="preload" href="../../_static/fonts/DMSans-Regular.ttf" as="font">
  <link rel="preload" href="../../_static/fonts/DMMono-Regular.ttf" as="font">
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/cloud-provider-selector.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/translation-selector.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/searchunify/main.css" type="text/css" />

  
  <link rel="index" title="Index" href="../../genindex.html" />
  <link rel="search" title="Search" href="../../search.html" />
  <link rel="top" title="Databricks on AWS" href="../../index.html" /> 
</head>

<body class="wy-body-for-nav" role="document">

  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T85FQ33"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TWTKQQ"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->

  
  <nav class="wy-nav-top header su_header" role="navigation" aria-label="top navigation">
    
<nav class="wy-nav-top header su_header" role="navigation" aria-label="top navigation">
  <div class="container-logo">
    <ul class="mobile-menu-toggle">
        <li class="menu-toggle">
            <i data-toggle="wy-nav-top" class="wy-nav-top-menu-button db-icon db-icon-menu pull-left"></i>
            
            <a href="https://www.databricks.com/" class="wy-nav-top-logo"><img src="../../_static/small-scale-lockup-full-color-rgb.svg" width="137" height="21"
              alt="Databricks" /></a>   
               
              </li>
    </ul>
    <ul class="su_nav-menu">
      <li class="menu-toggle">
        <i data-toggle="wy-nav-top" class="wy-nav-top-menu-button db-icon db-icon-menu pull-left"></i>
        
          
        
        <a href="https://www.databricks.com/" class="wy-nav-top-logo"><img src="../../_static/small-scale-lockup-full-color-rgb.svg" width="137" height="21"
            alt="Databricks" /></a></li>
        <!-- 
<li><a href="https://help.databricks.com/s/">Help Center</a></li>
<li class="active"><a href="https://docs.databricks.com/en/">Documentation</a></li>
<li><a href="https://kb.databricks.com/">Knowledge Base</a></li>
 -->
    </ul>
  </div>
  <div class="su_nav-right">
    <ul class="su_link-mobile">
  <!-- Mobile header code can go here -->
</ul>
<ul class="right-try-list">
   
</ul>
  </div>
</nav>
  </nav>

  <div class="su_sub-header">
    <div class="container">
      <div class="su_sub-header-inner">
        <!-- <div class="su_subnav-menu-right">
  <div id="auto" style="width: 100%;">
    <div ng-controller="SearchautoController">
      <div bind-html-compile="autocompleteHtml">
        <form class="su__search-box-1" disabled="disabled">
          <input class="su__search-input" type="search" name="Search box" id="su__search-b" placeholder="Search Documentation" disabled="disabled"/>
          <button class="su__search-button" type="submit" class="button button-success" disabled="disabled">
            <svg width="24" height="24" viewBox="0 0 24 24">
              <path
                d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"
                fill="#333"></path>
            </svg>
          </button>
        </form>
      </div>
    </div>
  </div>
</div> -->
        <div class="search-lng-gap"></div>
        <div style="margin-left: 16px; margin-right: 16px;">
          <!-- <select name="lng selector" id="lng-selector">
    <option value="../../../en/partners/prep/dbt.html" class="notranslate">English</option>
    <option value="../../../ja/partners/prep/dbt.html" class="notranslate">日本語</option>
    <option value="../../../pt/partners/prep/dbt.html" class="notranslate">Português (Brasil)</option>
</select> -->
        </div>
        <div class="cloud-selector-container">
          <!-- <select name="cloud provider selector" id="cloud-provider-selector">
    <option value="aws" selected class="notranslate">
        Amazon Web Services
    </option>
    <option value="azure"  class="notranslate">
        Microsoft Azure
    </option>
    <option value="gcp"  class="notranslate">
        Google Cloud Platform
    </option>
</select> -->
        </div>
      </div>
    </div>
  </div>
  <page class="js-page-container">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side su_nav-side">
<div class="wy-side-scroll">
  <div class="wy-side-nav-search">
    

    

    

    
  </div>

  <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
    
      <a href="../../index.html" class="main-navigation-home">Databricks on AWS</a>
    

    
      

      
        <p class="caption"><span class="caption-text">Load &amp; manage data</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../rag-temp/index.html">RAG Studio</a></li>
</ul>

      
    
  </div>

  <div role="contentinfo">
    
  <p class="build_info notranslate"data-last-edit="December 23, 2023">
    Updated Jan 11, 2024
  </p>
<script>
  window.addEventListener('DOMContentLoaded',function(){
    var h1=document.querySelector('h1');
    var bi=document.querySelector('[data-last-edit]');
    if(h1 && bi){
      var ver = document.createElement('p');
      ver.className = 'version_info';
      ver.textContent = bi.getAttribute('data-last-edit');
      h1.parentElement.insertBefore(ver, h1.nextElementSibling);
    }
  });
</script>

    <p>
      
        <a id='feedbacklink' href="mailto:doc-feedback@databricks.com?subject=Documentation Feedback">Send us feedback</a>
      
    </p>
  </div>
</div>
</nav>
    
    
<main class="wy-grid-for-nav su_nav-grid">
  <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
    <div class="wy-nav-content su__nav_content">
      <div class="rst-content">
        





<div role="navigation" aria-label="breadcrumbs navigation" class="wy-breadcrumbs-wrapper">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Documentation</a> <span class="db-icon db-icon-chevron-right"></span></li>
    
    
      <li>Connect to dbt Core</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>
</div>
        
        <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
          <div itemprop="articleBody">
            
    
  <div class="section" id="connect-to-dbt-core">
<h1>Connect to dbt Core<a class="headerlink" href="#connect-to-dbt-core" title="Permalink to this headline"> </a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This article covers dbt Core, a version of dbt for your local development machine that interacts with Databricks SQL warehouses and Databricks clusters within your Databricks workspaces. To use the hosted version of dbt (called <em>dbt Cloud</em>) instead, or to use Partner Connect to quickly create a SQL warehouse within your workspace and then connect it to dbt Cloud, see <a class="reference internal" href="dbt-cloud.html"><span class="doc">Connect to dbt Cloud</span></a>.</p>
</div>
<p>dbt (data build tool) is a development environment that enables data analysts and data engineers to transform data by simply writing select statements. dbt handles turning these select statements into tables and views. dbt compiles your code into raw SQL and then runs that code on the specified database in Databricks. dbt supports collaborative coding patterns and best practices such as version control, documentation, modularity, and more.</p>
<p>dbt does not extract or load data. dbt focuses on the transformation step only, using a “transform after load” architecture. dbt assumes that you already have a copy of your data in your database.</p>
<p>This article focuses on using dbt Core. dbt Core enables you to write dbt code in the text editor or IDE of your choice on your local development machine and then run dbt from the command line. dbt Core includes the dbt Command Line Interface (CLI). The <a class="reference external" href="https://docs.getdbt.com/dbt-cli/cli-overview">dbt CLI</a> is free to use and <a class="reference external" href="https://github.com/dbt-labs/dbt">open source</a>.</p>
<p>A hosted version of dbt called dbt Cloud is also available. dbt Cloud comes equipped with turnkey support for scheduling jobs, CI/CD, serving documentation, monitoring and alerting, and an integrated development environment (IDE). For more information, see <a class="reference internal" href="dbt-cloud.html"><span class="doc">Connect to dbt Cloud</span></a>. The dbt Cloud Developer plan provides one free developer seat; Team and Enterprise paid plans are also available. For more information, see <a class="reference external" href="https://www.getdbt.com/pricing/">dbt Pricing</a> on the dbt website.</p>
<p>Because dbt Core and dbt Cloud can use hosted git repositories (for example, on GitHub, GitLab or BitBucket), you can use dbt Core to create a dbt project and then make it available to your dbt Cloud users. For more information, see <a class="reference external" href="https://docs.getdbt.com/docs/building-a-dbt-project/projects#creating-a-dbt-project">Creating a dbt project</a> and <a class="reference external" href="https://docs.getdbt.com/docs/building-a-dbt-project/projects#using-an-existing-project">Using an existing project</a> on the dbt website.</p>
<p>For a general overview of dbt, watch the following YouTube video (26 minutes).</p>
<p></p>
<iframe width="640" height="360" style="margin-bottom: 25px" src="https://www.youtube.com/embed/zoHoIGE6tPc?rel=0" frameborder="0" allowfullscreen="1">&nbsp;</iframe><p></p>
<p></p>
<div class="toctree-wrapper compound">
</div>
<p></p>
<div class="section" id="requirements">
<h2>Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline"> </a></h2>
<p>Before you install dbt Core, you must install the following on your local development machine:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.python.org/downloads/">Python</a> 3.7 or higher</p></li>
<li><p>A utility for creating Python virtual environments (such as <a class="reference external" href="https://docs.python-guide.org/dev/virtualenvs/">pipenv</a>)</p></li>
</ul>
<p>You also need one of the following to authenticate:</p>
<ul>
<li><p>(Recommended) dbt Core enabled as an OAuth application in your account. This is enabled by default.</p>
<p>(Optional) To use a custom IdP for dbt login, see <a class="reference internal" href="../../administration-guide/account-settings-e2/single-sign-on/index.html"><span class="doc">Set up SSO in your Databricks account console</span></a>.</p>
</li>
<li><p>A personal access token</p>
<p></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>As a security best practice when you authenticate with automated tools, systems, scripts, and apps, Databricks recommends that you use OAuth tokens.</p>
<p>If you use personal access token authentication, Databricks recommends using personal access tokens belonging to <a class="reference internal" href="../../administration-guide/users-groups/service-principals.html"><span class="doc">service principals</span></a> instead of workspace users. To create tokens for service principals, see <a class="reference internal" href="../../administration-guide/users-groups/service-principals.html#personal-access-tokens"><span class="std std-ref">Manage tokens for a service principal</span></a>.</p>
</div>
</li>
</ul>
</div>
<div class="section" id="step-1-create-and-activate-a-python-virtual-environment">
<h2>Step 1: Create and activate a Python virtual environment<a class="headerlink" href="#step-1-create-and-activate-a-python-virtual-environment" title="Permalink to this headline"> </a></h2>
<p>In this step, you use <code class="docutils literal notranslate"><span class="pre">pipenv</span></code> to create a <em><a class="reference external" href="https://realpython.com/python-virtual-environments-a-primer/">Python virtual environment</a></em>. We recommend using a Python virtual environment as it isolates package versions and code dependencies to that specific environment, regardless of the package versions and code dependencies within other environments. This helps reduce unexpected package version mismatches and code dependency collisions.</p>
<ol class="arabic">
<li><p>From your terminal, switch to an empty directory, creating that directory first if necessary. This procedure creates an empty directory named <code class="docutils literal notranslate"><span class="pre">dbt_demo</span></code> in the root of your user home directory.</p>
<div class="js-code-language-tabs compound">
<div class="compound-first compound" lang="Unix,&amp;nbsp;Linux,&amp;nbsp;macOS">
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mkdir<span class="w"> </span>~/dbt_demo
<span class="nb">cd</span><span class="w"> </span>~/dbt_demo
</pre></div>
</div>
</div>
<div class="compound-last compound" lang="Windows">
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mkdir<span class="w"> </span>%USERPROFILE%<span class="se">\d</span>bt_demo
<span class="nb">cd</span><span class="w"> </span>%USERPROFILE%<span class="se">\d</span>bt_demo
</pre></div>
</div>
</div>
</div>
</li>
<li><p>In this empty directory, create a file named <code class="docutils literal notranslate"><span class="pre">Pipfile</span></code> with the following content. This <em><a class="reference external" href="https://realpython.com/pipenv-guide/#the-pipfile">Pipfile</a></em> instructs <code class="docutils literal notranslate"><span class="pre">pipenv</span></code> to use Python version 3.8.6. If you use a different version, replace <code class="docutils literal notranslate"><span class="pre">3.8.6</span></code> with your version number.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>[[source]]
url = &quot;https://pypi.org/simple&quot;
verify_ssl = true
name = &quot;pypi&quot;

[packages]
dbt-databricks = &quot;*&quot;

[requires]
python_version = &quot;3.8.6&quot;
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The preceding line <code class="docutils literal notranslate"><span class="pre">dbt-databricks</span> <span class="pre">=</span> <span class="pre">&quot;*&quot;</span></code> instructs <code class="docutils literal notranslate"><span class="pre">pipenv</span></code> to use the latest version of the <code class="docutils literal notranslate"><span class="pre">dbt-databricks</span></code> package. In production scenarios, you should replace <code class="docutils literal notranslate"><span class="pre">*</span></code> with the specific version of the package that you want to use. See <a class="reference external" href="https://pypi.org/project/dbt-databricks/#history">dbt-databricks Release history</a> on the Python Package Index (PyPI) website.</p>
</div>
</li>
<li><p>Create a Python virtual environment in this directory by running <code class="docutils literal notranslate"><span class="pre">pipenv</span></code> and specifying the Python version to use. This command specifies Python version 3.8.6. If you use a different version, replace <code class="docutils literal notranslate"><span class="pre">3.8.6</span></code> with your version number:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pipenv<span class="w"> </span>--python<span class="w"> </span><span class="m">3</span>.8.6
</pre></div>
</div>
</li>
<li><p>Install the dbt Databricks adapter by running <code class="docutils literal notranslate"><span class="pre">pipenv</span></code> with the <code class="docutils literal notranslate"><span class="pre">install</span></code> option. This installs the packages in your <code class="docutils literal notranslate"><span class="pre">Pipfile</span></code>, which includes the dbt Databricks adapter package, <code class="docutils literal notranslate"><span class="pre">dbt-databricks</span></code>, from PyPI. The dbt Databricks adapter package automatically installs dbt Core and other dependencies.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>If your local development machine uses any of the following operating systems, you must complete additional steps first: CentOS, MacOS, Ubuntu, Debian, and Windows. See the “Does my operating system have prerequisites” section of <a class="reference external" href="https://docs.getdbt.com/dbt-cli/install/pip">Use pip to install dbt</a> on the dbt Labs website.</p>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pipenv<span class="w"> </span>install
</pre></div>
</div>
</li>
<li><p>Activate this virtual environment by running <code class="docutils literal notranslate"><span class="pre">pipenv</span> <span class="pre">shell</span></code>. To confirm the activation, the terminal displays <code class="docutils literal notranslate"><span class="pre">(dbt_demo)</span></code> before the prompt. The virtual environment begins using the specified version of Python and isolates all package versions and code dependencies within this new environment.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pipenv<span class="w"> </span>shell
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To deactivate this virtual environment, run <code class="docutils literal notranslate"><span class="pre">exit</span></code>. <code class="docutils literal notranslate"><span class="pre">(dbt_demo)</span></code> disappears from before the prompt. If you run <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">--version</span></code> or <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">list</span></code> with this virtual environment deactivated, you might see a different version of Python, a different list of available packages or package versions, or both.</p>
</div>
</li>
<li><p>Confirm that your virtual environment is running the expected version of Python by running <code class="docutils literal notranslate"><span class="pre">python</span></code> with the <code class="docutils literal notranslate"><span class="pre">--version</span></code> option.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>--version
</pre></div>
</div>
<p>If an unexpected version of Python displays, make sure you have activated your virtual environment by running <code class="docutils literal notranslate"><span class="pre">pipenv</span> <span class="pre">shell</span></code>.</p>
</li>
<li><p>Confirm that your virtual environment is running the expected versions of dbt and the dbt Databricks adapter by running <code class="docutils literal notranslate"><span class="pre">dbt</span></code> with the <code class="docutils literal notranslate"><span class="pre">--version</span></code> option.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>dbt<span class="w"> </span>--version
</pre></div>
</div>
<p>If an unexpected version of dbt or the dbt Databricks adapter displays, make sure you have activated your virtual environment by running <code class="docutils literal notranslate"><span class="pre">pipenv</span> <span class="pre">shell</span></code>. If an unexpected version still displays, try installing dbt or the dbt Databricks adapter again after you activate your virtual environment.</p>
</li>
</ol>
</div>
<div class="section" id="step-2-create-a-dbt-project-and-specify-and-test-connection-settings">
<h2>Step 2: Create a dbt project and specify and test connection settings<a class="headerlink" href="#step-2-create-a-dbt-project-and-specify-and-test-connection-settings" title="Permalink to this headline"> </a></h2>
<p>In this step, you create a dbt <em>project</em>, which is a collection of related directories and files that are required to use dbt. You then configure your connection <em>profiles</em>, which contain connection settings to a Databricks <a class="reference internal" href="../../compute/configure.html"><span class="doc">cluster</span></a>, a <a class="reference internal" href="../../compute/sql-warehouse/create-sql-warehouse.html"><span class="doc">SQL warehouse</span></a>, or both. To increase security, dbt projects and profiles are stored in separate locations by default.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>You can connect to an existing cluster or SQL warehouse, or you can create a new one.</p>
<ul class="simple">
<li><p>An existing cluster or SQL warehouse can be efficient for multiple dbt projects, for using dbt in a team, or for development use cases.</p></li>
<li><p>A new cluster or SQL warehouse allows you to run a single dbt project in isolation for production use cases, as well as leverage automatic termination to save costs when that dbt project is not running.</p></li>
</ul>
<p>Use Databricks to create a new cluster or SQL warehouse, and then reference the newly-created or existing cluster or SQL warehouse from your dbt profile.</p>
</div>
<ol class="arabic">
<li><p>With the virtual environment still activated, run the <a class="reference external" href="https://docs.getdbt.com/reference/commands/init">dbt init</a> command with a name for your project. This procedure creates a project named <code class="docutils literal notranslate"><span class="pre">my_dbt_demo</span></code>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>dbt<span class="w"> </span>init<span class="w"> </span>my_dbt_demo
</pre></div>
</div>
</li>
<li><p>When you are prompted to choose a <code class="docutils literal notranslate"><span class="pre">databricks</span></code> or <code class="docutils literal notranslate"><span class="pre">spark</span></code> database, enter the number that corresponds to <code class="docutils literal notranslate"><span class="pre">databricks</span></code>.</p></li>
<li><p>When prompted for a <code class="docutils literal notranslate"><span class="pre">host</span></code> value, do the following:</p>
<ul class="simple">
<li><p>For a cluster, enter the <strong>Server Hostname</strong> value from the <a class="reference internal" href="../../integrations/jdbc-odbc-bi.html#connection-details-cluster"><span class="std std-ref">Advanced Options, JDBC/ODBC</span></a> tab for your Databricks cluster.</p></li>
<li><p>For a SQL warehouse, enter the <strong>Server Hostname</strong> value from the <a class="reference internal" href="../../integrations/jdbc-odbc-bi.html#connection-details-sql-warehouse"><span class="std std-ref">Connection Details</span></a> tab for your SQL warehouse.</p></li>
</ul>
</li>
<li><p>When prompted for an <code class="docutils literal notranslate"><span class="pre">http_path</span></code> value, do the following:</p>
<ul class="simple">
<li><p>For a cluster, enter the <strong>HTTP Path</strong> value from the <a class="reference internal" href="../../integrations/jdbc-odbc-bi.html#connection-details-cluster"><span class="std std-ref">Advanced Options, JDBC/ODBC</span></a> tab for your Databricks cluster.</p></li>
<li><p>For a SQL warehouse, enter the <strong>HTTP Path</strong> value from the <a class="reference internal" href="../../integrations/jdbc-odbc-bi.html#connection-details-sql-warehouse"><span class="std std-ref">Connection Details</span></a> tab for your SQL warehouse.</p></li>
</ul>
</li>
<li><p>To choose an authentication type, enter the number that corresponds with <code class="docutils literal notranslate"><span class="pre">use</span> <span class="pre">oauth</span></code> (recommended) or <code class="docutils literal notranslate"><span class="pre">use</span> <span class="pre">access</span> <span class="pre">token</span></code>.</p></li>
<li><p>If you chose <code class="docutils literal notranslate"><span class="pre">use</span> <span class="pre">access</span> <span class="pre">token</span></code> for your authentication type, enter the value of your Databricks <a class="reference external" href="https://docs.databricks.com/api/workspace/tokenmanagement">personal access token</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>As a security best practice when you authenticate with automated tools, systems, scripts, and apps, Databricks recommends that you use OAuth tokens.</p>
<p>If you use personal access token authentication, Databricks recommends using personal access tokens belonging to <a class="reference internal" href="../../administration-guide/users-groups/service-principals.html"><span class="doc">service principals</span></a> instead of workspace users. To create tokens for service principals, see <a class="reference internal" href="../../administration-guide/users-groups/service-principals.html#personal-access-tokens"><span class="std std-ref">Manage tokens for a service principal</span></a>.</p>
</div>
</li>
<li><p>When prompted for the <code class="docutils literal notranslate"><span class="pre">desired</span> <span class="pre">Unity</span> <span class="pre">Catalog</span> <span class="pre">option</span></code> value, enter the number that corresponds with <code class="docutils literal notranslate"><span class="pre">use</span> <span class="pre">Unity</span> <span class="pre">Catalog</span></code> or <code class="docutils literal notranslate"><span class="pre">not</span> <span class="pre">use</span> <span class="pre">Unity</span> <span class="pre">Catalog</span></code>.</p></li>
<li><p>If you chose to use Unity Catalog, enter the desired value for <code class="docutils literal notranslate"><span class="pre">catalog</span></code> when prompted.</p></li>
<li><p>Enter the desired values for <code class="docutils literal notranslate"><span class="pre">schema</span></code> and <code class="docutils literal notranslate"><span class="pre">threads</span></code> when prompted.</p></li>
<li><p>dbt writes your entries to a <code class="docutils literal notranslate"><span class="pre">profiles.yml</span></code> file. The location of this file is listed in the output of the <code class="docutils literal notranslate"><span class="pre">dbt</span> <span class="pre">init</span></code> command. You can also list this location later by running the <code class="docutils literal notranslate"><span class="pre">dbt</span> <span class="pre">debug</span> <span class="pre">--config-dir</span></code> command. You can open this file now to examine and verify its contents.</p>
<p>If you chose <code class="docutils literal notranslate"><span class="pre">use</span> <span class="pre">oauth</span></code> for your authentication type, add your machine-to-machine (M2M) or user-to-machine (U2M) authentication profile to <code class="docutils literal notranslate"><span class="pre">profiles.yml</span></code>.</p>
<p>The following is an example <code class="docutils literal notranslate"><span class="pre">profiles.yml</span></code> file with the profile <code class="docutils literal notranslate"><span class="pre">aws-oauth-u2m</span></code> specified. Specifying <code class="docutils literal notranslate"><span class="pre">aws-oauth-u2m</span></code> for <code class="docutils literal notranslate"><span class="pre">target</span></code> sets the U2M profile as the default run profile used by dbt.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">my_dbt_demo</span><span class="p">:</span>
<span class="n">outputs</span><span class="p">:</span>
   <span class="n">azure</span><span class="o">-</span><span class="n">oauth</span><span class="o">-</span><span class="n">u2m</span><span class="p">:</span>
      <span class="n">catalog</span><span class="p">:</span> <span class="n">uc_demos</span>
      <span class="n">host</span><span class="p">:</span> <span class="s2">&quot;xxx.cloud.databricks.com&quot;</span>
      <span class="n">http_path</span><span class="p">:</span> <span class="s2">&quot;/sql/1.0/warehouses/9196548d010cf14d&quot;</span>
      <span class="n">schema</span><span class="p">:</span> <span class="n">databricks_demo</span>
      <span class="n">threads</span><span class="p">:</span> <span class="mi">1</span>
      <span class="nb">type</span><span class="p">:</span> <span class="n">databricks</span>
      <span class="n">auth_type</span><span class="p">:</span> <span class="n">oauth</span>
<span class="n">target</span><span class="p">:</span> <span class="n">aws</span><span class="o">-</span><span class="n">oauth</span><span class="o">-</span><span class="n">u2m</span>
</pre></div>
</div>
<p>Databricks does not recommend specifying secrets in <code class="docutils literal notranslate"><span class="pre">profiles.yml</span></code> directly. Instead, set the client ID and client secret as environment variables.</p>
</li>
<li><p>Confirm that the connection details are correct by traversing into the <code class="docutils literal notranslate"><span class="pre">my_dbt_demo</span></code> directory and running the <code class="docutils literal notranslate"><span class="pre">dbt</span> <span class="pre">debug</span></code> command.</p>
<p>If you chose <code class="docutils literal notranslate"><span class="pre">use</span> <span class="pre">oauth</span></code> for your authentication type, you’re prompted to sign in with your identity provider.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Before you begin, verify that your cluster or SQL warehouse is running.</p>
</div>
<p>You should see output similar to the following:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>my_dbt_demo
dbt<span class="w"> </span>debug
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">...</span>
<span class="go">Configuration:</span>
<span class="go">  profiles.yml file [OK found and valid]</span>
<span class="go">  dbt_project.yml file [OK found and valid]</span>

<span class="go">Required dependencies:</span>
<span class="go">  - git [OK found]</span>

<span class="go">Connection:</span>
<span class="go">  ...</span>
<span class="go">  Connection test: OK connection ok</span>
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="next-steps">
<h2>Next steps<a class="headerlink" href="#next-steps" title="Permalink to this headline"> </a></h2>
<ul class="simple">
<li><p>Create, run, and test dbt Core models locally. See the <a class="reference internal" href="../../integrations/dbt-core-tutorial.html"><span class="doc">dbt Core tutorial</span></a>.</p></li>
<li><p>Run dbt Core projects as Databricks job tasks. See <a class="reference internal" href="../../workflows/jobs/how-to/use-dbt-in-workflows.html"><span class="doc">Use dbt transformations in a Databricks job</span></a>.</p></li>
</ul>
</div>
<div class="section" id="additional-resources">
<h2>Additional resources<a class="headerlink" href="#additional-resources" title="Permalink to this headline"> </a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://blog.getdbt.com/what--exactly--is-dbt-/">What, exactly, is dbt?</a></p></li>
<li><p><a class="reference external" href="https://blog.getdbt.com/analytics-engineering-for-everyone-databricks-in-dbt-cloud/">Analytics Engineering for Everyone: Databricks in dbt Cloud</a> on the dbt website.</p></li>
<li><p><a class="reference external" href="https://docs.getdbt.com/tutorial/setting-up">dbt Getting Started tutorial</a></p></li>
<li><p><a class="reference external" href="https://docs.getdbt.com/docs">dbt documentation</a></p></li>
<li><p><a class="reference external" href="https://docs.getdbt.com/dbt-cli/cli-overview">dbt CLI documentation</a></p></li>
<li><p><a class="reference external" href="https://github.com/dbt-labs/dbt-databricks-demo">dbt + Databricks Demo</a></p></li>
<li><p><a class="reference external" href="https://discourse.getdbt.com/">dbt Discourse community</a></p></li>
<li><p><a class="reference external" href="https://blog.getdbt.com/">dbt blog</a></p></li>
</ul>
</div>
</div>


    
          </div>
        </div>
        <div  class="suapp-rating">
  <div id="suPageRateApp">
     <su-app></su-app>
   </div> 
 </div>
<hr> 
<footer>
  <div role="contentinfo">
      <p class="copyright">
          &copy; Databricks 2023. All rights reserved. Apache, Apache Spark, Spark, and the Spark logo are trademarks of the <a href="http://www.apache.org/">Apache Software Foundation</a>.
      </p>
      <p> 
        
          <a id='feedbacklink' href="mailto:doc-feedback@databricks.com?subject=Documentation Feedback">Send us feedback</a>
        
     | <a href="https://databricks.com/privacy-policy">Privacy Policy</a> | <a href="https://databricks.com/terms-of-use">Terms of Use</a></p>

  </div> 

</footer>
      </div>
    </div>
  </section>
</main>

  </page>
  
  <script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
      URL_ROOT: '../../',
      VERSION: '1.0',
      COLLAPSE_INDEX: false,
      FILE_SUFFIX: '.html',
      HAS_SOURCE: 'false'
    };
  </script>
  <script type="text/javascript" src="../../_static/jquery.js"></script>
  <script type="text/javascript" src="../../_static/underscore.js"></script>
  <script type="text/javascript" src="../../_static/doctools.js"></script>
  <script type="text/javascript" src="../../_static/language_data.js"></script>
  

  <script type="text/javascript" src="../../_static/js/clipboard.min.js"></script>
  <script type="text/javascript" src="../../_static/js/jquery.waypoints.min.js"></script>

  <!-- Select2 (https://select2.org/) -->
  <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
  <!-- End Select2 -->

  
  
  <script type="text/javascript" src="../../_static/js/localized.js"></script>
  <script type="text/javascript" src="../../_static/js/custom.js"></script>
  

  
  
  <script type="text/javascript">
    jQuery(function () {
      SphinxRtdTheme.StickyNav.enable();
    });

  </script>
  
 



  <script>
  window.__searchunifyLoaderConfig = JSON.parse('{"clients": {"en": "02c2e804-27e9-11ee-aefb-0242ac120011", "ja": "6a42c3f2-2820-11ee-aefb-0242ac120011", "pt": "6a86badd-2821-11ee-aefb-0242ac120011"}}')
</script>
<script type="text/javascript" src="../../_static/js/search-loader.js"></script>
</body>
<script type='text/javascript'>
  window.onload = function () {
    var description = document.querySelector('meta[name="description"]').getAttribute("content");
    let titleText = document.querySelector('h1').textContent;
    document.querySelector('meta[property="og:title"]').setAttribute("content", titleText);
    document.querySelector('meta[property="og:description"]').setAttribute("content", description);
    document.querySelector('meta[property="twitter:description"]').setAttribute("content", description);
  };
</script>

</html>