

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en-US" > <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en-US"> <!--<![endif]-->

<head>
  <!-- cookie consent -->
  
    <!-- Combined Onetrust and Rudderstack Implementation Scripts -->
    <!-- Onetrust Initialization -->
    <script type="text/javascript" src="https://cdn.cookielaw.org/consent/92466579-1717-44d3-809d-a05fb02843ed-test/OtAutoBlock.js"></script>
    <script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" data-document-language="true" type="text/javascript" charset="UTF-8" data-domain-script="92466579-1717-44d3-809d-a05fb02843ed-test"></script>
    <link rel="stylesheet" id="db-onetrust-style" href="https://www.databricks.com/wp-content/uploads/db_onetrust.css" media="all" />
    <!-- Setting Rudderstack Write Key -->
    <script>window.rudderstackKey = "2SOR9fvSr5Fi6tN2ihPbVHnX1SZ" </script>
    <!-- Rudderstack Initialization + Onetrust Integration + Rudderstack Custom Events -->
    <script type="text/javascript" src="https://www.databricks.com/sites/default/files/rudderstack/v1/db-rudderstack-events.js"></script>

  <!-- cookie consent -->

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="X-UA-Compatible" content="IE=9" />
  <meta content="Learn how to connect your Databricks workspace to dbt Cloud, a hosted service that helps data analysts and engineers productionize dbt deployments." name="description" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
  <meta property="og:image" content="https://www.databricks.com/wp-content/uploads/2020/04/og-databricks.png">
  <meta property="og:image:type" content="image/png">
  <meta property="og:title" content="Connect to dbt Cloud">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://docs.databricks.com">
  <meta property="og:description" content="" id="og-description">
  <meta name="twitter:image" content="https://www.databricks.com/wp-content/uploads/2020/04/og-databricks.png">
  <meta name="twitter:site" content="@databricks">
  <meta name="twitter:creator" content="@databricks">
  <meta property="twitter:description" content="">
  
  <title>Connect to dbt Cloud &#124; Databricks on AWS</title>
  
  
  <link rel="canonical" href="https://docs.databricks.com/en/partners/prep/dbt-cloud.html">
  <!-- Start hreflang tag -->
  <link rel="alternate" hreflang="en" href="https://docs.databricks.com/en/partners/prep/dbt-cloud.html" />
<link rel="alternate" hreflang="x-default" href="https://docs.databricks.com/en/partners/prep/dbt-cloud.html" />
  <!-- End hreflang tag -->
  
  
  <link rel="shortcut icon" href="../../_static/favicon.ico" />
  

  

  

  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;
j.setAttributeNode(d.createAttribute('data-ot-ignore'));
f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-T85FQ33');</script>
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;
j.setAttributeNode(d.createAttribute('data-ot-ignore'));
f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-TWTKQQ');</script>
    
  <!-- End Google Tag Manager -->


  <!-- MaxMind / GEO IP -->
  <script src="//js.maxmind.com/js/apis/geoip2/v2.1/geoip2.js" type="text/javascript"></script>
  <!-- End MaxMind / GEO IP -->

  
  
  <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600&display=swap" rel="stylesheet">
  <link rel="preload" href="../../_static/fonts/DMSans-Bold.ttf" as="font">
  <link rel="preload" href="../../_static/fonts/DMSans-Regular.ttf" as="font">
  <link rel="preload" href="../../_static/fonts/DMMono-Regular.ttf" as="font">
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/cloud-provider-selector.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/translation-selector.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/searchunify/main.css" type="text/css" />

  
  <link rel="index" title="Index" href="../../genindex.html" />
  <link rel="search" title="Search" href="../../search.html" />
  <link rel="top" title="Databricks on AWS" href="../../index.html" /> 
</head>

<body class="wy-body-for-nav" role="document">

  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T85FQ33"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TWTKQQ"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->

  
  <nav class="wy-nav-top header su_header" role="navigation" aria-label="top navigation">
    
<nav class="wy-nav-top header su_header" role="navigation" aria-label="top navigation">
  <div class="container-logo">
    <ul class="mobile-menu-toggle">
        <li class="menu-toggle">
            <i data-toggle="wy-nav-top" class="wy-nav-top-menu-button db-icon db-icon-menu pull-left"></i>
            
            <a href="https://www.databricks.com/" class="wy-nav-top-logo"><img src="../../_static/small-scale-lockup-full-color-rgb.svg" width="137" height="21"
              alt="Databricks" /></a>   
               
              </li>
    </ul>
    <ul class="su_nav-menu">
      <li class="menu-toggle">
        <i data-toggle="wy-nav-top" class="wy-nav-top-menu-button db-icon db-icon-menu pull-left"></i>
        
          
        
        <a href="https://www.databricks.com/" class="wy-nav-top-logo"><img src="../../_static/small-scale-lockup-full-color-rgb.svg" width="137" height="21"
            alt="Databricks" /></a></li>
        <!-- 
<li><a href="https://help.databricks.com/s/">Help Center</a></li>
<li class="active"><a href="https://docs.databricks.com/en/">Documentation</a></li>
<li><a href="https://kb.databricks.com/">Knowledge Base</a></li>
 -->
    </ul>
  </div>
  <div class="su_nav-right">
    <ul class="su_link-mobile">
  <!-- Mobile header code can go here -->
</ul>
<ul class="right-try-list">
   
</ul>
  </div>
</nav>
  </nav>

  <div class="su_sub-header">
    <div class="container">
      <div class="su_sub-header-inner">
        <!-- <div class="su_subnav-menu-right">
  <div id="auto" style="width: 100%;">
    <div ng-controller="SearchautoController">
      <div bind-html-compile="autocompleteHtml">
        <form class="su__search-box-1" disabled="disabled">
          <input class="su__search-input" type="search" name="Search box" id="su__search-b" placeholder="Search Documentation" disabled="disabled"/>
          <button class="su__search-button" type="submit" class="button button-success" disabled="disabled">
            <svg width="24" height="24" viewBox="0 0 24 24">
              <path
                d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"
                fill="#333"></path>
            </svg>
          </button>
        </form>
      </div>
    </div>
  </div>
</div> -->
        <div class="search-lng-gap"></div>
        <div style="margin-left: 16px; margin-right: 16px;">
          <!-- <select name="lng selector" id="lng-selector">
    <option value="../../../en/partners/prep/dbt-cloud.html" class="notranslate">English</option>
    <option value="../../../ja/partners/prep/dbt-cloud.html" class="notranslate">日本語</option>
    <option value="../../../pt/partners/prep/dbt-cloud.html" class="notranslate">Português (Brasil)</option>
</select> -->
        </div>
        <div class="cloud-selector-container">
          <!-- <select name="cloud provider selector" id="cloud-provider-selector">
    <option value="aws" selected class="notranslate">
        Amazon Web Services
    </option>
    <option value="azure"  class="notranslate">
        Microsoft Azure
    </option>
    <option value="gcp"  class="notranslate">
        Google Cloud Platform
    </option>
</select> -->
        </div>
      </div>
    </div>
  </div>
  <page class="js-page-container">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side su_nav-side">
<div class="wy-side-scroll">
  <div class="wy-side-nav-search">
    

    

    

    
  </div>

  <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
    
      <a href="../../index.html" class="main-navigation-home">Databricks on AWS</a>
    

    
      

      
        <p class="caption"><span class="caption-text">Load &amp; manage data</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../rag-temp/index.html">RAG Studio</a></li>
</ul>

      
    
  </div>

  <div role="contentinfo">
    
  <p class="build_info notranslate"data-last-edit="December 23, 2023">
    Updated Jan 11, 2024
  </p>
<script>
  window.addEventListener('DOMContentLoaded',function(){
    var h1=document.querySelector('h1');
    var bi=document.querySelector('[data-last-edit]');
    if(h1 && bi){
      var ver = document.createElement('p');
      ver.className = 'version_info';
      ver.textContent = bi.getAttribute('data-last-edit');
      h1.parentElement.insertBefore(ver, h1.nextElementSibling);
    }
  });
</script>

    <p>
      
        <a id='feedbacklink' href="mailto:doc-feedback@databricks.com?subject=Documentation Feedback">Send us feedback</a>
      
    </p>
  </div>
</div>
</nav>
    
    
<main class="wy-grid-for-nav su_nav-grid">
  <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
    <div class="wy-nav-content su__nav_content">
      <div class="rst-content">
        





<div role="navigation" aria-label="breadcrumbs navigation" class="wy-breadcrumbs-wrapper">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Documentation</a> <span class="db-icon db-icon-chevron-right"></span></li>
    
    
      <li>Connect to dbt Cloud</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>
</div>
        
        <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
          <div itemprop="articleBody">
            
    
  <div class="section" id="connect-to-dbt-cloud">
<h1>Connect to dbt Cloud<a class="headerlink" href="#connect-to-dbt-cloud" title="Permalink to this headline"> </a></h1>
<p>dbt (data build tool) is a development environment that enables data analysts and data engineers to transform data by simply writing select statements. dbt handles turning these select statements into tables and views. dbt compiles your code into raw SQL and then runs that code on the specified database in Databricks. dbt supports collaborative coding patterns and best practices such as version control, documentation, and modularity.</p>
<p>dbt does not extract or load data. dbt focuses on the transformation step only, using a “transform after load” architecture. dbt assumes that you already have a copy of your data in your database.</p>
<p>This article focuses on dbt Cloud. dbt Cloud comes equipped with turnkey support for scheduling jobs, CI/CD, serving documentation, monitoring and alerting, and an integrated development environment (IDE).</p>
<p>A local version of dbt called dbt Core is also available. dbt Core enables you to write dbt code in the text editor or IDE of your choice on your local development machine and then run dbt from the command line. dbt Core includes the dbt Command Line Interface (CLI). The dbt CLI is free to use and open source. For more information, see <a class="reference internal" href="dbt.html"><span class="doc">Connect to dbt Core</span></a>.</p>
<p>Because dbt Cloud and dbt Core can use hosted git repositories (for example, on GitHub, GitLab or BitBucket), you can use dbt Cloud to create a dbt project and then make it available to your dbt Cloud and dbt Core users. For more information, see <a class="reference external" href="https://docs.getdbt.com/docs/building-a-dbt-project/projects#creating-a-dbt-project">Creating a dbt project</a> and <a class="reference external" href="https://docs.getdbt.com/docs/building-a-dbt-project/projects#using-an-existing-project">Using an existing project</a> on the dbt website.</p>
<p>For a general overview of dbt, watch the following YouTube video (26 minutes).</p>
<p></p>
<iframe width="640" height="360" style="margin-bottom: 25px" src="https://www.youtube.com/embed/zoHoIGE6tPc?rel=0" frameborder="0" allowfullscreen="1">&nbsp;</iframe><p></p>
<div class="section" id="connect-to-dbt-cloud-using-partner-connect">
<span id="connect-to-dbt-cloud-using-pc"></span><span id="partner-connect"></span><h2>Connect to dbt Cloud using Partner Connect<a class="headerlink" href="#connect-to-dbt-cloud-using-partner-connect" title="Permalink to this headline"> </a></h2>
<p>This section describes how to connect a Databricks SQL warehouse to dbt Cloud using Partner Connect, then give dbt Cloud read access to your data.</p>
<div class="section" id="differences-between-standard-connections-and-dbt-cloud">
<span id="differences"></span><h3>Differences between standard connections and dbt Cloud<a class="headerlink" href="#differences-between-standard-connections-and-dbt-cloud" title="Permalink to this headline"> </a></h3>
<p>To connect to dbt Cloud using Partner Connect, you follow the steps in <a class="reference internal" href="../../partner-connect/prep.html"><span class="doc">Connect to data prep partners using Partner Connect</span></a>. The dbt Cloud connection is different from standard data preparation and transformation connections in the following ways:</p>
<ul class="simple">
<li><p>In addition to a service principal and a personal access token, Partner Connect creates a SQL warehouse (formerly SQL endpoint) named <strong>DBT_CLOUD_ENDPOINT</strong> by default.</p></li>
</ul>
</div>
<div class="section" id="steps-to-connect">
<span id="partner-connect-steps"></span><h3>Steps to connect<a class="headerlink" href="#steps-to-connect" title="Permalink to this headline"> </a></h3>
<p>To connect to dbt Cloud using Partner Connect, do the following:</p>
<ol class="arabic">
<li><p><a class="reference internal" href="../../partner-connect/prep.html"><span class="doc">Connect to data prep partners using Partner Connect</span></a>.</p></li>
<li><p>After you connect to dbt Cloud, your dbt Cloud dashboard appears. To explore your dbt Cloud project, in the menu bar, next to the dbt logo, select your dbt account name from the first drop-down if it is not displayed, and then select the <strong>Databricks Partner Connect Trial</strong> project from the second drop-down menu if it is not displayed.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>To view your project’s settings, click the “three stripes” or “hamburger” menu, click <strong>Account Settings &gt; Projects</strong>, and click the name of the project. To view the connection settings, click the link next to <strong>Connection</strong>. To change any settings, click <strong>Edit</strong>.</p>
<p>To view the Databricks personal access token information for this project, click the “person” icon on the menu bar, click <strong>Profile &gt; Credentials &gt; Databricks Partner Connect Trial</strong>, and click the name of the project. To make a change, click <strong>Edit</strong>.</p>
</div>
</li>
</ol>
</div>
<div class="section" id="steps-to-give-dbt-cloud-read-access-to-your-data">
<span id="read-access"></span><h3>Steps to give dbt Cloud read access to your data<a class="headerlink" href="#steps-to-give-dbt-cloud-read-access-to-your-data" title="Permalink to this headline"> </a></h3>
<p>Partner Connect gives create-only permission to the <strong>DBT_CLOUD_USER</strong> service principal only on the default catalog. Follow these steps in your Databricks workspace to give the <strong>DBT_CLOUD_USER</strong> service principal read access to the data that you choose.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>You can adapt these steps to give dbt Cloud additional access across catalogs, databases, and tables within your workspace. However, as a security best practice, Databricks strongly recommends that you give access only to the individual tables that you need the <strong>DBT_CLOUD_USER</strong> service principal to work with and only read access to those tables.</p>
</div>
<ol class="arabic">
<li><p>Click <img alt="Catalog icon" src="../../_images/data-icon.png" /> <strong>Catalog</strong> in the sidebar.</p></li>
<li><p>Select the SQL warehouse (<strong>DBT_CLOUD_ENDPOINT</strong>) in the drop-down list at the top right.</p>
<div class="figure align-default">
<img alt="Select warehouse" src="../../_images/select-endpoint.png" />
</div>
<ol class="loweralpha simple">
<li><p>Under <strong>Catalog Explorer</strong>, select the catalog that contains the database for your table.</p></li>
<li><p>Select the database that contains your table.</p></li>
<li><p>Select your table.</p></li>
</ol>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you do not see your catalog, database, or table listed, enter any portion of the name in the <strong>Select Catalog</strong>, <strong>Select Database</strong>, or <strong>Filter tables</strong> boxes, respectively, to narrow down the list.</p>
<div class="figure align-default">
<img alt="Filter tables" src="../../_images/filter-tables.png" />
</div>
</div>
</li>
<li><p>Click <strong>Permissions</strong>.</p></li>
<li><p>Click <strong>Grant</strong>.</p></li>
<li><p>For <strong>Type to add multiple users or groups</strong>, select <strong>DBT_CLOUD_USER</strong>. This is the Databricks service principal that Partner Connect created for you in the previous section.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you do not see <strong>DBT_CLOUD_USER</strong>, begin typing <code class="docutils literal notranslate"><span class="pre">DBT_CLOUD_USER</span></code> in the <strong>Type to add multiple users or groups</strong> box until it appears in the list, and then select it.</p>
</div>
</li>
<li><p>Grant read access only by selecting <strong>SELECT</strong> and <strong>READ_METADATA</strong>.</p></li>
<li><p>Click <strong>OK</strong>.</p></li>
</ol>
<p>Repeat steps 4-9 for each additional table that you want to give dbt Cloud read access to.</p>
</div>
<div class="section" id="troubleshoot-the-dbt-cloud-connection">
<span id="troubleshoot-partner-connect"></span><h3>Troubleshoot the dbt Cloud connection<a class="headerlink" href="#troubleshoot-the-dbt-cloud-connection" title="Permalink to this headline"> </a></h3>
<p>If someone deletes the project in dbt Cloud for this account, and you the click the <strong>dbt</strong> tile, an error message appears, stating that the project cannot be found. To fix this, click <strong>Delete connection</strong>, and then start from the beginning of this procedure to create the connection again.</p>
</div>
</div>
<div class="section" id="connect-to-dbt-cloud-manually">
<span id="manual-connection"></span><h2>Connect to dbt Cloud manually<a class="headerlink" href="#connect-to-dbt-cloud-manually" title="Permalink to this headline"> </a></h2>
<p>This section describes how to connect a Databricks cluster or a Databricks SQL warehouse in your Databricks workspace to dbt Cloud.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Databricks recommends connecting to a SQL warehouse. If you don’t have the Databricks SQL access entitlement, or if you want to run Python models, you can connect to a cluster instead.</p>
</div>
<div class="section" id="requirements">
<span id="manual-requirements"></span><h3>Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline"> </a></h3>
<ul>
<li><p>A cluster or SQL warehouse in your Databricks workspace.</p>
<ul class="simple">
<li><p><a class="reference internal" href="../../compute/configure.html"><span class="doc">Create a cluster</span></a>.</p></li>
<li><p><a class="reference internal" href="../../compute/sql-warehouse/create-sql-warehouse.html"><span class="doc">Configure SQL warehouses</span></a>.</p></li>
</ul>
</li>
<li><p>The connection details for your cluster or SQL warehouse, specifically the <strong>Server Hostname</strong>, <strong>Port</strong>, and <strong>HTTP Path</strong> values.</p>
<ul class="simple">
<li><p><a class="reference internal" href="../../integrations/jdbc-odbc-bi.html#connection-details-cluster"><span class="std std-ref">Get connection details for a cluster</span></a>.</p></li>
<li><p><a class="reference internal" href="../../integrations/jdbc-odbc-bi.html#sql"><span class="std std-ref">Get connection details for a SQL warehouse</span></a>.</p></li>
</ul>
</li>
<li><p>A Databricks <a class="reference internal" href="../../dev-tools/auth/pat.html"><span class="doc">personal access token</span></a>.. To create a personal access token, do the following:</p>
<ol class="arabic simple">
<li><p>In your Databricks workspace, click your Databricks username in the top bar, and then select <strong>User Settings</strong> from the drop down.</p></li>
<li><p>Click <strong>Developer</strong>.</p></li>
<li><p>Next to <strong>Access tokens</strong>, click <strong>Manage</strong>.</p></li>
<li><p>Click <strong>Generate new token</strong>.</p></li>
<li><p>(Optional) Enter a comment that helps you to identify this token in the future, and change the token’s default lifetime of 90 days. To create a token with no lifetime (not recommended), leave the <strong>Lifetime (days)</strong> box empty (blank).</p></li>
<li><p>Click <strong>Generate</strong>.</p></li>
<li><p>Copy the displayed token to a secure location, and then click <strong>Done</strong>.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Be sure to save the copied token in a secure location. Do not share your copied token with others. If you lose the copied token, you cannot regenerate that exact same token. Instead, you must repeat this procedure to create a new token. If you lose the copied token, or you believe that the token has been compromised, Databricks strongly recommends that you immediately delete that token from your workspace by clicking the trash can (<strong>Revoke</strong>) icon next to the token on the <strong>Access tokens</strong> page.</p>
<p>If you are not able to create or use tokens in your workspace, this might be because your workspace administrator has disabled tokens or has not given you permission to create or use tokens. See your workspace administrator or the following:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../../administration-guide/access-control/tokens.html#enable-tokens"><span class="std std-ref">Enable or disable personal access token authentication for the workspace</span></a></p></li>
<li><p><a class="reference internal" href="../../security/auth-authz/api-access-permissions.html#pat"><span class="std std-ref">Personal access token permissions</span></a></p></li>
</ul>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>As a security best practice when you authenticate with automated tools, systems, scripts, and apps, Databricks recommends that you use OAuth tokens.</p>
<p>If you use personal access token authentication, Databricks recommends using personal access tokens belonging to <a class="reference internal" href="../../administration-guide/users-groups/service-principals.html"><span class="doc">service principals</span></a> instead of workspace users. To create tokens for service principals, see <a class="reference internal" href="../../administration-guide/users-groups/service-principals.html#personal-access-tokens"><span class="std std-ref">Manage tokens for a service principal</span></a>.</p>
</div>
</li>
</ul>
<ul>
<li><p>To connect dbt Cloud to data managed by Unity Catalog, dbt version 1.1 or above.</p>
<p>The steps in this article create a new environment that uses the latest dbt version. For information about upgrading the dbt version for an existing environment, see <a class="reference external" href="https://docs.getdbt.com/docs/dbt-versions/upgrade-core-in-cloud#upgrading-to-the-latest-version-of-dbt-in-cloud">Upgrading to the latest version of dbt in Cloud</a> in the dbt documentation.</p>
</li>
</ul>
</div>
<div class="section" id="step-1-sign-up-for-dbt-cloud">
<span id="sign-up"></span><h3>Step 1: Sign up for dbt Cloud<a class="headerlink" href="#step-1-sign-up-for-dbt-cloud" title="Permalink to this headline"> </a></h3>
<p>Go to <a class="reference external" href="https://www.getdbt.com/signup/">dbt Cloud - Signup</a> and enter your email, name, and company information. Create a password and click <strong>Create my account</strong>.</p>
</div>
<div class="section" id="step-2-create-a-dbt-project">
<span id="create-project"></span><h3>Step 2: Create a dbt project<a class="headerlink" href="#step-2-create-a-dbt-project" title="Permalink to this headline"> </a></h3>
<p>In this step, you create a dbt <em>project</em>, which contains a connection to a Databricks cluster or a SQL warehouse, a repository that contains your source code, and one or more environments (such as testing and production environments).</p>
<ol class="arabic">
<li><p><a class="reference external" href="https://cloud.getdbt.com/login/">Sign in to dbt Cloud</a>.</p></li>
<li><p>Click the settings icon, and then click <strong>Account Settings</strong>.</p></li>
<li><p>Click <strong>New Project</strong>.</p></li>
<li><p>For <strong>Name</strong>, enter a unique name for your project, and then click <strong>Continue</strong>.</p></li>
<li><p>For <strong>Choose a connection</strong>, click <strong>Databricks</strong>, and then click <strong>Next</strong>.</p></li>
<li><p>For <strong>Name</strong>, enter a unique name for this connection.</p></li>
<li><p>For <strong>Select Adapter</strong>, click <strong>Databricks (dbt-databricks)</strong>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Databricks recommends using <code class="docutils literal notranslate"><span class="pre">dbt-databricks</span></code>, which supports Unity Catalog, instead of <code class="docutils literal notranslate"><span class="pre">dbt-spark</span></code>. By default, new projects use <code class="docutils literal notranslate"><span class="pre">dbt-databricks</span></code>. To migrate an existing project to <code class="docutils literal notranslate"><span class="pre">dbt-databricks</span></code>, see <a class="reference external" href="https://docs.getdbt.com/guides/migration/tools/migrating-from-spark-to-databricks">Migrating from dbt-spark to dbt-databricks</a> in the dbt documentation.</p>
</div>
</li>
<li><p>Under <strong>Settings</strong>, for <strong>Server Hostname</strong>, enter the server hostname value from the requirements.</p></li>
<li><p>For <strong>HTTP Path</strong>, enter the HTTP path value from the requirements.</p></li>
<li><p>If your workspace is Unity Catalog-enabled, under <strong>Optional Settings</strong>, enter the name of the catalog for dbt Cloud to use.</p></li>
<li><p>Under <strong>Development Credentials</strong>, for <strong>Token</strong>, enter the personal access token from the requirements.</p></li>
<li><p>For <strong>Schema</strong>, enter the name of the schema where you want dbt Cloud to create the tables and views (for example, <code class="docutils literal notranslate"><span class="pre">default</span></code>).</p></li>
<li><p>Click <strong>Test Connection</strong>.</p></li>
<li><p>If the test succeeds, click <strong>Next</strong>.</p></li>
</ol>
<p></p>
<p></p>
<p>For more information, see <a class="reference external" href="https://docs.getdbt.com/docs/dbt-cloud/cloud-configuring-dbt-cloud/connecting-your-database#connecting-to-databricks">Connecting to Databricks ODBC</a> on the dbt website.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>To view or change the settings for this project, or to delete the project altogether, click the settings icon, click <strong>Account Settings &gt; Projects</strong>, and click the name of the project. To change the settings, click <strong>Edit</strong>. To delete the project, click <strong>Edit &gt; Delete Project</strong>.</p>
<p>To view or change your Databricks personal access token value for this project, click the “person” icon, click <strong>Profile &gt; Credentials</strong>, and click the name of the project. To make a change, click <strong>Edit</strong>.</p>
</div>
<p>After you connect to a Databricks cluster or a Databricks SQL warehouse, follow the on-screen instructions to <strong>Setup a Repository</strong>, and then click <strong>Continue</strong>.</p>
<p>After you set up the repository, follow the on-screen instructions to invite users and then click <strong>Complete</strong>. Or click <strong>Skip &amp; Complete</strong>.</p>
</div>
</div>
<div class="section" id="tutorial">
<h2>Tutorial<a class="headerlink" href="#tutorial" title="Permalink to this headline"> </a></h2>
<p>In this section, you use your dbt Cloud project to work with some sample data. This section assumes that you have already created your project and have the dbt Cloud IDE open to that project.</p>
<div class="section" id="step-1-create-and-run-models">
<span id="create-model"></span><h3>Step 1: Create and run models<a class="headerlink" href="#step-1-create-and-run-models" title="Permalink to this headline"> </a></h3>
<p>In this step, you use the dbt Cloud IDE to create and run <em>models</em>, which are <code class="docutils literal notranslate"><span class="pre">select</span></code> statements that create either a new view (the default) or a new table in a database, based on existing data in that same database. This procedure creates a model based on the sample <code class="docutils literal notranslate"><span class="pre">diamonds</span></code> table from the <a class="reference internal" href="../../discover/databricks-datasets.html"><span class="doc">Sample datasets</span></a>, as described in the <a class="reference internal" href="../../getting-started/quick-start.html#step-3-create-a-table"><span class="std std-ref">Create a table</span></a> section of <a class="reference internal" href="../../getting-started/quick-start.html"><span class="doc">Tutorial: Query data with notebooks</span></a>. This procedure assumes this table has already been created in your workspace’s <code class="docutils literal notranslate"><span class="pre">default</span></code> database.</p>
<ol class="arabic">
<li><p>With the project open, click <strong>Develop</strong> at the top of the UI.</p></li>
<li><p>Click <strong>Initialize dbt project</strong>.</p></li>
<li><p>Click <strong>Commit and sync</strong>, enter a commit message, and then click <strong>Commit</strong>.</p></li>
<li><p>Click <strong>Create branch</strong>, enter a name for your branch, and then click <strong>Submit</strong>.</p></li>
<li><p>Create the first model: Click <strong>Create New File</strong>.</p></li>
<li><p>In the text editor, enter the following SQL statement. This statement selects only the carat, cut, color, and clarity details for each diamond from the <code class="docutils literal notranslate"><span class="pre">diamonds</span></code> table. The <code class="docutils literal notranslate"><span class="pre">config</span></code> block instructs dbt to create a table in the database based on this statement.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{{</span> <span class="n">config</span><span class="p">(</span>
  <span class="n">materialized</span><span class="o">=</span><span class="s1">&#39;table&#39;</span><span class="p">,</span>
  <span class="n">file_format</span><span class="o">=</span><span class="s1">&#39;delta&#39;</span>
<span class="p">)</span> <span class="p">}}</span>
</pre></div>
</div>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">select</span><span class="w"> </span><span class="n">carat</span><span class="p">,</span><span class="w"> </span><span class="n">cut</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="p">,</span><span class="w"> </span><span class="n">clarity</span>
<span class="k">from</span><span class="w"> </span><span class="n">diamonds</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>For additional <code class="docutils literal notranslate"><span class="pre">config</span></code> options such as the <code class="docutils literal notranslate"><span class="pre">merge</span></code> incremental strategy, see <a class="reference external" href="https://docs.getdbt.com/reference/resource-configs/databricks-configs">Databricks configurations</a> in the dbt documentation.</p>
</div>
</li>
<li><p>Click <strong>Save As</strong>.</p></li>
<li><p>For the filename, enter <code class="docutils literal notranslate"><span class="pre">models/diamonds_four_cs.sql</span></code> and then click <strong>Create</strong>.</p></li>
<li><p>Create a second model: Click <img alt="Create New File icon" src="../../_images/dbt-cloud-create-new-file.png" /> (<strong>Create New File</strong>) in the upper-right corner.</p></li>
<li><p>In the text editor, enter the following SQL statement. This statement selects unique values from the <code class="docutils literal notranslate"><span class="pre">colors</span></code> column in the <code class="docutils literal notranslate"><span class="pre">diamonds_four_cs</span></code> table, sorting the results in alphabetical order first to last. Because there is no <code class="docutils literal notranslate"><span class="pre">config</span></code> block, this model instructs dbt to create a view in the database based on this statement.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">select</span><span class="w"> </span><span class="k">distinct</span><span class="w"> </span><span class="n">color</span>
<span class="k">from</span><span class="w"> </span><span class="n">diamonds_four_cs</span>
<span class="n">sort</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="k">asc</span>
</pre></div>
</div>
</li>
<li><p>Click <strong>Save As</strong>.</p></li>
<li><p>For the filename, enter <code class="docutils literal notranslate"><span class="pre">models/diamonds_list_colors.sql</span></code>, and then click <strong>Create</strong>.</p></li>
<li><p>Create a third model: Click <img alt="Create New File icon" src="../../_images/dbt-cloud-create-new-file.png" /> (<strong>Create New File</strong>) in the upper-right corner.</p></li>
<li><p>In the text editor, enter the following SQL statement. This statement averages diamond prices by color, sorting the results by average price from highest to lowest. This model instructs dbt to create a view in the database based on this statement.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">select</span><span class="w"> </span><span class="n">color</span><span class="p">,</span><span class="w"> </span><span class="k">avg</span><span class="p">(</span><span class="n">price</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">price</span>
<span class="k">from</span><span class="w"> </span><span class="n">diamonds</span>
<span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">color</span>
<span class="k">order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">price</span><span class="w"> </span><span class="k">desc</span>
</pre></div>
</div>
</li>
<li><p>Click <strong>Save As</strong>.</p></li>
<li><p>For the filename, enter <code class="docutils literal notranslate"><span class="pre">models/diamonds_prices.sql</span></code> and click <strong>Create</strong>.</p></li>
<li><p>Run the models: In the command line, run the <code class="docutils literal notranslate"><span class="pre">dbt</span> <span class="pre">run</span></code> command with the paths to the three preceding files. In the <code class="docutils literal notranslate"><span class="pre">default</span></code> database, dbt creates one table named <code class="docutils literal notranslate"><span class="pre">diamonds_four_cs</span></code> and two views named <code class="docutils literal notranslate"><span class="pre">diamonds_list_colors</span></code> and <code class="docutils literal notranslate"><span class="pre">diamonds_prices</span></code>. dbt gets these view and table names from their related <code class="docutils literal notranslate"><span class="pre">.sql</span></code> file names.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>dbt<span class="w"> </span>run<span class="w"> </span>--model<span class="w"> </span>models/diamonds_four_cs.sql<span class="w"> </span>models/diamonds_list_colors.sql<span class="w"> </span>models/diamonds_prices.sql
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">...</span>
<span class="go">... | 1 of 3 START table model default.diamonds_four_cs.................... [RUN]</span>
<span class="go">... | 1 of 3 OK created table model default.diamonds_four_cs............... [OK ...]</span>
<span class="go">... | 2 of 3 START view model default.diamonds_list_colors................. [RUN]</span>
<span class="go">... | 2 of 3 OK created view model default.diamonds_list_colors............ [OK ...]</span>
<span class="go">... | 3 of 3 START view model default.diamonds_prices...................... [RUN]</span>
<span class="go">... | 3 of 3 OK created view model default.diamonds_prices................. [OK ...]</span>
<span class="go">... |</span>
<span class="go">... | Finished running 1 table model, 2 view models ...</span>

<span class="go">Completed successfully</span>

<span class="go">Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3</span>
</pre></div>
</div>
</li>
<li><p>Run the following SQL code to list information about the new views and to select all rows from the table and views.</p>
<p>If you are connecting to a cluster, you can run this SQL code from a <a class="reference internal" href="../../notebooks/notebooks-manage.html#create-a-notebook"><span class="std std-ref">notebook</span></a> that is attached to the cluster, specifying SQL as the default language for the notebook. If you are connecting to a SQL warehouse, you can run this SQL code from a <a class="reference internal" href="../../sql/user/queries/queries.html#create-a-query"><span class="std std-ref">query</span></a>.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SHOW</span><span class="w"> </span><span class="n">views</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="k">default</span>
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">+-----------+----------------------+-------------+</span>
<span class="go">| namespace | viewName             | isTemporary |</span>
<span class="go">+===========+======================+=============+</span>
<span class="go">| default   | diamonds_list_colors | false       |</span>
<span class="go">+-----------+----------------------+-------------+</span>
<span class="go">| default   | diamonds_prices      | false       |</span>
<span class="go">+-----------+----------------------+-------------+</span>
</pre></div>
</div>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">diamonds_four_cs</span>
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">+-------+---------+-------+---------+</span>
<span class="go">| carat | cut     | color | clarity |</span>
<span class="go">+=======+=========+=======+=========+</span>
<span class="go">| 0.23  | Ideal   | E     | SI2     |</span>
<span class="go">+-------+---------+-------+---------+</span>
<span class="go">| 0.21  | Premium | E     | SI1     |</span>
<span class="go">+-------+---------+-------+---------+</span>
<span class="go">...</span>
</pre></div>
</div>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">diamonds_list_colors</span>
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">+-------+</span>
<span class="go">| color |</span>
<span class="go">+=======+</span>
<span class="go">| D     |</span>
<span class="go">+-------+</span>
<span class="go">| E     |</span>
<span class="go">+-------+</span>
<span class="go">...</span>
</pre></div>
</div>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">diamonds_prices</span>
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">+-------+---------+</span>
<span class="go">| color | price   |</span>
<span class="go">+=======+=========+</span>
<span class="go">| J     | 5323.82 |</span>
<span class="go">+-------+---------+</span>
<span class="go">| I     | 5091.87 |</span>
<span class="go">+-------+---------+</span>
<span class="go">...</span>
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="step-2-create-and-run-more-complex-models">
<span id="complex-models"></span><h3>Step 2: Create and run more complex models<a class="headerlink" href="#step-2-create-and-run-more-complex-models" title="Permalink to this headline"> </a></h3>
<p>In this step, you create more complex models for a set of related data tables. These data tables contain information about a fictional sports league of three teams playing a season of six games. This procedure creates the data tables, creates the models, and runs the models.</p>
<ol class="arabic">
<li><p>Run the following SQL code to create the necessary data tables.</p>
<p>If you are connecting to a cluster, you can run this SQL code from a <a class="reference internal" href="../../notebooks/notebooks-manage.html#create-a-notebook"><span class="std std-ref">notebook</span></a> that is attached to the cluster, specifying SQL as the default language for the notebook. If you are connecting to a SQL warehouse, you can run this SQL code from a <a class="reference internal" href="../../sql/user/queries/queries.html#create-a-query"><span class="std std-ref">query</span></a>.</p>
<p>The tables and views in this step start with <code class="docutils literal notranslate"><span class="pre">zzz_</span></code> to help identify them as part of this example. You do not need to follow this pattern for your own tables and views.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">DROP</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="n">zzz_game_opponents</span><span class="p">;</span>
<span class="k">DROP</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="n">zzz_game_scores</span><span class="p">;</span>
<span class="k">DROP</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="n">zzz_games</span><span class="p">;</span>
<span class="k">DROP</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="n">zzz_teams</span><span class="p">;</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">zzz_game_opponents</span><span class="w"> </span><span class="p">(</span>
<span class="n">game_id</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span>
<span class="n">home_team_id</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span>
<span class="n">visitor_team_id</span><span class="w"> </span><span class="nb">INT</span>
<span class="p">)</span><span class="w"> </span><span class="k">USING</span><span class="w"> </span><span class="n">DELTA</span><span class="p">;</span>

<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">zzz_game_opponents</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">zzz_game_opponents</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">);</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">zzz_game_opponents</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">zzz_game_opponents</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">);</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">zzz_game_opponents</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">zzz_game_opponents</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>

<span class="c1">-- Result:</span>
<span class="c1">-- +---------+--------------+-----------------+</span>
<span class="c1">-- | game_id | home_team_id | visitor_team_id |</span>
<span class="c1">-- +=========+==============+=================+</span>
<span class="c1">-- | 1       | 1            | 2               |</span>
<span class="c1">-- +---------+--------------+-----------------+</span>
<span class="c1">-- | 2       | 1            | 3               |</span>
<span class="c1">-- +---------+--------------+-----------------+</span>
<span class="c1">-- | 3       | 2            | 1               |</span>
<span class="c1">-- +---------+--------------+-----------------+</span>
<span class="c1">-- | 4       | 2            | 3               |</span>
<span class="c1">-- +---------+--------------+-----------------+</span>
<span class="c1">-- | 5       | 3            | 1               |</span>
<span class="c1">-- +---------+--------------+-----------------+</span>
<span class="c1">-- | 6       | 3            | 2               |</span>
<span class="c1">-- +---------+--------------+-----------------+</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">zzz_game_scores</span><span class="w"> </span><span class="p">(</span>
<span class="n">game_id</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span>
<span class="n">home_team_score</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span>
<span class="n">visitor_team_score</span><span class="w"> </span><span class="nb">INT</span>
<span class="p">)</span><span class="w"> </span><span class="k">USING</span><span class="w"> </span><span class="n">DELTA</span><span class="p">;</span>

<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">zzz_game_scores</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">zzz_game_scores</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">zzz_game_scores</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">zzz_game_scores</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">zzz_game_scores</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">zzz_game_scores</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>

<span class="c1">-- Result:</span>
<span class="c1">-- +---------+-----------------+--------------------+</span>
<span class="c1">-- | game_id | home_team_score | visitor_team_score |</span>
<span class="c1">-- +=========+=================+====================+</span>
<span class="c1">-- | 1       | 4               | 2                  |</span>
<span class="c1">-- +---------+-----------------+--------------------+</span>
<span class="c1">-- | 2       | 0               | 1                  |</span>
<span class="c1">-- +---------+-----------------+--------------------+</span>
<span class="c1">-- | 3       | 1               | 2                  |</span>
<span class="c1">-- +---------+-----------------+--------------------+</span>
<span class="c1">-- | 4       | 3               | 2                  |</span>
<span class="c1">-- +---------+-----------------+--------------------+</span>
<span class="c1">-- | 5       | 3               | 0                  |</span>
<span class="c1">-- +---------+-----------------+--------------------+</span>
<span class="c1">-- | 6       | 3               | 1                  |</span>
<span class="c1">-- +---------+-----------------+--------------------+</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">zzz_games</span><span class="w"> </span><span class="p">(</span>
<span class="n">game_id</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span>
<span class="n">game_date</span><span class="w"> </span><span class="nb">DATE</span>
<span class="p">)</span><span class="w"> </span><span class="k">USING</span><span class="w"> </span><span class="n">DELTA</span><span class="p">;</span>

<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">zzz_games</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;2020-12-12&#39;</span><span class="p">);</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">zzz_games</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;2021-01-09&#39;</span><span class="p">);</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">zzz_games</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;2020-12-19&#39;</span><span class="p">);</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">zzz_games</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;2021-01-16&#39;</span><span class="p">);</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">zzz_games</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;2021-01-23&#39;</span><span class="p">);</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">zzz_games</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;2021-02-06&#39;</span><span class="p">);</span>

<span class="c1">-- Result:</span>
<span class="c1">-- +---------+------------+</span>
<span class="c1">-- | game_id | game_date  |</span>
<span class="c1">-- +=========+============+</span>
<span class="c1">-- | 1       | 2020-12-12 |</span>
<span class="c1">-- +---------+------------+</span>
<span class="c1">-- | 2       | 2021-01-09 |</span>
<span class="c1">-- +---------+------------+</span>
<span class="c1">-- | 3       | 2020-12-19 |</span>
<span class="c1">-- +---------+------------+</span>
<span class="c1">-- | 4       | 2021-01-16 |</span>
<span class="c1">-- +---------+------------+</span>
<span class="c1">-- | 5       | 2021-01-23 |</span>
<span class="c1">-- +---------+------------+</span>
<span class="c1">-- | 6       | 2021-02-06 |</span>
<span class="c1">-- +---------+------------+</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">zzz_teams</span><span class="w"> </span><span class="p">(</span>
<span class="n">team_id</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span>
<span class="n">team_city</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<span class="p">)</span><span class="w"> </span><span class="k">USING</span><span class="w"> </span><span class="n">DELTA</span><span class="p">;</span>

<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">zzz_teams</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;San Francisco&quot;</span><span class="p">);</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">zzz_teams</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;Seattle&quot;</span><span class="p">);</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">zzz_teams</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;Amsterdam&quot;</span><span class="p">);</span>

<span class="c1">-- Result:</span>
<span class="c1">-- +---------+---------------+</span>
<span class="c1">-- | team_id | team_city     |</span>
<span class="c1">-- +=========+===============+</span>
<span class="c1">-- | 1       | San Francisco |</span>
<span class="c1">-- +---------+---------------+</span>
<span class="c1">-- | 2       | Seattle       |</span>
<span class="c1">-- +---------+---------------+</span>
<span class="c1">-- | 3       | Amsterdam     |</span>
<span class="c1">-- +---------+---------------+</span>
</pre></div>
</div>
</li>
<li><p>Create the first model: Click <img alt="Create New File icon" src="../../_images/dbt-cloud-create-new-file.png" /> (<strong>Create New File</strong>) in the upper-right corner.</p></li>
<li><p>In the text editor, enter the following SQL statement. This statement creates a table that provides the details of each game, such as team names and scores. The <code class="docutils literal notranslate"><span class="pre">config</span></code> block instructs dbt to create a table in the database based on this statement.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="c1">-- Create a table that provides full details for each game, including</span>
<span class="c1">-- the game ID, the home and visiting teams&#39; city names and scores,</span>
<span class="c1">-- the game winner&#39;s city name, and the game date.</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{{</span> <span class="n">config</span><span class="p">(</span>
  <span class="n">materialized</span><span class="o">=</span><span class="s1">&#39;table&#39;</span><span class="p">,</span>
  <span class="n">file_format</span><span class="o">=</span><span class="s1">&#39;delta&#39;</span>
<span class="p">)</span> <span class="p">}}</span>
</pre></div>
</div>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="c1">-- Step 4 of 4: Replace the visitor team IDs with their city names.</span>
<span class="k">select</span>
<span class="w">  </span><span class="n">game_id</span><span class="p">,</span>
<span class="w">  </span><span class="n">home</span><span class="p">,</span>
<span class="w">  </span><span class="n">t</span><span class="p">.</span><span class="n">team_city</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">visitor</span><span class="p">,</span>
<span class="w">  </span><span class="n">home_score</span><span class="p">,</span>
<span class="w">  </span><span class="n">visitor_score</span><span class="p">,</span>
<span class="w">  </span><span class="c1">-- Step 3 of 4: Display the city name for each game&#39;s winner.</span>
<span class="w">  </span><span class="k">case</span>
<span class="w">    </span><span class="k">when</span>
<span class="w">      </span><span class="n">home_score</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">visitor_score</span>
<span class="w">        </span><span class="k">then</span>
<span class="w">          </span><span class="n">home</span>
<span class="w">    </span><span class="k">when</span>
<span class="w">      </span><span class="n">visitor_score</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">home_score</span>
<span class="w">        </span><span class="k">then</span>
<span class="w">          </span><span class="n">t</span><span class="p">.</span><span class="n">team_city</span>
<span class="w">  </span><span class="k">end</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">winner</span><span class="p">,</span>
<span class="w">  </span><span class="n">game_date</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nb">date</span>
<span class="k">from</span><span class="w"> </span><span class="p">(</span>
<span class="w">  </span><span class="c1">-- Step 2 of 4: Replace the home team IDs with their actual city names.</span>
<span class="w">  </span><span class="k">select</span>
<span class="w">    </span><span class="n">game_id</span><span class="p">,</span>
<span class="w">    </span><span class="n">t</span><span class="p">.</span><span class="n">team_city</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">home</span><span class="p">,</span>
<span class="w">    </span><span class="n">home_score</span><span class="p">,</span>
<span class="w">    </span><span class="n">visitor_team_id</span><span class="p">,</span>
<span class="w">    </span><span class="n">visitor_score</span><span class="p">,</span>
<span class="w">    </span><span class="n">game_date</span>
<span class="w">  </span><span class="k">from</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="c1">-- Step 1 of 4: Combine data from various tables (for example, game and team IDs, scores, dates).</span>
<span class="w">    </span><span class="k">select</span>
<span class="w">      </span><span class="k">g</span><span class="p">.</span><span class="n">game_id</span><span class="p">,</span>
<span class="w">      </span><span class="k">go</span><span class="p">.</span><span class="n">home_team_id</span><span class="p">,</span>
<span class="w">      </span><span class="n">gs</span><span class="p">.</span><span class="n">home_team_score</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">home_score</span><span class="p">,</span>
<span class="w">      </span><span class="k">go</span><span class="p">.</span><span class="n">visitor_team_id</span><span class="p">,</span>
<span class="w">      </span><span class="n">gs</span><span class="p">.</span><span class="n">visitor_team_score</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">visitor_score</span><span class="p">,</span>
<span class="w">      </span><span class="k">g</span><span class="p">.</span><span class="n">game_date</span>
<span class="w">    </span><span class="k">from</span>
<span class="w">      </span><span class="n">zzz_games</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="k">g</span><span class="p">,</span>
<span class="w">      </span><span class="n">zzz_game_opponents</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="k">go</span><span class="p">,</span>
<span class="w">      </span><span class="n">zzz_game_scores</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">gs</span>
<span class="w">    </span><span class="k">where</span>
<span class="w">      </span><span class="k">g</span><span class="p">.</span><span class="n">game_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">go</span><span class="p">.</span><span class="n">game_id</span><span class="w"> </span><span class="k">and</span>
<span class="w">      </span><span class="k">g</span><span class="p">.</span><span class="n">game_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gs</span><span class="p">.</span><span class="n">game_id</span>
<span class="w">  </span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">all_ids</span><span class="p">,</span>
<span class="w">    </span><span class="n">zzz_teams</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">t</span>
<span class="w">  </span><span class="k">where</span>
<span class="w">    </span><span class="n">all_ids</span><span class="p">.</span><span class="n">home_team_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="n">team_id</span>
<span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">visitor_ids</span><span class="p">,</span>
<span class="w">  </span><span class="n">zzz_teams</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">t</span>
<span class="k">where</span>
<span class="w">  </span><span class="n">visitor_ids</span><span class="p">.</span><span class="n">visitor_team_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="n">team_id</span>
<span class="k">order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">game_date</span><span class="w"> </span><span class="k">desc</span>
</pre></div>
</div>
</li>
<li><p>Click <strong>Save As</strong>.</p></li>
<li><p>For the filename, enter <code class="docutils literal notranslate"><span class="pre">models/zzz_game_details.sql</span></code> and then click <strong>Create</strong>.</p></li>
<li><p>Create a second model: Click <img alt="Create New File icon" src="../../_images/dbt-cloud-create-new-file.png" /> (<strong>Create New File</strong>) in the upper-right corner.</p></li>
<li><p>In the text editor, enter the following SQL statement. This statement creates a view that lists team win-loss records for the season.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="c1">-- Create a view that summarizes the season&#39;s win and loss records by team.</span>

<span class="c1">-- Step 2 of 2: Calculate the number of wins and losses for each team.</span>
<span class="k">select</span>
<span class="w">  </span><span class="n">winner</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">team</span><span class="p">,</span>
<span class="w">  </span><span class="k">count</span><span class="p">(</span><span class="n">winner</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">wins</span><span class="p">,</span>
<span class="w">  </span><span class="c1">-- Each team played in 4 games.</span>
<span class="w">  </span><span class="p">(</span><span class="mi">4</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="n">winner</span><span class="p">))</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">losses</span>
<span class="k">from</span><span class="w"> </span><span class="p">(</span>
<span class="w">  </span><span class="c1">-- Step 1 of 2: Determine the winner and loser for each game.</span>
<span class="w">  </span><span class="k">select</span>
<span class="w">    </span><span class="n">game_id</span><span class="p">,</span>
<span class="w">    </span><span class="n">winner</span><span class="p">,</span>
<span class="w">    </span><span class="k">case</span>
<span class="w">      </span><span class="k">when</span>
<span class="w">        </span><span class="n">home</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">winner</span>
<span class="w">          </span><span class="k">then</span>
<span class="w">            </span><span class="n">visitor</span>
<span class="w">      </span><span class="k">else</span>
<span class="w">        </span><span class="n">home</span>
<span class="w">    </span><span class="k">end</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">loser</span>
<span class="w">  </span><span class="k">from</span><span class="w"> </span><span class="n">zzz_game_details</span>
<span class="p">)</span>
<span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">winner</span>
<span class="k">order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">wins</span><span class="w"> </span><span class="k">desc</span>
</pre></div>
</div>
</li>
<li><p>Click <strong>Save As</strong>.</p></li>
<li><p>For the filename, enter <code class="docutils literal notranslate"><span class="pre">models/zzz_win_loss_records.sql</span></code> and then click <strong>Create</strong>.</p></li>
<li><p>Run the models: In the command line, run the <code class="docutils literal notranslate"><span class="pre">dbt</span> <span class="pre">run</span></code> command with the paths to the two preceding files. In the <code class="docutils literal notranslate"><span class="pre">default</span></code> database (as specified in your project settings), dbt creates one table named <code class="docutils literal notranslate"><span class="pre">zzz_game_details</span></code> and one view named <code class="docutils literal notranslate"><span class="pre">zzz_win_loss_records</span></code>. dbt gets these view and table names from their related <code class="docutils literal notranslate"><span class="pre">.sql</span></code> file names.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>dbt<span class="w"> </span>run<span class="w"> </span>--model<span class="w"> </span>models/zzz_game_details.sql<span class="w"> </span>models/zzz_win_loss_records.sql
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">...</span>
<span class="go">... | 1 of 2 START table model default.zzz_game_details.................... [RUN]</span>
<span class="go">... | 1 of 2 OK created table model default.zzz_game_details............... [OK ...]</span>
<span class="go">... | 2 of 2 START view model default.zzz_win_loss_records................. [RUN]</span>
<span class="go">... | 2 of 2 OK created view model default.zzz_win_loss_records............ [OK ...]</span>
<span class="go">... |</span>
<span class="go">... | Finished running 1 table model, 1 view model ...</span>

<span class="go">Completed successfully</span>

<span class="go">Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2</span>
</pre></div>
</div>
</li>
<li><p>Run the following SQL code to list information about the new view and to select all rows from the table and view.</p>
<p>If you are connecting to a cluster, you can run this SQL code from a <a class="reference internal" href="../../notebooks/notebooks-manage.html#create-a-notebook"><span class="std std-ref">notebook</span></a> that is attached to the cluster, specifying SQL as the default language for the notebook. If you are connecting to a SQL warehouse, you can run this SQL code from a <a class="reference internal" href="../../sql/user/queries/queries.html#create-a-query"><span class="std std-ref">query</span></a>.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SHOW</span><span class="w"> </span><span class="n">VIEWS</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;zzz_win_loss_records&#39;</span><span class="p">;</span>
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">+-----------+----------------------+-------------+</span>
<span class="go">| namespace | viewName             | isTemporary |</span>
<span class="go">+===========+======================+=============+</span>
<span class="go">| default   | zzz_win_loss_records | false       |</span>
<span class="go">+-----------+----------------------+-------------+</span>
</pre></div>
</div>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">zzz_game_details</span><span class="p">;</span>
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">+---------+---------------+---------------+------------+---------------+---------------+------------+</span>
<span class="go">| game_id | home          | visitor       | home_score | visitor_score | winner        | date       |</span>
<span class="go">+=========+===============+===============+============+===============+===============+============+</span>
<span class="go">| 1       | San Francisco | Seattle       | 4          | 2             | San Francisco | 2020-12-12 |</span>
<span class="go">+---------+---------------+---------------+------------+---------------+---------------+------------+</span>
<span class="go">| 2       | San Francisco | Amsterdam     | 0          | 1             | Amsterdam     | 2021-01-09 |</span>
<span class="go">+---------+---------------+---------------+------------+---------------+---------------+------------+</span>
<span class="go">| 3       | Seattle       | San Francisco | 1          | 2             | San Francisco | 2020-12-19 |</span>
<span class="go">+---------+---------------+---------------+------------+---------------+---------------+------------+</span>
<span class="go">| 4       | Seattle       | Amsterdam     | 3          | 2             | Seattle       | 2021-01-16 |</span>
<span class="go">+---------+---------------+---------------+------------+---------------+---------------+------------+</span>
<span class="go">| 5       | Amsterdam     | San Francisco | 3          | 0             | Amsterdam     | 2021-01-23 |</span>
<span class="go">+---------+---------------+---------------+------------+---------------+---------------+------------+</span>
<span class="go">| 6       | Amsterdam     | Seattle       | 3          | 1             | Amsterdam     | 2021-02-06 |</span>
<span class="go">+---------+---------------+---------------+------------+---------------+---------------+------------+</span>
</pre></div>
</div>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">zzz_win_loss_records</span><span class="p">;</span>
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">+---------------+------+--------+</span>
<span class="go">| team          | wins | losses |</span>
<span class="go">+===============+======+========+</span>
<span class="go">| Amsterdam     | 3    | 1      |</span>
<span class="go">+---------------+------+--------+</span>
<span class="go">| San Francisco | 2    | 2      |</span>
<span class="go">+---------------+------+--------+</span>
<span class="go">| Seattle       | 1    | 3      |</span>
<span class="go">+---------------+------+--------+</span>
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="step-3-create-and-run-tests">
<span id="tests"></span><h3>Step 3: Create and run tests<a class="headerlink" href="#step-3-create-and-run-tests" title="Permalink to this headline"> </a></h3>
<p>In this step, you create <em>tests</em>, which are assertions you make about your models. When you run these tests, dbt tells you if each test in your project passes or fails.</p>
<p>There are two type of tests. <em>Schema tests</em>, written in YAML, return the number of records that do not pass an assertion. When this number is zero, all records pass, therefore the tests pass. <em>Data tests</em> are specific queries that must return zero records to pass.</p>
<ol class="arabic">
<li><p>Create the schema tests: Click <img alt="Create New File icon" src="../../_images/dbt-cloud-create-new-file.png" /> (<strong>Create New File</strong>) in the upper-right corner.</p></li>
<li><p>In the text editor, enter the following content. This file includes schema tests that determine whether the specified columns have unique values, are not null, have only the specified values, or a combination.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>

<span class="nt">models</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">zzz_game_details</span>
<span class="w">    </span><span class="nt">columns</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">game_id</span>
<span class="w">        </span><span class="nt">tests</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unique</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not_null</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">home</span>
<span class="w">        </span><span class="nt">tests</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not_null</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">accepted_values</span><span class="p">:</span>
<span class="w">              </span><span class="nt">values</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;Amsterdam&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;San</span><span class="nv"> </span><span class="s">Francisco&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;Seattle&#39;</span><span class="p p-Indicator">]</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">visitor</span>
<span class="w">        </span><span class="nt">tests</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not_null</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">accepted_values</span><span class="p">:</span>
<span class="w">              </span><span class="nt">values</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;Amsterdam&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;San</span><span class="nv"> </span><span class="s">Francisco&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;Seattle&#39;</span><span class="p p-Indicator">]</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">home_score</span>
<span class="w">        </span><span class="nt">tests</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not_null</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">visitor_score</span>
<span class="w">        </span><span class="nt">tests</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not_null</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">winner</span>
<span class="w">        </span><span class="nt">tests</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not_null</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">accepted_values</span><span class="p">:</span>
<span class="w">              </span><span class="nt">values</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;Amsterdam&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;San</span><span class="nv"> </span><span class="s">Francisco&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;Seattle&#39;</span><span class="p p-Indicator">]</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">date</span>
<span class="w">        </span><span class="nt">tests</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not_null</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">zzz_win_loss_records</span>
<span class="w">    </span><span class="nt">columns</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">team</span>
<span class="w">        </span><span class="nt">tests</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unique</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not_null</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">relationships</span><span class="p">:</span>
<span class="w">              </span><span class="nt">to</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ref(&#39;zzz_game_details&#39;)</span>
<span class="w">              </span><span class="nt">field</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">home</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">wins</span>
<span class="w">        </span><span class="nt">tests</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not_null</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">losses</span>
<span class="w">        </span><span class="nt">tests</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not_null</span>
</pre></div>
</div>
</li>
<li><p>Click <strong>Save As</strong>.</p></li>
<li><p>For the filename, enter <code class="docutils literal notranslate"><span class="pre">models/schema.yml</span></code>, and then click <strong>Create</strong>.</p></li>
<li><p>Create the first data test: Click <img alt="Create New File icon" src="../../_images/dbt-cloud-create-new-file.png" /> (<strong>Create New File</strong>) in the upper-right corner.</p></li>
<li><p>In the text editor, enter the following SQL statement. This file includes a data test to determine whether any games happened outside of the regular season.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="c1">-- This season&#39;s games happened between 2020-12-12 and 2021-02-06.</span>
<span class="c1">-- For this test to pass, this query must return no results.</span>

<span class="k">select</span><span class="w"> </span><span class="nb">date</span>
<span class="k">from</span><span class="w"> </span><span class="n">zzz_game_details</span>
<span class="k">where</span><span class="w"> </span><span class="nb">date</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="s1">&#39;2020-12-12&#39;</span>
<span class="k">or</span><span class="w"> </span><span class="nb">date</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="s1">&#39;2021-02-06&#39;</span>
</pre></div>
</div>
</li>
<li><p>Click <strong>Save As</strong>.</p></li>
<li><p>For the filename, enter <code class="docutils literal notranslate"><span class="pre">tests/zzz_game_details_check_dates.sql</span></code>, and then click <strong>Create</strong>.</p></li>
<li><p>Create a second data test: Click <img alt="Create New File icon" src="../../_images/dbt-cloud-create-new-file.png" /> (<strong>Create New File</strong>) in the upper-right corner.</p></li>
<li><p>In the text editor, enter the following SQL statement. This file includes a data test to determine whether any scores were negative or any games were tied.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="c1">-- This sport allows no negative scores or tie games.</span>
<span class="c1">-- For this test to pass, this query must return no results.</span>

<span class="k">select</span><span class="w"> </span><span class="n">home_score</span><span class="p">,</span><span class="w"> </span><span class="n">visitor_score</span>
<span class="k">from</span><span class="w"> </span><span class="n">zzz_game_details</span>
<span class="k">where</span><span class="w"> </span><span class="n">home_score</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span>
<span class="k">or</span><span class="w"> </span><span class="n">visitor_score</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span>
<span class="k">or</span><span class="w"> </span><span class="n">home_score</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">visitor_score</span>
</pre></div>
</div>
</li>
<li><p>Click <strong>Save As</strong>.</p></li>
<li><p>For the filename, enter <code class="docutils literal notranslate"><span class="pre">tests/zzz_game_details_check_scores.sql</span></code>, and then click <strong>Create</strong>.</p></li>
<li><p>Create a third data test: Click <img alt="Create New File icon" src="../../_images/dbt-cloud-create-new-file.png" /> (<strong>Create New File</strong>) in the upper-right corner.</p></li>
<li><p>In the text editor, enter the following SQL statement. This file includes a data test to determine whether any teams had negative win or loss records, had more win or loss records than games played, or played more games than were allowed.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="c1">-- Each team participated in 4 games this season.</span>
<span class="c1">-- For this test to pass, this query must return no results.</span>

<span class="k">select</span><span class="w"> </span><span class="n">wins</span><span class="p">,</span><span class="w"> </span><span class="n">losses</span>
<span class="k">from</span><span class="w"> </span><span class="n">zzz_win_loss_records</span>
<span class="k">where</span><span class="w"> </span><span class="n">wins</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="n">wins</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">4</span>
<span class="k">or</span><span class="w"> </span><span class="n">losses</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="n">losses</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">4</span>
<span class="k">or</span><span class="w"> </span><span class="p">(</span><span class="n">wins</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">losses</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">4</span>
</pre></div>
</div>
</li>
<li><p>Click <strong>Save As</strong>.</p></li>
<li><p>For the filename, enter <code class="docutils literal notranslate"><span class="pre">tests/zzz_win_loss_records_check_records.sql</span></code>, and then click <strong>Create</strong>.</p></li>
<li><p>Run the tests: In the command line, run the <code class="docutils literal notranslate"><span class="pre">dbt</span> <span class="pre">test</span></code> command.</p></li>
</ol>
</div>
<div class="section" id="step-4-clean-up">
<span id="clean-up"></span><h3>Step 4: Clean up<a class="headerlink" href="#step-4-clean-up" title="Permalink to this headline"> </a></h3>
<p>You can delete the tables and views you created for this example by running the following SQL code.</p>
<p>If you are connecting to a cluster, you can run this SQL code from a <a class="reference internal" href="../../notebooks/notebooks-manage.html#create-a-notebook"><span class="std std-ref">notebook</span></a> that is attached to the cluster, specifying SQL as the default language for the notebook. If you are connecting to a SQL warehouse, you can run this SQL code from a <a class="reference internal" href="../../sql/user/queries/queries.html#create-a-query"><span class="std std-ref">query</span></a>.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">DROP</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">zzz_game_opponents</span><span class="p">;</span>
<span class="k">DROP</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">zzz_game_scores</span><span class="p">;</span>
<span class="k">DROP</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">zzz_games</span><span class="p">;</span>
<span class="k">DROP</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">zzz_teams</span><span class="p">;</span>
<span class="k">DROP</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">zzz_game_details</span><span class="p">;</span>
<span class="k">DROP</span><span class="w"> </span><span class="k">VIEW</span><span class="w"> </span><span class="n">zzz_win_loss_records</span><span class="p">;</span>

<span class="k">DROP</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">diamonds</span><span class="p">;</span>
<span class="k">DROP</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">diamonds_four_cs</span><span class="p">;</span>
<span class="k">DROP</span><span class="w"> </span><span class="k">VIEW</span><span class="w"> </span><span class="n">diamonds_list_colors</span><span class="p">;</span>
<span class="k">DROP</span><span class="w"> </span><span class="k">VIEW</span><span class="w"> </span><span class="n">diamonds_prices</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="next-steps">
<h2>Next steps<a class="headerlink" href="#next-steps" title="Permalink to this headline"> </a></h2>
<ul class="simple">
<li><p>Learn more about dbt <a class="reference external" href="https://docs.getdbt.com/docs/building-a-dbt-project/building-models">models</a>.</p></li>
<li><p>Learn how to <a class="reference external" href="https://docs.getdbt.com/docs/building-a-dbt-project/tests">test</a> your dbt projects.</p></li>
<li><p>Learn how to use <a class="reference external" href="https://docs.getdbt.com/docs/building-a-dbt-project/jinja-macros">Jinja</a>, a templating language, for programming SQL in your dbt projects.</p></li>
<li><p>Learn about dbt <a class="reference external" href="https://docs.getdbt.com/docs/guides/best-practices">best practices</a>.</p></li>
</ul>
</div>
<div class="section" id="additional-resources">
<h2>Additional resources<a class="headerlink" href="#additional-resources" title="Permalink to this headline"> </a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://blog.getdbt.com/what--exactly--is-dbt-/">What, exactly, is dbt?</a></p></li>
<li><p><a class="reference external" href="https://docs.getdbt.com/docs/introduction">General dbt documentation</a></p></li>
<li><p><a class="reference external" href="https://github.com/dbt-labs/dbt">dbt-core GitHub repository</a></p></li>
<li><p><a class="reference external" href="https://docs.getdbt.com/dbt-cli/cli-overview">dbt CLI</a></p></li>
<li><p><a class="reference external" href="https://www.getdbt.com/pricing/">dbt pricing</a></p></li>
<li><p><a class="reference external" href="https://blog.getdbt.com/analytics-engineering-for-everyone-databricks-in-dbt-cloud/">Analytics Engineering for Everyone: Databricks in dbt Cloud</a></p></li>
<li><p><a class="reference external" href="https://docs.getdbt.com/docs/dbt-cloud/cloud-overview">dbt Cloud overview</a></p></li>
<li><p><a class="reference external" href="https://docs.getdbt.com/docs/dbt-cloud/cloud-configuring-dbt-cloud/connecting-your-database#connecting-to-databricks">Connecting to Databricks</a></p></li>
<li><p><a class="reference external" href="https://discourse.getdbt.com/">dbt Discourse community</a></p></li>
<li><p><a class="reference external" href="https://blog.getdbt.com/">dbt blog</a></p></li>
<li><p><a class="reference external" href="https://docs.getdbt.com/docs/dbt-cloud/cloud-dbt-cloud-support">Support</a></p></li>
</ul>
</div>
</div>


    
          </div>
        </div>
        <div  class="suapp-rating">
  <div id="suPageRateApp">
     <su-app></su-app>
   </div> 
 </div>
<hr> 
<footer>
  <div role="contentinfo">
      <p class="copyright">
          &copy; Databricks 2023. All rights reserved. Apache, Apache Spark, Spark, and the Spark logo are trademarks of the <a href="http://www.apache.org/">Apache Software Foundation</a>.
      </p>
      <p> 
        
          <a id='feedbacklink' href="mailto:doc-feedback@databricks.com?subject=Documentation Feedback">Send us feedback</a>
        
     | <a href="https://databricks.com/privacy-policy">Privacy Policy</a> | <a href="https://databricks.com/terms-of-use">Terms of Use</a></p>

  </div> 

</footer>
      </div>
    </div>
  </section>
</main>

  </page>
  
  <script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
      URL_ROOT: '../../',
      VERSION: '1.0',
      COLLAPSE_INDEX: false,
      FILE_SUFFIX: '.html',
      HAS_SOURCE: 'false'
    };
  </script>
  <script type="text/javascript" src="../../_static/jquery.js"></script>
  <script type="text/javascript" src="../../_static/underscore.js"></script>
  <script type="text/javascript" src="../../_static/doctools.js"></script>
  <script type="text/javascript" src="../../_static/language_data.js"></script>
  

  <script type="text/javascript" src="../../_static/js/clipboard.min.js"></script>
  <script type="text/javascript" src="../../_static/js/jquery.waypoints.min.js"></script>

  <!-- Select2 (https://select2.org/) -->
  <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
  <!-- End Select2 -->

  
  
  <script type="text/javascript" src="../../_static/js/localized.js"></script>
  <script type="text/javascript" src="../../_static/js/custom.js"></script>
  

  
  
  <script type="text/javascript">
    jQuery(function () {
      SphinxRtdTheme.StickyNav.enable();
    });

  </script>
  
 



  <script>
  window.__searchunifyLoaderConfig = JSON.parse('{"clients": {"en": "02c2e804-27e9-11ee-aefb-0242ac120011", "ja": "6a42c3f2-2820-11ee-aefb-0242ac120011", "pt": "6a86badd-2821-11ee-aefb-0242ac120011"}}')
</script>
<script type="text/javascript" src="../../_static/js/search-loader.js"></script>
</body>
<script type='text/javascript'>
  window.onload = function () {
    var description = document.querySelector('meta[name="description"]').getAttribute("content");
    let titleText = document.querySelector('h1').textContent;
    document.querySelector('meta[property="og:title"]').setAttribute("content", titleText);
    document.querySelector('meta[property="og:description"]').setAttribute("content", description);
    document.querySelector('meta[property="twitter:description"]').setAttribute("content", description);
  };
</script>

</html>