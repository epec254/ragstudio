

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en-US" > <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en-US"> <!--<![endif]-->

<head>
  <!-- cookie consent -->
  
    <!-- Combined Onetrust and Rudderstack Implementation Scripts -->
    <!-- Onetrust Initialization -->
    <script type="text/javascript" src="https://cdn.cookielaw.org/consent/92466579-1717-44d3-809d-a05fb02843ed-test/OtAutoBlock.js"></script>
    <script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" data-document-language="true" type="text/javascript" charset="UTF-8" data-domain-script="92466579-1717-44d3-809d-a05fb02843ed-test"></script>
    <link rel="stylesheet" id="db-onetrust-style" href="https://www.databricks.com/wp-content/uploads/db_onetrust.css" media="all" />
    <!-- Setting Rudderstack Write Key -->
    <script>window.rudderstackKey = "2SOR9fvSr5Fi6tN2ihPbVHnX1SZ" </script>
    <!-- Rudderstack Initialization + Onetrust Integration + Rudderstack Custom Events -->
    <script type="text/javascript" src="https://www.databricks.com/sites/default/files/rudderstack/v1/db-rudderstack-events.js"></script>

  <!-- cookie consent -->

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="X-UA-Compatible" content="IE=9" />
  <meta content="Learn about the metric tables and dashboard created by Databricks Lakehouse Monitoring." name="description" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
  <meta property="og:image" content="https://www.databricks.com/wp-content/uploads/2020/04/og-databricks.png">
  <meta property="og:image:type" content="image/png">
  <meta property="og:title" content="Monitor metric tables">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://docs.databricks.com">
  <meta property="og:description" content="" id="og-description">
  <meta name="twitter:image" content="https://www.databricks.com/wp-content/uploads/2020/04/og-databricks.png">
  <meta name="twitter:site" content="@databricks">
  <meta name="twitter:creator" content="@databricks">
  <meta property="twitter:description" content="">
  
  <title>Monitor metric tables &#124; Databricks on AWS</title>
  
  
  <link rel="canonical" href="https://docs.databricks.com/en/lakehouse-monitoring/monitor-output.html">
  <!-- Start hreflang tag -->
  <link rel="alternate" hreflang="en" href="https://docs.databricks.com/en/lakehouse-monitoring/monitor-output.html" />
<link rel="alternate" hreflang="x-default" href="https://docs.databricks.com/en/lakehouse-monitoring/monitor-output.html" />
  <!-- End hreflang tag -->
  
  
  <link rel="shortcut icon" href="../_static/favicon.ico" />
  

  

  

  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;
j.setAttributeNode(d.createAttribute('data-ot-ignore'));
f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-T85FQ33');</script>
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;
j.setAttributeNode(d.createAttribute('data-ot-ignore'));
f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-TWTKQQ');</script>
    
  <!-- End Google Tag Manager -->


  <!-- MaxMind / GEO IP -->
  <script src="//js.maxmind.com/js/apis/geoip2/v2.1/geoip2.js" type="text/javascript"></script>
  <!-- End MaxMind / GEO IP -->

  
  
  <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600&display=swap" rel="stylesheet">
  <link rel="preload" href="../_static/fonts/DMSans-Bold.ttf" as="font">
  <link rel="preload" href="../_static/fonts/DMSans-Regular.ttf" as="font">
  <link rel="preload" href="../_static/fonts/DMMono-Regular.ttf" as="font">
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/cloud-provider-selector.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/translation-selector.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/searchunify/main.css" type="text/css" />

  
  <link rel="index" title="Index" href="../genindex.html" />
  <link rel="search" title="Search" href="../search.html" />
  <link rel="top" title="Databricks on AWS" href="../index.html" /> 
</head>

<body class="wy-body-for-nav" role="document">

  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T85FQ33"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TWTKQQ"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->

  
  <nav class="wy-nav-top header su_header" role="navigation" aria-label="top navigation">
    
<nav class="wy-nav-top header su_header" role="navigation" aria-label="top navigation">
  <div class="container-logo">
    <ul class="mobile-menu-toggle">
        <li class="menu-toggle">
            <i data-toggle="wy-nav-top" class="wy-nav-top-menu-button db-icon db-icon-menu pull-left"></i>
            
            <a href="https://www.databricks.com/" class="wy-nav-top-logo"><img src="../_static/small-scale-lockup-full-color-rgb.svg" width="137" height="21"
              alt="Databricks" /></a>   
               
              </li>
    </ul>
    <ul class="su_nav-menu">
      <li class="menu-toggle">
        <i data-toggle="wy-nav-top" class="wy-nav-top-menu-button db-icon db-icon-menu pull-left"></i>
        
          
        
        <a href="https://www.databricks.com/" class="wy-nav-top-logo"><img src="../_static/small-scale-lockup-full-color-rgb.svg" width="137" height="21"
            alt="Databricks" /></a></li>
        <!-- 
<li><a href="https://help.databricks.com/s/">Help Center</a></li>
<li class="active"><a href="https://docs.databricks.com/en/">Documentation</a></li>
<li><a href="https://kb.databricks.com/">Knowledge Base</a></li>
 -->
    </ul>
  </div>
  <div class="su_nav-right">
    <ul class="su_link-mobile">
  <!-- Mobile header code can go here -->
</ul>
<ul class="right-try-list">
   
</ul>
  </div>
</nav>
  </nav>

  <div class="su_sub-header">
    <div class="container">
      <div class="su_sub-header-inner">
        <!-- <div class="su_subnav-menu-right">
  <div id="auto" style="width: 100%;">
    <div ng-controller="SearchautoController">
      <div bind-html-compile="autocompleteHtml">
        <form class="su__search-box-1" disabled="disabled">
          <input class="su__search-input" type="search" name="Search box" id="su__search-b" placeholder="Search Documentation" disabled="disabled"/>
          <button class="su__search-button" type="submit" class="button button-success" disabled="disabled">
            <svg width="24" height="24" viewBox="0 0 24 24">
              <path
                d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"
                fill="#333"></path>
            </svg>
          </button>
        </form>
      </div>
    </div>
  </div>
</div> -->
        <div class="search-lng-gap"></div>
        <div style="margin-left: 16px; margin-right: 16px;">
          <!-- <select name="lng selector" id="lng-selector">
    <option value="../../en/lakehouse-monitoring/monitor-output.html" class="notranslate">English</option>
    <option value="../../ja/lakehouse-monitoring/monitor-output.html" class="notranslate">日本語</option>
    <option value="../../pt/lakehouse-monitoring/monitor-output.html" class="notranslate">Português (Brasil)</option>
</select> -->
        </div>
        <div class="cloud-selector-container">
          <!-- <select name="cloud provider selector" id="cloud-provider-selector">
    <option value="aws" selected class="notranslate">
        Amazon Web Services
    </option>
    <option value="azure"  class="notranslate">
        Microsoft Azure
    </option>
    <option value="gcp"  class="notranslate">
        Google Cloud Platform
    </option>
</select> -->
        </div>
      </div>
    </div>
  </div>
  <page class="js-page-container">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side su_nav-side">
<div class="wy-side-scroll">
  <div class="wy-side-nav-search">
    

    

    

    
  </div>

  <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
    
      <a href="../index.html" class="main-navigation-home">Databricks on AWS</a>
    

    
      

      
        <p class="caption"><span class="caption-text">Load &amp; manage data</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../rag-temp/index.html">RAG Studio</a></li>
</ul>

      
    
  </div>

  <div role="contentinfo">
    
  <p class="build_info notranslate"data-last-edit="December 23, 2023">
    Updated Jan 11, 2024
  </p>
<script>
  window.addEventListener('DOMContentLoaded',function(){
    var h1=document.querySelector('h1');
    var bi=document.querySelector('[data-last-edit]');
    if(h1 && bi){
      var ver = document.createElement('p');
      ver.className = 'version_info';
      ver.textContent = bi.getAttribute('data-last-edit');
      h1.parentElement.insertBefore(ver, h1.nextElementSibling);
    }
  });
</script>

    <p>
      
        <a id='feedbacklink' href="mailto:doc-feedback@databricks.com?subject=Documentation Feedback">Send us feedback</a>
      
    </p>
  </div>
</div>
</nav>
    
    
<main class="wy-grid-for-nav su_nav-grid">
  <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
    <div class="wy-nav-content su__nav_content">
      <div class="rst-content">
        





<div role="navigation" aria-label="breadcrumbs navigation" class="wy-breadcrumbs-wrapper">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Documentation</a> <span class="db-icon db-icon-chevron-right"></span></li>
    
    
      <li>Monitor metric tables</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>
</div>
        
        <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
          <div itemprop="articleBody">
            
    
  <div class="section" id="monitor-metric-tables">
<h1>Monitor metric tables<a class="headerlink" href="#monitor-metric-tables" title="Permalink to this headline"> </a></h1>
<div class="preview admonition">
<p class="admonition-title">Preview</p>
<p>This feature is in <a class="reference internal" href="../release-notes/release-types.html"><span class="doc">Public Preview</span></a>.</p>
</div>
<p>This page describes the metric tables created by Databricks Lakehouse Monitoring. For information about the dashboard created by a monitor, see <a class="reference internal" href="monitor-dashboard.html"><span class="doc">Use the generated SQL dashboard</span></a>.</p>
<p>When a monitor runs on a Databricks table, it creates or updates two metric tables: a profile metrics table and a drift metrics table.</p>
<ul class="simple">
<li><p>The profile metrics table contains summary statistics for each column and for each combination of time window, slice, and grouping columns. For <code class="docutils literal notranslate"><span class="pre">InferenceLog</span></code> analysis, the analysis table also contains model accuracy metrics.</p></li>
<li><p>The drift metrics table contains statistics that track changes in distribution for a metric. Drift tables can be used to visualize or alert on changes in the data instead of specific values. The following types of drift are computed:</p>
<ul>
<li><p>Consecutive drift compares a window to the previous time window. Consecutive drift is only calculated if a consecutive time window exists after aggregation according to the specified granularities.</p></li>
<li><p>Baseline drift compares a window to the baseline distribution determined by the baseline table. Baseline drift is only calculated if a baseline table is provided.</p></li>
</ul>
</li>
</ul>
<div class="section" id="where-metric-tables-are-located">
<h2>Where metric tables are located<a class="headerlink" href="#where-metric-tables-are-located" title="Permalink to this headline"> </a></h2>
<p>Monitor metric tables are saved to <code class="docutils literal notranslate"><span class="pre">{output_schema}.{table_name}_profile_metrics</span></code> and <code class="docutils literal notranslate"><span class="pre">{output_schema}.{table_name}_drift_metrics</span></code>, where:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">{output_schema}</span></code> is the catalog and schema specified by <code class="docutils literal notranslate"><span class="pre">output_schema_name</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{table_name}</span></code> is the name of the table being monitored.</p></li>
</ul>
</div>
<div class="section" id="how-monitor-statistics-are-computed">
<h2>How monitor statistics are computed<a class="headerlink" href="#how-monitor-statistics-are-computed" title="Permalink to this headline"> </a></h2>
<p>Each statistic and metric in the metric tables is computed for a specified time interval (called a “window”). For <code class="docutils literal notranslate"><span class="pre">Snapshot</span></code> analysis, the time window is a single point in time corresponding to the time the metric was refreshed. For <code class="docutils literal notranslate"><span class="pre">TimeSeries</span></code> and <code class="docutils literal notranslate"><span class="pre">InferenceLog</span></code> analysis, the time window is based on the granularities specified in <code class="docutils literal notranslate"><span class="pre">create_monitor</span></code> and the values in the <code class="docutils literal notranslate"><span class="pre">timestamp_col</span></code> specified in the <code class="docutils literal notranslate"><span class="pre">profile_type</span></code> argument.</p>
<p>Metrics are always computed for the entire table. In addition, if you provide a slicing expression, metrics are computed for each data slice defined by a value of the expression.</p>
<p>For example:</p>
<p><code class="docutils literal notranslate"><span class="pre">slicing_exprs=[&quot;col_1&quot;,</span> <span class="pre">&quot;col_2</span> <span class="pre">&gt;</span> <span class="pre">10&quot;]</span></code></p>
<p>generates the following slices: one for <code class="docutils literal notranslate"><span class="pre">col_2</span> <span class="pre">&gt;</span> <span class="pre">10</span></code>, one for <code class="docutils literal notranslate"><span class="pre">col_2</span> <span class="pre">&lt;=</span> <span class="pre">10</span></code>, and one for each unique value in <code class="docutils literal notranslate"><span class="pre">col1</span></code>.</p>
<p>Slices are identified in the metrics tables by the column names <code class="docutils literal notranslate"><span class="pre">slice_key</span></code> and <code class="docutils literal notranslate"><span class="pre">slice_value</span></code>. In this example, one slice key would be “col_2 &gt; 10” and the corresponding values would be “true” and “false”. The entire table is equivalent to <code class="docutils literal notranslate"><span class="pre">slice_key</span></code> = NULL and <code class="docutils literal notranslate"><span class="pre">slice_value</span></code> = NULL. Slices are defined by a single slice key.</p>
<p>Metrics are computed for all possible groups defined by the time windows and slice keys and values. In addition, for <code class="docutils literal notranslate"><span class="pre">InferenceLog</span></code> analysis, metrics are computed for each model id. For details, see <a class="reference internal" href="#output_schema"><span class="std std-ref">Column schemas for generated tables</span></a>.</p>
<div class="section" id="additional-statistics-for-model-accuracy-monitoring-inferencelog-analysis-only">
<h3>Additional statistics for model accuracy monitoring (<code class="docutils literal notranslate"><span class="pre">InferenceLog</span></code> analysis only)<a class="headerlink" href="#additional-statistics-for-model-accuracy-monitoring-inferencelog-analysis-only" title="Permalink to this headline"> </a></h3>
<p>Additional statistics are calculated for <code class="docutils literal notranslate"><span class="pre">InferenceLog</span></code> analysis.</p>
<ul class="simple">
<li><p>Model quality is calculated if both <code class="docutils literal notranslate"><span class="pre">label_col</span></code> and <code class="docutils literal notranslate"><span class="pre">prediction_col</span></code> are provided.</p></li>
<li><p>Slices are automatically created based on the distinct values of <code class="docutils literal notranslate"><span class="pre">model_id_col</span></code>.</p></li>
<li><p>For classification models, <a class="reference internal" href="fairness-bias.html"><span class="doc">fairness and bias statistics</span></a> are calculated for slices that have a Boolean value.</p></li>
</ul>
</div>
</div>
<div class="section" id="query-analysis-and-drift-metrics-tables">
<h2>Query analysis and drift metrics tables<a class="headerlink" href="#query-analysis-and-drift-metrics-tables" title="Permalink to this headline"> </a></h2>
<p>You can query the metrics tables directly. The following example is based on <code class="docutils literal notranslate"><span class="pre">InferenceLog</span></code> analysis:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span>
<span class="w">  </span><span class="n">window</span><span class="p">.</span><span class="k">start</span><span class="p">,</span><span class="w"> </span><span class="k">column_name</span><span class="p">,</span><span class="w"> </span><span class="k">count</span><span class="p">,</span><span class="w"> </span><span class="n">num_nulls</span><span class="p">,</span><span class="w"> </span><span class="n">distinct_count</span><span class="p">,</span><span class="w"> </span><span class="n">frequent_items</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">census_monitor_db</span><span class="p">.</span><span class="n">adult_census_profile_metrics</span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">model_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w">    </span><span class="err">—</span><span class="w"> </span><span class="n">Constrain</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="k">version</span><span class="w"> </span><span class="mi">1</span>
<span class="w">  </span><span class="k">AND</span><span class="w"> </span><span class="n">slice_key</span><span class="w"> </span><span class="k">IS</span><span class="w"> </span><span class="k">NULL</span><span class="w">    </span><span class="err">—</span><span class="w"> </span><span class="n">look</span><span class="w"> </span><span class="k">at</span><span class="w"> </span><span class="k">aggregate</span><span class="w"> </span><span class="n">metrics</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">whole</span><span class="w"> </span><span class="k">data</span>
<span class="w">  </span><span class="k">AND</span><span class="w"> </span><span class="k">column_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">&quot;income_predicted&quot;</span>
<span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">window</span><span class="p">.</span><span class="k">start</span>
</pre></div>
</div>
</div>
<div class="section" id="column-schemas-for-generated-tables">
<span id="output_schema"></span><h2>Column schemas for generated tables<a class="headerlink" href="#column-schemas-for-generated-tables" title="Permalink to this headline"> </a></h2>
<p>For each column in the primary table, the metrics tables contain one row for each combination of grouping columns. The column associated with each row is shown in the column <code class="docutils literal notranslate"><span class="pre">column_name</span></code>.</p>
<p>For metrics based on more than one column such as model accuracy metrics, <code class="docutils literal notranslate"><span class="pre">column_name</span></code> is set to <code class="docutils literal notranslate"><span class="pre">:table</span></code>.</p>
<p>For profile metrics, the following grouping columns are used:</p>
<ul class="simple">
<li><p>time window</p></li>
<li><p>granularity (<code class="docutils literal notranslate"><span class="pre">TimeSeries</span></code> and <code class="docutils literal notranslate"><span class="pre">InferenceLog</span></code> analysis only)</p></li>
<li><p>log type - input table or baseline table</p></li>
<li><p>slice key and value</p></li>
<li><p>model id (<code class="docutils literal notranslate"><span class="pre">InferenceLog</span></code> analysis only)</p></li>
</ul>
<p>For drift metrics, the following additional grouping columns are used:</p>
<ul class="simple">
<li><p>comparison time window</p></li>
<li><p>drift type (comparison to previous window or comparison to baseline table)</p></li>
</ul>
<p>The schemas of the metric tables are shown below, and are also shown in the <a class="reference external" href="https://api-docs.databricks.com/python/lakehouse-monitoring/latest/index.html">Databricks Lakehouse Monitoring API reference documentation</a>.</p>
<div class="section" id="profile-metrics-table-schema">
<span id="profile-metrics-table"></span><h3>Profile metrics table schema<a class="headerlink" href="#profile-metrics-table-schema" title="Permalink to this headline"> </a></h3>
<p>The following table shows the schema of the profile metrics table. Where a metric is not applicable to a row, the corresponding cell is null.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 21%" />
<col style="width: 8%" />
<col style="width: 71%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Column name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p> <strong>Grouping columns</strong></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p> window</p></td>
<td><p>  Struct. See [1] below.</p></td>
<td><p> Time window.</p></td>
</tr>
<tr class="row-even"><td><p> granularity</p></td>
<td><p> string</p></td>
<td><p> Window duration, set by <code class="docutils literal notranslate"><span class="pre">granularities</span></code> parameter.</p></td>
</tr>
<tr class="row-odd"><td><p> model_id_col</p></td>
<td><p> string</p></td>
<td><p> Optional. Only used for <code class="docutils literal notranslate"><span class="pre">InferenceLog</span></code> analysis type.</p></td>
</tr>
<tr class="row-even"><td><p> log_type</p></td>
<td><p> string</p></td>
<td><p> Table used to calculate metrics. BASELINE or INPUT.</p></td>
</tr>
<tr class="row-odd"><td><p> slice_key</p></td>
<td><p> string</p></td>
<td><p> Slice expression. NULL for default, which is all data.</p></td>
</tr>
<tr class="row-even"><td><p> slice_value</p></td>
<td><p> string</p></td>
<td><p> Value of the slicing expression.</p></td>
</tr>
<tr class="row-odd"><td><p> column_name</p></td>
<td><p> string</p></td>
<td><p> Name of column in primary table. <code class="docutils literal notranslate"><span class="pre">:table</span></code> is a special name for metrics that apply to the whole table, such as model accuracy.</p></td>
</tr>
<tr class="row-even"><td><p> data_type</p></td>
<td><p> string</p></td>
<td><p> Spark data type of <code class="docutils literal notranslate"><span class="pre">column_name</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p> logging_table_commit_version</p></td>
<td><p> int</p></td>
<td><p> Ignore.</p></td>
</tr>
<tr class="row-even"><td><p> monitor_version</p></td>
<td><p> bigint</p></td>
<td><p> Version of the monitor configuration used to calculate the metrics in the row. See [5] below for details.</p></td>
</tr>
<tr class="row-odd"><td><p> <strong>Metrics columns - summary statistics</strong></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p> count</p></td>
<td><p> bigint</p></td>
<td><p> Number of non-null values.</p></td>
</tr>
<tr class="row-odd"><td><p> num_nulls</p></td>
<td><p> bigint</p></td>
<td><p> Number of null values in <code class="docutils literal notranslate"><span class="pre">column_name</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p> avg</p></td>
<td><p> double</p></td>
<td><p> Arithmetic mean of the column, ingoring nulls.</p></td>
</tr>
<tr class="row-odd"><td><p> quantiles</p></td>
<td><p> <code class="docutils literal notranslate"><span class="pre">array&lt;double&gt;</span></code></p></td>
<td><p> Array of 1000 quantiles. See [2] below.</p></td>
</tr>
<tr class="row-even"><td><p> distinct_count</p></td>
<td><p> bigint</p></td>
<td><p> Number of distinct values in <code class="docutils literal notranslate"><span class="pre">column_name</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p> min</p></td>
<td><p> double</p></td>
<td><p> Minimum value in <code class="docutils literal notranslate"><span class="pre">column_name</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p> max</p></td>
<td><p> double</p></td>
<td><p> Maximum value in <code class="docutils literal notranslate"><span class="pre">column_name</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p> stddev</p></td>
<td><p> double</p></td>
<td><p> Standard deviation of <code class="docutils literal notranslate"><span class="pre">column_name</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p> num_zeros</p></td>
<td><p> bigint</p></td>
<td><p> Number of zeros in <code class="docutils literal notranslate"><span class="pre">column_name</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p> num_nan</p></td>
<td><p> bigint</p></td>
<td><p> Number of NaN values in <code class="docutils literal notranslate"><span class="pre">column_name</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p> min_size</p></td>
<td><p> double</p></td>
<td><p> Minimum size of arrays or structures in <code class="docutils literal notranslate"><span class="pre">column_name</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p> max_size</p></td>
<td><p> double</p></td>
<td><p> Maximum size of arrays or structures in <code class="docutils literal notranslate"><span class="pre">column_name</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p> avg_size</p></td>
<td><p> double</p></td>
<td><p> Average size of arrays or structures in <code class="docutils literal notranslate"><span class="pre">column_name</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p> min_len</p></td>
<td><p> double</p></td>
<td><p> Minimum length of string and binary values in <code class="docutils literal notranslate"><span class="pre">column_name</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p> max_len</p></td>
<td><p> double</p></td>
<td><p> Maximum length of string and binary values in <code class="docutils literal notranslate"><span class="pre">column_name</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p> avg_len</p></td>
<td><p> double</p></td>
<td><p> Average length of string and binary values in <code class="docutils literal notranslate"><span class="pre">column_name</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p> frequent_items</p></td>
<td><p> Struct. See [1] below.</p></td>
<td><p> Top 100 most frequently occuring items.</p></td>
</tr>
<tr class="row-odd"><td><p> non_null_columns</p></td>
<td><p> <code class="docutils literal notranslate"><span class="pre">array&lt;string&gt;</span></code></p></td>
<td><p> List of columns with at least one non-null value.</p></td>
</tr>
<tr class="row-even"><td><p> median</p></td>
<td><p> double</p></td>
<td><p> Median value of <code class="docutils literal notranslate"><span class="pre">column_name</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p> percent_null</p></td>
<td><p> double</p></td>
<td><p> Percent of null values in <code class="docutils literal notranslate"><span class="pre">column_name</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p> percent_zeros</p></td>
<td><p> double</p></td>
<td><p> Percent of values that are zero in <code class="docutils literal notranslate"><span class="pre">column_name</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p> percent_distinct</p></td>
<td><p> double</p></td>
<td><p> Percent of values that are distinct in <code class="docutils literal notranslate"><span class="pre">column_name</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p> <strong>Metrics columns - classification model accuracy</strong> [3]</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p> accuracy_score</p></td>
<td><p> double</p></td>
<td><p> Accuracy of model, calculated as (number of correct predictions / total number of predictions), ignoring null values.</p></td>
</tr>
<tr class="row-even"><td><p> confusion_matrix</p></td>
<td><p> Struct. See [1] below.</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p> precision</p></td>
<td><p> Struct. See [1] below.</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p> recall</p></td>
<td><p> Struct. See [1] below.</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p> f1_score</p></td>
<td><p> Struct. See [1] below.</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p> <strong>Metrics columns - regression model accuracy</strong> [3]</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p> mean_squared_error</p></td>
<td><p> double</p></td>
<td><p> Mean squared error between <code class="docutils literal notranslate"><span class="pre">prediction_col</span></code> and <code class="docutils literal notranslate"><span class="pre">label_col</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p> root_mean_squared_error</p></td>
<td><p> double</p></td>
<td><p> Root mean squared error between <code class="docutils literal notranslate"><span class="pre">prediction_col</span></code> and <code class="docutils literal notranslate"><span class="pre">label_col</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p> mean_average_error</p></td>
<td><p> double</p></td>
<td><p> Mean average error between <code class="docutils literal notranslate"><span class="pre">prediction_col</span></code> and <code class="docutils literal notranslate"><span class="pre">label_col</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p> mean_absolute_percentage_error</p></td>
<td><p> double</p></td>
<td><p> Mean absolute percentage error between <code class="docutils literal notranslate"><span class="pre">prediction_col</span></code> and <code class="docutils literal notranslate"><span class="pre">label_col</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p> r2_score</p></td>
<td><p> double</p></td>
<td><p> R-squared score between <code class="docutils literal notranslate"><span class="pre">prediction_col</span></code> and <code class="docutils literal notranslate"><span class="pre">label_col</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p> <strong>Metrics columns - fairness and bias</strong> [4]</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p> predictive_parity</p></td>
<td><p> double</p></td>
<td><p> Measures whether the two groups have equal precision across all predicted classes. <code class="docutils literal notranslate"><span class="pre">label_col</span></code> is required.</p></td>
</tr>
<tr class="row-even"><td><p> predictive_equality</p></td>
<td><p> double</p></td>
<td><p> Measures whether the two groups have equal false positive rate across all predicted classes. <code class="docutils literal notranslate"><span class="pre">label_col</span></code> is required.</p></td>
</tr>
<tr class="row-odd"><td><p> equal_opportunity</p></td>
<td><p> double</p></td>
<td><p> Measures whether the two groups have equal recall across all predicted classes. <code class="docutils literal notranslate"><span class="pre">label_col</span></code> is required.</p></td>
</tr>
<tr class="row-even"><td><p> statistical_parity</p></td>
<td><p> double</p></td>
<td><p> Measures whether the two groups have equal acceptance rate. Acceptance rate here is defined as the empirical probability to be predicted as a certain class, across all predicted classes.</p></td>
</tr>
</tbody>
</table>
<p>[1] Format of struct for <code class="docutils literal notranslate"><span class="pre">confusion_matrix</span></code>, <code class="docutils literal notranslate"><span class="pre">precision</span></code>, <code class="docutils literal notranslate"><span class="pre">recall</span></code>, and <code class="docutils literal notranslate"><span class="pre">f1_score</span></code>:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 82%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Column name</p></th>
<th class="head"><p>Type</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p> window</p></td>
<td><p>  <code class="docutils literal notranslate"><span class="pre">struct&lt;start:</span> <span class="pre">timestamp,</span> <span class="pre">end:</span> <span class="pre">timestamp&gt;</span></code></p></td>
</tr>
<tr class="row-odd"><td><p> frequent_items</p></td>
<td><p>  <code class="docutils literal notranslate"><span class="pre">array&lt;struct&lt;item:</span> <span class="pre">string,</span> <span class="pre">count:</span> <span class="pre">bigint&gt;&gt;</span></code></p></td>
</tr>
<tr class="row-even"><td><p> confusion_matrix</p></td>
<td><p> <code class="docutils literal notranslate"><span class="pre">struct&lt;prediction:</span> <span class="pre">string,</span> <span class="pre">label:</span> <span class="pre">string,</span> <span class="pre">count:</span> <span class="pre">bigint&gt;</span></code></p></td>
</tr>
<tr class="row-odd"><td><p> precision</p></td>
<td><p> <code class="docutils literal notranslate"><span class="pre">struct&lt;one_vs_all:</span> <span class="pre">map&lt;string,double&gt;,</span> <span class="pre">macro:</span> <span class="pre">double,</span> <span class="pre">weighted:</span> <span class="pre">double&gt;</span></code></p></td>
</tr>
<tr class="row-even"><td><p> recall</p></td>
<td><p> <code class="docutils literal notranslate"><span class="pre">struct&lt;one_vs_all:</span> <span class="pre">map&lt;string,double&gt;,</span> <span class="pre">macro:</span> <span class="pre">double,</span> <span class="pre">weighted:</span> <span class="pre">double&gt;</span></code></p></td>
</tr>
<tr class="row-odd"><td><p> f1_score</p></td>
<td><p> <code class="docutils literal notranslate"><span class="pre">struct&lt;one_vs_all:</span> <span class="pre">map&lt;string,double&gt;,</span> <span class="pre">macro:</span> <span class="pre">double,</span> <span class="pre">weighted:</span> <span class="pre">double&gt;</span></code></p></td>
</tr>
</tbody>
</table>
<p>[2] Sample code to retrieve the 50th percentile: <code class="docutils literal notranslate"><span class="pre">SELECT</span> <span class="pre">element_at(quantiles,</span> <span class="pre">int((size(quantiles)+1)/2))</span> <span class="pre">AS</span> <span class="pre">p50</span> <span class="pre">...</span></code> or <code class="docutils literal notranslate"><span class="pre">SELECT</span> <span class="pre">quantiles[500]</span> <span class="pre">...</span> </code>.</p>
<p>[3] Only shown if the monitor has <code class="docutils literal notranslate"><span class="pre">InferenceLog</span></code> analysis type and both <code class="docutils literal notranslate"><span class="pre">label_col</span></code> and <code class="docutils literal notranslate"><span class="pre">prediction_col</span></code> are provided.</p>
<p>[4] Only shown if the monitor has <code class="docutils literal notranslate"><span class="pre">InferenceLog</span></code> analysis type and <code class="docutils literal notranslate"><span class="pre">problem_type</span></code> is <code class="docutils literal notranslate"><span class="pre">classification</span></code>.</p>
<p>[5] The version shown in this column is the version that was used to calculate the statistics in the row and might not be the current version of the monitor. Each time you refresh the metrics, the monitor attempts to recompute previously calculated metrics using the current monitor configuration. The current monitor version appears in the monitor information returned by the API and Python Client.</p>
</div>
<div class="section" id="drift-metrics-table-schema">
<span id="drift-metrics-table"></span><h3>Drift metrics table schema<a class="headerlink" href="#drift-metrics-table-schema" title="Permalink to this headline"> </a></h3>
<p>The following table shows the schema of the drift metrics table. The drift table is only generated if a baseline table is provided, or if a consecutive time window exists after aggregation according to the specified granularities.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 13%" />
<col style="width: 21%" />
<col style="width: 66%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Column name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p> <strong>Grouping columns</strong></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p> window</p></td>
<td><p> <code class="docutils literal notranslate"><span class="pre">struct&lt;start:</span> <span class="pre">timestamp,</span> <span class="pre">end:</span> <span class="pre">timestamp&gt;</span></code></p></td>
<td><p> Time window.</p></td>
</tr>
<tr class="row-even"><td><p> window_cmp</p></td>
<td><p> <code class="docutils literal notranslate"><span class="pre">struct&lt;start:</span> <span class="pre">timestamp,</span> <span class="pre">end:</span> <span class="pre">timestamp&gt;</span></code></p></td>
<td><p> Comparison window for drift_type <code class="docutils literal notranslate"><span class="pre">CONSECUTIVE</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p> drift_type</p></td>
<td><p>  string</p></td>
<td><p> BASELINE or CONSECUTIVE. Whether the drift metrics compare to the previous time window or to the baseline table.</p></td>
</tr>
<tr class="row-even"><td><p> granularity</p></td>
<td><p> string</p></td>
<td><p> Window duration, set by <code class="docutils literal notranslate"><span class="pre">granularities</span></code> parameter.</p></td>
</tr>
<tr class="row-odd"><td><p> model_id_col</p></td>
<td><p> string</p></td>
<td><p> Optional. Only used for <code class="docutils literal notranslate"><span class="pre">InferenceLog</span></code> analysis type.</p></td>
</tr>
<tr class="row-even"><td><p> slice_key</p></td>
<td><p> string</p></td>
<td><p> Slice expression. NULL for default, which is all data.</p></td>
</tr>
<tr class="row-odd"><td><p> slice_value</p></td>
<td><p> string</p></td>
<td><p> Value of the slicing expression.</p></td>
</tr>
<tr class="row-even"><td><p> column_name</p></td>
<td><p> string</p></td>
<td><p> Name of column in primary table. <code class="docutils literal notranslate"><span class="pre">:table</span></code> is a special name for metrics that apply to the whole table, such as model accuracy.</p></td>
</tr>
<tr class="row-odd"><td><p> data_type</p></td>
<td><p> string</p></td>
<td><p> Spark data type of <code class="docutils literal notranslate"><span class="pre">column_name</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p> monitor_version</p></td>
<td><p> bigint</p></td>
<td><p> Version of the monitor configuration used to calculate the metrics in the row. See [6] below for details.</p></td>
</tr>
<tr class="row-odd"><td><p> <strong>Metrics columns - drift</strong></p></td>
<td></td>
<td><p> Differences are calculated as current window - comparison window.</p></td>
</tr>
<tr class="row-even"><td><p> count_delta</p></td>
<td><p> double</p></td>
<td><p> Difference in <code class="docutils literal notranslate"><span class="pre">count</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p> avg_delta</p></td>
<td><p> double</p></td>
<td><p> Difference in <code class="docutils literal notranslate"><span class="pre">avg</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p> percent_null_delta</p></td>
<td><p> double</p></td>
<td><p> Difference in <code class="docutils literal notranslate"><span class="pre">percent_null</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p> percent_zeros_delta</p></td>
<td><p> double</p></td>
<td><p> Difference in <code class="docutils literal notranslate"><span class="pre">percent_zeros</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p> percent_distinct_delta</p></td>
<td><p> double</p></td>
<td><p> Difference in <code class="docutils literal notranslate"><span class="pre">percent_distinct</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p> non_null_columns_delta</p></td>
<td><p> <code class="docutils literal notranslate"><span class="pre">struct&lt;added:</span> <span class="pre">int,</span> <span class="pre">missing:</span> <span class="pre">int&gt;</span></code></p></td>
<td><p> Number of columns with any increase or decrease in non-null values.</p></td>
</tr>
<tr class="row-even"><td><p> chi_squared_test</p></td>
<td><p> <code class="docutils literal notranslate"><span class="pre">struct&lt;statistic:</span> <span class="pre">double,</span> <span class="pre">pvalue:</span> <span class="pre">double&gt;</span></code></p></td>
<td><p> Chi-square test for drift in distribution.</p></td>
</tr>
<tr class="row-odd"><td><p> ks_test</p></td>
<td><p> <code class="docutils literal notranslate"><span class="pre">struct&lt;statistic:</span> <span class="pre">double,</span> <span class="pre">pvalue:</span> <span class="pre">double&gt;</span></code></p></td>
<td><p> KS test for drift in distribution. Calculated for numeric columns only.</p></td>
</tr>
<tr class="row-even"><td><p> tv_distance</p></td>
<td><p>  double</p></td>
<td><p> Total variation distance for drift in distribution.</p></td>
</tr>
<tr class="row-odd"><td><p> l_infinity_distance</p></td>
<td><p> double</p></td>
<td><p> L-infinity distance for drift in distribution.</p></td>
</tr>
<tr class="row-even"><td><p> js_distance</p></td>
<td><p> double</p></td>
<td><p> Jensen–Shannon distance for drift in distribution. Calculated for categorical columns only.</p></td>
</tr>
<tr class="row-odd"><td><p> wasserstein_distance</p></td>
<td><p> double</p></td>
<td><p> Drift between two numeric distributions using the Wasserstein distance metric.</p></td>
</tr>
<tr class="row-even"><td><p> population_stability_index</p></td>
<td><p> double</p></td>
<td><p> Metric for comparing the drift between two numeric distributions using the population stability index metric. See [7] below for details.</p></td>
</tr>
</tbody>
</table>
<p>[6] The version shown in this column is the version that was used to calculate the statistics in the row and might not be the current version of the monitor. Each time you refresh the metrics, the monitor attempts to recompute previously calculated metrics using the current monitor configuration. The current monitor version appears in the monitor information returned by the API and Python Client.</p>
<p>[7] The output of the population stability index is a numeric value that represents how different two distributions are. The range is [0, inf). PSI &lt; 0.1 means no significant population change. PSI &lt; 0.2 indicates moderate population change. PSI &gt;= 0.2 indicates significant population change.</p>
</div>
</div>
</div>


    
          </div>
        </div>
        <div  class="suapp-rating">
  <div id="suPageRateApp">
     <su-app></su-app>
   </div> 
 </div>
<hr> 
<footer>
  <div role="contentinfo">
      <p class="copyright">
          &copy; Databricks 2023. All rights reserved. Apache, Apache Spark, Spark, and the Spark logo are trademarks of the <a href="http://www.apache.org/">Apache Software Foundation</a>.
      </p>
      <p> 
        
          <a id='feedbacklink' href="mailto:doc-feedback@databricks.com?subject=Documentation Feedback">Send us feedback</a>
        
     | <a href="https://databricks.com/privacy-policy">Privacy Policy</a> | <a href="https://databricks.com/terms-of-use">Terms of Use</a></p>

  </div> 

</footer>
      </div>
    </div>
  </section>
</main>

  </page>
  
  <script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
      URL_ROOT: '../',
      VERSION: '1.0',
      COLLAPSE_INDEX: false,
      FILE_SUFFIX: '.html',
      HAS_SOURCE: 'false'
    };
  </script>
  <script type="text/javascript" src="../_static/jquery.js"></script>
  <script type="text/javascript" src="../_static/underscore.js"></script>
  <script type="text/javascript" src="../_static/doctools.js"></script>
  <script type="text/javascript" src="../_static/language_data.js"></script>
  

  <script type="text/javascript" src="../_static/js/clipboard.min.js"></script>
  <script type="text/javascript" src="../_static/js/jquery.waypoints.min.js"></script>

  <!-- Select2 (https://select2.org/) -->
  <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
  <!-- End Select2 -->

  
  
  <script type="text/javascript" src="../_static/js/localized.js"></script>
  <script type="text/javascript" src="../_static/js/custom.js"></script>
  

  
  
  <script type="text/javascript">
    jQuery(function () {
      SphinxRtdTheme.StickyNav.enable();
    });

  </script>
  
 



  <script>
  window.__searchunifyLoaderConfig = JSON.parse('{"clients": {"en": "02c2e804-27e9-11ee-aefb-0242ac120011", "ja": "6a42c3f2-2820-11ee-aefb-0242ac120011", "pt": "6a86badd-2821-11ee-aefb-0242ac120011"}}')
</script>
<script type="text/javascript" src="../_static/js/search-loader.js"></script>
</body>
<script type='text/javascript'>
  window.onload = function () {
    var description = document.querySelector('meta[name="description"]').getAttribute("content");
    let titleText = document.querySelector('h1').textContent;
    document.querySelector('meta[property="og:title"]').setAttribute("content", titleText);
    document.querySelector('meta[property="og:description"]').setAttribute("content", description);
    document.querySelector('meta[property="twitter:description"]').setAttribute("content", description);
  };
</script>

</html>