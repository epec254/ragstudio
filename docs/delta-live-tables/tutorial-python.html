

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en-US" > <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en-US"> <!--<![endif]-->

<head>
  <!-- cookie consent -->
  
    <!-- Combined Onetrust and Rudderstack Implementation Scripts -->
    <!-- Onetrust Initialization -->
    <script type="text/javascript" src="https://cdn.cookielaw.org/consent/92466579-1717-44d3-809d-a05fb02843ed-test/OtAutoBlock.js"></script>
    <script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" data-document-language="true" type="text/javascript" charset="UTF-8" data-domain-script="92466579-1717-44d3-809d-a05fb02843ed-test"></script>
    <link rel="stylesheet" id="db-onetrust-style" href="https://www.databricks.com/wp-content/uploads/db_onetrust.css" media="all" />
    <!-- Setting Rudderstack Write Key -->
    <script>window.rudderstackKey = "2SOR9fvSr5Fi6tN2ihPbVHnX1SZ" </script>
    <!-- Rudderstack Initialization + Onetrust Integration + Rudderstack Custom Events -->
    <script type="text/javascript" src="https://www.databricks.com/sites/default/files/rudderstack/v1/db-rudderstack-events.js"></script>

  <!-- cookie consent -->

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="X-UA-Compatible" content="IE=9" />
  <meta content="This tutorial shows you how to use Python to declare tables for data pipelines in Delta Live Tables." name="description" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
  <meta property="og:image" content="https://www.databricks.com/wp-content/uploads/2020/04/og-databricks.png">
  <meta property="og:image:type" content="image/png">
  <meta property="og:title" content="Tutorial: Declare a data pipeline with Python in Delta Live Tables">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://docs.databricks.com">
  <meta property="og:description" content="" id="og-description">
  <meta name="twitter:image" content="https://www.databricks.com/wp-content/uploads/2020/04/og-databricks.png">
  <meta name="twitter:site" content="@databricks">
  <meta name="twitter:creator" content="@databricks">
  <meta property="twitter:description" content="">
  
  <title>Tutorial: Declare a data pipeline with Python in Delta Live Tables &#124; Databricks on AWS</title>
  
  
  <link rel="canonical" href="https://docs.databricks.com/en/delta-live-tables/tutorial-python.html">
  <!-- Start hreflang tag -->
  <link rel="alternate" hreflang="en" href="https://docs.databricks.com/en/delta-live-tables/tutorial-python.html" />
<link rel="alternate" hreflang="x-default" href="https://docs.databricks.com/en/delta-live-tables/tutorial-python.html" />
  <!-- End hreflang tag -->
  
  
  <link rel="shortcut icon" href="../_static/favicon.ico" />
  

  

  

  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;
j.setAttributeNode(d.createAttribute('data-ot-ignore'));
f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-T85FQ33');</script>
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;
j.setAttributeNode(d.createAttribute('data-ot-ignore'));
f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-TWTKQQ');</script>
    
  <!-- End Google Tag Manager -->


  <!-- MaxMind / GEO IP -->
  <script src="//js.maxmind.com/js/apis/geoip2/v2.1/geoip2.js" type="text/javascript"></script>
  <!-- End MaxMind / GEO IP -->

  
  
  <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600&display=swap" rel="stylesheet">
  <link rel="preload" href="../_static/fonts/DMSans-Bold.ttf" as="font">
  <link rel="preload" href="../_static/fonts/DMSans-Regular.ttf" as="font">
  <link rel="preload" href="../_static/fonts/DMMono-Regular.ttf" as="font">
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/cloud-provider-selector.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/translation-selector.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/searchunify/main.css" type="text/css" />

  
  <link rel="index" title="Index" href="../genindex.html" />
  <link rel="search" title="Search" href="../search.html" />
  <link rel="top" title="Databricks on AWS" href="../index.html" /> 
</head>

<body class="wy-body-for-nav" role="document">

  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T85FQ33"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TWTKQQ"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->

  
  <nav class="wy-nav-top header su_header" role="navigation" aria-label="top navigation">
    
<nav class="wy-nav-top header su_header" role="navigation" aria-label="top navigation">
  <div class="container-logo">
    <ul class="mobile-menu-toggle">
        <li class="menu-toggle">
            <i data-toggle="wy-nav-top" class="wy-nav-top-menu-button db-icon db-icon-menu pull-left"></i>
            
            <a href="https://www.databricks.com/" class="wy-nav-top-logo"><img src="../_static/small-scale-lockup-full-color-rgb.svg" width="137" height="21"
              alt="Databricks" /></a>   
               
              </li>
    </ul>
    <ul class="su_nav-menu">
      <li class="menu-toggle">
        <i data-toggle="wy-nav-top" class="wy-nav-top-menu-button db-icon db-icon-menu pull-left"></i>
        
          
        
        <a href="https://www.databricks.com/" class="wy-nav-top-logo"><img src="../_static/small-scale-lockup-full-color-rgb.svg" width="137" height="21"
            alt="Databricks" /></a></li>
        <!-- 
<li><a href="https://help.databricks.com/s/">Help Center</a></li>
<li class="active"><a href="https://docs.databricks.com/en/">Documentation</a></li>
<li><a href="https://kb.databricks.com/">Knowledge Base</a></li>
 -->
    </ul>
  </div>
  <div class="su_nav-right">
    <ul class="su_link-mobile">
  <!-- Mobile header code can go here -->
</ul>
<ul class="right-try-list">
   
</ul>
  </div>
</nav>
  </nav>

  <div class="su_sub-header">
    <div class="container">
      <div class="su_sub-header-inner">
        <!-- <div class="su_subnav-menu-right">
  <div id="auto" style="width: 100%;">
    <div ng-controller="SearchautoController">
      <div bind-html-compile="autocompleteHtml">
        <form class="su__search-box-1" disabled="disabled">
          <input class="su__search-input" type="search" name="Search box" id="su__search-b" placeholder="Search Documentation" disabled="disabled"/>
          <button class="su__search-button" type="submit" class="button button-success" disabled="disabled">
            <svg width="24" height="24" viewBox="0 0 24 24">
              <path
                d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"
                fill="#333"></path>
            </svg>
          </button>
        </form>
      </div>
    </div>
  </div>
</div> -->
        <div class="search-lng-gap"></div>
        <div style="margin-left: 16px; margin-right: 16px;">
          <!-- <select name="lng selector" id="lng-selector">
    <option value="../../en/delta-live-tables/tutorial-python.html" class="notranslate">English</option>
    <option value="../../ja/delta-live-tables/tutorial-python.html" class="notranslate">日本語</option>
    <option value="../../pt/delta-live-tables/tutorial-python.html" class="notranslate">Português (Brasil)</option>
</select> -->
        </div>
        <div class="cloud-selector-container">
          <!-- <select name="cloud provider selector" id="cloud-provider-selector">
    <option value="aws" selected class="notranslate">
        Amazon Web Services
    </option>
    <option value="azure"  class="notranslate">
        Microsoft Azure
    </option>
    <option value="gcp"  class="notranslate">
        Google Cloud Platform
    </option>
</select> -->
        </div>
      </div>
    </div>
  </div>
  <page class="js-page-container">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side su_nav-side">
<div class="wy-side-scroll">
  <div class="wy-side-nav-search">
    

    

    

    
  </div>

  <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
    
      <a href="../index.html" class="main-navigation-home">Databricks on AWS</a>
    

    
      

      
        <p class="caption"><span class="caption-text">Load &amp; manage data</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../rag-temp/index.html">RAG Studio</a></li>
</ul>

      
    
  </div>

  <div role="contentinfo">
    
  <p class="build_info notranslate"data-last-edit="December 23, 2023">
    Updated Jan 11, 2024
  </p>
<script>
  window.addEventListener('DOMContentLoaded',function(){
    var h1=document.querySelector('h1');
    var bi=document.querySelector('[data-last-edit]');
    if(h1 && bi){
      var ver = document.createElement('p');
      ver.className = 'version_info';
      ver.textContent = bi.getAttribute('data-last-edit');
      h1.parentElement.insertBefore(ver, h1.nextElementSibling);
    }
  });
</script>

    <p>
      
        <a id='feedbacklink' href="mailto:doc-feedback@databricks.com?subject=Documentation Feedback">Send us feedback</a>
      
    </p>
  </div>
</div>
</nav>
    
    
<main class="wy-grid-for-nav su_nav-grid">
  <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
    <div class="wy-nav-content su__nav_content">
      <div class="rst-content">
        





<div role="navigation" aria-label="breadcrumbs navigation" class="wy-breadcrumbs-wrapper">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Documentation</a> <span class="db-icon db-icon-chevron-right"></span></li>
    
    
      <li>Tutorial: Declare a data pipeline with Python in Delta Live Tables</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>
</div>
        
        <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
          <div itemprop="articleBody">
            
    
  <div class="section" id="tutorial-declare-a-data-pipeline-with-python-in-delta-live-tables">
<span id="tutorial-declare-a-data-pipeline-with-python-in-dlt"></span><h1>Tutorial: Declare a data pipeline with Python in Delta Live Tables<a class="headerlink" href="#tutorial-declare-a-data-pipeline-with-python-in-delta-live-tables" title="Permalink to this headline"> </a></h1>
<p>This tutorial shows you how to use Python syntax to declare a data pipeline in Delta Live Tables. Users familiar with PySpark or Pandas for Spark can use DataFrames with Delta Live Tables. For users unfamiliar with Spark DataFrames, Databricks recommends using SQL for Delta Live Tables. See <a class="reference internal" href="tutorial-sql.html"><span class="doc">Tutorial: Declare a data pipeline with SQL in Delta Live Tables</span></a>.</p>
<p>Python syntax for Delta Live Tables extends standard PySpark with a set of decorator functions imported through the <code class="docutils literal notranslate"><span class="pre">dlt</span></code> module.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>You cannot mix languages within a Delta Live Tables source code file. You can use multiple notebooks or files with different languages in a pipeline.</p></li>
<li><p>To use the code in this example, select <code class="docutils literal notranslate"><span class="pre">Hive</span> <span class="pre">metastore</span></code> as the storage option when you create the pipeline. Because this example reads data from DBFS, you cannot run this example with a pipeline configured to use Unity Catalog as the storage option.</p></li>
</ul>
</div>
<div class="section" id="where-do-you-run-delta-live-tables-python-queries">
<span id="where-do-you-run-dlt-python-queries"></span><h2>Where do you run Delta Live Tables Python queries?<a class="headerlink" href="#where-do-you-run-delta-live-tables-python-queries" title="Permalink to this headline"> </a></h2>
<p>You can use notebooks or Python files to write Delta Live Tables Python queries, but Delta Live Tables is not designed to be run interactively in notebook cells.</p>
<p>Delta Live Tables differs from many Python scripts in a key way: you do not call the functions that perform data ingestion and transformation to create Delta Live Tables datasets. Instead, Delta Live Tables interprets the decorator functions from the <code class="docutils literal notranslate"><span class="pre">dlt</span></code> module in all files loaded into a pipeline and builds a dataflow graph.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>You cannot rely on the cell-by-cell execution ordering of notebooks when writing Python for Delta Live Tables. Delta Live Tables evaluates and runs all code defined in notebooks, but has an entirely different execution model than a notebook <strong>Run all</strong> command.</p>
</div>
<p>Executing a cell that contains Delta Live Tables syntax in a Databricks notebook results in an error message. To learn about configuring pipelines with Delta Live Tables, see <a class="reference internal" href="tutorial-pipelines.html"><span class="doc">Tutorial: Run your first Delta Live Tables pipeline</span></a>.</p>
<p></p>
</div>
<div class="section" id="declare-a-delta-live-tables-data-pipeline-with-python">
<span id="declare-a-dlt-data-pipeline-with-python"></span><h2>Declare a Delta Live Tables data pipeline with Python<a class="headerlink" href="#declare-a-delta-live-tables-data-pipeline-with-python" title="Permalink to this headline"> </a></h2>
<p>This tutorial demonstrates using Python syntax to declare a Delta Live Tables pipeline on a dataset containing Wikipedia clickstream data to:</p>
<ul class="simple">
<li><p>Read the raw JSON clickstream data into a table.</p></li>
<li><p>Read the records from the raw data table and use Delta Live Tables <a class="reference internal" href="expectations.html"><span class="doc">expectations</span></a> to create a new table that contains cleansed data.</p></li>
<li><p>Use the records from the cleansed data table to make Delta Live Tables queries that create derived datasets.</p></li>
</ul>
<p>This code demonstrates a simplified example of the medallion architecture. See <a class="reference internal" href="../lakehouse/medallion.html"><span class="doc">What is the medallion lakehouse architecture?</span></a>.</p>
<p>Copy the Python code and paste it into a new Python notebook. You can add the example code to a single cell of the notebook or multiple cells. To review options for creating notebooks, see <a class="reference internal" href="../notebooks/notebooks-manage.html#create-notebook"><span class="std std-ref">Create a notebook</span></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When you create a pipeline with the Python interface, by default, table names are defined by function names. For example, the following Python example creates three tables named <code class="docutils literal notranslate"><span class="pre">clickstream_raw</span></code>, <code class="docutils literal notranslate"><span class="pre">clickstream_prepared</span></code>, and <code class="docutils literal notranslate"><span class="pre">top_spark_referrers</span></code>. You can override the table name using the <code class="docutils literal notranslate"><span class="pre">name</span></code> parameter. See <a class="reference internal" href="python-ref.html#create-table-python"><span class="std std-ref">Create a Delta Live Tables materialized view or streaming table</span></a>.</p>
</div>
</div>
<div class="section" id="import-the-delta-live-tables-module">
<span id="import-the-dlt-module"></span><h2>Import the Delta Live Tables module<a class="headerlink" href="#import-the-delta-live-tables-module" title="Permalink to this headline"> </a></h2>
<p>All Delta Live Tables Python APIs are implemented in the <code class="docutils literal notranslate"><span class="pre">dlt</span></code> module. Explicitly import the <code class="docutils literal notranslate"><span class="pre">dlt</span></code> module at the top of Python notebooks and files.</p>
<p>The following example shows this import, alongside import statements for <code class="docutils literal notranslate"><span class="pre">pyspark.sql.functions</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">dlt</span>
<span class="kn">from</span> <span class="nn">pyspark.sql.functions</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
</div>
<div class="section" id="execute-arbitrary-python-statements">
<h2>Execute arbitrary Python statements<a class="headerlink" href="#execute-arbitrary-python-statements" title="Permalink to this headline"> </a></h2>
<p>You can define Python variables and functions alongside Delta Live Tables code in notebooks. All Python logic runs as Delta Live Tables resolves the pipeline graph.</p>
<p>The following code declares a text variable used in a later step to load a JSON data file:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">json_path</span> <span class="o">=</span> <span class="s2">&quot;/databricks-datasets/wikipedia-datasets/data-001/clickstream/raw-uncompressed-json/2015_2_clickstream.json&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="create-a-table-from-files-in-object-storage">
<h2>Create a table from files in object storage<a class="headerlink" href="#create-a-table-from-files-in-object-storage" title="Permalink to this headline"> </a></h2>
<p>Delta Live Tables supports loading data from all formats supported by Databricks. See <a class="reference internal" href="../query/formats/index.html"><span class="doc">Data format options</span></a>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">&#64;dlt.table</span></code> decorator tells Delta Live Tables to create a table that contains the result of a DataFrame returned by a function. Add the <code class="docutils literal notranslate"><span class="pre">&#64;dlt.table</span></code> decorator before any Python function definition that returns a Spark DataFrame to register a new table in Delta Live Tables. The following example demonstrates using the function name as the table name and adding a descriptive comment to the table:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@dlt</span><span class="o">.</span><span class="n">table</span><span class="p">(</span>
  <span class="n">comment</span><span class="o">=</span><span class="s2">&quot;The raw wikipedia clickstream dataset, ingested from /databricks-datasets.&quot;</span>
<span class="p">)</span>
<span class="k">def</span> <span class="nf">clickstream_raw</span><span class="p">():</span>
  <span class="k">return</span> <span class="p">(</span><span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;json&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">json_path</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="section" id="add-a-table-from-an-upstream-dataset-in-the-pipeline">
<h2>Add a table from an upstream dataset in the pipeline<a class="headerlink" href="#add-a-table-from-an-upstream-dataset-in-the-pipeline" title="Permalink to this headline"> </a></h2>
<p>You can use <code class="docutils literal notranslate"><span class="pre">dlt.read()</span></code> to read data from other datasets declared in your current Delta Live Tables pipeline. Declaring new tables in this way creates a dependency that Delta Live Tables automatically resolves before executing updates. The following code also includes examples of monitoring and enforcing data quality with expectations. See <a class="reference internal" href="expectations.html"><span class="doc">Manage data quality with Delta Live Tables</span></a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@dlt</span><span class="o">.</span><span class="n">table</span><span class="p">(</span>
  <span class="n">comment</span><span class="o">=</span><span class="s2">&quot;Wikipedia clickstream data cleaned and prepared for analysis.&quot;</span>
<span class="p">)</span>
<span class="nd">@dlt</span><span class="o">.</span><span class="n">expect</span><span class="p">(</span><span class="s2">&quot;valid_current_page_title&quot;</span><span class="p">,</span> <span class="s2">&quot;current_page_title IS NOT NULL&quot;</span><span class="p">)</span>
<span class="nd">@dlt</span><span class="o">.</span><span class="n">expect_or_fail</span><span class="p">(</span><span class="s2">&quot;valid_count&quot;</span><span class="p">,</span> <span class="s2">&quot;click_count &gt; 0&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">clickstream_prepared</span><span class="p">():</span>
  <span class="k">return</span> <span class="p">(</span>
    <span class="n">dlt</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;clickstream_raw&quot;</span><span class="p">)</span>
      <span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s2">&quot;click_count&quot;</span><span class="p">,</span> <span class="n">expr</span><span class="p">(</span><span class="s2">&quot;CAST(n AS INT)&quot;</span><span class="p">))</span>
      <span class="o">.</span><span class="n">withColumnRenamed</span><span class="p">(</span><span class="s2">&quot;curr_title&quot;</span><span class="p">,</span> <span class="s2">&quot;current_page_title&quot;</span><span class="p">)</span>
      <span class="o">.</span><span class="n">withColumnRenamed</span><span class="p">(</span><span class="s2">&quot;prev_title&quot;</span><span class="p">,</span> <span class="s2">&quot;previous_page_title&quot;</span><span class="p">)</span>
      <span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;current_page_title&quot;</span><span class="p">,</span> <span class="s2">&quot;click_count&quot;</span><span class="p">,</span> <span class="s2">&quot;previous_page_title&quot;</span><span class="p">)</span>
  <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="create-a-table-with-enriched-data-views">
<h2>Create a table with enriched data views<a class="headerlink" href="#create-a-table-with-enriched-data-views" title="Permalink to this headline"> </a></h2>
<p>Because Delta Live Tables processes updates to pipelines as a series of dependency graphs, you can declare highly enriched views that power dashboards, BI, and analytics by declaring tables with specific business logic.</p>
<p>Delta Live Tables tables are equivalent conceptually to materialized views. Whereas traditional views on Spark execute logic each time the view is queried, Delta Live Tables tables store the most recent version of query results in data files. Because Delta Live Tables manages updates for all datasets in a pipeline, you can schedule pipeline updates to match latency requirements for materialized views and know that queries against these tables contain the most recent version of data available.</p>
<p>The table defined by the following code demonstrates the conceptual similarity to a materialized view derived from upstream data in your pipeline:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@dlt</span><span class="o">.</span><span class="n">table</span><span class="p">(</span>
  <span class="n">comment</span><span class="o">=</span><span class="s2">&quot;A table containing the top pages linking to the Apache Spark page.&quot;</span>
<span class="p">)</span>
<span class="k">def</span> <span class="nf">top_spark_referrers</span><span class="p">():</span>
  <span class="k">return</span> <span class="p">(</span>
    <span class="n">dlt</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;clickstream_prepared&quot;</span><span class="p">)</span>
      <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">expr</span><span class="p">(</span><span class="s2">&quot;current_page_title == &#39;Apache_Spark&#39;&quot;</span><span class="p">))</span>
      <span class="o">.</span><span class="n">withColumnRenamed</span><span class="p">(</span><span class="s2">&quot;previous_page_title&quot;</span><span class="p">,</span> <span class="s2">&quot;referrer&quot;</span><span class="p">)</span>
      <span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">desc</span><span class="p">(</span><span class="s2">&quot;click_count&quot;</span><span class="p">))</span>
      <span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;referrer&quot;</span><span class="p">,</span> <span class="s2">&quot;click_count&quot;</span><span class="p">)</span>
      <span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
  <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="next-steps">
<h2>Next steps<a class="headerlink" href="#next-steps" title="Permalink to this headline"> </a></h2>
<p>To learn more, see <a class="reference internal" href="python-ref.html"><span class="doc">Delta Live Tables Python language reference</span></a>.</p>
</div>
</div>


    
          </div>
        </div>
        <div  class="suapp-rating">
  <div id="suPageRateApp">
     <su-app></su-app>
   </div> 
 </div>
<hr> 
<footer>
  <div role="contentinfo">
      <p class="copyright">
          &copy; Databricks 2023. All rights reserved. Apache, Apache Spark, Spark, and the Spark logo are trademarks of the <a href="http://www.apache.org/">Apache Software Foundation</a>.
      </p>
      <p> 
        
          <a id='feedbacklink' href="mailto:doc-feedback@databricks.com?subject=Documentation Feedback">Send us feedback</a>
        
     | <a href="https://databricks.com/privacy-policy">Privacy Policy</a> | <a href="https://databricks.com/terms-of-use">Terms of Use</a></p>

  </div> 

</footer>
      </div>
    </div>
  </section>
</main>

  </page>
  
  <script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
      URL_ROOT: '../',
      VERSION: '1.0',
      COLLAPSE_INDEX: false,
      FILE_SUFFIX: '.html',
      HAS_SOURCE: 'false'
    };
  </script>
  <script type="text/javascript" src="../_static/jquery.js"></script>
  <script type="text/javascript" src="../_static/underscore.js"></script>
  <script type="text/javascript" src="../_static/doctools.js"></script>
  <script type="text/javascript" src="../_static/language_data.js"></script>
  

  <script type="text/javascript" src="../_static/js/clipboard.min.js"></script>
  <script type="text/javascript" src="../_static/js/jquery.waypoints.min.js"></script>

  <!-- Select2 (https://select2.org/) -->
  <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
  <!-- End Select2 -->

  
  
  <script type="text/javascript" src="../_static/js/localized.js"></script>
  <script type="text/javascript" src="../_static/js/custom.js"></script>
  

  
  
  <script type="text/javascript">
    jQuery(function () {
      SphinxRtdTheme.StickyNav.enable();
    });

  </script>
  
 



  <script>
  window.__searchunifyLoaderConfig = JSON.parse('{"clients": {"en": "02c2e804-27e9-11ee-aefb-0242ac120011", "ja": "6a42c3f2-2820-11ee-aefb-0242ac120011", "pt": "6a86badd-2821-11ee-aefb-0242ac120011"}}')
</script>
<script type="text/javascript" src="../_static/js/search-loader.js"></script>
</body>
<script type='text/javascript'>
  window.onload = function () {
    var description = document.querySelector('meta[name="description"]').getAttribute("content");
    let titleText = document.querySelector('h1').textContent;
    document.querySelector('meta[property="og:title"]').setAttribute("content", titleText);
    document.querySelector('meta[property="og:description"]').setAttribute("content", description);
    document.querySelector('meta[property="twitter:description"]').setAttribute("content", description);
  };
</script>

</html>