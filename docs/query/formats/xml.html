

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en-US" > <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en-US"> <!--<![endif]-->

<head>
  <!-- cookie consent -->
  
    <!-- Combined Onetrust and Rudderstack Implementation Scripts -->
    <!-- Onetrust Initialization -->
    <script type="text/javascript" src="https://cdn.cookielaw.org/consent/92466579-1717-44d3-809d-a05fb02843ed-test/OtAutoBlock.js"></script>
    <script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" data-document-language="true" type="text/javascript" charset="UTF-8" data-domain-script="92466579-1717-44d3-809d-a05fb02843ed-test"></script>
    <link rel="stylesheet" id="db-onetrust-style" href="https://www.databricks.com/wp-content/uploads/db_onetrust.css" media="all" />
    <!-- Setting Rudderstack Write Key -->
    <script>window.rudderstackKey = "2SOR9fvSr5Fi6tN2ihPbVHnX1SZ" </script>
    <!-- Rudderstack Initialization + Onetrust Integration + Rudderstack Custom Events -->
    <script type="text/javascript" src="https://www.databricks.com/sites/default/files/rudderstack/v1/db-rudderstack-events.js"></script>

  <!-- cookie consent -->

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="X-UA-Compatible" content="IE=9" />
  <meta content="This article describes how to read and write an XML file as an Apache Spark data source." name="description" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
  <meta property="og:image" content="https://www.databricks.com/wp-content/uploads/2020/04/og-databricks.png">
  <meta property="og:image:type" content="image/png">
  <meta property="og:title" content="XML file">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://docs.databricks.com">
  <meta property="og:description" content="" id="og-description">
  <meta name="twitter:image" content="https://www.databricks.com/wp-content/uploads/2020/04/og-databricks.png">
  <meta name="twitter:site" content="@databricks">
  <meta name="twitter:creator" content="@databricks">
  <meta property="twitter:description" content="">
  
  <title>XML file &#124; Databricks on AWS</title>
  
  
  <link rel="canonical" href="https://docs.databricks.com/en/query/formats/xml.html">
  <!-- Start hreflang tag -->
  <link rel="alternate" hreflang="en" href="https://docs.databricks.com/en/query/formats/xml.html" />
<link rel="alternate" hreflang="x-default" href="https://docs.databricks.com/en/query/formats/xml.html" />
  <!-- End hreflang tag -->
  
  
  <link rel="shortcut icon" href="../../_static/favicon.ico" />
  

  

  

  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;
j.setAttributeNode(d.createAttribute('data-ot-ignore'));
f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-T85FQ33');</script>
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;
j.setAttributeNode(d.createAttribute('data-ot-ignore'));
f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-TWTKQQ');</script>
    
  <!-- End Google Tag Manager -->


  <!-- MaxMind / GEO IP -->
  <script src="//js.maxmind.com/js/apis/geoip2/v2.1/geoip2.js" type="text/javascript"></script>
  <!-- End MaxMind / GEO IP -->

  
  
  <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600&display=swap" rel="stylesheet">
  <link rel="preload" href="../../_static/fonts/DMSans-Bold.ttf" as="font">
  <link rel="preload" href="../../_static/fonts/DMSans-Regular.ttf" as="font">
  <link rel="preload" href="../../_static/fonts/DMMono-Regular.ttf" as="font">
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/cloud-provider-selector.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/translation-selector.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/searchunify/main.css" type="text/css" />

  
  <link rel="index" title="Index" href="../../genindex.html" />
  <link rel="search" title="Search" href="../../search.html" />
  <link rel="top" title="Databricks on AWS" href="../../index.html" /> 
</head>

<body class="wy-body-for-nav" role="document">

  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T85FQ33"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TWTKQQ"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->

  
  <nav class="wy-nav-top header su_header" role="navigation" aria-label="top navigation">
    
<nav class="wy-nav-top header su_header" role="navigation" aria-label="top navigation">
  <div class="container-logo">
    <ul class="mobile-menu-toggle">
        <li class="menu-toggle">
            <i data-toggle="wy-nav-top" class="wy-nav-top-menu-button db-icon db-icon-menu pull-left"></i>
            
            <a href="https://www.databricks.com/" class="wy-nav-top-logo"><img src="../../_static/small-scale-lockup-full-color-rgb.svg" width="137" height="21"
              alt="Databricks" /></a>   
               
              </li>
    </ul>
    <ul class="su_nav-menu">
      <li class="menu-toggle">
        <i data-toggle="wy-nav-top" class="wy-nav-top-menu-button db-icon db-icon-menu pull-left"></i>
        
          
        
        <a href="https://www.databricks.com/" class="wy-nav-top-logo"><img src="../../_static/small-scale-lockup-full-color-rgb.svg" width="137" height="21"
            alt="Databricks" /></a></li>
        <!-- 
<li><a href="https://help.databricks.com/s/">Help Center</a></li>
<li class="active"><a href="https://docs.databricks.com/en/">Documentation</a></li>
<li><a href="https://kb.databricks.com/">Knowledge Base</a></li>
 -->
    </ul>
  </div>
  <div class="su_nav-right">
    <ul class="su_link-mobile">
  <!-- Mobile header code can go here -->
</ul>
<ul class="right-try-list">
   
</ul>
  </div>
</nav>
  </nav>

  <div class="su_sub-header">
    <div class="container">
      <div class="su_sub-header-inner">
        <!-- <div class="su_subnav-menu-right">
  <div id="auto" style="width: 100%;">
    <div ng-controller="SearchautoController">
      <div bind-html-compile="autocompleteHtml">
        <form class="su__search-box-1" disabled="disabled">
          <input class="su__search-input" type="search" name="Search box" id="su__search-b" placeholder="Search Documentation" disabled="disabled"/>
          <button class="su__search-button" type="submit" class="button button-success" disabled="disabled">
            <svg width="24" height="24" viewBox="0 0 24 24">
              <path
                d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"
                fill="#333"></path>
            </svg>
          </button>
        </form>
      </div>
    </div>
  </div>
</div> -->
        <div class="search-lng-gap"></div>
        <div style="margin-left: 16px; margin-right: 16px;">
          <!-- <select name="lng selector" id="lng-selector">
    <option value="../../../en/query/formats/xml.html" class="notranslate">English</option>
    <option value="../../../ja/query/formats/xml.html" class="notranslate">日本語</option>
    <option value="../../../pt/query/formats/xml.html" class="notranslate">Português (Brasil)</option>
</select> -->
        </div>
        <div class="cloud-selector-container">
          <!-- <select name="cloud provider selector" id="cloud-provider-selector">
    <option value="aws" selected class="notranslate">
        Amazon Web Services
    </option>
    <option value="azure"  class="notranslate">
        Microsoft Azure
    </option>
    <option value="gcp"  class="notranslate">
        Google Cloud Platform
    </option>
</select> -->
        </div>
      </div>
    </div>
  </div>
  <page class="js-page-container">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side su_nav-side">
<div class="wy-side-scroll">
  <div class="wy-side-nav-search">
    

    

    

    
  </div>

  <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
    
      <a href="../../index.html" class="main-navigation-home">Databricks on AWS</a>
    

    
      

      
        <p class="caption"><span class="caption-text">Load &amp; manage data</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../rag-temp/index.html">RAG Studio</a></li>
</ul>

      
    
  </div>

  <div role="contentinfo">
    
  <p class="build_info notranslate"data-last-edit="December 23, 2023">
    Updated Jan 11, 2024
  </p>
<script>
  window.addEventListener('DOMContentLoaded',function(){
    var h1=document.querySelector('h1');
    var bi=document.querySelector('[data-last-edit]');
    if(h1 && bi){
      var ver = document.createElement('p');
      ver.className = 'version_info';
      ver.textContent = bi.getAttribute('data-last-edit');
      h1.parentElement.insertBefore(ver, h1.nextElementSibling);
    }
  });
</script>

    <p>
      
        <a id='feedbacklink' href="mailto:doc-feedback@databricks.com?subject=Documentation Feedback">Send us feedback</a>
      
    </p>
  </div>
</div>
</nav>
    
    
<main class="wy-grid-for-nav su_nav-grid">
  <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
    <div class="wy-nav-content su__nav_content">
      <div class="rst-content">
        





<div role="navigation" aria-label="breadcrumbs navigation" class="wy-breadcrumbs-wrapper">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Documentation</a> <span class="db-icon db-icon-chevron-right"></span></li>
    
    
      <li>XML file</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>
</div>
        
        <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
          <div itemprop="articleBody">
            
    
  <div class="section" id="xml-file">
<h1>XML file<a class="headerlink" href="#xml-file" title="Permalink to this headline"> </a></h1>
<p>This article describes how to read and write an XML file as an Apache Spark data source.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Native XML file format support is available as a Private Preview. See <a class="reference external" href="../../_extras/documents/native-xml-private-preview.pdf">XML Format</a>.</p>
</div>
<div class="section" id="requirements">
<h2>Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline"> </a></h2>
<ol class="arabic">
<li><p>Create the <code class="docutils literal notranslate"><span class="pre">spark-xml</span></code> library as a <a class="reference internal" href="../../libraries/package-repositories.html#maven-libraries"><span class="std std-ref">Maven library</span></a>. For the Maven coordinate, specify:</p>
<ul class="simple">
<li><p>Databricks Runtime 7.x and above: <code class="docutils literal notranslate"><span class="pre">com.databricks:spark-xml_2.12:&lt;release&gt;</span></code></p></li>
</ul>
<p>See <code class="docutils literal notranslate"><span class="pre">spark-xml</span></code> <a class="reference external" href="https://github.com/databricks/spark-xml/releases">Releases</a> for the latest version of <code class="docutils literal notranslate"><span class="pre">&lt;release&gt;</span></code>.</p>
</li>
<li><p><a class="reference internal" href="../../libraries/cluster-libraries.html#install-libraries"><span class="std std-ref">Install the library</span></a> on a cluster.</p></li>
</ol>
</div>
<div class="section" id="example">
<h2>Example<a class="headerlink" href="#example" title="Permalink to this headline"> </a></h2>
<p>The example in this section uses the <a class="reference external" href="https://github.com/databricks/spark-xml/raw/master/src/test/resources/books.xml">books</a> XML file.</p>
<ol class="arabic">
<li><p>Retrieve the books XML file:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>wget<span class="w"> </span>https://github.com/databricks/spark-xml/raw/master/src/test/resources/books.xml
</pre></div>
</div>
</li>
<li><p>Upload the file to <a class="reference internal" href="../../archive/legacy/data-tab.html"><span class="doc">DBFS</span></a>.</p></li>
</ol>
<div class="section" id="read-and-write-xml-data">
<h3>Read and write XML data<a class="headerlink" href="#read-and-write-xml-data" title="Permalink to this headline"> </a></h3>
<div class="js-code-language-tabs js-code-language-tabs--literal compound">
<div class="compound-first highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="cm">/*Infer schema*/</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">books</span>
<span class="k">USING</span><span class="w"> </span><span class="n">xml</span>
<span class="k">OPTIONS</span><span class="w"> </span><span class="p">(</span><span class="n">path</span><span class="w"> </span><span class="ss">&quot;dbfs:/books.xml&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">rowTag</span><span class="w"> </span><span class="ss">&quot;book&quot;</span><span class="p">)</span>

<span class="cm">/*Specify column names and types*/</span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">books</span><span class="w"> </span><span class="p">(</span><span class="n">author</span><span class="w"> </span><span class="n">string</span><span class="p">,</span><span class="w"> </span><span class="n">description</span><span class="w"> </span><span class="n">string</span><span class="p">,</span><span class="w"> </span><span class="n">genre</span><span class="w"> </span><span class="n">string</span><span class="p">,</span><span class="w"> </span><span class="n">_id</span><span class="w"> </span><span class="n">string</span><span class="p">,</span><span class="w"> </span><span class="n">price</span><span class="w"> </span><span class="n">double</span><span class="p">,</span><span class="w"> </span><span class="n">publish_date</span><span class="w"> </span><span class="n">string</span><span class="p">,</span><span class="w"> </span><span class="n">title</span><span class="w"> </span><span class="n">string</span><span class="p">)</span>
<span class="k">USING</span><span class="w"> </span><span class="n">xml</span>
<span class="k">OPTIONS</span><span class="w"> </span><span class="p">(</span><span class="n">path</span><span class="w"> </span><span class="ss">&quot;dbfs:/books.xml&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">rowTag</span><span class="w"> </span><span class="ss">&quot;book&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="compound-middle highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="c1">// Infer schema</span>

<span class="k">import</span><span class="w"> </span><span class="nn">com</span><span class="p">.</span><span class="nn">databricks</span><span class="p">.</span><span class="nn">spark</span><span class="p">.</span><span class="nn">xml</span><span class="p">.</span><span class="n">_</span><span class="w"> </span><span class="c1">// Add the DataFrame.read.xml() method</span>

<span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="n">read</span>
<span class="w">  </span><span class="p">.</span><span class="n">option</span><span class="p">(</span><span class="s">&quot;rowTag&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;book&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">.</span><span class="n">xml</span><span class="p">(</span><span class="s">&quot;dbfs:/books.xml&quot;</span><span class="p">)</span>

<span class="kd">val</span><span class="w"> </span><span class="n">selectedData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="s">&quot;author&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;_id&quot;</span><span class="p">)</span>
<span class="n">selectedData</span><span class="p">.</span><span class="n">write</span>
<span class="w">  </span><span class="p">.</span><span class="n">option</span><span class="p">(</span><span class="s">&quot;rootTag&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;books&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">.</span><span class="n">option</span><span class="p">(</span><span class="s">&quot;rowTag&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;book&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">.</span><span class="n">xml</span><span class="p">(</span><span class="s">&quot;dbfs:/newbooks.xml&quot;</span><span class="p">)</span>

<span class="c1">// Specify schema</span>

<span class="k">import</span><span class="w"> </span><span class="nn">org</span><span class="p">.</span><span class="nn">apache</span><span class="p">.</span><span class="nn">spark</span><span class="p">.</span><span class="nn">sql</span><span class="p">.</span><span class="nn">types</span><span class="p">.{</span><span class="nc">StructType</span><span class="p">,</span><span class="w"> </span><span class="nc">StructField</span><span class="p">,</span><span class="w"> </span><span class="nc">StringType</span><span class="p">,</span><span class="w"> </span><span class="nc">DoubleType</span><span class="p">}</span>

<span class="kd">val</span><span class="w"> </span><span class="n">customSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">StructType</span><span class="p">(</span><span class="nc">Array</span><span class="p">(</span>
<span class="w">  </span><span class="nc">StructField</span><span class="p">(</span><span class="s">&quot;_id&quot;</span><span class="p">,</span><span class="w"> </span><span class="nc">StringType</span><span class="p">,</span><span class="w"> </span><span class="n">nullable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">),</span>
<span class="w">  </span><span class="nc">StructField</span><span class="p">(</span><span class="s">&quot;author&quot;</span><span class="p">,</span><span class="w"> </span><span class="nc">StringType</span><span class="p">,</span><span class="w"> </span><span class="n">nullable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">),</span>
<span class="w">  </span><span class="nc">StructField</span><span class="p">(</span><span class="s">&quot;description&quot;</span><span class="p">,</span><span class="w"> </span><span class="nc">StringType</span><span class="p">,</span><span class="w"> </span><span class="n">nullable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">),</span>
<span class="w">  </span><span class="nc">StructField</span><span class="p">(</span><span class="s">&quot;genre&quot;</span><span class="p">,</span><span class="w"> </span><span class="nc">StringType</span><span class="p">,</span><span class="w"> </span><span class="n">nullable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">),</span>
<span class="w">  </span><span class="nc">StructField</span><span class="p">(</span><span class="s">&quot;price&quot;</span><span class="p">,</span><span class="w"> </span><span class="nc">DoubleType</span><span class="p">,</span><span class="w"> </span><span class="n">nullable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">),</span>
<span class="w">  </span><span class="nc">StructField</span><span class="p">(</span><span class="s">&quot;publish_date&quot;</span><span class="p">,</span><span class="w"> </span><span class="nc">StringType</span><span class="p">,</span><span class="w"> </span><span class="n">nullable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">),</span>
<span class="w">  </span><span class="nc">StructField</span><span class="p">(</span><span class="s">&quot;title&quot;</span><span class="p">,</span><span class="w"> </span><span class="nc">StringType</span><span class="p">,</span><span class="w"> </span><span class="n">nullable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">)))</span>

<span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="n">read</span>
<span class="w">  </span><span class="p">.</span><span class="n">option</span><span class="p">(</span><span class="s">&quot;rowTag&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;book&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">.</span><span class="n">schema</span><span class="p">(</span><span class="n">customSchema</span><span class="p">)</span>
<span class="w">  </span><span class="p">.</span><span class="n">xml</span><span class="p">(</span><span class="s">&quot;books.xml&quot;</span><span class="p">)</span>

<span class="kd">val</span><span class="w"> </span><span class="n">selectedData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="s">&quot;author&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;_id&quot;</span><span class="p">)</span>
<span class="n">selectedData</span><span class="p">.</span><span class="n">write</span>
<span class="w">  </span><span class="p">.</span><span class="n">option</span><span class="p">(</span><span class="s">&quot;rootTag&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;books&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">.</span><span class="n">option</span><span class="p">(</span><span class="s">&quot;rowTag&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;book&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">.</span><span class="n">xml</span><span class="p">(</span><span class="s">&quot;dbfs:/newbooks.xml&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="compound-last highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Infer schema</span>

<span class="nf">library</span><span class="p">(</span><span class="n">SparkR</span><span class="p">)</span>

<span class="nf">sparkR.session</span><span class="p">(</span><span class="s">&quot;local[4]&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">sparkPackages</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;com.databricks:spark-xml_2.12:&lt;release&gt;&quot;</span><span class="p">))</span>

<span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">read.df</span><span class="p">(</span><span class="s">&quot;dbfs:/books.xml&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">source</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;xml&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">rowTag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;book&quot;</span><span class="p">)</span>

<span class="c1"># Default `rootTag` and `rowTag`</span>
<span class="nf">write.df</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;dbfs:/newbooks.xml&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;xml&quot;</span><span class="p">)</span>

<span class="c1"># Specify schema</span>

<span class="n">customSchema</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">structType</span><span class="p">(</span>
<span class="w">  </span><span class="nf">structField</span><span class="p">(</span><span class="s">&quot;_id&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;string&quot;</span><span class="p">),</span>
<span class="w">  </span><span class="nf">structField</span><span class="p">(</span><span class="s">&quot;author&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;string&quot;</span><span class="p">),</span>
<span class="w">  </span><span class="nf">structField</span><span class="p">(</span><span class="s">&quot;description&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;string&quot;</span><span class="p">),</span>
<span class="w">  </span><span class="nf">structField</span><span class="p">(</span><span class="s">&quot;genre&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;string&quot;</span><span class="p">),</span>
<span class="w">  </span><span class="nf">structField</span><span class="p">(</span><span class="s">&quot;price&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;double&quot;</span><span class="p">),</span>
<span class="w">  </span><span class="nf">structField</span><span class="p">(</span><span class="s">&quot;publish_date&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;string&quot;</span><span class="p">),</span>
<span class="w">  </span><span class="nf">structField</span><span class="p">(</span><span class="s">&quot;title&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;string&quot;</span><span class="p">))</span>

<span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">read.df</span><span class="p">(</span><span class="s">&quot;dbfs:/books.xml&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">source</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;xml&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">schema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">customSchema</span><span class="p">,</span><span class="w"> </span><span class="n">rowTag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;book&quot;</span><span class="p">)</span>

<span class="c1"># In this case, `rootTag` is set to &quot;ROWS&quot; and `rowTag` is set to &quot;ROW&quot;.</span>
<span class="nf">write.df</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;dbfs:/newbooks.xml&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;xml&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;overwrite&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="options">
<h2>Options<a class="headerlink" href="#options" title="Permalink to this headline"> </a></h2>
<ul class="simple">
<li><p>Read</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">path</span></code>: Location of XML files. Accepts standard Hadoop globbing expressions.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rowTag</span></code>: The row tag to treat as a row. For example, in this XML <code class="docutils literal notranslate"><span class="pre">&lt;books&gt;&lt;book&gt;&lt;book&gt;...&lt;/books&gt;</span></code>, the value would be <code class="docutils literal notranslate"><span class="pre">book</span></code>. Default is <code class="docutils literal notranslate"><span class="pre">ROW</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">samplingRatio</span></code>: Sampling ratio for inferring schema (0.0 ~ 1). Default is 1. Possible types are <code class="docutils literal notranslate"><span class="pre">StructType</span></code>, <code class="docutils literal notranslate"><span class="pre">ArrayType</span></code>, <code class="docutils literal notranslate"><span class="pre">StringType</span></code>, <code class="docutils literal notranslate"><span class="pre">LongType</span></code>, <code class="docutils literal notranslate"><span class="pre">DoubleType</span></code>, <code class="docutils literal notranslate"><span class="pre">BooleanType</span></code>, <code class="docutils literal notranslate"><span class="pre">TimestampType</span></code> and <code class="docutils literal notranslate"><span class="pre">NullType</span></code>, unless you provide a schema.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">excludeAttribute</span></code>: Whether to exclude attributes in elements. Default is false.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nullValue</span></code>: The value to treat as a <code class="docutils literal notranslate"><span class="pre">null</span></code> value. Default is <code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mode</span></code>: The mode for dealing with corrupt records. Default is <code class="docutils literal notranslate"><span class="pre">PERMISSIVE</span></code>.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">PERMISSIVE</span></code>:</p>
<ul>
<li><p>When it encounters a corrupted record, sets all fields to <code class="docutils literal notranslate"><span class="pre">null</span></code> and puts the malformed string into a new field configured by <code class="docutils literal notranslate"><span class="pre">columnNameOfCorruptRecord</span></code>.</p></li>
<li><p>When it encounters a field of the wrong data type, sets the offending field to <code class="docutils literal notranslate"><span class="pre">null</span></code>.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">DROPMALFORMED</span></code>: ignores corrupted records.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">FAILFAST</span></code>: throws an exception when it detects corrupted records.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">inferSchema</span></code>: if <code class="docutils literal notranslate"><span class="pre">true</span></code>, attempts to infer an appropriate type for each resulting DataFrame column, like a boolean, numeric or date type. If <code class="docutils literal notranslate"><span class="pre">false</span></code>, all resulting columns are of string type. Default is <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">columnNameOfCorruptRecord</span></code>: The name of new field where malformed strings are stored. Default is <code class="docutils literal notranslate"><span class="pre">_corrupt_record</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">attributePrefix</span></code>: The prefix for attributes so that to differentiate attributes and elements. This is the prefix for field names. Default is <code class="docutils literal notranslate"><span class="pre">_</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">valueTag</span></code>: The tag used for the value when there are attributes in an element that has no child elements. Default is <code class="docutils literal notranslate"><span class="pre">_VALUE</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">charset</span></code>: Defaults to <code class="docutils literal notranslate"><span class="pre">UTF-8</span></code> but can be set to other valid charset names.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ignoreSurroundingSpaces</span></code>: Whether or not whitespaces surrounding values should be skipped. Default is false.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rowValidationXSDPath</span></code>: Path to an XSD file that is used to validate the XML for each row. Rows that fail to validate are treated like parse errors as above. The XSD does not otherwise affect the schema provided or inferred.  If the same local path is not already also visible on the executors in the cluster, then the XSD and any others it depends on should be added to the Spark executors with <a class="reference external" href="https://api-docs.databricks.com/scala/spark/latest/org/apache/spark/SparkContext.html#addFile(path:String):Unit">SparkContext.addFile</a>. In this case, to use local XSD <code class="docutils literal notranslate"><span class="pre">/foo/bar.xsd</span></code>, call <code class="docutils literal notranslate"><span class="pre">addFile(&quot;/foo/bar.xsd&quot;)</span></code> and pass <code class="docutils literal notranslate"><span class="pre">&quot;bar.xsd&quot;</span></code> as <code class="docutils literal notranslate"><span class="pre">rowValidationXSDPath</span></code>.</p></li>
</ul>
</li>
<li><p>Write</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">path</span></code>: Location to write files.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rowTag</span></code>: The row tag to treat as a row. For example, in this XML <code class="docutils literal notranslate"><span class="pre">&lt;books&gt;&lt;book&gt;&lt;book&gt;...&lt;/books&gt;</span></code>, the value would be <code class="docutils literal notranslate"><span class="pre">book</span></code>. Default is <code class="docutils literal notranslate"><span class="pre">ROW</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rootTag</span></code>: The root tag to treat as the root. For example, in this XML <code class="docutils literal notranslate"><span class="pre">&lt;books&gt;&lt;book&gt;&lt;book&gt;...&lt;/books&gt;</span></code>, the value would be <code class="docutils literal notranslate"><span class="pre">books</span></code>. Default is <code class="docutils literal notranslate"><span class="pre">ROWS</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nullValue</span></code>: The value to write <code class="docutils literal notranslate"><span class="pre">null</span></code> value. Default is the string <code class="docutils literal notranslate"><span class="pre">&quot;null&quot;</span></code>. When <code class="docutils literal notranslate"><span class="pre">&quot;null&quot;</span></code>, it does not write attributes and elements for fields.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">attributePrefix</span></code>: The prefix for attributes to differentiate attributes and elements. This is the prefix for field names. Default is <code class="docutils literal notranslate"><span class="pre">_</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">valueTag</span></code>: The tag used for the value when there are attributes in an element that has no child elements. Default is <code class="docutils literal notranslate"><span class="pre">_VALUE</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">compression</span></code>: Compression codec to use when saving to file. Should be the fully qualified name of a class implementing <code class="docutils literal notranslate"><span class="pre">org.apache.hadoop.io.compress.CompressionCodec</span></code> or one of case-insensitive short names (<code class="docutils literal notranslate"><span class="pre">bzip2</span></code>, <code class="docutils literal notranslate"><span class="pre">gzip</span></code>, <code class="docutils literal notranslate"><span class="pre">lz4</span></code>, and <code class="docutils literal notranslate"><span class="pre">snappy</span></code>). Default is no compression.</p></li>
</ul>
</li>
</ul>
<p>Supports the shortened name usage; You can use <code class="docutils literal notranslate"><span class="pre">xml</span></code> instead of <code class="docutils literal notranslate"><span class="pre">com.databricks.spark.xml</span></code>.</p>
</div>
<div class="section" id="xsd-support">
<h2>XSD support<a class="headerlink" href="#xsd-support" title="Permalink to this headline"> </a></h2>
<p>You can validate individual rows against an XSD schema using <code class="docutils literal notranslate"><span class="pre">rowValidationXSDPath</span></code>.</p>
<p>You use the utility <code class="docutils literal notranslate"><span class="pre">com.databricks.spark.xml.util.XSDToSchema</span></code> to extract a Spark DataFrame
schema from <em>some</em> XSD files. It supports only simple, complex and sequence types, only basic XSD functionality,
and is experimental.</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">import</span><span class="w"> </span><span class="nn">com</span><span class="p">.</span><span class="nn">databricks</span><span class="p">.</span><span class="nn">spark</span><span class="p">.</span><span class="nn">xml</span><span class="p">.</span><span class="nn">util</span><span class="p">.</span><span class="nc">XSDToSchema</span>
<span class="k">import</span><span class="w"> </span><span class="nn">java</span><span class="p">.</span><span class="nn">nio</span><span class="p">.</span><span class="nn">file</span><span class="p">.</span><span class="nc">Paths</span>

<span class="kd">val</span><span class="w"> </span><span class="n">schema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">XSDToSchema</span><span class="p">.</span><span class="n">read</span><span class="p">(</span><span class="nc">Paths</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;/path/to/your.xsd&quot;</span><span class="p">))</span>
<span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="n">read</span><span class="p">.</span><span class="n">schema</span><span class="p">(</span><span class="n">schema</span><span class="p">)....</span><span class="n">xml</span><span class="p">(...)</span>
</pre></div>
</div>
</div>
<div class="section" id="parse-nested-xml">
<h2>Parse nested XML<a class="headerlink" href="#parse-nested-xml" title="Permalink to this headline"> </a></h2>
<p>Although primarily used to convert an XML file into a DataFrame, you can also use the <code class="docutils literal notranslate"><span class="pre">from_xml</span></code> method to parse XML in a string-valued column in an existing DataFrame and add it as a new column with parsed results as a struct with:</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">import</span><span class="w"> </span><span class="nn">com</span><span class="p">.</span><span class="nn">databricks</span><span class="p">.</span><span class="nn">spark</span><span class="p">.</span><span class="nn">xml</span><span class="p">.</span><span class="nn">functions</span><span class="p">.</span><span class="n">from_xml</span>
<span class="k">import</span><span class="w"> </span><span class="nn">com</span><span class="p">.</span><span class="nn">databricks</span><span class="p">.</span><span class="nn">spark</span><span class="p">.</span><span class="nn">xml</span><span class="p">.</span><span class="n">schema_of_xml</span>
<span class="k">import</span><span class="w"> </span><span class="nn">spark</span><span class="p">.</span><span class="nn">implicits</span><span class="p">.</span><span class="n">_</span>

<span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="c1">/// DataFrame with XML in column &#39;payload&#39;</span>
<span class="kd">val</span><span class="w"> </span><span class="n">payloadSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">schema_of_xml</span><span class="p">(</span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="s">&quot;payload&quot;</span><span class="p">).</span><span class="n">as</span><span class="p">[</span><span class="nc">String</span><span class="p">])</span>
<span class="kd">val</span><span class="w"> </span><span class="n">parsed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df</span><span class="p">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s">&quot;parsed&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">from_xml</span><span class="p">(</span><span class="n">$</span><span class="s">&quot;payload&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">payloadSchema</span><span class="p">))</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">mode</span></code>:</p>
<ul>
<li><p>If set to <code class="docutils literal notranslate"><span class="pre">PERMISSIVE</span></code>, the default, the parse mode instead defaults to <code class="docutils literal notranslate"><span class="pre">DROPMALFORMED</span></code>. If you include a column in the schema for <code class="docutils literal notranslate"><span class="pre">from_xml</span></code> that matches the <code class="docutils literal notranslate"><span class="pre">columnNameOfCorruptRecord</span></code>, then <code class="docutils literal notranslate"><span class="pre">PERMISSIVE</span></code> mode outputs malformed records to that column in the resulting struct.</p></li>
<li><p>If set to <code class="docutils literal notranslate"><span class="pre">DROPMALFORMED</span></code>, XML values that do not parse correctly result in a <code class="docutils literal notranslate"><span class="pre">null</span></code> value for the column. No rows are dropped.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">from_xml</span></code> converts arrays of strings containing XML to arrays of parsed structs. Use <code class="docutils literal notranslate"><span class="pre">schema_of_xml_array</span></code> instead.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">from_xml_string</span></code> is an alternative for use in UDFs that operates on a String directly instead of a column.</p></li>
</ul>
</div>
</div>
<div class="section" id="conversion-rules">
<h2>Conversion rules<a class="headerlink" href="#conversion-rules" title="Permalink to this headline"> </a></h2>
<p>Due to structural differences between DataFrames and XML, there are some conversion rules from XML data to DataFrame and from DataFrame to XML data. You can disable handling attributes with the option <code class="docutils literal notranslate"><span class="pre">excludeAttribute</span></code>.</p>
<div class="section" id="convert-xml-to-dataframe">
<h3>Convert XML to DataFrame<a class="headerlink" href="#convert-xml-to-dataframe" title="Permalink to this headline"> </a></h3>
<ul>
<li><p>Attributes: Attributes are converted as fields with the prefix specified in the <code class="docutils literal notranslate"><span class="pre">attributePrefix</span></code> option. If <code class="docutils literal notranslate"><span class="pre">attributePrefix</span></code> is <code class="docutils literal notranslate"><span class="pre">_</span></code>, the document</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;one</span><span class="w"> </span><span class="na">myOneAttrib=</span><span class="s">&quot;AAAA&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;two&gt;</span>two<span class="nt">&lt;/two&gt;</span>
<span class="w">    </span><span class="nt">&lt;three&gt;</span>three<span class="nt">&lt;/three&gt;</span>
<span class="nt">&lt;/one&gt;</span>
</pre></div>
</div>
<p>produces the schema:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">root</span>
 <span class="o">|--</span> <span class="n">_myOneAttrib</span><span class="p">:</span> <span class="n">string</span> <span class="p">(</span><span class="n">nullable</span> <span class="o">=</span> <span class="n">true</span><span class="p">)</span>
 <span class="o">|--</span> <span class="n">two</span><span class="p">:</span> <span class="n">string</span> <span class="p">(</span><span class="n">nullable</span> <span class="o">=</span> <span class="n">true</span><span class="p">)</span>
 <span class="o">|--</span> <span class="n">three</span><span class="p">:</span> <span class="n">string</span> <span class="p">(</span><span class="n">nullable</span> <span class="o">=</span> <span class="n">true</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>If an element has attributes but no child elements, the attribute value is put in a separate field specified in the <code class="docutils literal notranslate"><span class="pre">valueTag</span></code> option. If <code class="docutils literal notranslate"><span class="pre">valueTag</span></code> is <code class="docutils literal notranslate"><span class="pre">_VALUE</span></code>, the document</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;one&gt;</span>
<span class="w">    </span><span class="nt">&lt;two</span><span class="w"> </span><span class="na">myTwoAttrib=</span><span class="s">&quot;BBBBB&quot;</span><span class="nt">&gt;</span>two<span class="nt">&lt;/two&gt;</span>
<span class="w">    </span><span class="nt">&lt;three&gt;</span>three<span class="nt">&lt;/three&gt;</span>
<span class="nt">&lt;/one&gt;</span>
</pre></div>
</div>
<p>produces the schema:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">root</span>
 <span class="o">|--</span> <span class="n">two</span><span class="p">:</span> <span class="n">struct</span> <span class="p">(</span><span class="n">nullable</span> <span class="o">=</span> <span class="n">true</span><span class="p">)</span>
 <span class="o">|</span>    <span class="o">|--</span> <span class="n">_VALUE</span><span class="p">:</span> <span class="n">string</span> <span class="p">(</span><span class="n">nullable</span> <span class="o">=</span> <span class="n">true</span><span class="p">)</span>
 <span class="o">|</span>    <span class="o">|--</span> <span class="n">_myTwoAttrib</span><span class="p">:</span> <span class="n">string</span> <span class="p">(</span><span class="n">nullable</span> <span class="o">=</span> <span class="n">true</span><span class="p">)</span>
 <span class="o">|--</span> <span class="n">three</span><span class="p">:</span> <span class="n">string</span> <span class="p">(</span><span class="n">nullable</span> <span class="o">=</span> <span class="n">true</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="convert-dataframe-to-xml">
<h3>Convert DataFrame to XML<a class="headerlink" href="#convert-dataframe-to-xml" title="Permalink to this headline"> </a></h3>
<p>Writing a XML file from DataFrame having a field <code class="docutils literal notranslate"><span class="pre">ArrayType</span></code> with its element as <code class="docutils literal notranslate"><span class="pre">ArrayType</span></code> would have an additional nested field for the element. This would not happen in reading and writing XML data but writing a DataFrame read from other sources. Therefore, roundtrip in reading and writing XML files has the same structure but writing a DataFrame read from other sources is possible to have a different structure.</p>
<p>A DataFrame with the schema:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="o">|--</span> <span class="n">a</span><span class="p">:</span> <span class="n">array</span> <span class="p">(</span><span class="n">nullable</span> <span class="o">=</span> <span class="n">true</span><span class="p">)</span>
 <span class="o">|</span>    <span class="o">|--</span> <span class="n">element</span><span class="p">:</span> <span class="n">array</span> <span class="p">(</span><span class="n">containsNull</span> <span class="o">=</span> <span class="n">true</span><span class="p">)</span>
 <span class="o">|</span>    <span class="o">|</span>    <span class="o">|--</span> <span class="n">element</span><span class="p">:</span> <span class="n">string</span> <span class="p">(</span><span class="n">containsNull</span> <span class="o">=</span> <span class="n">true</span><span class="p">)</span>
</pre></div>
</div>
<p>and data:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">+------------------------------------+</span>
<span class="o">|</span>                                   <span class="n">a</span><span class="o">|</span>
<span class="o">+------------------------------------+</span>
<span class="o">|</span><span class="p">[</span><span class="n">WrappedArray</span><span class="p">(</span><span class="n">aa</span><span class="p">),</span> <span class="n">WrappedArray</span><span class="p">(</span><span class="n">bb</span><span class="p">)]</span><span class="o">|</span>
<span class="o">+------------------------------------+</span>
</pre></div>
</div>
<p>produces the XML file:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;a&gt;</span>
<span class="w">  </span><span class="nt">&lt;item&gt;</span>aa<span class="nt">&lt;/item&gt;</span>
<span class="nt">&lt;/a&gt;</span>
<span class="nt">&lt;a&gt;</span>
<span class="w">  </span><span class="nt">&lt;item&gt;</span>bb<span class="nt">&lt;/item&gt;</span>
<span class="nt">&lt;/a&gt;</span>
</pre></div>
</div>
</div>
</div>
</div>


    
          </div>
        </div>
        <div  class="suapp-rating">
  <div id="suPageRateApp">
     <su-app></su-app>
   </div> 
 </div>
<hr> 
<footer>
  <div role="contentinfo">
      <p class="copyright">
          &copy; Databricks 2023. All rights reserved. Apache, Apache Spark, Spark, and the Spark logo are trademarks of the <a href="http://www.apache.org/">Apache Software Foundation</a>.
      </p>
      <p> 
        
          <a id='feedbacklink' href="mailto:doc-feedback@databricks.com?subject=Documentation Feedback">Send us feedback</a>
        
     | <a href="https://databricks.com/privacy-policy">Privacy Policy</a> | <a href="https://databricks.com/terms-of-use">Terms of Use</a></p>

  </div> 

</footer>
      </div>
    </div>
  </section>
</main>

  </page>
  
  <script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
      URL_ROOT: '../../',
      VERSION: '1.0',
      COLLAPSE_INDEX: false,
      FILE_SUFFIX: '.html',
      HAS_SOURCE: 'false'
    };
  </script>
  <script type="text/javascript" src="../../_static/jquery.js"></script>
  <script type="text/javascript" src="../../_static/underscore.js"></script>
  <script type="text/javascript" src="../../_static/doctools.js"></script>
  <script type="text/javascript" src="../../_static/language_data.js"></script>
  

  <script type="text/javascript" src="../../_static/js/clipboard.min.js"></script>
  <script type="text/javascript" src="../../_static/js/jquery.waypoints.min.js"></script>

  <!-- Select2 (https://select2.org/) -->
  <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
  <!-- End Select2 -->

  
  
  <script type="text/javascript" src="../../_static/js/localized.js"></script>
  <script type="text/javascript" src="../../_static/js/custom.js"></script>
  

  
  
  <script type="text/javascript">
    jQuery(function () {
      SphinxRtdTheme.StickyNav.enable();
    });

  </script>
  
 



  <script>
  window.__searchunifyLoaderConfig = JSON.parse('{"clients": {"en": "02c2e804-27e9-11ee-aefb-0242ac120011", "ja": "6a42c3f2-2820-11ee-aefb-0242ac120011", "pt": "6a86badd-2821-11ee-aefb-0242ac120011"}}')
</script>
<script type="text/javascript" src="../../_static/js/search-loader.js"></script>
</body>
<script type='text/javascript'>
  window.onload = function () {
    var description = document.querySelector('meta[name="description"]').getAttribute("content");
    let titleText = document.querySelector('h1').textContent;
    document.querySelector('meta[property="og:title"]').setAttribute("content", titleText);
    document.querySelector('meta[property="og:description"]').setAttribute("content", description);
    document.querySelector('meta[property="twitter:description"]').setAttribute("content", description);
  };
</script>

</html>