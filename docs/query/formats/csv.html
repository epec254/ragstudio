

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en-US" > <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en-US"> <!--<![endif]-->

<head>
  <!-- cookie consent -->
  
    <!-- Combined Onetrust and Rudderstack Implementation Scripts -->
    <!-- Onetrust Initialization -->
    <script type="text/javascript" src="https://cdn.cookielaw.org/consent/92466579-1717-44d3-809d-a05fb02843ed-test/OtAutoBlock.js"></script>
    <script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" data-document-language="true" type="text/javascript" charset="UTF-8" data-domain-script="92466579-1717-44d3-809d-a05fb02843ed-test"></script>
    <link rel="stylesheet" id="db-onetrust-style" href="https://www.databricks.com/wp-content/uploads/db_onetrust.css" media="all" />
    <!-- Setting Rudderstack Write Key -->
    <script>window.rudderstackKey = "2SOR9fvSr5Fi6tN2ihPbVHnX1SZ" </script>
    <!-- Rudderstack Initialization + Onetrust Integration + Rudderstack Custom Events -->
    <script type="text/javascript" src="https://www.databricks.com/sites/default/files/rudderstack/v1/db-rudderstack-events.js"></script>

  <!-- cookie consent -->

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="X-UA-Compatible" content="IE=9" />
  <meta content="Learn how to read and write data to CSV files using Databricks." name="description" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
  <meta property="og:image" content="https://www.databricks.com/wp-content/uploads/2020/04/og-databricks.png">
  <meta property="og:image:type" content="image/png">
  <meta property="og:title" content="Read and write to CSV files">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://docs.databricks.com">
  <meta property="og:description" content="" id="og-description">
  <meta name="twitter:image" content="https://www.databricks.com/wp-content/uploads/2020/04/og-databricks.png">
  <meta name="twitter:site" content="@databricks">
  <meta name="twitter:creator" content="@databricks">
  <meta property="twitter:description" content="">
  
  <title>Read and write to CSV files &#124; Databricks on AWS</title>
  
  
  <link rel="canonical" href="https://docs.databricks.com/en/query/formats/csv.html">
  <!-- Start hreflang tag -->
  <link rel="alternate" hreflang="en" href="https://docs.databricks.com/en/query/formats/csv.html" />
<link rel="alternate" hreflang="x-default" href="https://docs.databricks.com/en/query/formats/csv.html" />
  <!-- End hreflang tag -->
  
  
  <link rel="shortcut icon" href="../../_static/favicon.ico" />
  

  

  

  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;
j.setAttributeNode(d.createAttribute('data-ot-ignore'));
f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-T85FQ33');</script>
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;
j.setAttributeNode(d.createAttribute('data-ot-ignore'));
f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-TWTKQQ');</script>
    
  <!-- End Google Tag Manager -->


  <!-- MaxMind / GEO IP -->
  <script src="//js.maxmind.com/js/apis/geoip2/v2.1/geoip2.js" type="text/javascript"></script>
  <!-- End MaxMind / GEO IP -->

  
  
  <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600&display=swap" rel="stylesheet">
  <link rel="preload" href="../../_static/fonts/DMSans-Bold.ttf" as="font">
  <link rel="preload" href="../../_static/fonts/DMSans-Regular.ttf" as="font">
  <link rel="preload" href="../../_static/fonts/DMMono-Regular.ttf" as="font">
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/cloud-provider-selector.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/translation-selector.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/searchunify/main.css" type="text/css" />

  
  <link rel="index" title="Index" href="../../genindex.html" />
  <link rel="search" title="Search" href="../../search.html" />
  <link rel="top" title="Databricks on AWS" href="../../index.html" /> 
</head>

<body class="wy-body-for-nav" role="document">

  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T85FQ33"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TWTKQQ"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->

  
  <nav class="wy-nav-top header su_header" role="navigation" aria-label="top navigation">
    
<nav class="wy-nav-top header su_header" role="navigation" aria-label="top navigation">
  <div class="container-logo">
    <ul class="mobile-menu-toggle">
        <li class="menu-toggle">
            <i data-toggle="wy-nav-top" class="wy-nav-top-menu-button db-icon db-icon-menu pull-left"></i>
            
            <a href="https://www.databricks.com/" class="wy-nav-top-logo"><img src="../../_static/small-scale-lockup-full-color-rgb.svg" width="137" height="21"
              alt="Databricks" /></a>   
               
              </li>
    </ul>
    <ul class="su_nav-menu">
      <li class="menu-toggle">
        <i data-toggle="wy-nav-top" class="wy-nav-top-menu-button db-icon db-icon-menu pull-left"></i>
        
          
        
        <a href="https://www.databricks.com/" class="wy-nav-top-logo"><img src="../../_static/small-scale-lockup-full-color-rgb.svg" width="137" height="21"
            alt="Databricks" /></a></li>
        <!-- 
<li><a href="https://help.databricks.com/s/">Help Center</a></li>
<li class="active"><a href="https://docs.databricks.com/en/">Documentation</a></li>
<li><a href="https://kb.databricks.com/">Knowledge Base</a></li>
 -->
    </ul>
  </div>
  <div class="su_nav-right">
    <ul class="su_link-mobile">
  <!-- Mobile header code can go here -->
</ul>
<ul class="right-try-list">
   
</ul>
  </div>
</nav>
  </nav>

  <div class="su_sub-header">
    <div class="container">
      <div class="su_sub-header-inner">
        <!-- <div class="su_subnav-menu-right">
  <div id="auto" style="width: 100%;">
    <div ng-controller="SearchautoController">
      <div bind-html-compile="autocompleteHtml">
        <form class="su__search-box-1" disabled="disabled">
          <input class="su__search-input" type="search" name="Search box" id="su__search-b" placeholder="Search Documentation" disabled="disabled"/>
          <button class="su__search-button" type="submit" class="button button-success" disabled="disabled">
            <svg width="24" height="24" viewBox="0 0 24 24">
              <path
                d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"
                fill="#333"></path>
            </svg>
          </button>
        </form>
      </div>
    </div>
  </div>
</div> -->
        <div class="search-lng-gap"></div>
        <div style="margin-left: 16px; margin-right: 16px;">
          <!-- <select name="lng selector" id="lng-selector">
    <option value="../../../en/query/formats/csv.html" class="notranslate">English</option>
    <option value="../../../ja/query/formats/csv.html" class="notranslate">日本語</option>
    <option value="../../../pt/query/formats/csv.html" class="notranslate">Português (Brasil)</option>
</select> -->
        </div>
        <div class="cloud-selector-container">
          <!-- <select name="cloud provider selector" id="cloud-provider-selector">
    <option value="aws" selected class="notranslate">
        Amazon Web Services
    </option>
    <option value="azure"  class="notranslate">
        Microsoft Azure
    </option>
    <option value="gcp"  class="notranslate">
        Google Cloud Platform
    </option>
</select> -->
        </div>
      </div>
    </div>
  </div>
  <page class="js-page-container">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side su_nav-side">
<div class="wy-side-scroll">
  <div class="wy-side-nav-search">
    

    

    

    
  </div>

  <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
    
      <a href="../../index.html" class="main-navigation-home">Databricks on AWS</a>
    

    
      

      
        <p class="caption"><span class="caption-text">Load &amp; manage data</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../rag-temp/index.html">RAG Studio</a></li>
</ul>

      
    
  </div>

  <div role="contentinfo">
    
  <p class="build_info notranslate"data-last-edit="December 23, 2023">
    Updated Jan 11, 2024
  </p>
<script>
  window.addEventListener('DOMContentLoaded',function(){
    var h1=document.querySelector('h1');
    var bi=document.querySelector('[data-last-edit]');
    if(h1 && bi){
      var ver = document.createElement('p');
      ver.className = 'version_info';
      ver.textContent = bi.getAttribute('data-last-edit');
      h1.parentElement.insertBefore(ver, h1.nextElementSibling);
    }
  });
</script>

    <p>
      
        <a id='feedbacklink' href="mailto:doc-feedback@databricks.com?subject=Documentation Feedback">Send us feedback</a>
      
    </p>
  </div>
</div>
</nav>
    
    
<main class="wy-grid-for-nav su_nav-grid">
  <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
    <div class="wy-nav-content su__nav_content">
      <div class="rst-content">
        





<div role="navigation" aria-label="breadcrumbs navigation" class="wy-breadcrumbs-wrapper">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Documentation</a> <span class="db-icon db-icon-chevron-right"></span></li>
    
    
      <li>Read and write to CSV files</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>
</div>
        
        <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
          <div itemprop="articleBody">
            
    
  <div class="section" id="read-and-write-to-csv-files">
<h1>Read and write to CSV files<a class="headerlink" href="#read-and-write-to-csv-files" title="Permalink to this headline"> </a></h1>
<p>This article provides examples for reading and writing to CSV files with Databricks using Python, Scala, R, and SQL.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Databricks recommends the <a class="reference internal" href="../../sql/language-manual/functions/read_files.html"><span class="doc">read_files table-valued function</span></a> for SQL users to read CSV files. <code class="docutils literal notranslate"><span class="pre">read_files</span></code> is available in Databricks Runtime 13.1 and later.</p>
<p>You can also use a temporary view. If you use SQL to read CSV data directly without using temporary views or <code class="docutils literal notranslate"><span class="pre">read_files</span></code>, the following limitations apply:</p>
<ul class="simple">
<li><p>You can’t <a class="reference internal" href="#options"><span class="std std-ref">specify data source options</span></a>.</p>
<ul>
<li><p>You can’t <a class="reference internal" href="#specify-schema"><span class="std std-ref">specify the schema</span></a> for the data.</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="options">
<h2>Options<a class="headerlink" href="#options" title="Permalink to this headline"> </a></h2>
<p>You can configure several options for CSV file data sources. See the following Apache Spark reference articles for supported read and write options.</p>
<ul class="simple">
<li><p>Read</p>
<ul>
<li><p><a class="reference external" href="https://api-docs.databricks.com/python/pyspark/latest/pyspark.sql/api/pyspark.sql.DataFrameReader.csv.html#pyspark.sql.DataFrameReader.csv">Python</a></p></li>
<li><p><a class="reference external" href="https://api-docs.databricks.com/scala/spark/latest/org/apache/spark/sql/DataFrameReader.html#csv(path:String):Unit">Scala</a></p></li>
</ul>
</li>
<li><p>Write</p>
<ul>
<li><p><a class="reference external" href="https://api-docs.databricks.com/python/pyspark/latest/pyspark.sql/api/pyspark.sql.DataFrameWriter.csv.html#pyspark.sql.DataFrameWriter.csv">Python</a></p></li>
<li><p><a class="reference external" href="https://api-docs.databricks.com/scala/spark/latest/org/apache/spark/sql/DataFrameWriter.html#csv(path:String):Unit">Scala</a></p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="work-with-malformed-csv-records">
<span id="corrupt-records"></span><h2>Work with malformed CSV records<a class="headerlink" href="#work-with-malformed-csv-records" title="Permalink to this headline"> </a></h2>
<p>When reading CSV files with a specified schema, it is possible that the data in the files does not match the schema. For example, a field containing name of the city will not parse as an integer. The consequences depend on the mode that the parser runs in:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">PERMISSIVE</span></code> (default): nulls are inserted for fields that could not be parsed correctly</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">DROPMALFORMED</span></code>: drops lines that contain fields that could not be parsed</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">FAILFAST</span></code>: aborts the reading if any malformed data is found</p></li>
</ul>
<p>To set the mode, use the <code class="docutils literal notranslate"><span class="pre">mode</span></code> option.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">diamonds_df</span> <span class="o">=</span> <span class="p">(</span><span class="n">spark</span><span class="o">.</span><span class="n">read</span>
  <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;csv&quot;</span><span class="p">)</span>
  <span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">&quot;mode&quot;</span><span class="p">,</span> <span class="s2">&quot;PERMISSIVE&quot;</span><span class="p">)</span>
  <span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;/databricks-datasets/Rdatasets/data-001/csv/ggplot2/diamonds.csv&quot;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
<p>In the <code class="docutils literal notranslate"><span class="pre">PERMISSIVE</span></code> mode it is possible to inspect the rows that could not be parsed correctly using one of the following methods:</p>
<ul class="simple">
<li><p>You can provide a custom path to the option <code class="docutils literal notranslate"><span class="pre">badRecordsPath</span></code> to record corrupt records to a file.</p></li>
<li><p>You can add the column <code class="docutils literal notranslate"><span class="pre">_corrupt_record</span></code> to the schema provided to the DataFrameReader to review corrupt records in the resultant DataFrame.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">badRecordsPath</span></code> option takes precedence over <code class="docutils literal notranslate"><span class="pre">_corrupt_record</span></code>, meaning that malformed rows written to the provided path do not appear in the resultant DataFrame.</p>
<p>Default behavior for malformed records changes when using the <a class="reference internal" href="#rescued-data"><span class="std std-ref">rescued data column</span></a>.</p>
</div>
<div class="embedded-notebook-section section" id="find-malformed-rows-notebook">
<span id="read-csv-corrupt-record"></span><h3>Find malformed rows notebook<a class="headerlink" href="#find-malformed-rows-notebook" title="Permalink to this headline"> </a></h3>
<div class="embedded-notebook">
    <p class="notebook-import-help">
        <a href="/_extras/notebooks/source/read-csv-corrupt-record.html"            target="_blank">Open notebook in new tab</a>
        <button class="embedded-notebook-copy-to-clipboard"                copy-path-to-clipboard-on-click="/_extras/notebooks/source/read-csv-corrupt-record.html">            <img src="/_static/clippy.svg"                alt="Copy to clipboard">            Copy link for import        </button>    <div class="embedded-notebook-container">        <div class="loading-spinner"></div>        <iframe data-src="/_extras/notebooks/source/read-csv-corrupt-record.html"            id="1efda76fe2fd7a74882de4623bf33ad33dd1aa048590da252db60c3cec95724d" height="1000px" width="100%"            style="overflow-y:hidden;" scrolling="no"></iframe>    </div></div></div>
</div>
<div class="section" id="rescued-data-column">
<span id="rescued-data"></span><h2>Rescued data column<a class="headerlink" href="#rescued-data-column" title="Permalink to this headline"> </a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This feature is supported in <a class="reference internal" href="../../archive/runtime-release-notes/8.3.html"><span class="doc">Databricks Runtime 8.3 (unsupported)</span></a> and above.</p>
</div>
<p>When using the <code class="docutils literal notranslate"><span class="pre">PERMISSIVE</span></code> mode, you can enable the rescued data column to capture any data that wasn’t parsed because one or more fields in a record have one of the following issues:</p>
<ul class="simple">
<li><p>Absent from the provided schema.</p></li>
<li><p>Does not match the data type of the provided schema.</p></li>
<li><p>Has a case mismatch with the field names in the provided schema.</p></li>
</ul>
<p>The rescued data column is returned as a JSON document containing the columns that were rescued, and the source file path of the record. To remove the source file path from the rescued data column, you can set the SQL configuration <code class="docutils literal notranslate"><span class="pre">spark.conf.set(&quot;spark.databricks.sql.rescuedDataColumn.filePath.enabled&quot;,</span> <span class="pre">&quot;false&quot;)</span></code>. You can enable the rescued data column by setting the option <code class="docutils literal notranslate"><span class="pre">rescuedDataColumn</span></code> to a column name when reading data, such as <code class="docutils literal notranslate"><span class="pre">_rescued_data</span></code> with <code class="docutils literal notranslate"><span class="pre">spark.read.option(&quot;rescuedDataColumn&quot;,</span> <span class="pre">&quot;_rescued_data&quot;).format(&quot;csv&quot;).load(&lt;path&gt;)</span></code>.</p>
<p>The CSV parser supports three modes when parsing records: <code class="docutils literal notranslate"><span class="pre">PERMISSIVE</span></code>, <code class="docutils literal notranslate"><span class="pre">DROPMALFORMED</span></code>, and <code class="docutils literal notranslate"><span class="pre">FAILFAST</span></code>. When used together with <code class="docutils literal notranslate"><span class="pre">rescuedDataColumn</span></code>, data type mismatches do not cause records to be dropped in <code class="docutils literal notranslate"><span class="pre">DROPMALFORMED</span></code> mode or throw an error in <code class="docutils literal notranslate"><span class="pre">FAILFAST</span></code> mode. Only corrupt records—that is, incomplete or malformed CSV—are dropped or throw errors.</p>
<p>When <code class="docutils literal notranslate"><span class="pre">rescuedDataColumn</span></code> is used in <code class="docutils literal notranslate"><span class="pre">PERMISSIVE</span></code> mode, the following rules apply to <a class="reference internal" href="#corrupt-records"><span class="std std-ref">corrupt records</span></a>:</p>
<ul class="simple">
<li><p>The first row of the file (either a header row or a data row) sets the expected row length.</p></li>
<li><p>A row with a different number of columns is considered incomplete.</p></li>
<li><p>Data type mismatches are not considered corrupt records.</p></li>
<li><p>Only incomplete and malformed CSV records are considered corrupt and recorded to the <code class="docutils literal notranslate"><span class="pre">_corrupt_record</span></code> column or <code class="docutils literal notranslate"><span class="pre">badRecordsPath</span></code>.</p></li>
</ul>
</div>
<div class="section" id="sql-example-read-csv-file">
<h2>SQL example: Read CSV file<a class="headerlink" href="#sql-example-read-csv-file" title="Permalink to this headline"> </a></h2>
<p>The following SQL example reads a CSV file using <code class="docutils literal notranslate"><span class="pre">read_files</span></code>.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="c1">-- mode &quot;FAILFAST&quot; aborts file parsing with a RuntimeException if malformed lines are encountered</span>
<span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">read_files</span><span class="p">(</span>
<span class="w">  </span><span class="s1">&#39;s3://&lt;bucket&gt;/&lt;path&gt;/&lt;file&gt;.csv&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="n">format</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">&#39;csv&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="n">header</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="k">true</span><span class="p">,</span>
<span class="w">  </span><span class="k">mode</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">&#39;FAILFAST&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="scala-r-and-python-examples-read-csv-file">
<h2>Scala, R, and Python examples: Read CSV file<a class="headerlink" href="#scala-r-and-python-examples-read-csv-file" title="Permalink to this headline"> </a></h2>
<p>The following notebook shows how to read a file, display sample data, and print the data schema using Scala, R, and Python. The examples in this section use the <a class="reference internal" href="../../discover/databricks-datasets.html"><span class="doc">diamonds dataset</span></a>. Specify the path to the dataset as well as any options that you would like.</p>
<div class="embedded-notebook-section section" id="read-csv-files-notebook">
<span id="read-csv-files"></span><h3>Read CSV files notebook<a class="headerlink" href="#read-csv-files-notebook" title="Permalink to this headline"> </a></h3>
<div class="embedded-notebook">
    <p class="notebook-import-help">
        <a href="/_extras/notebooks/source/read-csv-files.html"            target="_blank">Open notebook in new tab</a>
        <button class="embedded-notebook-copy-to-clipboard"                copy-path-to-clipboard-on-click="/_extras/notebooks/source/read-csv-files.html">            <img src="/_static/clippy.svg"                alt="Copy to clipboard">            Copy link for import        </button>    <div class="embedded-notebook-container">        <div class="loading-spinner"></div>        <iframe data-src="/_extras/notebooks/source/read-csv-files.html"            id="189b34f14e13c465af9b1ecd2916914970a1cedafc209bc49ab2cda9bb2dc54e" height="1000px" width="100%"            style="overflow-y:hidden;" scrolling="no"></iframe>    </div></div></div>
</div>
<div class="section" id="example-specify-schema">
<span id="specify-schema"></span><h2>Example: Specify schema<a class="headerlink" href="#example-specify-schema" title="Permalink to this headline"> </a></h2>
<p>When the schema of the CSV file is known, you can specify the desired schema to the CSV reader with the <code class="docutils literal notranslate"><span class="pre">schema</span></code> option.</p>
<div class="embedded-notebook-section section" id="read-csv-files-with-schema-notebook">
<span id="read-csv-schema"></span><h3>Read CSV files with schema notebook<a class="headerlink" href="#read-csv-files-with-schema-notebook" title="Permalink to this headline"> </a></h3>
<div class="embedded-notebook">
    <p class="notebook-import-help">
        <a href="/_extras/notebooks/source/read-csv-schema.html"            target="_blank">Open notebook in new tab</a>
        <button class="embedded-notebook-copy-to-clipboard"                copy-path-to-clipboard-on-click="/_extras/notebooks/source/read-csv-schema.html">            <img src="/_static/clippy.svg"                alt="Copy to clipboard">            Copy link for import        </button>    <div class="embedded-notebook-container">        <div class="loading-spinner"></div>        <iframe data-src="/_extras/notebooks/source/read-csv-schema.html"            id="1a25a56c4095c1e18681196e2f7d93c428fc063ba0c9d06b8d4409ac3f87befd" height="1000px" width="100%"            style="overflow-y:hidden;" scrolling="no"></iframe>    </div></div></div>
<p>SQL example using <code class="docutils literal notranslate"><span class="pre">read_files</span></code>:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">read_files</span><span class="p">(</span>
<span class="w">  </span><span class="s1">&#39;s3://&lt;bucket&gt;/&lt;path&gt;/&lt;file&gt;.csv&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="n">format</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">&#39;csv&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="n">header</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="k">false</span><span class="p">,</span>
<span class="w">  </span><span class="k">schema</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">&#39;id string, date date, event_time timestamp&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="example-pitfalls-of-reading-a-subset-of-columns">
<h2>Example: Pitfalls of reading a subset of columns<a class="headerlink" href="#example-pitfalls-of-reading-a-subset-of-columns" title="Permalink to this headline"> </a></h2>
<p>The behavior of the CSV parser depends on the set of columns that are read. If the specified schema is incorrect, the results might differ considerably depending on the subset of columns that is accessed. The following notebook presents the most common pitfalls.</p>
<div class="embedded-notebook-section section" id="caveats-of-reading-a-subset-of-columns-of-a-csv-file-notebook">
<span id="read-csv-column-subset"></span><h3>Caveats of reading a subset of columns of a CSV file notebook<a class="headerlink" href="#caveats-of-reading-a-subset-of-columns-of-a-csv-file-notebook" title="Permalink to this headline"> </a></h3>
<div class="embedded-notebook">
    <p class="notebook-import-help">
        <a href="/_extras/notebooks/source/read-csv-column-subset.html"            target="_blank">Open notebook in new tab</a>
        <button class="embedded-notebook-copy-to-clipboard"                copy-path-to-clipboard-on-click="/_extras/notebooks/source/read-csv-column-subset.html">            <img src="/_static/clippy.svg"                alt="Copy to clipboard">            Copy link for import        </button>    <div class="embedded-notebook-container">        <div class="loading-spinner"></div>        <iframe data-src="/_extras/notebooks/source/read-csv-column-subset.html"            id="d4eb2660459be98457d5d58c40d80f97586409c80107f5ca790f6f6083ec84c4" height="1000px" width="100%"            style="overflow-y:hidden;" scrolling="no"></iframe>    </div></div></div>
</div>
</div>


    
          </div>
        </div>
        <div  class="suapp-rating">
  <div id="suPageRateApp">
     <su-app></su-app>
   </div> 
 </div>
<hr> 
<footer>
  <div role="contentinfo">
      <p class="copyright">
          &copy; Databricks 2023. All rights reserved. Apache, Apache Spark, Spark, and the Spark logo are trademarks of the <a href="http://www.apache.org/">Apache Software Foundation</a>.
      </p>
      <p> 
        
          <a id='feedbacklink' href="mailto:doc-feedback@databricks.com?subject=Documentation Feedback">Send us feedback</a>
        
     | <a href="https://databricks.com/privacy-policy">Privacy Policy</a> | <a href="https://databricks.com/terms-of-use">Terms of Use</a></p>

  </div> 

</footer>
      </div>
    </div>
  </section>
</main>

  </page>
  
  <script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
      URL_ROOT: '../../',
      VERSION: '1.0',
      COLLAPSE_INDEX: false,
      FILE_SUFFIX: '.html',
      HAS_SOURCE: 'false'
    };
  </script>
  <script type="text/javascript" src="../../_static/jquery.js"></script>
  <script type="text/javascript" src="../../_static/underscore.js"></script>
  <script type="text/javascript" src="../../_static/doctools.js"></script>
  <script type="text/javascript" src="../../_static/language_data.js"></script>
  

  <script type="text/javascript" src="../../_static/js/clipboard.min.js"></script>
  <script type="text/javascript" src="../../_static/js/jquery.waypoints.min.js"></script>

  <!-- Select2 (https://select2.org/) -->
  <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
  <!-- End Select2 -->

  
  
  <script type="text/javascript" src="../../_static/js/localized.js"></script>
  <script type="text/javascript" src="../../_static/js/custom.js"></script>
  

  
  
  <script type="text/javascript">
    jQuery(function () {
      SphinxRtdTheme.StickyNav.enable();
    });

  </script>
  
 



  <script>
  window.__searchunifyLoaderConfig = JSON.parse('{"clients": {"en": "02c2e804-27e9-11ee-aefb-0242ac120011", "ja": "6a42c3f2-2820-11ee-aefb-0242ac120011", "pt": "6a86badd-2821-11ee-aefb-0242ac120011"}}')
</script>
<script type="text/javascript" src="../../_static/js/search-loader.js"></script>
</body>
<script type='text/javascript'>
  window.onload = function () {
    var description = document.querySelector('meta[name="description"]').getAttribute("content");
    let titleText = document.querySelector('h1').textContent;
    document.querySelector('meta[property="og:title"]').setAttribute("content", titleText);
    document.querySelector('meta[property="og:description"]').setAttribute("content", description);
    document.querySelector('meta[property="twitter:description"]').setAttribute("content", description);
  };
</script>

</html>