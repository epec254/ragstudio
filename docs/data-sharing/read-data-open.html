

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en-US" > <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en-US"> <!--<![endif]-->

<head>
  <!-- cookie consent -->
  
    <!-- Combined Onetrust and Rudderstack Implementation Scripts -->
    <!-- Onetrust Initialization -->
    <script type="text/javascript" src="https://cdn.cookielaw.org/consent/92466579-1717-44d3-809d-a05fb02843ed-test/OtAutoBlock.js"></script>
    <script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" data-document-language="true" type="text/javascript" charset="UTF-8" data-domain-script="92466579-1717-44d3-809d-a05fb02843ed-test"></script>
    <link rel="stylesheet" id="db-onetrust-style" href="https://www.databricks.com/wp-content/uploads/db_onetrust.css" media="all" />
    <!-- Setting Rudderstack Write Key -->
    <script>window.rudderstackKey = "2SOR9fvSr5Fi6tN2ihPbVHnX1SZ" </script>
    <!-- Rudderstack Initialization + Onetrust Integration + Rudderstack Custom Events -->
    <script type="text/javascript" src="https://www.databricks.com/sites/default/files/rudderstack/v1/db-rudderstack-events.js"></script>

  <!-- cookie consent -->

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="X-UA-Compatible" content="IE=9" />
  <meta content="Learn how to read data that has been shared with you using the Delta Sharing open sharing protocol, which uses a credential file (token-based security) for access." name="description" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
  <meta property="og:image" content="https://www.databricks.com/wp-content/uploads/2020/04/og-databricks.png">
  <meta property="og:image:type" content="image/png">
  <meta property="og:title" content="Read data shared using Delta Sharing open sharing (for recipients)">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://docs.databricks.com">
  <meta property="og:description" content="" id="og-description">
  <meta name="twitter:image" content="https://www.databricks.com/wp-content/uploads/2020/04/og-databricks.png">
  <meta name="twitter:site" content="@databricks">
  <meta name="twitter:creator" content="@databricks">
  <meta property="twitter:description" content="">
  
  <title>Read data shared using Delta Sharing open sharing (for recipients) &#124; Databricks on AWS</title>
  
  
  <link rel="canonical" href="https://docs.databricks.com/en/data-sharing/read-data-open.html">
  <!-- Start hreflang tag -->
  <link rel="alternate" hreflang="en" href="https://docs.databricks.com/en/data-sharing/read-data-open.html" />
<link rel="alternate" hreflang="x-default" href="https://docs.databricks.com/en/data-sharing/read-data-open.html" />
  <!-- End hreflang tag -->
  
  
  <link rel="shortcut icon" href="../_static/favicon.ico" />
  

  

  

  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;
j.setAttributeNode(d.createAttribute('data-ot-ignore'));
f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-T85FQ33');</script>
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;
j.setAttributeNode(d.createAttribute('data-ot-ignore'));
f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-TWTKQQ');</script>
    
  <!-- End Google Tag Manager -->


  <!-- MaxMind / GEO IP -->
  <script src="//js.maxmind.com/js/apis/geoip2/v2.1/geoip2.js" type="text/javascript"></script>
  <!-- End MaxMind / GEO IP -->

  
  
  <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600&display=swap" rel="stylesheet">
  <link rel="preload" href="../_static/fonts/DMSans-Bold.ttf" as="font">
  <link rel="preload" href="../_static/fonts/DMSans-Regular.ttf" as="font">
  <link rel="preload" href="../_static/fonts/DMMono-Regular.ttf" as="font">
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/cloud-provider-selector.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/translation-selector.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/searchunify/main.css" type="text/css" />

  
  <link rel="index" title="Index" href="../genindex.html" />
  <link rel="search" title="Search" href="../search.html" />
  <link rel="top" title="Databricks on AWS" href="../index.html" /> 
</head>

<body class="wy-body-for-nav" role="document">

  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T85FQ33"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TWTKQQ"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->

  
  <nav class="wy-nav-top header su_header" role="navigation" aria-label="top navigation">
    
<nav class="wy-nav-top header su_header" role="navigation" aria-label="top navigation">
  <div class="container-logo">
    <ul class="mobile-menu-toggle">
        <li class="menu-toggle">
            <i data-toggle="wy-nav-top" class="wy-nav-top-menu-button db-icon db-icon-menu pull-left"></i>
            
            <a href="https://www.databricks.com/" class="wy-nav-top-logo"><img src="../_static/small-scale-lockup-full-color-rgb.svg" width="137" height="21"
              alt="Databricks" /></a>   
               
              </li>
    </ul>
    <ul class="su_nav-menu">
      <li class="menu-toggle">
        <i data-toggle="wy-nav-top" class="wy-nav-top-menu-button db-icon db-icon-menu pull-left"></i>
        
          
        
        <a href="https://www.databricks.com/" class="wy-nav-top-logo"><img src="../_static/small-scale-lockup-full-color-rgb.svg" width="137" height="21"
            alt="Databricks" /></a></li>
        <!-- 
<li><a href="https://help.databricks.com/s/">Help Center</a></li>
<li class="active"><a href="https://docs.databricks.com/en/">Documentation</a></li>
<li><a href="https://kb.databricks.com/">Knowledge Base</a></li>
 -->
    </ul>
  </div>
  <div class="su_nav-right">
    <ul class="su_link-mobile">
  <!-- Mobile header code can go here -->
</ul>
<ul class="right-try-list">
   
</ul>
  </div>
</nav>
  </nav>

  <div class="su_sub-header">
    <div class="container">
      <div class="su_sub-header-inner">
        <!-- <div class="su_subnav-menu-right">
  <div id="auto" style="width: 100%;">
    <div ng-controller="SearchautoController">
      <div bind-html-compile="autocompleteHtml">
        <form class="su__search-box-1" disabled="disabled">
          <input class="su__search-input" type="search" name="Search box" id="su__search-b" placeholder="Search Documentation" disabled="disabled"/>
          <button class="su__search-button" type="submit" class="button button-success" disabled="disabled">
            <svg width="24" height="24" viewBox="0 0 24 24">
              <path
                d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"
                fill="#333"></path>
            </svg>
          </button>
        </form>
      </div>
    </div>
  </div>
</div> -->
        <div class="search-lng-gap"></div>
        <div style="margin-left: 16px; margin-right: 16px;">
          <!-- <select name="lng selector" id="lng-selector">
    <option value="../../en/data-sharing/read-data-open.html" class="notranslate">English</option>
    <option value="../../ja/data-sharing/read-data-open.html" class="notranslate">日本語</option>
    <option value="../../pt/data-sharing/read-data-open.html" class="notranslate">Português (Brasil)</option>
</select> -->
        </div>
        <div class="cloud-selector-container">
          <!-- <select name="cloud provider selector" id="cloud-provider-selector">
    <option value="aws" selected class="notranslate">
        Amazon Web Services
    </option>
    <option value="azure"  class="notranslate">
        Microsoft Azure
    </option>
    <option value="gcp"  class="notranslate">
        Google Cloud Platform
    </option>
</select> -->
        </div>
      </div>
    </div>
  </div>
  <page class="js-page-container">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side su_nav-side">
<div class="wy-side-scroll">
  <div class="wy-side-nav-search">
    

    

    

    
  </div>

  <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
    
      <a href="../index.html" class="main-navigation-home">Databricks on AWS</a>
    

    
      

      
        <p class="caption"><span class="caption-text">Load &amp; manage data</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../rag-temp/index.html">RAG Studio</a></li>
</ul>

      
    
  </div>

  <div role="contentinfo">
    
  <p class="build_info notranslate"data-last-edit="December 23, 2023">
    Updated Jan 11, 2024
  </p>
<script>
  window.addEventListener('DOMContentLoaded',function(){
    var h1=document.querySelector('h1');
    var bi=document.querySelector('[data-last-edit]');
    if(h1 && bi){
      var ver = document.createElement('p');
      ver.className = 'version_info';
      ver.textContent = bi.getAttribute('data-last-edit');
      h1.parentElement.insertBefore(ver, h1.nextElementSibling);
    }
  });
</script>

    <p>
      
        <a id='feedbacklink' href="mailto:doc-feedback@databricks.com?subject=Documentation Feedback">Send us feedback</a>
      
    </p>
  </div>
</div>
</nav>
    
    
<main class="wy-grid-for-nav su_nav-grid">
  <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
    <div class="wy-nav-content su__nav_content">
      <div class="rst-content">
        





<div role="navigation" aria-label="breadcrumbs navigation" class="wy-breadcrumbs-wrapper">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Documentation</a> <span class="db-icon db-icon-chevron-right"></span></li>
    
    
      <li>Read data shared using Delta Sharing open sharing (for recipients)</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>
</div>
        
        <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
          <div itemprop="articleBody">
            
    
  <div class="section" id="read-data-shared-using-delta-sharing-open-sharing-for-recipients">
<span id="read-data-shared-using-ds-open-sharing-for-recipients"></span><h1>Read data shared using Delta Sharing open sharing (for recipients)<a class="headerlink" href="#read-data-shared-using-delta-sharing-open-sharing-for-recipients" title="Permalink to this headline"> </a></h1>
<p>This article describes how to read data that has been shared with you using the Delta Sharing <em>open sharing</em> protocol. In open sharing, you use a credential file that was shared with a member of your team by the data provider to gain secure read access to shared data. Access persists until the provider stops sharing the data with you. Updates to the data are available to you in near real time. You can read and make copies of the shared data, but you can’t modify the source data.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If data has been shared with you using Databricks-to-Databricks Delta Sharing, you don’t need a credential file to access data, and this article doesn’t apply to you. For instructions, see <a class="reference internal" href="read-data-databricks.html"><span class="doc">Read data shared using Databricks-to-Databricks Delta Sharing (for recipients)</span></a>.</p>
</div>
<p>The sections that follow describe how to use Databricks, Apache Spark, pandas, and Power BI to access and read shared data using the credential file.  For a full list of Delta Sharing connectors and information about how to use them, see the <a class="reference external" href="https://delta.io/sharing">Delta Sharing open source documentation</a>. If you run into trouble accessing the shared data, contact the data provider.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Partner integrations are, unless otherwise noted, provided by the third parties and you must have an account with the appropriate provider for the use of their products and services. While Databricks does its best to keep this content up to date, we make no representation regarding the integrations or the accuracy of the content on the partner integration pages. Reach out to the appropriate providers regarding the integrations.</p>
</div>
<div class="section" id="before-you-begin">
<h2>Before you begin<a class="headerlink" href="#before-you-begin" title="Permalink to this headline"> </a></h2>
<p>A member of your team must download the credential file shared by the data provider. See <a class="reference internal" href="recipient.html#get-access-open"><span class="std std-ref">Get access in the open sharing model</span></a>.</p>
<p>They should use a secure channel to share that file or file location with you.</p>
</div>
<div class="section" id="databricks-read-shared-data-using-open-sharing-connectors">
<span id="databricks-open-connectors"></span><h2>Databricks: Read shared data using open sharing connectors<a class="headerlink" href="#databricks-read-shared-data-using-open-sharing-connectors" title="Permalink to this headline"> </a></h2>
<p>This section describes how to use an open sharing connector to access shared data using a notebook in your Databricks workspace. You or another member of your team store the credential file in DBFS, then you use it to authenticate to the data provider’s Databricks account and read the data that the data provider shared with you.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the data provider is using Databricks-to-Databricks sharing and did not share a credential file with you, you must access the data using <a class="reference internal" href="../data-governance/unity-catalog/index.html"><span class="doc">Unity Catalog</span></a>. For instructions, see <a class="reference internal" href="read-data-databricks.html"><span class="doc">Read data shared using Databricks-to-Databricks Delta Sharing (for recipients)</span></a>.</p>
</div>
<p>In this example, you create a notebook with multiple cells that you can run independently. You could instead add the notebook commands to the same cell and run them in sequence.</p>
<div class="section" id="step-1-store-the-credential-file-in-dbfs-python-instructions">
<span id="store-creds"></span><h3>Step 1: Store the credential file in DBFS (Python instructions)<a class="headerlink" href="#step-1-store-the-credential-file-in-dbfs-python-instructions" title="Permalink to this headline"> </a></h3>
<p>In this step, you use a Python notebook in Databricks to store the credential file so that users on your team can access shared data.</p>
<p>Skip to the next step if you or someone on your team has already stored the credential file in DBFS.</p>
<ol class="arabic">
<li><p>In a text editor, open the credential file.</p></li>
<li><p>In your Databricks workspace, click <strong>New &gt; Notebook</strong>.</p>
<ul class="simple">
<li><p>Enter a name.</p></li>
<li><p>Set the default language for the notebook to Python.</p></li>
<li><p>Select a cluster to attach to the notebook.</p></li>
<li><p>Click <strong>Create</strong>.</p></li>
</ul>
<p>The notebook opens in the notebook editor.</p>
</li>
<li><p>To use Python or pandas to access the shared data, install the <a class="reference external" href="https://delta.io/connectors/">delta-sharing Python connector</a>. In the notebook editor, paste the following command:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>%sh pip install delta-sharing
</pre></div>
</div>
</li>
<li><p>Run the cell.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">delta-sharing</span></code> Python library gets installed in the cluster if it isn’t already installed.</p>
</li>
<li><p>In a new cell, paste the following command, which uploads the contents of the credential file to a folder in DBFS. Replace the variables as follows:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;dbfs-path&gt;</span></code>: the path to the folder where you want to save the credential file</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;credential-file-contents&gt;</span></code>: the contents of the credential file. This is not a path to the file, but the copied contents of the file.</p>
<p>The credential file contains JSON that defines three fields: <code class="docutils literal notranslate"><span class="pre">shareCredentialsVersion</span></code>, <code class="docutils literal notranslate"><span class="pre">endpoint</span></code>, and <code class="docutils literal notranslate"><span class="pre">bearerToken</span></code>.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>%scala
dbutils.fs.put(&quot;&lt;dbfs-path&gt;/config.share&quot;,&quot;&quot;&quot;
&lt;credential-file-contents&gt;
&quot;&quot;&quot;)
</pre></div>
</div>
</li>
</ul>
</li>
<li><p>Run the cell.</p>
<p>After the credential file is uploaded, you can delete this cell. All workspace users can read the credential file from DBFS, and the credential file is available in DBFS on all clusters and SQL warehouses in your workspace. To delete the cell, click <strong>x</strong> in the cell actions menu <img alt="Cell actions" src="../_images/cell-actions.png" /> at the far right.</p>
</li>
</ol>
</div>
<div class="section" id="step-2-use-a-notebook-to-list-and-read-shared-tables">
<h3>Step 2: Use a notebook to list and read shared tables<a class="headerlink" href="#step-2-use-a-notebook-to-list-and-read-shared-tables" title="Permalink to this headline"> </a></h3>
<p>In this step, you list the tables in the <em>share</em>, or set of shared tables and partitions, and you query a table.</p>
<ol class="arabic">
<li><p>Using Python, list the tables in the share.</p>
<p>In a new cell, paste the following command. Replace <code class="docutils literal notranslate"><span class="pre">&lt;dbfs-path&gt;</span></code> with the path that was created in <a class="reference internal" href="#store-creds"><span class="std std-ref">Step 1: Store the credential file in DBFS (Python instructions)</span></a>.</p>
<p>When the code runs, Python reads the credential file from DBFS on the cluster. Access data stored in DBFS at the path <code class="docutils literal notranslate"><span class="pre">/dbfs/</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">delta_sharing</span>

<span class="n">client</span> <span class="o">=</span> <span class="n">delta_sharing</span><span class="o">.</span><span class="n">SharingClient</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;/dbfs/&lt;dbfs-path&gt;/config.share&quot;</span><span class="p">)</span>

<span class="n">client</span><span class="o">.</span><span class="n">list_all_tables</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p>Run the cell.</p>
<p>The result is an array of tables, along with metadata for each table. The following output shows two tables:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Out[10]: [Table(name=&#39;example_table&#39;, share=&#39;example_share_0&#39;, schema=&#39;default&#39;), Table(name=&#39;other_example_table&#39;, share=&#39;example_share_0&#39;, schema=&#39;default&#39;)]
</pre></div>
</div>
<p>If the output is empty or doesn’t contain the tables you expect, contact the data provider.</p>
</li>
<li><p>Query a shared table.</p>
<ul>
<li><p><strong>Using Scala</strong>:</p>
<p>In a new cell, paste the following command. When the code runs, the credential file is read from DBFS through the JVM.</p>
<p>Replace the variables as follows:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;profile-path&gt;</span></code>: the DBFS path of the credential file. For example, <code class="docutils literal notranslate"><span class="pre">/&lt;dbfs-path&gt;/config.share</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;share-name&gt;</span></code>: the value of <code class="docutils literal notranslate"><span class="pre">share=</span></code> for the table.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;schema-name&gt;</span></code>: the value of <code class="docutils literal notranslate"><span class="pre">schema=</span></code> for the table.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;table-name&gt;</span></code>: the value of <code class="docutils literal notranslate"><span class="pre">name=</span></code> for the table.</p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>%scala
    spark.read.format(&quot;deltaSharing&quot;)
    .load(&quot;&lt;profile-path&gt;#&lt;share-name&gt;.&lt;schema-name&gt;.&lt;table-name&gt;&quot;).limit(10);
</pre></div>
</div>
<p>Run the cell. Each time you load the shared table, you see fresh data from the source.</p>
</li>
<li><p><strong>Using SQL</strong>:</p>
<p>To query the data using SQL, you create a local table in the workspace from the shared table, then query the local table. The shared data is not stored or cached in the local table. Each time you query the local table, you see the current state of the shared data.</p>
<p>In a new cell, paste the following command.</p>
<p>Replace the variables as follows:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;local-table-name&gt;</span></code>: the name of the local table.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;profile-path&gt;</span></code>: the location of the credential file.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;share-name&gt;</span></code>: the value of <code class="docutils literal notranslate"><span class="pre">share=</span></code> for the table.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;schema-name&gt;</span></code>: the value of <code class="docutils literal notranslate"><span class="pre">schema=</span></code> for the table.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;table-name&gt;</span></code>: the value of <code class="docutils literal notranslate"><span class="pre">name=</span></code> for the table.</p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>%sql
DROP TABLE IF EXISTS table_name;

CREATE TABLE &lt;local-table-name&gt; USING deltaSharing LOCATION &quot;&lt;profile-path&gt;#&lt;share-name&gt;.&lt;schema-name&gt;.&lt;table-name&gt;&quot;;

SELECT * FROM &lt;local-table-name&gt; LIMIT 10;
</pre></div>
</div>
<p>When you run the command, the shared data is queried directly. As a test, the table is queried and the first 10 results are returned.</p>
</li>
</ul>
<p>If the output is empty or doesn’t contain the data you expect, contact the data provider.</p>
</li>
</ol>
</div>
</div>
<div class="section" id="apache-spark-read-shared-data">
<span id="as-read-shared-data"></span><h2>Apache Spark: Read shared data<a class="headerlink" href="#apache-spark-read-shared-data" title="Permalink to this headline"> </a></h2>
<p>Follow these steps to access shared data using Spark 3.x or above.</p>
<p>These instructions assume that you have access to the credential file that was shared by the data provider. See <a class="reference internal" href="recipient.html#get-access-open"><span class="std std-ref">Get access in the open sharing model</span></a>.</p>
<div class="section" id="install-the-delta-sharing-python-and-spark-connectors">
<span id="install-the-ds-python-and-spark-connectors"></span><h3>Install the Delta Sharing Python and Spark connectors<a class="headerlink" href="#install-the-delta-sharing-python-and-spark-connectors" title="Permalink to this headline"> </a></h3>
<p>To access metadata related to the shared data, such as the list of tables shared with you, do the following. This example uses Python.</p>
<ol class="arabic">
<li><p>Install the <a class="reference external" href="https://delta.io/connectors/">delta-sharing Python connector</a>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>delta-sharing
</pre></div>
</div>
</li>
<li><p>Install the <a class="reference external" href="https://github.com/delta-io/delta-sharing#apache-spark-connector">Apache Spark connector</a>.</p></li>
</ol>
</div>
<div class="section" id="list-shared-tables-using-spark">
<h3>List shared tables using Spark<a class="headerlink" href="#list-shared-tables-using-spark" title="Permalink to this headline"> </a></h3>
<p>List the tables in the share. In the following example, replace <code class="docutils literal notranslate"><span class="pre">&lt;profile-path&gt;</span></code> with the location of the credential file.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">delta_sharing</span>

<span class="n">client</span> <span class="o">=</span> <span class="n">delta_sharing</span><span class="o">.</span><span class="n">SharingClient</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&lt;profile-path&gt;/config.share&quot;</span><span class="p">)</span>

<span class="n">client</span><span class="o">.</span><span class="n">list_all_tables</span><span class="p">()</span>
</pre></div>
</div>
<p>The result is an array of tables, along with metadata for each table. The following output shows two tables:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Out[10]: [Table(name=&#39;example_table&#39;, share=&#39;example_share_0&#39;, schema=&#39;default&#39;), Table(name=&#39;other_example_table&#39;, share=&#39;example_share_0&#39;, schema=&#39;default&#39;)]</span>
</pre></div>
</div>
<p>If the output is empty or doesn’t contain the tables you expect, contact the data provider.</p>
<p></p>
</div>
<div class="section" id="access-shared-data-using-spark">
<h3>Access shared data using Spark<a class="headerlink" href="#access-shared-data-using-spark" title="Permalink to this headline"> </a></h3>
<p>Run the following, replacing these variables:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;profile-path&gt;</span></code>: the location of the credential file.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;share-name&gt;</span></code>: the value of <code class="docutils literal notranslate"><span class="pre">share=</span></code> for the table.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;schema-name&gt;</span></code>: the value of <code class="docutils literal notranslate"><span class="pre">schema=</span></code> for the table.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;table-name&gt;</span></code>: the value of <code class="docutils literal notranslate"><span class="pre">name=</span></code> for the table.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;version-as-of&gt;</span></code>: optional. The version of the table to load the data. Only works if the data provider shares the history of the table. Requires <code class="docutils literal notranslate"><span class="pre">delta-sharing-spark</span></code> 0.5.0 or above.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;timestamp-as-of&gt;</span></code>: optional. Load the data at the version before or at the given timestamp. Only works if the data provider shares the history of the table. Requires <code class="docutils literal notranslate"><span class="pre">delta-sharing-spark</span></code> 0.6.0 or above.</p></li>
</ul>
<div class="js-code-language-tabs compound">
<div class="compound-first compound" lang="Python">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">delta_sharing</span><span class="o">.</span><span class="n">load_as_spark</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&lt;profile-path&gt;#&lt;share-name&gt;.&lt;schema-name&gt;.&lt;table-name&gt;&quot;</span><span class="p">,</span> <span class="n">version</span><span class="o">=&lt;</span><span class="n">version</span><span class="o">-</span><span class="k">as</span><span class="o">-</span><span class="n">of</span><span class="o">&gt;</span><span class="p">)</span>

<span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;deltaSharing&quot;</span><span class="p">)</span>\
<span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">&quot;versionAsOf&quot;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">version</span><span class="o">-</span><span class="k">as</span><span class="o">-</span><span class="n">of</span><span class="o">&gt;</span><span class="p">)</span>\
<span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;&lt;profile-path&gt;#&lt;share-name&gt;.&lt;schema-name&gt;.&lt;table-name&gt;&quot;</span><span class="p">)</span>\
<span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>

<span class="n">delta_sharing</span><span class="o">.</span><span class="n">load_as_spark</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&lt;profile-path&gt;#&lt;share-name&gt;.&lt;schema-name&gt;.&lt;table-name&gt;&quot;</span><span class="p">,</span> <span class="n">timestamp</span><span class="o">=&lt;</span><span class="n">timestamp</span><span class="o">-</span><span class="k">as</span><span class="o">-</span><span class="n">of</span><span class="o">&gt;</span><span class="p">)</span>

<span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;deltaSharing&quot;</span><span class="p">)</span>\
<span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">&quot;timestampAsOf&quot;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">timestamp</span><span class="o">-</span><span class="k">as</span><span class="o">-</span><span class="n">of</span><span class="o">&gt;</span><span class="p">)</span>\
<span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;&lt;profile-path&gt;#&lt;share-name&gt;.&lt;schema-name&gt;.&lt;table-name&gt;&quot;</span><span class="p">)</span>\
<span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="compound-last compound" lang="Scala">
<p class="compound-first">Run the following, replacing these variables:</p>
<ul class="compound-middle simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;profile-path&gt;</span></code>: the location of the credential file.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;share-name&gt;</span></code>: the value of <code class="docutils literal notranslate"><span class="pre">share=</span></code> for the table.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;schema-name&gt;</span></code>: the value of <code class="docutils literal notranslate"><span class="pre">schema=</span></code> for the table.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;table-name&gt;</span></code>: the value of <code class="docutils literal notranslate"><span class="pre">name=</span></code> for the table.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;version-as-of&gt;</span></code>: optional. The version of the table to load the data. Only works if the data provider shares the history of the table. Requires <code class="docutils literal notranslate"><span class="pre">delta-sharing-spark</span></code> 0.5.0 or above.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;timestamp-as-of&gt;</span></code>: optional. Load the data at the version before or at the given timestamp. Only works if the data provider shares the history of the table. Requires <code class="docutils literal notranslate"><span class="pre">delta-sharing-spark</span></code> 0.6.0 or above.</p></li>
</ul>
<div class="compound-last highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">spark</span><span class="p">.</span><span class="n">read</span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;deltaSharing&quot;</span><span class="p">)</span>
<span class="p">.</span><span class="n">option</span><span class="p">(</span><span class="s">&quot;versionAsOf&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&lt;</span><span class="n">version</span><span class="o">-</span><span class="n">as</span><span class="o">-</span><span class="n">of</span><span class="o">&gt;</span><span class="p">)</span>
<span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">&quot;&lt;profile-path&gt;#&lt;share-name&gt;.&lt;schema-name&gt;.&lt;table-name&gt;&quot;</span><span class="p">)</span>
<span class="p">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

<span class="n">spark</span><span class="p">.</span><span class="n">read</span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;deltaSharing&quot;</span><span class="p">)</span>
<span class="p">.</span><span class="n">option</span><span class="p">(</span><span class="s">&quot;timestampAsOf&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&lt;</span><span class="n">version</span><span class="o">-</span><span class="n">as</span><span class="o">-</span><span class="n">of</span><span class="o">&gt;</span><span class="p">)</span>
<span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">&quot;&lt;profile-path&gt;#&lt;share-name&gt;.&lt;schema-name&gt;.&lt;table-name&gt;&quot;</span><span class="p">)</span>
<span class="p">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="access-shared-change-data-feed-using-spark">
<h3>Access shared change data feed using Spark<a class="headerlink" href="#access-shared-change-data-feed-using-spark" title="Permalink to this headline"> </a></h3>
<p>If the table history has been shared with you and change data feed (CDF) is enabled on the source table, you can access the change data feed by running the following, replacing these variables. Requires <code class="docutils literal notranslate"><span class="pre">delta-sharing-spark</span></code> 0.5.0 or above.</p>
<p>One and only one start parameter must be provided.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;profile-path&gt;</span></code>: the location of the credential file.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;share-name&gt;</span></code>: the value of <code class="docutils literal notranslate"><span class="pre">share=</span></code> for the table.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;schema-name&gt;</span></code>: the value of <code class="docutils literal notranslate"><span class="pre">schema=</span></code> for the table.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;table-name&gt;</span></code>: the value of <code class="docutils literal notranslate"><span class="pre">name=</span></code> for the table.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;starting-version&gt;</span></code>: optional. The starting version of the query, inclusive. Specify as a Long.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;ending-version&gt;</span></code>: optional. The ending version of the query, inclusive. If the ending version is not provided, the API uses the latest table version.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;starting-timestamp&gt;</span></code>: optional. The starting timestamp of the query, this is converted to a version created greater or equal to this timestamp. Specify as a string in the format <code class="docutils literal notranslate"><span class="pre">yyyy-mm-dd</span> <span class="pre">hh:mm:ss[.fffffffff]</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;ending-timestamp&gt;</span></code>: optional. The ending timestamp of the query, this is converted to a version created earlier or equal to this timestamp. Specify as a string in the format <code class="docutils literal notranslate"><span class="pre">yyyy-mm-dd</span> <span class="pre">hh:mm:ss[.fffffffff]</span></code></p></li>
</ul>
<div class="js-code-language-tabs js-code-language-tabs--literal compound">
<div class="compound-first highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">delta_sharing</span><span class="o">.</span><span class="n">load_table_changes_as_spark</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&lt;profile-path&gt;#&lt;share-name&gt;.&lt;schema-name&gt;.&lt;table-name&gt;&quot;</span><span class="p">,</span>
  <span class="n">starting_version</span><span class="o">=&lt;</span><span class="n">starting</span><span class="o">-</span><span class="n">version</span><span class="o">&gt;</span><span class="p">,</span>
  <span class="n">ending_version</span><span class="o">=&lt;</span><span class="n">ending</span><span class="o">-</span><span class="n">version</span><span class="o">&gt;</span><span class="p">)</span>

<span class="n">delta_sharing</span><span class="o">.</span><span class="n">load_table_changes_as_spark</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&lt;profile-path&gt;#&lt;share-name&gt;.&lt;schema-name&gt;.&lt;table-name&gt;&quot;</span><span class="p">,</span>
  <span class="n">starting_timestamp</span><span class="o">=&lt;</span><span class="n">starting</span><span class="o">-</span><span class="n">timestamp</span><span class="o">&gt;</span><span class="p">,</span>
  <span class="n">ending_timestamp</span><span class="o">=&lt;</span><span class="n">ending</span><span class="o">-</span><span class="n">timestamp</span><span class="o">&gt;</span><span class="p">)</span>

<span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;deltaSharing&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">&quot;readChangeFeed&quot;</span><span class="p">,</span> <span class="s2">&quot;true&quot;</span><span class="p">)</span>\
<span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">&quot;statingVersion&quot;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">starting</span><span class="o">-</span><span class="n">version</span><span class="o">&gt;</span><span class="p">)</span>\
<span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">&quot;endingVersion&quot;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">ending</span><span class="o">-</span><span class="n">version</span><span class="o">&gt;</span><span class="p">)</span>\
<span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;&lt;profile-path&gt;#&lt;share-name&gt;.&lt;schema-name&gt;.&lt;table-name&gt;&quot;</span><span class="p">)</span>

<span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;deltaSharing&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">&quot;readChangeFeed&quot;</span><span class="p">,</span> <span class="s2">&quot;true&quot;</span><span class="p">)</span>\
<span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">&quot;startingTimestamp&quot;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">starting</span><span class="o">-</span><span class="n">timestamp</span><span class="o">&gt;</span><span class="p">)</span>\
<span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">&quot;endingTimestamp&quot;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">ending</span><span class="o">-</span><span class="n">timestamp</span><span class="o">&gt;</span><span class="p">)</span>\
<span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;&lt;profile-path&gt;#&lt;share-name&gt;.&lt;schema-name&gt;.&lt;table-name&gt;&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="compound-last highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">spark</span><span class="p">.</span><span class="n">read</span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;deltaSharing&quot;</span><span class="p">).</span><span class="n">option</span><span class="p">(</span><span class="s">&quot;readChangeFeed&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;true&quot;</span><span class="p">)</span>
<span class="p">.</span><span class="n">option</span><span class="p">(</span><span class="s">&quot;statingVersion&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&lt;</span><span class="n">starting</span><span class="o">-</span><span class="n">version</span><span class="o">&gt;</span><span class="p">)</span>
<span class="p">.</span><span class="n">option</span><span class="p">(</span><span class="s">&quot;endingVersion&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&lt;</span><span class="n">ending</span><span class="o">-</span><span class="n">version</span><span class="o">&gt;</span><span class="p">)</span>
<span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">&quot;&lt;profile-path&gt;#&lt;share-name&gt;.&lt;schema-name&gt;.&lt;table-name&gt;&quot;</span><span class="p">)</span>

<span class="n">spark</span><span class="p">.</span><span class="n">read</span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;deltaSharing&quot;</span><span class="p">).</span><span class="n">option</span><span class="p">(</span><span class="s">&quot;readChangeFeed&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;true&quot;</span><span class="p">)</span>
<span class="p">.</span><span class="n">option</span><span class="p">(</span><span class="s">&quot;startingTimestamp&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&lt;</span><span class="n">starting</span><span class="o">-</span><span class="n">timestamp</span><span class="o">&gt;</span><span class="p">)</span>
<span class="p">.</span><span class="n">option</span><span class="p">(</span><span class="s">&quot;endingTimestamp&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&lt;</span><span class="n">ending</span><span class="o">-</span><span class="n">timestamp</span><span class="o">&gt;</span><span class="p">)</span>
<span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">&quot;&lt;profile-path&gt;#&lt;share-name&gt;.&lt;schema-name&gt;.&lt;table-name&gt;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>If the output is empty or doesn’t contain the data you expect, contact the data provider.</p>
</div>
<div class="section" id="access-a-shared-table-using-spark-structured-streaming">
<span id="streaming-source"></span><h3>Access a shared table using Spark Structured Streaming<a class="headerlink" href="#access-a-shared-table-using-spark-structured-streaming" title="Permalink to this headline"> </a></h3>
<p>If the table history is shared with you, you can stream read the shared data. Requires <code class="docutils literal notranslate"><span class="pre">delta-sharing-spark</span></code> 0.6.0 or above.</p>
<p>Supported options:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ignoreDeletes</span></code>: Ignore transactions that delete data.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ignoreChanges</span></code>: Re-process updates if files were rewritten in the source table due to a data changing operation such as <code class="docutils literal notranslate"><span class="pre">UPDATE</span></code>, <code class="docutils literal notranslate"><span class="pre">MERGE</span> <span class="pre">INTO</span></code>, <code class="docutils literal notranslate"><span class="pre">DELETE</span></code> (within partitions), or <code class="docutils literal notranslate"><span class="pre">OVERWRITE</span></code>. Unchanged rows can still be emitted. Therefore your downstream consumers should be able to handle duplicates. Deletes are not propagated downstream. <code class="docutils literal notranslate"><span class="pre">ignoreChanges</span></code> subsumes <code class="docutils literal notranslate"><span class="pre">ignoreDeletes</span></code>. Therefore if you use <code class="docutils literal notranslate"><span class="pre">ignoreChanges</span></code>, your stream will not be disrupted by either deletions or updates to the source table.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">startingVersion</span></code>: The shared table version to start from. All table changes starting from this version (inclusive) will be read by the streaming source.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">startingTimestamp</span></code>: The timestamp to start from. All table changes committed at or after the timestamp (inclusive) will be read by the streaming source. Example: <code class="docutils literal notranslate"><span class="pre">&quot;2023-01-01</span> <span class="pre">00:00:00.0&quot;</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">maxFilesPerTrigger</span></code>: The number of new files to be considered in every micro-batch.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">maxBytesPerTrigger</span></code>: The amount of data that gets processed in each micro-batch. This option sets a “soft max”, meaning that a batch processes approximately this amount of data and may process more than the limit in order to make the streaming query move forward in cases when the smallest input unit is larger than this limit.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">readChangeFeed</span></code>: Stream read the change data feed of the shared table.</p></li>
</ul>
<p>Unsupported options:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Trigger.availableNow</span></code></p></li>
</ul>
<div class="section" id="sample-structured-streaming-queries">
<h4>Sample Structured Streaming queries<a class="headerlink" href="#sample-structured-streaming-queries" title="Permalink to this headline"> </a></h4>
<div class="js-code-language-tabs js-code-language-tabs--literal compound">
<div class="compound-first highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">spark</span><span class="p">.</span><span class="n">readStream</span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;deltaSharing&quot;</span><span class="p">)</span>
<span class="p">.</span><span class="n">option</span><span class="p">(</span><span class="s">&quot;startingVersion&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="p">.</span><span class="n">option</span><span class="p">(</span><span class="s">&quot;ignoreChanges&quot;</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">)</span>
<span class="p">.</span><span class="n">option</span><span class="p">(</span><span class="s">&quot;maxFilesPerTrigger&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">)</span>
<span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">&quot;&lt;profile-path&gt;#&lt;share-name&gt;.&lt;schema-name&gt;.&lt;table-name&gt;&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="compound-last highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">spark</span><span class="o">.</span><span class="n">readStream</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;deltaSharing&quot;</span><span class="p">)</span>\
<span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">&quot;startingVersion&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>\
<span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">&quot;ignoreDeletes&quot;</span><span class="p">,</span> <span class="n">true</span><span class="p">)</span>\
<span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">&quot;maxBytesPerTrigger&quot;</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>\
<span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;&lt;profile-path&gt;#&lt;share-name&gt;.&lt;schema-name&gt;.&lt;table-name&gt;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>See also <a class="reference internal" href="../structured-streaming/index.html"><span class="doc">Streaming on Databricks</span></a>.</p>
</div>
</div>
</div>
<div class="section" id="pandas-read-shared-data">
<h2>Pandas: Read shared data<a class="headerlink" href="#pandas-read-shared-data" title="Permalink to this headline"> </a></h2>
<p>Follow these steps to access shared data in pandas 0.25.3 or above.</p>
<p>These instructions assume that you have access to the credential file that was shared by the data provider. See <a class="reference internal" href="recipient.html#get-access-open"><span class="std std-ref">Get access in the open sharing model</span></a>.</p>
<div class="section" id="install-the-delta-sharing-python-connector">
<span id="install-the-ds-python-connector"></span><h3>Install the Delta Sharing Python connector<a class="headerlink" href="#install-the-delta-sharing-python-connector" title="Permalink to this headline"> </a></h3>
<p>To access metadata related to the shared data, such as the list of tables shared with you, you must install the <a class="reference external" href="https://delta.io/connectors/">delta-sharing Python connector</a>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>delta-sharing
</pre></div>
</div>
</div>
<div class="section" id="list-shared-tables-using-pandas">
<h3>List shared tables using pandas<a class="headerlink" href="#list-shared-tables-using-pandas" title="Permalink to this headline"> </a></h3>
<p>To list the tables in the share, run the following, replacing <code class="docutils literal notranslate"><span class="pre">&lt;profile-path&gt;/config.share</span></code> with the location of the credential file.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">delta_sharing</span>

<span class="n">client</span> <span class="o">=</span> <span class="n">delta_sharing</span><span class="o">.</span><span class="n">SharingClient</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&lt;profile-path&gt;/config.share&quot;</span><span class="p">)</span>

<span class="n">client</span><span class="o">.</span><span class="n">list_all_tables</span><span class="p">()</span>
</pre></div>
</div>
<p>If the output is empty or doesn’t contain the tables you expect, contact the data provider.</p>
</div>
<div class="section" id="access-shared-data-using-pandas">
<h3>Access shared data using pandas<a class="headerlink" href="#access-shared-data-using-pandas" title="Permalink to this headline"> </a></h3>
<p>To access shared data in pandas using Python, run the following, replacing the variables as follows:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;profile-path&gt;</span></code>: the location of the credential file.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;share-name&gt;</span></code>: the value of <code class="docutils literal notranslate"><span class="pre">share=</span></code> for the table.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;schema-name&gt;</span></code>: the value of <code class="docutils literal notranslate"><span class="pre">schema=</span></code> for the table.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;table-name&gt;</span></code>: the value of <code class="docutils literal notranslate"><span class="pre">name=</span></code> for the table.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">delta_sharing</span>
<span class="n">delta_sharing</span><span class="o">.</span><span class="n">load_as_pandas</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&lt;profile-path&gt;#&lt;share-name&gt;.&lt;schema-name&gt;.&lt;table-name&gt;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="access-a-shared-change-data-feed-using-pandas">
<h3>Access a shared change data feed using pandas<a class="headerlink" href="#access-a-shared-change-data-feed-using-pandas" title="Permalink to this headline"> </a></h3>
<p></p>
<p>To access the change data feed for a shared table in pandas using Python run the following, replacing the variables as follows. A change data feed may not be available, depending on whether or not the data provider shared the change data feed for the table.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;starting-version&gt;</span></code>: optional. The starting version of the query, inclusive.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;ending-version&gt;</span></code>: optional. The ending version of the query, inclusive.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;starting-timestamp&gt;</span></code>: optional. The starting timestamp of the query. This is converted to a version created greater or equal to this timestamp.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;ending-timestamp&gt;</span></code>: optional. The ending timestamp of the query. This is converted to a version created earlier or equal to this timestamp.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">delta_sharing</span>
<span class="n">delta_sharing</span><span class="o">.</span><span class="n">load_table_changes_as_pandas</span><span class="p">(</span>
  <span class="sa">f</span><span class="s2">&quot;&lt;profile-path&gt;#&lt;share-name&gt;.&lt;schema-name&gt;.&lt;table-name&gt;&quot;</span><span class="p">,</span>
  <span class="n">starting_version</span><span class="o">=&lt;</span><span class="n">starting</span><span class="o">-</span><span class="n">version</span><span class="o">&gt;</span><span class="p">,</span>
  <span class="n">ending_version</span><span class="o">=&lt;</span><span class="n">starting</span><span class="o">-</span><span class="n">version</span><span class="o">&gt;</span><span class="p">)</span>

<span class="n">delta_sharing</span><span class="o">.</span><span class="n">load_table_changes_as_pandas</span><span class="p">(</span>
  <span class="sa">f</span><span class="s2">&quot;&lt;profile-path&gt;#&lt;share-name&gt;.&lt;schema-name&gt;.&lt;table-name&gt;&quot;</span><span class="p">,</span>
  <span class="n">starting_timestamp</span><span class="o">=&lt;</span><span class="n">starting</span><span class="o">-</span><span class="n">timestamp</span><span class="o">&gt;</span><span class="p">,</span>
  <span class="n">ending_timestamp</span><span class="o">=&lt;</span><span class="n">ending</span><span class="o">-</span><span class="n">timestamp</span><span class="o">&gt;</span><span class="p">)</span>
</pre></div>
</div>
<p>If the output is empty or doesn’t contain the data you expect, contact the data provider.</p>
</div>
</div>
<div class="section" id="power-bi-read-shared-data">
<span id="power-bi"></span><h2>Power BI: Read shared data<a class="headerlink" href="#power-bi-read-shared-data" title="Permalink to this headline"> </a></h2>
<p>The Power BI Delta Sharing connector allows you to discover, analyze, and visualize datasets shared with you through the Delta Sharing open protocol.</p>
<div class="section" id="requirements">
<h3>Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline"> </a></h3>
<ul class="simple">
<li><p>Power BI Desktop 2.99.621.0 or above. <a class="reference external" href="https://www.microsoft.com/download/details.aspx?id=58494">Download the latest version</a>.</p></li>
<li><p>Access to the credential file that was shared by the data provider. See <a class="reference internal" href="recipient.html#get-access-open"><span class="std std-ref">Get access in the open sharing model</span></a>.</p></li>
</ul>
</div>
<div class="section" id="connect-to-databricks">
<h3>Connect to Databricks<a class="headerlink" href="#connect-to-databricks" title="Permalink to this headline"> </a></h3>
<p>To connect to Databricks using the Delta Sharing connector, do the following:</p>
<ol class="arabic simple">
<li><p>Open the shared credential file with a text editor to retrieve the endpoint URL and the token.</p></li>
<li><p>Open Power BI Desktop.</p></li>
<li><p>On the <strong>Get Data</strong> menu, search for <strong>Delta Sharing</strong>.</p></li>
<li><p>Select the connector and click <strong>Connect</strong>.</p></li>
<li><p>Enter the endpoint URL that you copied from the credentials file into the <strong>Delta Sharing Server URL</strong> field.</p></li>
<li><p>Optionally, in the <strong>Advanced Options</strong> tab, set a <strong>Row Limit</strong> for the maximum number of rows that you can download. This is set to 1 million rows by default.</p></li>
<li><p>Click <strong>OK</strong>.</p></li>
<li><p>For <strong>Authentication</strong>, copy the token that you retrieved from the credentials file into <strong>Bearer Token</strong>.</p></li>
<li><p>Click <strong>Connect</strong>.</p></li>
</ol>
</div>
<div class="section" id="limitations-of-the-power-bi-delta-sharing-connector">
<h3>Limitations of the Power BI Delta Sharing connector<a class="headerlink" href="#limitations-of-the-power-bi-delta-sharing-connector" title="Permalink to this headline"> </a></h3>
<p>The Power BI Delta Sharing Connector has the following limitations:</p>
<ul class="simple">
<li><p>The data that the connector loads must fit into the memory of your machine. To ensure this, the connector limits the number of imported rows to the <strong>Row Limit</strong> that you set under the Advanced Options tab in Power BI Desktop.</p></li>
</ul>
</div>
</div>
</div>


    
          </div>
        </div>
        <div  class="suapp-rating">
  <div id="suPageRateApp">
     <su-app></su-app>
   </div> 
 </div>
<hr> 
<footer>
  <div role="contentinfo">
      <p class="copyright">
          &copy; Databricks 2023. All rights reserved. Apache, Apache Spark, Spark, and the Spark logo are trademarks of the <a href="http://www.apache.org/">Apache Software Foundation</a>.
      </p>
      <p> 
        
          <a id='feedbacklink' href="mailto:doc-feedback@databricks.com?subject=Documentation Feedback">Send us feedback</a>
        
     | <a href="https://databricks.com/privacy-policy">Privacy Policy</a> | <a href="https://databricks.com/terms-of-use">Terms of Use</a></p>

  </div> 

</footer>
      </div>
    </div>
  </section>
</main>

  </page>
  
  <script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
      URL_ROOT: '../',
      VERSION: '1.0',
      COLLAPSE_INDEX: false,
      FILE_SUFFIX: '.html',
      HAS_SOURCE: 'false'
    };
  </script>
  <script type="text/javascript" src="../_static/jquery.js"></script>
  <script type="text/javascript" src="../_static/underscore.js"></script>
  <script type="text/javascript" src="../_static/doctools.js"></script>
  <script type="text/javascript" src="../_static/language_data.js"></script>
  

  <script type="text/javascript" src="../_static/js/clipboard.min.js"></script>
  <script type="text/javascript" src="../_static/js/jquery.waypoints.min.js"></script>

  <!-- Select2 (https://select2.org/) -->
  <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
  <!-- End Select2 -->

  
  
  <script type="text/javascript" src="../_static/js/localized.js"></script>
  <script type="text/javascript" src="../_static/js/custom.js"></script>
  

  
  
  <script type="text/javascript">
    jQuery(function () {
      SphinxRtdTheme.StickyNav.enable();
    });

  </script>
  
 



  <script>
  window.__searchunifyLoaderConfig = JSON.parse('{"clients": {"en": "02c2e804-27e9-11ee-aefb-0242ac120011", "ja": "6a42c3f2-2820-11ee-aefb-0242ac120011", "pt": "6a86badd-2821-11ee-aefb-0242ac120011"}}')
</script>
<script type="text/javascript" src="../_static/js/search-loader.js"></script>
</body>
<script type='text/javascript'>
  window.onload = function () {
    var description = document.querySelector('meta[name="description"]').getAttribute("content");
    let titleText = document.querySelector('h1').textContent;
    document.querySelector('meta[property="og:title"]').setAttribute("content", titleText);
    document.querySelector('meta[property="og:description"]').setAttribute("content", description);
    document.querySelector('meta[property="twitter:description"]').setAttribute("content", description);
  };
</script>

</html>