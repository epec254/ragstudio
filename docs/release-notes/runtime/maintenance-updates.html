

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en-US" > <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en-US"> <!--<![endif]-->

<head>
  <!-- cookie consent -->
  
    <!-- Combined Onetrust and Rudderstack Implementation Scripts -->
    <!-- Onetrust Initialization -->
    <script type="text/javascript" src="https://cdn.cookielaw.org/consent/92466579-1717-44d3-809d-a05fb02843ed-test/OtAutoBlock.js"></script>
    <script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" data-document-language="true" type="text/javascript" charset="UTF-8" data-domain-script="92466579-1717-44d3-809d-a05fb02843ed-test"></script>
    <link rel="stylesheet" id="db-onetrust-style" href="https://www.databricks.com/wp-content/uploads/db_onetrust.css" media="all" />
    <!-- Setting Rudderstack Write Key -->
    <script>window.rudderstackKey = "2SOR9fvSr5Fi6tN2ihPbVHnX1SZ" </script>
    <!-- Rudderstack Initialization + Onetrust Integration + Rudderstack Custom Events -->
    <script type="text/javascript" src="https://www.databricks.com/sites/default/files/rudderstack/v1/db-rudderstack-events.js"></script>

  <!-- cookie consent -->

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="X-UA-Compatible" content="IE=9" />
  <meta content="Maintenance updates issued for Databricks Runtime releases." name="description" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
  <meta property="og:image" content="https://www.databricks.com/wp-content/uploads/2020/04/og-databricks.png">
  <meta property="og:image:type" content="image/png">
  <meta property="og:title" content="Databricks Runtime maintenance updates">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://docs.databricks.com">
  <meta property="og:description" content="" id="og-description">
  <meta name="twitter:image" content="https://www.databricks.com/wp-content/uploads/2020/04/og-databricks.png">
  <meta name="twitter:site" content="@databricks">
  <meta name="twitter:creator" content="@databricks">
  <meta property="twitter:description" content="">
  
  <title>Databricks Runtime maintenance updates &#124; Databricks on AWS</title>
  
  
  <link rel="canonical" href="https://docs.databricks.com/en/release-notes/runtime/maintenance-updates.html">
  <!-- Start hreflang tag -->
  <link rel="alternate" hreflang="en" href="https://docs.databricks.com/en/release-notes/runtime/maintenance-updates.html" />
<link rel="alternate" hreflang="x-default" href="https://docs.databricks.com/en/release-notes/runtime/maintenance-updates.html" />
  <!-- End hreflang tag -->
  
  
  <link rel="shortcut icon" href="../../_static/favicon.ico" />
  

  

  

  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;
j.setAttributeNode(d.createAttribute('data-ot-ignore'));
f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-T85FQ33');</script>
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;
j.setAttributeNode(d.createAttribute('data-ot-ignore'));
f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-TWTKQQ');</script>
    
  <!-- End Google Tag Manager -->


  <!-- MaxMind / GEO IP -->
  <script src="//js.maxmind.com/js/apis/geoip2/v2.1/geoip2.js" type="text/javascript"></script>
  <!-- End MaxMind / GEO IP -->

  
  
  <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600&display=swap" rel="stylesheet">
  <link rel="preload" href="../../_static/fonts/DMSans-Bold.ttf" as="font">
  <link rel="preload" href="../../_static/fonts/DMSans-Regular.ttf" as="font">
  <link rel="preload" href="../../_static/fonts/DMMono-Regular.ttf" as="font">
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/cloud-provider-selector.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/translation-selector.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/searchunify/main.css" type="text/css" />

  
  <link rel="index" title="Index" href="../../genindex.html" />
  <link rel="search" title="Search" href="../../search.html" />
  <link rel="top" title="Databricks on AWS" href="../../index.html" /> 
</head>

<body class="wy-body-for-nav" role="document">

  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T85FQ33"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TWTKQQ"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->

  
  <nav class="wy-nav-top header su_header" role="navigation" aria-label="top navigation">
    
<nav class="wy-nav-top header su_header" role="navigation" aria-label="top navigation">
  <div class="container-logo">
    <ul class="mobile-menu-toggle">
        <li class="menu-toggle">
            <i data-toggle="wy-nav-top" class="wy-nav-top-menu-button db-icon db-icon-menu pull-left"></i>
            
            <a href="https://www.databricks.com/" class="wy-nav-top-logo"><img src="../../_static/small-scale-lockup-full-color-rgb.svg" width="137" height="21"
              alt="Databricks" /></a>   
               
              </li>
    </ul>
    <ul class="su_nav-menu">
      <li class="menu-toggle">
        <i data-toggle="wy-nav-top" class="wy-nav-top-menu-button db-icon db-icon-menu pull-left"></i>
        
          
        
        <a href="https://www.databricks.com/" class="wy-nav-top-logo"><img src="../../_static/small-scale-lockup-full-color-rgb.svg" width="137" height="21"
            alt="Databricks" /></a></li>
        <!-- 
<li><a href="https://help.databricks.com/s/">Help Center</a></li>
<li class="active"><a href="https://docs.databricks.com/en/">Documentation</a></li>
<li><a href="https://kb.databricks.com/">Knowledge Base</a></li>
 -->
    </ul>
  </div>
  <div class="su_nav-right">
    <ul class="su_link-mobile">
  <!-- Mobile header code can go here -->
</ul>
<ul class="right-try-list">
   
</ul>
  </div>
</nav>
  </nav>

  <div class="su_sub-header">
    <div class="container">
      <div class="su_sub-header-inner">
        <!-- <div class="su_subnav-menu-right">
  <div id="auto" style="width: 100%;">
    <div ng-controller="SearchautoController">
      <div bind-html-compile="autocompleteHtml">
        <form class="su__search-box-1" disabled="disabled">
          <input class="su__search-input" type="search" name="Search box" id="su__search-b" placeholder="Search Documentation" disabled="disabled"/>
          <button class="su__search-button" type="submit" class="button button-success" disabled="disabled">
            <svg width="24" height="24" viewBox="0 0 24 24">
              <path
                d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"
                fill="#333"></path>
            </svg>
          </button>
        </form>
      </div>
    </div>
  </div>
</div> -->
        <div class="search-lng-gap"></div>
        <div style="margin-left: 16px; margin-right: 16px;">
          <!-- <select name="lng selector" id="lng-selector">
    <option value="../../../en/release-notes/runtime/maintenance-updates.html" class="notranslate">English</option>
    <option value="../../../ja/release-notes/runtime/maintenance-updates.html" class="notranslate">日本語</option>
    <option value="../../../pt/release-notes/runtime/maintenance-updates.html" class="notranslate">Português (Brasil)</option>
</select> -->
        </div>
        <div class="cloud-selector-container">
          <!-- <select name="cloud provider selector" id="cloud-provider-selector">
    <option value="aws" selected class="notranslate">
        Amazon Web Services
    </option>
    <option value="azure"  class="notranslate">
        Microsoft Azure
    </option>
    <option value="gcp"  class="notranslate">
        Google Cloud Platform
    </option>
</select> -->
        </div>
      </div>
    </div>
  </div>
  <page class="js-page-container">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side su_nav-side">
<div class="wy-side-scroll">
  <div class="wy-side-nav-search">
    

    

    

    
  </div>

  <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
    
      <a href="../../index.html" class="main-navigation-home">Databricks on AWS</a>
    

    
      

      
        <p class="caption"><span class="caption-text">Load &amp; manage data</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../rag-temp/index.html">RAG Studio</a></li>
</ul>

      
    
  </div>

  <div role="contentinfo">
    
  <p class="build_info notranslate"data-last-edit="December 23, 2023">
    Updated Jan 11, 2024
  </p>
<script>
  window.addEventListener('DOMContentLoaded',function(){
    var h1=document.querySelector('h1');
    var bi=document.querySelector('[data-last-edit]');
    if(h1 && bi){
      var ver = document.createElement('p');
      ver.className = 'version_info';
      ver.textContent = bi.getAttribute('data-last-edit');
      h1.parentElement.insertBefore(ver, h1.nextElementSibling);
    }
  });
</script>

    <p>
      
        <a id='feedbacklink' href="mailto:doc-feedback@databricks.com?subject=Documentation Feedback">Send us feedback</a>
      
    </p>
  </div>
</div>
</nav>
    
    
<main class="wy-grid-for-nav su_nav-grid">
  <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
    <div class="wy-nav-content su__nav_content">
      <div class="rst-content">
        





<div role="navigation" aria-label="breadcrumbs navigation" class="wy-breadcrumbs-wrapper">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Documentation</a> <span class="db-icon db-icon-chevron-right"></span></li>
    
    
      <li>Databricks Runtime maintenance updates</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>
</div>
        
        <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
          <div itemprop="articleBody">
            
    
  <div class="section" id="databricks-runtime-maintenance-updates">
<span id="dbr-maintenance-updates"></span><h1>Databricks Runtime maintenance updates<a class="headerlink" href="#databricks-runtime-maintenance-updates" title="Permalink to this headline"> </a></h1>
<p>This article lists maintenance updates for supported Databricks Runtime versions. To add a maintenance update to an existing cluster, restart the cluster. For the maintenance updates on unsupported Databricks Runtime versions, see <a class="reference internal" href="../../archive/runtime-release-notes/maintenance-updates-archive.html"><span class="doc">Maintenance updates for Databricks Runtime (archived)</span></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Releases are staged. Your Databricks account might not update for a few days after the initial release date.</p>
</div>
<div class="section" id="databricks-runtime-releases">
<span id="dbr-releases"></span><h2>Databricks Runtime releases<a class="headerlink" href="#databricks-runtime-releases" title="Permalink to this headline"> </a></h2>
<div class="contents local topic" id="maintenance-updates-by-release">
<p class="topic-title first">Maintenance updates by release:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#databricks-runtime-142" id="id1">Databricks Runtime 14.2</a></p></li>
<li><p><a class="reference internal" href="#databricks-runtime-141" id="id2">Databricks Runtime 14.1</a></p></li>
<li><p><a class="reference internal" href="#databricks-runtime-140" id="id3">Databricks Runtime 14.0</a></p></li>
<li><p><a class="reference internal" href="#databricks-runtime-133-lts" id="id4">Databricks Runtime 13.3 LTS</a></p></li>
<li><p><a class="reference internal" href="#databricks-runtime-132" id="id5">Databricks Runtime 13.2</a></p></li>
<li><p><a class="reference internal" href="#databricks-runtime-122-lts" id="id6">Databricks Runtime 12.2 LTS</a></p></li>
<li><p><a class="reference internal" href="#databricks-runtime-113-lts" id="id7">Databricks Runtime 11.3 LTS</a></p></li>
<li><p><a class="reference internal" href="#databricks-runtime-104-lts" id="id8">Databricks Runtime 10.4 LTS</a></p></li>
<li><p><a class="reference internal" href="#databricks-runtime-91-lts" id="id9">Databricks Runtime 9.1 LTS</a></p></li>
</ul>
</div>
<div class="section" id="databricks-runtime-142">
<span id="dbr-142"></span><span id="142"></span><h3><a class="toc-backref" href="#id1">Databricks Runtime 14.2</a><a class="headerlink" href="#databricks-runtime-142" title="Permalink to this headline"> </a></h3>
<p>See <a class="reference internal" href="14.2.html"><span class="doc">Databricks Runtime 14.2</span></a>.</p>
<ul class="simple">
<li><p>November 29, 2023</p>
<ul>
<li><p>Installed a new package, <code class="docutils literal notranslate"><span class="pre">pyarrow-hotfix</span></code> to remediate a PyArrow RCE vulnerability.</p></li>
<li><p>Fixed an issue where escaped underscores in <code class="docutils literal notranslate"><span class="pre">getColumns</span></code> operations originating from JDBC or ODBC clients were wrongly interpreted as wildcards.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45730">[SPARK-45730]</a> Improved time constraints for <code class="docutils literal notranslate"><span class="pre">ReloadingX509TrustManagerSuite</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45852">[SPARK-45852]</a> The Python client for Spark Connect now catches recursion errors during text conversion.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45808">[SPARK-45808]</a> Improved error handling for SQL exceptions.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45920">[SPARK-45920]</a> <code class="docutils literal notranslate"><span class="pre">GROUP</span> <span class="pre">BY</span></code> ordinal is doesn’t replace the ordinal.</p></li>
<li><p>Revert <a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45649">[SPARK-45649]</a>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45733">[SPARK-45733]</a> Added support for multiple retry policies.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45509">[SPARK-45509]</a> Fixed <code class="docutils literal notranslate"><span class="pre">df</span></code> column reference behavior for Spark Connect.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45655">[SPARK-45655]</a> Allow non-deterministic expressions inside <code class="docutils literal notranslate"><span class="pre">AggregateFunctions</span></code> in <code class="docutils literal notranslate"><span class="pre">CollectMetrics</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45905">[SPARK-45905]</a> The least common type between decimal types now retain integral digits first.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45136">[SPARK-45136]</a> Enhance <code class="docutils literal notranslate"><span class="pre">ClosureCleaner</span></code> with Ammonite support.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45859">[SPARK-45859]</a> Made UDF objects in <code class="docutils literal notranslate"><span class="pre">ml.functions</span></code> lazy.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-46028">[SPARK-46028]</a> <code class="docutils literal notranslate"><span class="pre">Column.__getitem__</span></code> accepts input columns.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45798">[SPARK-45798]</a> Assert server-side session ID.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45892">[SPARK-45892]</a> Refactor optimizer plan validation to decouple <code class="docutils literal notranslate"><span class="pre">validateSchemaOutput</span></code> and <code class="docutils literal notranslate"><span class="pre">validateExprIdUniqueness</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45844">[SPARK-45844]</a> Implement case-insensitivity for XML.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45770">[SPARK-45770]</a> Fixed column resolution with <code class="docutils literal notranslate"><span class="pre">DataFrameDropColumns</span></code> for <code class="docutils literal notranslate"><span class="pre">Dataframe.drop</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44790">[SPARK-44790]</a> Added <code class="docutils literal notranslate"><span class="pre">to_xml</span></code> implementation and bindings for Python, Spark Connect, and SQL.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45851">[SPARK-45851]</a> Added support for multiple policies in the Scala client.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="databricks-runtime-141">
<span id="dbr-141"></span><span id="141"></span><h3><a class="toc-backref" href="#id2">Databricks Runtime 14.1</a><a class="headerlink" href="#databricks-runtime-141" title="Permalink to this headline"> </a></h3>
<p>See <a class="reference internal" href="14.1.html"><span class="doc">Databricks Runtime 14.1</span></a>.</p>
<ul class="simple">
<li><p>November 29, 2023</p>
<ul>
<li><p>Installed a new package, <code class="docutils literal notranslate"><span class="pre">pyarrow-hotfix</span></code> to remediate a PyArrow RCE vulnerability.</p></li>
<li><p>Fixed an issue where escaped underscores in <code class="docutils literal notranslate"><span class="pre">getColumns</span></code> operations originating from JDBC or ODBC clients were wrongly interpreted as wildcards.</p></li>
<li><p>When ingesting CSV data using Auto Loader or Streaming Tables, large CSV files are now splittable and can be processed in parallel during both schema inference and data processing.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45892">[SPARK-45892]</a> Refactor optimizer plan validation to decouple <code class="docutils literal notranslate"><span class="pre">validateSchemaOutput</span></code> and <code class="docutils literal notranslate"><span class="pre">validateExprIdUniqueness</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45620">[SPARK-45620]</a> APIs related to Python UDF now use camelCase.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44790">[SPARK-44790]</a> Added <code class="docutils literal notranslate"><span class="pre">to_xml</span></code> implementation and bindings for Python, Spark Connect, and SQL.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45770">[SPARK-45770]</a> Fixed column resolution with <code class="docutils literal notranslate"><span class="pre">DataFrameDropColumns</span></code> for <code class="docutils literal notranslate"><span class="pre">Dataframe.drop</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45859">[SPARK-45859]</a> Made UDF objects in <code class="docutils literal notranslate"><span class="pre">ml.functions</span></code> lazy.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45730">[SPARK-45730]</a> Improved time constraints for <code class="docutils literal notranslate"><span class="pre">ReloadingX509TrustManagerSuite</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44784">[SPARK-44784]</a> Made SBT testing hermetic.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>November 10, 2023</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45545">[SPARK-45545]</a> <code class="docutils literal notranslate"><span class="pre">SparkTransportConf</span></code> inherits <code class="docutils literal notranslate"><span class="pre">SSLOptions</span></code> upon creation.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45250">[SPARK-45250]</a> Added support for stage-level task resource profile for yarn clusters when dynamic allocation is turned off.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44753">[SPARK-44753]</a> Added XML DataFrame reader and writer for PySpark SQL.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45396">[SPARK-45396]</a> Added a doc entry for <code class="docutils literal notranslate"><span class="pre">PySpark.ml.connect</span></code> module.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45584">[SPARK-45584]</a> Fixed subquery run failure with <code class="docutils literal notranslate"><span class="pre">TakeOrderedAndProjectExec</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45541">[SPARK-45541]</a> Added SSLFactory.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45577">[SPARK-45577]</a> Fixed <code class="docutils literal notranslate"><span class="pre">UserDefinedPythonTableFunctionAnalyzeRunner</span></code> to pass folded values from named arguments.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45562">[SPARK-45562]</a> Made ‘rowTag’ a required option.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45427">[SPARK-45427]</a> Added RPC SSL settings to <code class="docutils literal notranslate"><span class="pre">SSLOptions</span></code> and <code class="docutils literal notranslate"><span class="pre">SparkTransportConf</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43380">[SPARK-43380]</a> Fixed slowdown in Avro read.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45430">[SPARK-45430]</a> <code class="docutils literal notranslate"><span class="pre">FramelessOffsetWindowFunction</span></code> no longer fails when <code class="docutils literal notranslate"><span class="pre">IGNORE</span> <span class="pre">NULLS</span></code> and <code class="docutils literal notranslate"><span class="pre">offset</span> <span class="pre">&gt;</span> <span class="pre">rowCount</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45429">[SPARK-45429]</a> Added helper classes for SSL RPC communication.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45386">[SPARK-45386]</a> Fixed an issue where <code class="docutils literal notranslate"><span class="pre">StorageLevel.NONE</span></code> would incorrectly return 0.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44219">[SPARK-44219]</a> Added per-rule validation checks for optimization rewrites.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45543">[SPARK-45543]</a> Fixed an issue where <code class="docutils literal notranslate"><span class="pre">InferWindowGroupLimit</span></code> caused an issue if the other window functions didn’t have the same window frame as the rank-like functions.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>September 27, 2023</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44823">[SPARK-44823]</a> Updated <code class="docutils literal notranslate"><span class="pre">black</span></code> to 23.9.1 and fixed erroneous check.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45339">[SPARK-45339]</a> PySpark now logs errors it retries.</p></li>
<li><p>Revert <a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42946">[SPARK-42946]</a> Redacted sensitive data nested under variable substitutions.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44551">[SPARK-44551]</a> Edited comments to sync with OSS.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45360">[SPARK-45360]</a> Spark session builder supports initialization from <code class="docutils literal notranslate"><span class="pre">SPARK_REMOTE</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45279">[SPARK-45279]</a> Attached <code class="docutils literal notranslate"><span class="pre">plan_id</span></code> to all logical plans.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45425">[SPARK-45425]</a> Mapped <code class="docutils literal notranslate"><span class="pre">TINYINT</span></code> to <code class="docutils literal notranslate"><span class="pre">ShortType</span></code> for <code class="docutils literal notranslate"><span class="pre">MsSqlServerDialect</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45419">[SPARK-45419]</a> Removed file version map entry of larger versions to avoid reusing <code class="docutils literal notranslate"><span class="pre">rocksdb</span></code> sst file IDs.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45488">[SPARK-45488]</a> Added support for value in <code class="docutils literal notranslate"><span class="pre">rowTag</span></code> element.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42205">[SPARK-42205]</a> Removed logging of <code class="docutils literal notranslate"><span class="pre">Accumulables</span></code> in <code class="docutils literal notranslate"><span class="pre">Task/Stage</span></code> start events in <code class="docutils literal notranslate"><span class="pre">JsonProtocol</span></code> event logs.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45426">[SPARK-45426]</a> Added support for <code class="docutils literal notranslate"><span class="pre">ReloadingX509TrustManager</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45256">[SPARK-45256]</a> <code class="docutils literal notranslate"><span class="pre">DurationWriter</span></code> fails when writing more values than the initial capacity.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43380">[SPARK-43380]</a> Fixed <code class="docutils literal notranslate"><span class="pre">Avro</span></code> data type conversion issues without causing performance regression.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45182">[SPARK-45182]</a> Added support for rolling back shuffle map stage so all stage tasks can be retried when the stage output is indeterminate.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45399">[SPARK-45399]</a> Added XML Options using <code class="docutils literal notranslate"><span class="pre">newOption</span></code>.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="databricks-runtime-140">
<span id="dbr-140"></span><span id="140"></span><h3><a class="toc-backref" href="#id3">Databricks Runtime 14.0</a><a class="headerlink" href="#databricks-runtime-140" title="Permalink to this headline"> </a></h3>
<p>See <a class="reference internal" href="14.0.html"><span class="doc">Databricks Runtime 14.0</span></a>.</p>
<ul class="simple">
<li><p>November 29, 2023</p>
<ul>
<li><p>Installed a new package, <code class="docutils literal notranslate"><span class="pre">pyarrow-hotfix</span></code> to remediate a PyArrow RCE vulnerability.</p></li>
<li><p>Fixed an issue where escaped underscores in <code class="docutils literal notranslate"><span class="pre">getColumns</span></code> operations originating from JDBC or ODBC clients were wrongly interpreted as wildcards.</p></li>
<li><p>When ingesting CSV data using Auto Loader or Streaming Tables, large CSV files are now splittable and can be processed in parallel during both schema inference and data processing.</p></li>
<li><p>Spark-snowflake connector is upgraded to 2.12.0.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45859">[SPARK-45859]</a> Made UDF objects in <code class="docutils literal notranslate"><span class="pre">ml.functions</span></code> lazy.</p></li>
<li><p>Revert <a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45592">[SPARK-45592]</a>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45892">[SPARK-45892]</a> Refactor optimizer plan validation to decouple <code class="docutils literal notranslate"><span class="pre">validateSchemaOutput</span></code> and <code class="docutils literal notranslate"><span class="pre">validateExprIdUniqueness</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45592">[SPARK-45592]</a> Fixed correctness issue in AQE with <code class="docutils literal notranslate"><span class="pre">InMemoryTableScanExec</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45620">[SPARK-45620]</a> APIs related to Python UDF now use camelCase.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44784">[SPARK-44784]</a> Made SBT testing hermetic.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45770">[SPARK-45770]</a> Fixed column resolution with <code class="docutils literal notranslate"><span class="pre">DataFrameDropColumns</span></code> for <code class="docutils literal notranslate"><span class="pre">Dataframe.drop</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45544">[SPARK-45544]</a> Integrated SSL support into <code class="docutils literal notranslate"><span class="pre">TransportContext</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45730">[SPARK-45730]</a> Improved time constraints for <code class="docutils literal notranslate"><span class="pre">ReloadingX509TrustManagerSuite</span></code>.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>November 10, 2023</p>
<ul>
<li><p>Changed data feed queries on Unity Catalog Streaming Tables and Materialized Views to display error messages.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45545">[SPARK-45545]</a> <code class="docutils literal notranslate"><span class="pre">SparkTransportConf</span></code> inherits <code class="docutils literal notranslate"><span class="pre">SSLOptions</span></code> upon creation.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45584">[SPARK-45584]</a> Fixed subquery run failure with <code class="docutils literal notranslate"><span class="pre">TakeOrderedAndProjectExec</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45427">[SPARK-45427]</a> Added RPC SSL settings to <code class="docutils literal notranslate"><span class="pre">SSLOptions</span></code> and <code class="docutils literal notranslate"><span class="pre">SparkTransportConf</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45541">[SPARK-45541]</a> Added <code class="docutils literal notranslate"><span class="pre">SSLFactory</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45430">[SPARK-45430]</a> <code class="docutils literal notranslate"><span class="pre">FramelessOffsetWindowFunction</span></code> no longer fails when <code class="docutils literal notranslate"><span class="pre">IGNORE</span> <span class="pre">NULLS</span></code> and <code class="docutils literal notranslate"><span class="pre">offset</span> <span class="pre">&gt;</span> <span class="pre">rowCount</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45429">[SPARK-45429]</a> Added helper classes for SSL RPC communication.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44219">[SPARK-44219]</a> Added extra per-rule validations for optimization rewrites.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45543">[SPARK-45543]</a> Fixed an issue where <code class="docutils literal notranslate"><span class="pre">InferWindowGroupLimit</span></code> generated an error if the other window functions haven’t the same window frame as the rank-like functions.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>October 23, 2023</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45426">[SPARK-45426]</a> Added support for <code class="docutils literal notranslate"><span class="pre">ReloadingX509TrustManager</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45396">[SPARK-45396]</a> Added doc entry for <code class="docutils literal notranslate"><span class="pre">PySpark.ml.connect</span></code> module, and added <code class="docutils literal notranslate"><span class="pre">Evaluator</span></code> to <code class="docutils literal notranslate"><span class="pre">__all__</span></code> at <code class="docutils literal notranslate"><span class="pre">ml.connect</span></code></p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45256">[SPARK-45256]</a> Fixed an issue where <code class="docutils literal notranslate"><span class="pre">DurationWriter</span></code> failed when writing more values than initial capacity.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45279">[SPARK-45279]</a> Attached <code class="docutils literal notranslate"><span class="pre">plan_id</span></code> to all logical plans.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45250">[SPARK-45250]</a> Added support for stage-level task resource profile for yarn clusters when dynamic allocation is turned off.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45182">[SPARK-45182]</a> Added support for rolling back shuffle map stage so all stage tasks can be retried when the stage output is indeterminate.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45419">[SPARK-45419]</a> Avoid reusing <code class="docutils literal notranslate"><span class="pre">rocksdb</span> <span class="pre">sst</span></code> files in a different <code class="docutils literal notranslate"><span class="pre">rocksdb</span></code> instance by removing file version map entries of larger versions.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45386">[SPARK-45386]</a> Fixed an issue where <code class="docutils literal notranslate"><span class="pre">StorageLevel.NONE</span></code> would incorrectly return 0.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>October 13, 2023</p>
<ul>
<li><p>Snowflake-jdbc dependency upgraded from 3.13.29 to 3.13.33.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">array_insert</span></code> function is 1-based for positive and negative indexes, while before, it was 0-based for negative indexes. It now inserts a new element at the end of input arrays for the index -1. To restore the previous behavior, set <code class="docutils literal notranslate"><span class="pre">spark.sql.legacy.negativeIndexInArrayInsert</span></code> to <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p></li>
<li><p>Databricks no longer ignores corrupt files when a CSV schema inference with Auto Loader has enabled <code class="docutils literal notranslate"><span class="pre">ignoreCorruptFiles</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45227">[SPARK-45227]</a> Fixed a subtle thread-safety issue with <code class="docutils literal notranslate"><span class="pre">CoarseGrainedExecutorBackend</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44658">[SPARK-44658]</a> <code class="docutils literal notranslate"><span class="pre">ShuffleStatus.getMapStatus</span></code> should return <code class="docutils literal notranslate"><span class="pre">None</span></code> instead of <code class="docutils literal notranslate"><span class="pre">Some(null)</span></code></p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44910">[SPARK-44910]</a> <code class="docutils literal notranslate"><span class="pre">Encoders.bean</span></code> does not support superclasses with generic type arguments.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45346">[SPARK-45346]</a> Parquet schema inference respects case-sensitive flags when merging schema.</p></li>
<li><p>Revert <a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42946">[SPARK-42946]</a>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42205">[SPARK-42205]</a> Updated the JSON protocol to remove Accumulables logging in a task or stage start events.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45360">[SPARK-45360]</a> Spark session builder supports initialization from <code class="docutils literal notranslate"><span class="pre">SPARK_REMOTE</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45316">[SPARK-45316]</a> Add new parameters <code class="docutils literal notranslate"><span class="pre">ignoreCorruptFiles</span></code>/<code class="docutils literal notranslate"><span class="pre">ignoreMissingFiles</span></code> to <code class="docutils literal notranslate"><span class="pre">HadoopRDD</span></code> and <code class="docutils literal notranslate"><span class="pre">NewHadoopRDD</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44909">[SPARK-44909]</a> Skip running the torch distributor log streaming server when it is not available.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45084">[SPARK-45084]</a> <code class="docutils literal notranslate"><span class="pre">StateOperatorProgress</span></code> now uses accurate shuffle partition number.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45371">[SPARK-45371]</a> Fixed shading issues in the Spark Connect Scala Client.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45178">[SPARK-45178]</a> Fallback to running a single batch for <code class="docutils literal notranslate"><span class="pre">Trigger.AvailableNow</span></code> with unsupported sources rather than using the wrapper.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44840">[SPARK-44840]</a> Make <code class="docutils literal notranslate"><span class="pre">array_insert()</span></code> 1-based for negative indexes.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44551">[SPARK-44551]</a> Edited comments to sync with OSS.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45078">[SPARK-45078]</a> The <code class="docutils literal notranslate"><span class="pre">ArrayInsert</span></code> function now makes explicit casting when the element type does not equal the derived component type.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45339">[SPARK-45339]</a> PySpark now logs retry errors.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45057">[SPARK-45057]</a> Avoid acquiring read lock when <code class="docutils literal notranslate"><span class="pre">keepReadLock</span></code> is false.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44908">[SPARK-44908]</a> Fixed cross-validator <code class="docutils literal notranslate"><span class="pre">foldCol</span></code> param functionality.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="databricks-runtime-133-lts">
<span id="dbr-133-lts"></span><span id="133"></span><h3><a class="toc-backref" href="#id4">Databricks Runtime 13.3 LTS</a><a class="headerlink" href="#databricks-runtime-133-lts" title="Permalink to this headline"> </a></h3>
<p>See <a class="reference internal" href="13.3lts.html"><span class="doc">Databricks Runtime 13.3 LTS</span></a>.</p>
<ul class="simple">
<li><p>November 29, 2023</p>
<ul>
<li><p>Installed a new package, <code class="docutils literal notranslate"><span class="pre">pyarrow-hotfix</span></code> to remediate a PyArrow RCE vulnerability.</p></li>
<li><p>Spark-snowflake connector is upgraded to 2.12.0.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44846">[SPARK-44846]</a> Removed complex grouping expressions after <code class="docutils literal notranslate"><span class="pre">RemoveRedundantAggregates</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45544">[SPARK-45544]</a> Integrated SSL support into <code class="docutils literal notranslate"><span class="pre">TransportContext</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45892">[SPARK-45892]</a> Refactor optimizer plan validation to decouple <code class="docutils literal notranslate"><span class="pre">validateSchemaOutput</span></code> and <code class="docutils literal notranslate"><span class="pre">validateExprIdUniqueness</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45730">[SPARK-45730]</a> Improved time constraints for <code class="docutils literal notranslate"><span class="pre">ReloadingX509TrustManagerSuite</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45859">[SPARK-45859]</a> Made UDF objects in <code class="docutils literal notranslate"><span class="pre">ml.functions</span></code> lazy.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>November 10, 2023</p>
<ul>
<li><p>Partition filters on Delta Lake streaming queries are pushed down before rate limiting to achieve better utilization.</p></li>
<li><p>Changed data feed queries on Unity Catalog Streaming Tables and Materialized Views to display error messages.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45545">[SPARK-45545]</a> <code class="docutils literal notranslate"><span class="pre">SparkTransportConf</span></code> inherits <code class="docutils literal notranslate"><span class="pre">SSLOptions</span></code> upon creation.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45584">[SPARK-45584]</a> Fixed subquery run failure with <code class="docutils literal notranslate"><span class="pre">TakeOrderedAndProjectExec</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45427">[SPARK-45427]</a> Added RPC SSL settings to <code class="docutils literal notranslate"><span class="pre">SSLOptions</span></code> and <code class="docutils literal notranslate"><span class="pre">SparkTransportConf</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45541">[SPARK-45541]</a> Added <code class="docutils literal notranslate"><span class="pre">SSLFactory</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45430">[SPARK-45430]</a> <code class="docutils literal notranslate"><span class="pre">FramelessOffsetWindowFunction</span></code> no longer fails when <code class="docutils literal notranslate"><span class="pre">IGNORE</span> <span class="pre">NULLS</span></code> and <code class="docutils literal notranslate"><span class="pre">offset</span> <span class="pre">&gt;</span> <span class="pre">rowCount</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45429">[SPARK-45429]</a> Added helper classes for SSL RPC communication.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44219">[SPARK-44219]</a> Added extra per-rule validations for optimization rewrites.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45543">[SPARK-45543]</a> Fixed an issue where <code class="docutils literal notranslate"><span class="pre">InferWindowGroupLimit</span></code> caused an issue if the other window functions didn’t have the same window frame as the rank-like functions.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>October 23, 2023</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45256">[SPARK-45256]</a> Fixed an issue where <code class="docutils literal notranslate"><span class="pre">DurationWriter</span></code> failed when writing more values than initial capacity.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45419">[SPARK-45419]</a> Avoid reusing <code class="docutils literal notranslate"><span class="pre">rocksdb</span> <span class="pre">sst</span></code> files in a different <code class="docutils literal notranslate"><span class="pre">rocksdb</span></code> instance by removing file version map entries of larger versions.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45426">[SPARK-45426]</a> Added support for <code class="docutils literal notranslate"><span class="pre">ReloadingX509TrustManager</span></code>.</p></li>
<li><p>Miscellaneous fixes.</p></li>
</ul>
</li>
<li><p>October 13, 2023</p>
<ul>
<li><p>Snowflake-jdbc dependency upgraded from 3.13.29 to 3.13.33.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">array_insert</span></code> function is 1-based for positive and negative indexes, while before, it was 0-based for negative indexes. It now inserts a new element at the end of input arrays for the index -1. To restore the previous behavior, set <code class="docutils literal notranslate"><span class="pre">spark.sql.legacy.negativeIndexInArrayInsert</span></code> to <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p></li>
<li><p>Fixed an issue around not ignoring corrupt files when <code class="docutils literal notranslate"><span class="pre">ignoreCorruptFiles</span></code> is enabled during CSV schema inference with Auto Loader.</p></li>
<li><p>Revert <a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42946">[SPARK-42946]</a>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42205">[SPARK-42205]</a> Updated the JSON protocol to remove Accumulables logging in a task or stage start events.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45178">[SPARK-45178]</a> Fallback to running a single batch for <code class="docutils literal notranslate"><span class="pre">Trigger.AvailableNow</span></code> with unsupported sources rather than using the wrapper.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45316">[SPARK-45316]</a> Add new parameters <code class="docutils literal notranslate"><span class="pre">ignoreCorruptFiles</span></code> and <code class="docutils literal notranslate"><span class="pre">ignoreMissingFiles</span></code> to <code class="docutils literal notranslate"><span class="pre">HadoopRDD</span></code> and <code class="docutils literal notranslate"><span class="pre">NewHadoopRDD</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44740">[SPARK-44740]</a>[FOLLOW] Fixed metadata values for Artifacts.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45360">[SPARK-45360]</a> Initialized Spark session builder configuration from <code class="docutils literal notranslate"><span class="pre">SPARK_REMOTE</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44551">[SPARK-44551]</a> Edited comments to sync with OSS.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45346">[SPARK-45346]</a> Parquet schema inference now respects case-sensitive flags when merging schema.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44658">[SPARK-44658]</a> <code class="docutils literal notranslate"><span class="pre">ShuffleStatus.getMapStatus</span></code> now returns <code class="docutils literal notranslate"><span class="pre">None</span></code> instead of <code class="docutils literal notranslate"><span class="pre">Some(null)</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44840">[SPARK-44840]</a> Made <code class="docutils literal notranslate"><span class="pre">array_insert()</span></code> 1-based for negative indexes.</p></li>
</ul>
</li>
<li><p>September 14, 2023</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44873">[SPARK-44873]</a> Added support for <code class="docutils literal notranslate"><span class="pre">alter</span> <span class="pre">view</span></code> with nested columns in Hive client.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44878">[SPARK-44878]</a> Turned off strict limit for <code class="docutils literal notranslate"><span class="pre">RocksDB</span></code> write manager to avoid insertion exception on cache complete.</p></li>
</ul>
</li>
<li><p>August 30, 2023</p>
<ul>
<li><p>The dbutils <code class="docutils literal notranslate"><span class="pre">cp</span></code> command (<code class="docutils literal notranslate"><span class="pre">dbutils.fs.cp</span></code>) has been optimized for faster copying. With this improvement, copy operations can take up to 100 less time, depending on the file size. The feature is available across all Clouds and file systems accessible in Databricks, including for Unity Catalog Volumes and DBFS mounts.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44455">[SPARK-44455]</a> Quote identifiers with backticks in the <code class="docutils literal notranslate"><span class="pre">SHOW</span> <span class="pre">CREATE</span> <span class="pre">TABLE</span></code> result.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44763">[SPARK-44763]</a> Fixed an issue that showed a string as a double in binary arithmetic with interval.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44871">[SPARK-44871]</a> Fixed <code class="docutils literal notranslate"><span class="pre">percentile_disc</span></code> behavior.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44714">[SPARK-44714]</a> Ease restriction of LCA resolution regarding queries.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44818">[SPARK-44818]</a> Fixed race for pending task interrupt issued before <code class="docutils literal notranslate"><span class="pre">taskThread</span></code> is initialized.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44505">[SPARK-44505]</a> Added override for columnar support in Scan for DSv2.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44479">[SPARK-44479]</a> Fixed protobuf conversion from an empty struct type.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44718">[SPARK-44718]</a> Match <code class="docutils literal notranslate"><span class="pre">ColumnVector</span></code> memory-mode config default to <code class="docutils literal notranslate"><span class="pre">OffHeapMemoryMode</span></code> config value.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42941">[SPARK-42941]</a> Added support for <code class="docutils literal notranslate"><span class="pre">StreamingQueryListener</span></code> in Python.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44558">[SPARK-44558]</a> Export PySpark’s Spark Connect Log Level.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44464">[SPARK-44464]</a> Fixed <code class="docutils literal notranslate"><span class="pre">applyInPandasWithStatePythonRunner</span></code> to output rows that have Null as the first column value.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44643">[SPARK-44643]</a> Fixed <code class="docutils literal notranslate"><span class="pre">Row.__repr__</span></code> when the field is an empty row.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="databricks-runtime-132">
<span id="dbr-132"></span><span id="132"></span><h3><a class="toc-backref" href="#id5">Databricks Runtime 13.2</a><a class="headerlink" href="#databricks-runtime-132" title="Permalink to this headline"> </a></h3>
<p>See <a class="reference internal" href="13.2.html"><span class="doc">Databricks Runtime 13.2</span></a>.</p>
<ul class="simple">
<li><p>November 29, 2023</p>
<ul>
<li><p>Installed a new package, <code class="docutils literal notranslate"><span class="pre">pyarrow-hotfix</span></code> to remediate a PyArrow RCE vulnerability.</p></li>
<li><p>Fixed an issue where escaped underscores in <code class="docutils literal notranslate"><span class="pre">getColumns</span></code> operations originating from JDBC or ODBC clients were wrongly interpreted as wildcards.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44846">[SPARK-44846]</a> Removed complex grouping expressions after <code class="docutils literal notranslate"><span class="pre">RemoveRedundantAggregates</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43802">[SPARK-43802]</a> Fixed an issue where codegen for unhex and unbase64 expressions would fail.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>November 14, 2023</p>
<ul>
<li><p>Partition filters on Delta Lake streaming queries are pushed down before rate limiting to achieve better utilization.</p></li>
<li><p>Changed data feed queries on Unity Catalog Streaming Tables and Materialized Views to display error messages.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45584">[SPARK-45584]</a> Fixed subquery run failure with <code class="docutils literal notranslate"><span class="pre">TakeOrderedAndProjectExec</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45430">[SPARK-45430]</a> <code class="docutils literal notranslate"><span class="pre">FramelessOffsetWindowFunction</span></code> no longer fails when <code class="docutils literal notranslate"><span class="pre">IGNORE</span> <span class="pre">NULLS</span></code> and <code class="docutils literal notranslate"><span class="pre">offset</span> <span class="pre">&gt;</span> <span class="pre">rowCount</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45543">[SPARK-45543]</a> Fixed an issue where <code class="docutils literal notranslate"><span class="pre">InferWindowGroupLimit</span></code> caused an issue if the other window functions didn’t have the same window frame as the rank-like functions.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>October 24, 2023</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45346">[SPARK-45346]</a> Parquet schema inference now respects case-sensitive flag when merging a schema.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45256">[SPARK-45256]</a> <code class="docutils literal notranslate"><span class="pre">DurationWriter</span></code> now fails when writing more values than initial capacity.</p></li>
<li><p>Revert <a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42946">[SPARK-42946]</a>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45419">[SPARK-45419]</a> Avoid reusing <code class="docutils literal notranslate"><span class="pre">rocksdb</span> <span class="pre">sst</span></code> files in a different <code class="docutils literal notranslate"><span class="pre">rocksdb</span></code> instance by removing file version map entry of larger versions.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>October 13, 2023</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">Snowflake-jdbc</span></code> dependency upgraded from 3.13.29 to 3.13.33.</p></li>
<li><p>No longer ignoring corrupt files when <code class="docutils literal notranslate"><span class="pre">ignoreCorruptFiles</span></code> is enabled during CSV schema inference with Auto Loader.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44658">[SPARK-44658]</a> <code class="docutils literal notranslate"><span class="pre">ShuffleStatus.getMapStatus</span></code> returns <code class="docutils literal notranslate"><span class="pre">None</span></code> instead of <code class="docutils literal notranslate"><span class="pre">Some(null)</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42205">[SPARK-42205]</a> Updated the JSON protocol to remove Accumulables logging in a task or stage start events.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45178">[SPARK-45178]</a> Fallback to running a single batch for <code class="docutils literal notranslate"><span class="pre">Trigger.AvailableNow</span></code> with unsupported sources rather than using the wrapper.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>September 9, 2023</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44873">[SPARK-44873]</a> Added support for <code class="docutils literal notranslate"><span class="pre">alter</span> <span class="pre">view</span></code> with nested columns in the Hive client.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44878">[SPARK-44878]</a> Turned off strict limit for <code class="docutils literal notranslate"><span class="pre">RocksDB</span></code> write manager to avoid insertion exception on cache complete.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44718">[SPARK-44718]</a> Match <code class="docutils literal notranslate"><span class="pre">ColumnVector</span></code> memory-mode config default to <code class="docutils literal notranslate"><span class="pre">OffHeapMemoryMode</span></code> config value.</p></li>
<li><p>Miscellaneous fixes.</p></li>
</ul>
</li>
<li><p>August 30, 2023</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44871">[SPARK-44871]</a> Fixed <code class="docutils literal notranslate"><span class="pre">percentile_disc</span></code> behavior.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44485">[SPARK-44485]</a> Optimized <code class="docutils literal notranslate"><span class="pre">TreeNode.generateTreeString</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44818">[SPARK-44818]</a> Fixed race for pending task interrupt issued before <code class="docutils literal notranslate"><span class="pre">taskThread</span></code> is initialized.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44245">[SPARK-44245]</a> <code class="docutils literal notranslate"><span class="pre">PySpark.sql.dataframe</span> <span class="pre">sample()</span></code> doctests are now illustrative-only.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44714">[SPARK-44714]</a> Ease restriction of LCA resolution regarding queries.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>August 15, 2023</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44410">[SPARK-44410]</a> Backport to 13.2: Set active session in <code class="docutils literal notranslate"><span class="pre">create</span></code> and <code class="docutils literal notranslate"><span class="pre">getOrCreate</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44643">[SPARK-44643]</a> Fixed <code class="docutils literal notranslate"><span class="pre">Row.__repr__</span></code> when the row is empty.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44479">[SPARK-44479]</a> Fixed <code class="docutils literal notranslate"><span class="pre">protobuf</span></code> conversion from an empty struct type.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44455">[SPARK-44455]</a> <code class="docutils literal notranslate"><span class="pre">SHOW</span> <span class="pre">CREATE</span> <span class="pre">TABLE</span></code> now quotes identifiers with special characters.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44504">[SPARK-44504]</a> Maintenance task now cleans up loaded providers on stop error.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44464">[SPARK-44464]</a> Fixed <code class="docutils literal notranslate"><span class="pre">applyInPandasWithStatePythonRunner</span></code> to output rows that have <code class="docutils literal notranslate"><span class="pre">Null</span></code> as the first column value.</p></li>
<li><p>Miscellaneous fixes.</p></li>
</ul>
</li>
<li><p>July 29, 2023</p>
<ul>
<li><p>Fixed an issue where <code class="docutils literal notranslate"><span class="pre">dbutils.fs.ls()</span></code> returned <code class="docutils literal notranslate"><span class="pre">INVALID_PARAMETER_VALUE.LOCATION_OVERLAP</span></code> when called for a storage location path which clashed with other external or managed storage location.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44199">[SPARK-44199]</a> <code class="docutils literal notranslate"><span class="pre">CacheManager</span></code> no longer refreshes the <code class="docutils literal notranslate"><span class="pre">fileIndex</span></code> unnecessarily.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44448">[SPARK-44448]</a> Fixed incorrect results from <code class="docutils literal notranslate"><span class="pre">DenseRankLimitIterator</span></code> and <code class="docutils literal notranslate"><span class="pre">InferWindowGroupLimit</span></code>.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>July 24, 2023</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41848">[SPARK-41848]</a> Fixed task over-schedule issue with <code class="docutils literal notranslate"><span class="pre">TaskResourceProfile</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44337">[SPARK-44337]</a> Fixed an issue where any field set to <code class="docutils literal notranslate"><span class="pre">Any.getDefaultInstance</span></code> caused parse errors.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44136">[SPARK-44136]</a> Fixed an issue where <code class="docutils literal notranslate"><span class="pre">StateManager</span></code> would get materialized in an executor instead of the driver in <code class="docutils literal notranslate"><span class="pre">FlatMapGroupsWithStateExec</span></code>.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="databricks-runtime-122-lts">
<span id="dbr-122-lts"></span><span id="122"></span><h3><a class="toc-backref" href="#id6">Databricks Runtime 12.2 LTS</a><a class="headerlink" href="#databricks-runtime-122-lts" title="Permalink to this headline"> </a></h3>
<p>See <a class="reference internal" href="12.2lts.html"><span class="doc">Databricks Runtime 12.2 LTS</span></a>.</p>
<ul>
<li><p>November 29, 2023</p>
<ul class="simple">
<li><p>Installed a new package, <code class="docutils literal notranslate"><span class="pre">pyarrow-hotfix</span></code> to remediate a PyArrow RCE vulnerability.</p></li>
<li><p>Fixed an issue where escaped underscores in <code class="docutils literal notranslate"><span class="pre">getColumns</span></code> operations originating from JDBC or ODBC clients were wrongly interpreted as wildcards.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42205">[SPARK-42205]</a> Removed logging accumulables in <code class="docutils literal notranslate"><span class="pre">Stage</span></code> and <code class="docutils literal notranslate"><span class="pre">Task</span></code> start events.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44846">[SPARK-44846]</a> Removed complex grouping expressions after <code class="docutils literal notranslate"><span class="pre">RemoveRedundantAggregates</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43718">[SPARK-43718]</a> Fixed nullability for keys in <code class="docutils literal notranslate"><span class="pre">USING</span></code> joins.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45544">[SPARK-45544]</a> Integrated SSL support into <code class="docutils literal notranslate"><span class="pre">TransportContext</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43973">[SPARK-43973]</a> Structured Streaming UI now displays failed queries correctly.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45730">[SPARK-45730]</a> Improved time constraints for <code class="docutils literal notranslate"><span class="pre">ReloadingX509TrustManagerSuite</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45859">[SPARK-45859]</a> Made UDF objects in <code class="docutils literal notranslate"><span class="pre">ml.functions</span></code> lazy.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>November 14, 2023</p>
<ul class="simple">
<li><p>Partition filters on Delta Lake streaming queries are pushed down before rate limiting to achieve better utilization.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45545">[SPARK-45545]</a> <code class="docutils literal notranslate"><span class="pre">SparkTransportConf</span></code> inherits <code class="docutils literal notranslate"><span class="pre">SSLOptions</span></code> upon creation.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45427">[SPARK-45427]</a> Added RPC SSL settings to <code class="docutils literal notranslate"><span class="pre">SSLOptions</span></code> and <code class="docutils literal notranslate"><span class="pre">SparkTransportConf</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45584">[SPARK-45584]</a> Fixed subquery run failure with <code class="docutils literal notranslate"><span class="pre">TakeOrderedAndProjectExec</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45541">[SPARK-45541]</a> Added <code class="docutils literal notranslate"><span class="pre">SSLFactory</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45430">[SPARK-45430]</a> <code class="docutils literal notranslate"><span class="pre">FramelessOffsetWindowFunction</span></code> no longer fails when <code class="docutils literal notranslate"><span class="pre">IGNORE</span> <span class="pre">NULLS</span></code> and <code class="docutils literal notranslate"><span class="pre">offset</span> <span class="pre">&gt;</span> <span class="pre">rowCount</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45429">[SPARK-45429]</a> Added helper classes for SSL RPC communication.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>October 24, 2023</p>
<ul class="simple">
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45426">[SPARK-45426]</a> Added support for <code class="docutils literal notranslate"><span class="pre">ReloadingX509TrustManager</span></code>.</p></li>
<li><p>Miscellaneous fixes.</p></li>
</ul>
</li>
<li><p>October 13, 2023</p>
<ul class="simple">
<li><p>Snowflake-jdbc dependency upgraded from 3.13.29 to 3.13.33.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42553">[SPARK-42553]</a> Ensure at least one time unit after interval.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45346">[SPARK-45346]</a> Parquet schema inference respects case sensitive flag when merging schema.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45178">[SPARK-45178]</a> Fallback to running a single batch for <code class="docutils literal notranslate"><span class="pre">Trigger.AvailableNow</span></code> with unsupported sources rather than using the wrapper.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45084">[SPARK-45084]</a> <code class="docutils literal notranslate"><span class="pre">StateOperatorProgress</span></code> to use an accurate, adequate shuffle partition number.</p></li>
</ul>
</li>
<li><p>September 12, 2023</p>
<ul class="simple">
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44873">[SPARK-44873]</a> Added support for <code class="docutils literal notranslate"><span class="pre">alter</span> <span class="pre">view</span></code> with nested columns in the Hive client.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44718">[SPARK-44718]</a> Match <code class="docutils literal notranslate"><span class="pre">ColumnVector</span></code> memory-mode config default to <code class="docutils literal notranslate"><span class="pre">OffHeapMemoryMode</span></code> config value.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43799">[SPARK-43799]</a> Added descriptor binary option to PySpark <code class="docutils literal notranslate"><span class="pre">Protobuf</span></code> API.</p></li>
<li><p>Miscellaneous fixes.</p></li>
</ul>
</li>
<li><p>August 30, 2023</p>
<ul class="simple">
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44485">[SPARK-44485]</a> Optimized <code class="docutils literal notranslate"><span class="pre">TreeNode.generateTreeString</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44818">[SPARK-44818]</a> Fixed race for pending task interrupt issued before <code class="docutils literal notranslate"><span class="pre">taskThread</span></code> is initialized.</p></li>
<li><p>[11.3-13.0][[SPARK-44871]]<a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44871">https://issues.apache.org/jira/browse/SPARK-44871</a>) Fixed <code class="docutils literal notranslate"><span class="pre">percentile_disc</span></code> behavior.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44714">[SPARK-44714]</a> Eased restriction of LCA resolution regarding queries.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>August 15, 2023</p>
<ul class="simple">
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44504">[SPARK-44504]</a> Maintenance task cleans up loaded providers on stop error.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44464">[SPARK-44464]</a> Fixed <code class="docutils literal notranslate"><span class="pre">applyInPandasWithStatePythonRunner</span></code> to output rows that have <code class="docutils literal notranslate"><span class="pre">Null</span></code> as the first column value.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>July 29, 2023</p>
<ul class="simple">
<li><p>Fixed an issue where <code class="docutils literal notranslate"><span class="pre">dbutils.fs.ls()</span></code> returned <code class="docutils literal notranslate"><span class="pre">INVALID_PARAMETER_VALUE.LOCATION_OVERLAP</span></code> when called for a storage location path which clashed with other external or managed storage location.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44199">[SPARK-44199]</a> <code class="docutils literal notranslate"><span class="pre">CacheManager</span></code> no longer refreshes the <code class="docutils literal notranslate"><span class="pre">fileIndex</span></code> unnecessarily.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>July 24, 2023</p>
<ul class="simple">
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44337">[SPARK-44337]</a> Fixed an issue where any field set to <code class="docutils literal notranslate"><span class="pre">Any.getDefaultInstance</span></code> caused parse errors.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44136">[SPARK-44136]</a> Fixed an issue where <code class="docutils literal notranslate"><span class="pre">StateManager</span></code> would get materialized in an executor instead of the driver in <code class="docutils literal notranslate"><span class="pre">FlatMapGroupsWithStateExec</span></code>.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>June 23, 2023</p>
<ul class="simple">
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>June 15, 2023</p>
<ul class="simple">
<li><p>Photonized <code class="docutils literal notranslate"><span class="pre">approx_count_distinct</span></code>.</p></li>
<li><p>Snowflake-jdbc library is upgraded to 3.13.29 to address a security issue.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43779">[SPARK-43779]</a> <code class="docutils literal notranslate"><span class="pre">ParseToDate</span></code> now loads <code class="docutils literal notranslate"><span class="pre">EvalMode</span></code> in the main thread.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43156">[SPARK-43156]</a><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43098">[SPARK-43098]</a> Extended scalar subquery count error test with <code class="docutils literal notranslate"><span class="pre">decorrelateInnerQuery</span></code> turned off.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>June 2, 2023</p>
<ul class="simple">
<li><p>The JSON parser in <code class="docutils literal notranslate"><span class="pre">failOnUnknownFields</span></code> mode drops a record in <code class="docutils literal notranslate"><span class="pre">DROPMALFORMED</span></code> mode and fails directly in <code class="docutils literal notranslate"><span class="pre">FAILFAST</span></code> mode.</p></li>
<li><p>Improve the performance of incremental updates with <code class="docutils literal notranslate"><span class="pre">SHALLOW</span> <span class="pre">CLONE</span></code> Iceberg and Parquet.</p></li>
<li><p>Fixed an issue in Auto Loader where different source file formats were inconsistent when the provided schema did not include inferred partitions. This issue could cause unexpected failures when reading files with missing columns in the inferred partition schema.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43404">[SPARK-43404]</a> Skip reusing the sst file for the same version of RocksDB state store to avoid the ID mismatch error.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43413">[SPARK-43413]</a>[11.3-13.0] Fixed <code class="docutils literal notranslate"><span class="pre">IN</span></code> subquery <code class="docutils literal notranslate"><span class="pre">ListQuery</span></code> nullability.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43522">[SPARK-43522]</a> Fixed creating struct column name with index of array.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43541">[SPARK-43541]</a> Propagate all <code class="docutils literal notranslate"><span class="pre">Project</span></code> tags in resolving of expressions and missing columns.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43527">[SPARK-43527]</a> Fixed <code class="docutils literal notranslate"><span class="pre">catalog.listCatalogs</span></code> in PySpark.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43123">[SPARK-43123]</a> Internal field metadata no longer leaks to catalogs.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43340">[SPARK-43340]</a> Fixed missing stack trace field in eventlogs.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42444">[SPARK-42444]</a> <code class="docutils literal notranslate"><span class="pre">DataFrame.drop</span></code> now handles duplicated columns correctly.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42937">[SPARK-42937]</a> <code class="docutils literal notranslate"><span class="pre">PlanSubqueries</span></code> now sets <code class="docutils literal notranslate"><span class="pre">InSubqueryExec#shouldBroadcast</span></code> to true.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43286">[SPARK-43286]</a> Updated <code class="docutils literal notranslate"><span class="pre">aes_encrypt</span></code> CBC mode to generate random IVs.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43378">[SPARK-43378]</a> Properly close stream objects in <code class="docutils literal notranslate"><span class="pre">deserializeFromChunkedBuffer</span></code>.</p></li>
</ul>
</li>
<li><p>May 17, 2023</p>
<ul class="simple">
<li><p>Parquet scans are now robust against OOMs when scanning exceptionally structured files by dynamically adjusting batch size. File metadata is analyzed to preemptively lower batch size and is lowered again on task retries as a final safety net.</p></li>
<li><p>If an Avro file was read with just the <code class="docutils literal notranslate"><span class="pre">failOnUnknownFields\</span></code> option or with Auto Loader in the <code class="docutils literal notranslate"><span class="pre">failOnNewColumns\</span></code> schema evolution mode, columns that have different data types would be read as <code class="docutils literal notranslate"><span class="pre">null\</span></code> instead of throwing an error stating that the file cannot be read. These reads now fail and recommend users to use the <code class="docutils literal notranslate"><span class="pre">rescuedDataColumn\</span></code> option.</p></li>
<li><p>Auto Loader now does the following.</p></li>
<li><ul>
<li><p>Correctly reads and no longer rescues <code class="docutils literal notranslate"><span class="pre">Integer</span></code>, <code class="docutils literal notranslate"><span class="pre">Short</span></code>, and <code class="docutils literal notranslate"><span class="pre">Byte</span></code> types if one of these data types is provided, but the Avro file suggests one of the other two types.</p></li>
</ul>
</li>
<li><ul>
<li><p>Prevents reading interval types as date or time stamp types to avoid getting corrupt dates.</p></li>
</ul>
</li>
<li><ul>
<li><p>Prevents reading <code class="docutils literal notranslate"><span class="pre">Decimal</span></code> types with lower precision.</p></li>
</ul>
</li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43172">[SPARK-43172]</a> Exposes host and token from Spark connect client.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43293">[SPARK-43293]</a> <code class="docutils literal notranslate"><span class="pre">__qualified_access_only</span></code> is ignored in normal columns.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43098">[SPARK-43098]</a> Fixed correctness <code class="docutils literal notranslate"><span class="pre">COUNT</span></code> bug when scalar subquery is grouped by clause.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43085">[SPARK-43085]</a> Support for column <code class="docutils literal notranslate"><span class="pre">DEFAULT</span></code> assignment for multi-part table names.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43190">[SPARK-43190]</a> <code class="docutils literal notranslate"><span class="pre">ListQuery.childOutput</span></code> is now consistent with secondary output.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43192">[SPARK-43192]</a> Removed user agent charset validation.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>April 25, 2023</p>
<ul class="simple">
<li><p>If a Parquet file was read with just the <code class="docutils literal notranslate"><span class="pre">failOnUnknownFields</span></code> option or with Auto Loader in the <code class="docutils literal notranslate"><span class="pre">failOnNewColumns</span></code> schema evolution mode, columns that had different data types would be read as <code class="docutils literal notranslate"><span class="pre">null</span></code> instead of throwing an error stating that the file cannot be read. These reads now fail and recommend users to use the <code class="docutils literal notranslate"><span class="pre">rescuedDataColumn</span></code> option.</p></li>
<li><p>Auto Loader now correctly reads and no longer rescues <code class="docutils literal notranslate"><span class="pre">Integer</span></code>, <code class="docutils literal notranslate"><span class="pre">Short</span></code>, and <code class="docutils literal notranslate"><span class="pre">Byte</span></code> types if one of these data types is provided. The Parquet file suggests one of the other two types. When the rescued data column was previously enabled, the data type mismatch would cause columns to be saved even though they were readable.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43009">[SPARK-43009]</a> Parameterized <code class="docutils literal notranslate"><span class="pre">sql()</span></code> with <code class="docutils literal notranslate"><span class="pre">Any</span></code> constants</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42406">[SPARK-42406]</a> Terminate Protobuf recursive fields by dropping the field</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43038">[SPARK-43038]</a> Support the CBC mode by <code class="docutils literal notranslate"><span class="pre">aes_encrypt()</span></code>/<code class="docutils literal notranslate"><span class="pre">aes_decrypt()</span></code></p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42971">[SPARK-42971]</a> Change to print <code class="docutils literal notranslate"><span class="pre">workdir</span></code> if <code class="docutils literal notranslate"><span class="pre">appDirs</span></code> is null when worker handle <code class="docutils literal notranslate"><span class="pre">WorkDirCleanup</span></code> event</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43018">[SPARK-43018]</a> Fix bug for INSERT commands with timestamp literals</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>April 11, 2023</p>
<ul class="simple">
<li><p>Support legacy data source formats in the <code class="docutils literal notranslate"><span class="pre">SYNC</span></code> command.</p></li>
<li><p>Fixes an issue in the %autoreload behavior in notebooks outside of a repo.</p></li>
<li><p>Fixed an issue where Auto Loader schema evolution can go into an infinite fail loop when a new column is detected in the schema of a nested JSON object.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42928">[SPARK-42928]</a> Makes <code class="docutils literal notranslate"><span class="pre">resolvePersistentFunction</span></code> synchronized.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42936">[SPARK-42936]</a> Fixes LCan issue when the clause can be resolved directly by its child aggregate.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42967">[SPARK-42967]</a> Fixes <code class="docutils literal notranslate"><span class="pre">SparkListenerTaskStart.stageAttemptId</span></code> when a task starts after the stage is canceled.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>March 29, 2023</p>
<ul>
<li><p>Databricks SQL now supports specifying default values for columns of Delta Lake tables, either at table creation time or afterward. Subsequent <code class="docutils literal notranslate"><span class="pre">INSERT</span></code>, <code class="docutils literal notranslate"><span class="pre">UPDATE</span></code>, <code class="docutils literal notranslate"><span class="pre">DELETE</span></code>, and <code class="docutils literal notranslate"><span class="pre">MERGE</span></code> commands can refer to any column’s default value using the explicit <code class="docutils literal notranslate"><span class="pre">DEFAULT</span></code> keyword. In addition, if any <code class="docutils literal notranslate"><span class="pre">INSERT</span></code> assignment has an explicit list of fewer columns than the target table, corresponding column default values are substituted for the remaining columns (or NULL if no default is specified).</p>
<p>For example:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="p">(</span><span class="k">first</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span><span class="w"> </span><span class="k">second</span><span class="w"> </span><span class="nb">DATE</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">CURRENT_DATE</span><span class="p">())</span><span class="w"> </span><span class="k">USING</span><span class="w"> </span><span class="n">delta</span><span class="p">;</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="k">DEFAULT</span><span class="p">);</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="k">DEFAULT</span><span class="p">);</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">first</span><span class="p">,</span><span class="w"> </span><span class="k">second</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">t</span><span class="p">;</span>
<span class="err">\</span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2023</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">28</span>
<span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2023</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">28</span><span class="n">z</span>
</pre></div>
</div>
</li>
<li><p>Auto Loader now initiates at least one synchronous RocksDB log cleanup for <code class="docutils literal notranslate"><span class="pre">Trigger.AvailableNow</span></code> streams to check that the checkpoint can get regularly cleaned up for fast-running Auto Loader streams. This can cause some streams to take longer before they shut down, but it will save you storage costs and improve the Auto Loader experience in future runs.</p></li>
<li><p>You can now modify a Delta table to add support to table features using <code class="docutils literal notranslate"><span class="pre">DeltaTable.addFeatureSupport(feature_name)</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42794">[SPARK-42794]</a> Increase the lockAcquireTimeoutMs to 2 minutes for acquiring the RocksDB state store in Structure Streaming</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42521">[SPARK-42521]</a> Add NULLs for INSERTs with user-specified lists of fewer columns than the target table</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42702">[SPARK-42702]</a><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42623">[SPARK-42623]</a> Support parameterized query in subquery and CTE</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42668">[SPARK-42668]</a> Catch exception while trying to close the compressed stream in HDFSStateStoreProvider stop</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42403">[SPARK-42403]</a> JsonProtocol should handle null JSON strings</p></li>
</ul>
</li>
<li><p>March 8, 2023</p>
<ul class="simple">
<li><p>The error message “Failure to initialize configuration” has been improved to provide more context for the customer.</p></li>
<li><p>There is a terminology change for adding features to a Delta table using the table property. The preferred syntax is now <code class="docutils literal notranslate"><span class="pre">'delta.feature.featureName'='supported'</span></code> instead of <code class="docutils literal notranslate"><span class="pre">'delta.feature.featureName'='enabled'</span></code>. For backward compatibility, using <code class="docutils literal notranslate"><span class="pre">'delta.feature.featureName'='enabled'</span></code> still works and will continue to work.</p></li>
<li><p>Starting from this release, it is possible to create/replace a table with an additional table property <code class="docutils literal notranslate"><span class="pre">delta.ignoreProtocolDefaults</span></code> to ignore protocol-related Spark configs, which includes default reader and writer versions and table features supported by default.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42070">[SPARK-42070]</a> Change the default value of the argument of the Mask function from -1 to NULL</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41793">[SPARK-41793]</a> Incorrect result for window frames defined by a range clause on significant decimals</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42484">[SPARK-42484]</a> UnsafeRowUtils better error message</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42516">[SPARK-42516]</a> Always capture the session time zone config while creating views</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42635">[SPARK-42635]</a> Fix the TimestampAdd expression.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42622">[SPARK-42622]</a> Turned off substitution in values</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42534">[SPARK-42534]</a> Fix DB2Dialect Limit clause</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42121">[SPARK-42121]</a> Add built-in table-valued functions posexplode, posexplode_outer, json_tuple and stack</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42045">[SPARK-42045]</a> ANSI SQL mode: Round/Bround should return an error on tiny/small/significant integer overflow</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="databricks-runtime-113-lts">
<span id="dbr-113-lts"></span><span id="113"></span><h3><a class="toc-backref" href="#id7">Databricks Runtime 11.3 LTS</a><a class="headerlink" href="#databricks-runtime-113-lts" title="Permalink to this headline"> </a></h3>
<p>See <a class="reference internal" href="11.3lts.html"><span class="doc">Databricks Runtime 11.3 LTS</span></a>.</p>
<ul class="simple">
<li><p>November 29, 2023</p>
<ul>
<li><p>Installed a new package, <code class="docutils literal notranslate"><span class="pre">pyarrow-hotfix</span></code> to remediate a PyArrow RCE vulnerability.</p></li>
<li><p>Fixed an issue where escaped underscores in <code class="docutils literal notranslate"><span class="pre">getColumns</span></code> operations originating from JDBC or ODBC clients were wrongly interpreted as wildcards.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43973">[SPARK-43973]</a> Structured Streaming UI now displays failed queries correctly.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45730">[SPARK-45730]</a> Improved time constraints for <code class="docutils literal notranslate"><span class="pre">ReloadingX509TrustManagerSuite</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45544">[SPARK-45544]</a> Integrated SSL support into <code class="docutils literal notranslate"><span class="pre">TransportContext</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45859">[SPARK-45859]</a> Made UDF objects in <code class="docutils literal notranslate"><span class="pre">ml.functions</span></code> lazy.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43718">[SPARK-43718]</a> Fixed nullability for keys in <code class="docutils literal notranslate"><span class="pre">USING</span></code> joins.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44846">[SPARK-44846]</a> Removed complex grouping expressions after <code class="docutils literal notranslate"><span class="pre">RemoveRedundantAggregates</span></code>.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>November 14, 2023</p>
<ul>
<li><p>Partition filters on Delta Lake streaming queries are pushed down before rate limiting to achieve better utilization.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42205">[SPARK-42205]</a> Removed logging accumulables in Stage and Task start events.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45545">[SPARK-45545]</a> <code class="docutils literal notranslate"><span class="pre">SparkTransportConf</span></code> inherits <code class="docutils literal notranslate"><span class="pre">SSLOptions</span></code> upon creation.</p></li>
<li><p>Revert <a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-33861">[SPARK-33861]</a>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45541">[SPARK-45541]</a> Added <code class="docutils literal notranslate"><span class="pre">SSLFactory</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45429">[SPARK-45429]</a> Added helper classes for SSL RPC communication.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45584">[SPARK-45584]</a> Fixed subquery run failure with <code class="docutils literal notranslate"><span class="pre">TakeOrderedAndProjectExec</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45430">[SPARK-45430]</a> <code class="docutils literal notranslate"><span class="pre">FramelessOffsetWindowFunction</span></code> no longer fails when <code class="docutils literal notranslate"><span class="pre">IGNORE</span> <span class="pre">NULLS</span></code> and <code class="docutils literal notranslate"><span class="pre">offset</span> <span class="pre">&gt;</span> <span class="pre">rowCount</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45427">[SPARK-45427]</a> Added RPC SSL settings to <code class="docutils literal notranslate"><span class="pre">SSLOptions</span></code> and <code class="docutils literal notranslate"><span class="pre">SparkTransportConf</span></code>.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>October 24, 2023</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45426">[SPARK-45426]</a> Added support for <code class="docutils literal notranslate"><span class="pre">ReloadingX509TrustManager</span></code>.</p></li>
<li><p>Miscellaneous fixes.</p></li>
</ul>
</li>
<li><p>October 13, 2023</p>
<ul>
<li><p>Snowflake-jdbc dependency upgraded from 3.13.29 to 3.13.33.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45178">[SPARK-45178]</a> Fallback to running a single batch for <code class="docutils literal notranslate"><span class="pre">Trigger.AvailableNow</span></code> with unsupported sources rather than using the wrapper.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45084">[SPARK-45084]</a> <code class="docutils literal notranslate"><span class="pre">StateOperatorProgress</span></code> to use an accurate, adequate shuffle partition number.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45346">[SPARK-45346]</a> Parquet schema inference now respects case-sensitive flag when merging a schema.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>September 10, 2023</p>
<ul>
<li><p>Miscellaneous fixes.</p></li>
</ul>
</li>
<li><p>August 30, 2023</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44818">[SPARK-44818]</a> Fixed race for pending task interrupt issued before <code class="docutils literal notranslate"><span class="pre">taskThread</span></code> is initialized.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44871">[SPARK-44871]</a>[11.3-13.0] Fixed <code class="docutils literal notranslate"><span class="pre">percentile_disc</span></code> behavior.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>August 15, 2023</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44485">[SPARK-44485]</a> Optimized <code class="docutils literal notranslate"><span class="pre">TreeNode.generateTreeString</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44504">[SPARK-44504]</a> Maintenance task cleans up loaded providers on stop error.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44464">[SPARK-44464]</a> Fixed <code class="docutils literal notranslate"><span class="pre">applyInPandasWithStatePythonRunner</span></code> to output rows that have <code class="docutils literal notranslate"><span class="pre">Null</span></code> as the first column value.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>July 27, 2023</p>
<ul>
<li><p>Fixed an issue where <code class="docutils literal notranslate"><span class="pre">dbutils.fs.ls()</span></code> returned <code class="docutils literal notranslate"><span class="pre">INVALID_PARAMETER_VALUE.LOCATION_OVERLAP</span></code> when called for a storage location path which clashed with other external or managed storage location.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44199">[SPARK-44199]</a> <code class="docutils literal notranslate"><span class="pre">CacheManager</span></code> no longer refreshes the <code class="docutils literal notranslate"><span class="pre">fileIndex</span></code> unnecessarily.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>July 24, 2023</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44136">[SPARK-44136]</a> Fixed an issue that StateManager can get materialized in executor instead of driver in FlatMapGroupsWithStateExec.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>June 23, 2023</p>
<ul>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>June 15, 2023</p>
<ul>
<li><p>Photonized <code class="docutils literal notranslate"><span class="pre">approx_count_distinct</span></code>.</p></li>
<li><p>Snowflake-jdbc library is upgraded to 3.13.29 to address a security issue.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43779">[SPARK-43779]</a> <code class="docutils literal notranslate"><span class="pre">ParseToDate</span></code> now loads <code class="docutils literal notranslate"><span class="pre">EvalMode</span></code> in the main thread.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40862">[SPARK-40862]</a> Support non-aggregated subqueries in RewriteCorrelatedScalarSubquery</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43156">[SPARK-43156]</a><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43098">[SPARK-43098]</a> Extended scalar subquery count bug test with <code class="docutils literal notranslate"><span class="pre">decorrelateInnerQuery</span></code> turned off.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43098">[SPARK-43098]</a> Fix correctness COUNT bug when scalar subquery has a group by clause</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>June 2, 2023</p>
<ul>
<li><p>The JSON parser in <code class="docutils literal notranslate"><span class="pre">failOnUnknownFields</span></code> mode drops a record in <code class="docutils literal notranslate"><span class="pre">DROPMALFORMED</span></code> mode and fails directly in <code class="docutils literal notranslate"><span class="pre">FAILFAST</span></code> mode.</p></li>
<li><p>Improve the performance of incremental updates with <code class="docutils literal notranslate"><span class="pre">SHALLOW</span> <span class="pre">CLONE</span></code> Iceberg and Parquet.</p></li>
<li><p>Fixed an issue in Auto Loader where different source file formats were inconsistent when the provided schema did not include inferred partitions. This issue could cause unexpected failures when reading files with missing columns in the inferred partition schema.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43404">[SPARK-43404]</a>Skip reusing the sst file for the same version of RocksDB state store to avoid the ID mismatch error.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43527">[SPARK-43527]</a> Fixed <code class="docutils literal notranslate"><span class="pre">catalog.listCatalogs</span></code> in PySpark.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43413">[SPARK-43413]</a>[11.3-13.0] Fixed <code class="docutils literal notranslate"><span class="pre">IN</span></code> subquery <code class="docutils literal notranslate"><span class="pre">ListQuery</span></code> nullability.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43340">[SPARK-43340]</a> Fixed missing stack trace field in eventlogs.</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="databricks-runtime-104-lts">
<span id="dbr-104-lts"></span><span id="104"></span><h3><a class="toc-backref" href="#id8">Databricks Runtime 10.4 LTS</a><a class="headerlink" href="#databricks-runtime-104-lts" title="Permalink to this headline"> </a></h3>
<p>See <a class="reference internal" href="10.4lts.html"><span class="doc">Databricks Runtime 10.4 LTS</span></a>.</p>
<ul class="simple">
<li><p>November 29, 2023</p>
<ul>
<li><p>Installed a new package, <code class="docutils literal notranslate"><span class="pre">pyarrow-hotfix</span></code> to remediate a PyArrow RCE vulnerability.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45544">[SPARK-45544]</a> Integrated SSL support into <code class="docutils literal notranslate"><span class="pre">TransportContext</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45859">[SPARK-45859]</a> Made UDF objects in <code class="docutils literal notranslate"><span class="pre">ml.functions</span></code> lazy.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43718">[SPARK-43718]</a> Fixed nullability for keys in <code class="docutils literal notranslate"><span class="pre">USING</span></code> joins.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45730">[SPARK-45730]</a> Improved time constraints for <code class="docutils literal notranslate"><span class="pre">ReloadingX509TrustManagerSuite</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42205">[SPARK-42205]</a> Removed logging accumulables in Stage and Task start events.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44846">[SPARK-44846]</a> Removed complex grouping expressions after <code class="docutils literal notranslate"><span class="pre">RemoveRedundantAggregates</span></code>.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>November 14, 2023</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45541">[SPARK-45541]</a> Added <code class="docutils literal notranslate"><span class="pre">SSLFactory</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45545">[SPARK-45545]</a> <code class="docutils literal notranslate"><span class="pre">SparkTransportConf</span></code> inherits <code class="docutils literal notranslate"><span class="pre">SSLOptions</span></code> upon creation.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45427">[SPARK-45427]</a> Added RPC SSL settings to <code class="docutils literal notranslate"><span class="pre">SSLOptions</span></code> and <code class="docutils literal notranslate"><span class="pre">SparkTransportConf</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45429">[SPARK-45429]</a> Added helper classes for SSL RPC communication.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45584">[SPARK-45584]</a> Fixed subquery run failure with <code class="docutils literal notranslate"><span class="pre">TakeOrderedAndProjectExec</span></code>.</p></li>
<li><p>Revert <a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-33861">[SPARK-33861]</a>.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>October 24, 2023</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45426">[SPARK-45426]</a> Added support for <code class="docutils literal notranslate"><span class="pre">ReloadingX509TrustManager</span></code>.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>October 13, 2023</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45084">[SPARK-45084]</a> <code class="docutils literal notranslate"><span class="pre">StateOperatorProgress</span></code> to use an accurate, adequate shuffle partition number.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45178">[SPARK-45178]</a> Fallback to running a single batch for <code class="docutils literal notranslate"><span class="pre">Trigger.AvailableNow</span></code> with unsupported sources rather than using the wrapper.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>September 10, 2023</p>
<ul>
<li><p>Miscellaneous fixes.</p></li>
</ul>
</li>
<li><p>August 30, 2023</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44818">[SPARK-44818]</a> Fixed race for pending task interrupt issued before <code class="docutils literal notranslate"><span class="pre">taskThread</span></code> is initialized.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>August 15, 2023</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44504">[SPARK-44504]</a> Maintenance task cleans up loaded providers on stop error.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43973">[SPARK-43973]</a> Structured Streaming UI now appears failed queries correctly.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>June 23, 2023</p>
<ul>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>June 15, 2023</p>
<ul>
<li><p>Snowflake-jdbc library is upgraded to 3.13.29 to address a security issue.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43098">[SPARK-43098]</a> Fix correctness COUNT bug when scalar subquery has a group by clause</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40862">[SPARK-40862]</a> Support non-aggregated subqueries in RewriteCorrelatedScalarSubquery</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43156">[SPARK-43156]</a><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43098">[SPARK-43098]</a> Extended scalar subquery count test with <code class="docutils literal notranslate"><span class="pre">decorrelateInnerQuery</span></code> turned off.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>June 2, 2023</p>
<ul>
<li><p>The JSON parser in <code class="docutils literal notranslate"><span class="pre">failOnUnknownFields</span></code> mode drops a record in <code class="docutils literal notranslate"><span class="pre">DROPMALFORMED</span></code> mode and fails directly in <code class="docutils literal notranslate"><span class="pre">FAILFAST</span></code> mode.</p></li>
<li><p>Fixed an issue in JSON rescued data parsing to prevent <code class="docutils literal notranslate"><span class="pre">UnknownFieldException</span></code>.</p></li>
<li><p>Fixed an issue in Auto Loader where different source file formats were inconsistent when the provided schema did not include inferred partitions. This issue could cause unexpected failures when reading files with missing columns in the inferred partition schema.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43404">[SPARK-43404]</a> Skip reusing the sst file for the same version of RocksDB state store to avoid the ID mismatch error.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43413">[SPARK-43413]</a> Fixed <code class="docutils literal notranslate"><span class="pre">IN</span></code> subquery <code class="docutils literal notranslate"><span class="pre">ListQuery</span></code> nullability.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>May 17, 2023</p>
<ul>
<li><p>Parquet scans are now robust against OOMs when scanning exceptionally structured files by dynamically adjusting batch size. File metadata is analyzed to preemptively lower batch size and is lowered again on task retries as a final safety net.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41520">[SPARK-41520]</a> Split <code class="docutils literal notranslate"><span class="pre">AND_OR</span></code> tree pattern to separate <code class="docutils literal notranslate"><span class="pre">AND</span></code> and <code class="docutils literal notranslate"><span class="pre">OR</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43190">[SPARK-43190]</a> <code class="docutils literal notranslate"><span class="pre">ListQuery.childOutput</span></code> is now consistent with secondary output.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>April 25, 2023</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42928">[SPARK-42928]</a> Make <code class="docutils literal notranslate"><span class="pre">resolvePersistentFunction</span></code> synchronized.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>April 11, 2023</p>
<ul>
<li><p>Fixed an issue where Auto Loader schema evolution can go into an infinite fail loop when a new column is detected in the schema of a nested JSON object.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42937">[SPARK-42937]</a> <code class="docutils literal notranslate"><span class="pre">PlanSubqueries</span></code> now sets <code class="docutils literal notranslate"><span class="pre">InSubqueryExec#shouldBroadcast</span></code> to true.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42967">[SPARK-42967]</a> Fix SparkListenerTaskStart.stageAttemptId when a task is started after the stage is canceled.</p></li>
</ul>
</li>
<li><p>March 29, 2023</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42668">[SPARK-42668]</a> Catch exception while trying to close the compressed stream in HDFSStateStoreProvider stop</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42635">[SPARK-42635]</a> Fix the …</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>March 14, 2023</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41162">[SPARK-41162]</a> Fix anti- and semi-join for self-join with aggregations</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-33206">[SPARK-33206]</a> Fix shuffle index cache weight calculation for small index files</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42484">[SPARK-42484]</a> Improved the <code class="docutils literal notranslate"><span class="pre">UnsafeRowUtils</span></code> error message</p></li>
<li><p>Miscellaneous fixes.</p></li>
</ul>
</li>
<li><p>February 28, 2023</p>
<ul>
<li><p>Support generated column for yyyy-MM-dd date_format. This change supports partition pruning for yyyy-MM-dd as a date_format in generated columns.</p></li>
<li><p>Users can now read and write specific Delta tables requiring Reader version 3 and Writer version 7, using Databricks Runtime 9.1 LTS or later. To succeed, table features listed in the tables’ protocol must be supported by the current version of Databricks Runtime.</p></li>
<li><p>Support generated column for yyyy-MM-dd date_format. This change supports partition pruning for yyyy-MM-dd as a date_format in generated columns.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>February 16, 2023</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-30220">[SPARK-30220]</a> Enable using Exists/In subqueries outside of the Filter node</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>January 31, 2023</p>
<ul>
<li><p>Table types of JDBC tables are now EXTERNAL by default.</p></li>
</ul>
</li>
<li><p>January 18, 2023</p>
<ul>
<li><p>Azure Synapse connector returns a more descriptive error message when a column name contains not valid characters such as whitespaces or semicolons. In such cases, the following message will be returned: <code class="docutils literal notranslate"><span class="pre">Azure</span> <span class="pre">Synapse</span> <span class="pre">Analytics</span> <span class="pre">failed</span> <span class="pre">to</span> <span class="pre">run</span> <span class="pre">the</span> <span class="pre">JDBC</span> <span class="pre">query</span> <span class="pre">produced</span> <span class="pre">by</span> <span class="pre">the</span> <span class="pre">connector.</span> <span class="pre">Check</span> <span class="pre">column</span> <span class="pre">names</span> <span class="pre">do</span> <span class="pre">not</span> <span class="pre">include</span> <span class="pre">not</span> <span class="pre">valid</span> <span class="pre">characters</span> <span class="pre">such</span> <span class="pre">as</span> <span class="pre">';'</span> <span class="pre">or</span> <span class="pre">white</span> <span class="pre">space</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38277">[SPARK-38277]</a> Clear write batch after RocksDB state store’s commit</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41199">[SPARK-41199]</a> Fix metrics issue when DSv1 streaming source and DSv2 streaming source are co-used</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41198">[SPARK-41198]</a> Fix metrics in streaming query having CTE and DSv1 streaming source</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41339">[SPARK-41339]</a> Close and recreate RocksDB write batch instead of just clearing</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41732">[SPARK-41732]</a> Apply tree-pattern based pruning for the rule SessionWindowing</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>November 29, 2022</p>
<ul>
<li><p>Users can configure leading and trailing whitespaces’ behavior when writing data using the Redshift connector. The following options have been added to control white space handling:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">csvignoreleadingwhitespace</span></code>, when set to <code class="docutils literal notranslate"><span class="pre">true</span></code>, removes leading white space from values during writes when <code class="docutils literal notranslate"><span class="pre">tempformat</span></code> is set to <code class="docutils literal notranslate"><span class="pre">CSV</span></code> or <code class="docutils literal notranslate"><span class="pre">CSV</span> <span class="pre">GZIP</span></code>. Whitespaces are retained when the config is set to <code class="docutils literal notranslate"><span class="pre">false</span></code>. By default, the value is <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">csvignoretrailingwhitespace</span></code>, when set to <code class="docutils literal notranslate"><span class="pre">true</span></code>, removes trailing white space from values during writes when <code class="docutils literal notranslate"><span class="pre">tempformat</span></code> is set to <code class="docutils literal notranslate"><span class="pre">CSV</span></code> or <code class="docutils literal notranslate"><span class="pre">CSV</span> <span class="pre">GZIP</span></code>. Whitespaces are retained when the config is set to <code class="docutils literal notranslate"><span class="pre">false</span></code>. By default, the value is <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p></li>
</ul>
</li>
<li><p>Fixed an issue with JSON parsing in Auto Loader when all columns were left as strings (<code class="docutils literal notranslate"><span class="pre">cloudFiles.inferColumnTypes</span></code> was not set or set to <code class="docutils literal notranslate"><span class="pre">false</span></code>) and the JSON contained nested objects.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>November 15, 2022</p>
<ul>
<li><p>Upgraded Apache commons-text to 1.10.0.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40646">[SPARK-40646]</a> JSON parsing for structs, maps, and arrays has been fixed so when a part of a record does not match the schema, the rest of the record can still be parsed correctly instead of returning nulls. To opt-in for the improved behavior, set <code class="docutils literal notranslate"><span class="pre">spark.sql.json.enablePartialResults</span></code> to <code class="docutils literal notranslate"><span class="pre">true</span></code>. The flag is turned off by default to preserve the original behavior.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40292">[SPARK-40292]</a> Fix column names in <code class="docutils literal notranslate"><span class="pre">arrays_zip</span></code> function when arrays are referenced from nested structs</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>November 1, 2022</p>
<ul>
<li><p>Fixed an issue where if a Delta table had a user-defined column named <code class="docutils literal notranslate"><span class="pre">_change_type</span></code>, but <strong>Change data feed</strong> was turned off on that table, data in that column would incorrectly fill with NULL values when running <code class="docutils literal notranslate"><span class="pre">MERGE</span></code>.</p></li>
<li><p>Fixed an issue with Auto Loader where a file can be duplicated in the same micro-batch when <code class="docutils literal notranslate"><span class="pre">allowOverwrites</span></code> is enabled</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40697">[SPARK-40697]</a> Add read-side char padding to cover external data files</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40596">[SPARK-40596]</a> Populate ExecutorDecommission with messages in ExecutorDecommissionInfo</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>October 18, 2022</p>
<ul>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>October 5, 2022</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40468">[SPARK-40468]</a> Fix column pruning in CSV when <code class="docutils literal notranslate"><span class="pre">_corrupt_record</span></code> is selected.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>September 22, 2022</p>
<ul>
<li><p>Users can set spark.conf.set(<code class="docutils literal notranslate"><span class="pre">spark.databricks.io.listKeysWithPrefix.azure.enabled</span></code>, <code class="docutils literal notranslate"><span class="pre">true</span></code>) to re-enable the built-in listing for Auto Loader on ADLS Gen2. Built-in listing was previously turned off due to performance issues but can have led to increased storage costs for customers.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40315">[SPARK-40315]</a> Add hashCode() for Literal of ArrayBasedMapData</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40213">[SPARK-40213]</a> Support ASCII value conversion for Latin-1 characters</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40380">[SPARK-40380]</a> Fix constant-folding of InvokeLike to avoid non-serializable literal embedded in the plan</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38404">[SPARK-38404]</a> Improve CTE resolution when a nested CTE references an outer CTE</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40089">[SPARK-40089]</a> Fix sorting for some Decimal types</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39887">[SPARK-39887]</a> RemoveRedundantAliases should keep aliases that make the output of projection nodes unique</p></li>
</ul>
</li>
<li><p>September 6, 2022</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40235">[SPARK-40235]</a> Use interruptible lock instead of synchronized in Executor.updateDependencies()</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40218">[SPARK-40218]</a> GROUPING SETS should preserve the grouping columns</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39976">[SPARK-39976]</a> ArrayIntersect should handle null in left expression correctly</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40053">[SPARK-40053]</a> Add <code class="docutils literal notranslate"><span class="pre">assume</span></code> to dynamic cancel cases which require Python runtime environment</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-35542">[SPARK-35542]</a> Fix: Bucketizer created for multiple columns with parameters splitsArray,  inputCols and outputCols can not be loaded after saving it</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40079">[SPARK-40079]</a> Add Imputer inputCols validation for empty input case</p></li>
</ul>
</li>
<li><p>August 24, 2022</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39983">[SPARK-39983]</a> Do not cache unserialized broadcast relations on the driver</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39775">[SPARK-39775]</a> Disable validate default values when parsing Avro schemas</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39962">[SPARK-39962]</a> Apply projection when group attributes are empty</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-37643">[SPARK-37643]</a> when charVarcharAsString is true, for char datatype predicate query should skip rpadding rule</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>August 9, 2022</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39847">[SPARK-39847]</a> Fix race condition in RocksDBLoader.loadLibrary() if the caller thread is interrupted</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39731">[SPARK-39731]</a> Fix issue in CSV and JSON data sources when parsing dates in “yyyyMMdd” format with CORRECTED time parser policy</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>July 27, 2022</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39625">[SPARK-39625]</a> Add Dataset.as(StructType)</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39689">[SPARK-39689]</a>Support 2-chars <code class="docutils literal notranslate"><span class="pre">lineSep</span></code> in CSV data source</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39104">[SPARK-39104]</a> InMemoryRelation#isCachedColumnBuffersLoaded should be thread-safe</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39570">[SPARK-39570]</a> Inline table should allow expressions with alias</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39702">[SPARK-39702]</a> Reduce memory overhead of TransportCipher$EncryptedMessage by using a shared byteRawChannel</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39575">[SPARK-39575]</a> add ByteBuffer#rewind after ByteBuffer#get in AvroDeserializer</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39476">[SPARK-39476]</a> Disable Unwrap cast optimize when casting from Long to Float/ Double or from Integer to Float</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38868">[SPARK-38868]</a> Don’t propagate exceptions from filter predicate when optimizing outer joins</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>July 20, 2022</p>
<ul>
<li><p>Make Delta MERGE operation results consistent when the source is non-deterministic.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39355">[SPARK-39355]</a> Single column uses quoted to construct UnresolvedAttribute</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39548">[SPARK-39548]</a> CreateView Command with a window clause query press a wrong window definition not found issue</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39419">[SPARK-39419]</a> Fix ArraySort to throw an exception when the comparator returns null</p></li>
<li><p>Turned off Auto Loader’s use of built-in cloud APIs for directory listing on Azure.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>July 5, 2022</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39376">[SPARK-39376]</a> Hide duplicated columns in star expansion of subquery alias from NATURAL/USING JOIN</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>June 15, 2022</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39283">[SPARK-39283]</a> Fix deadlock between TaskMemoryManager and UnsafeExternalSorter.SpillableIterator</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39285">[SPARK-39285]</a> Spark should not check field names when reading files</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-34096">[SPARK-34096]</a> Improve performance for nth_value ignore nulls over offset window</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-36718">[SPARK-36718]</a> Fix the <code class="docutils literal notranslate"><span class="pre">isExtractOnly</span></code> check in CollapseProject</p></li>
</ul>
</li>
<li><p>June 2, 2022</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39093">[SPARK-39093]</a> Avoid codegen compilation error when dividing year-month intervals or day-time intervals by an integral</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38990">[SPARK-38990]</a> Avoid NullPointerException when evaluating date_trunc/trunc format as a bound reference</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>May 18, 2022</p>
<ul>
<li><p>Fixes a potential built-in memory leak in Auto Loader.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38918">[SPARK-38918]</a> Nested column pruning should filter out attributes that do not belong to the current relation</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-37593">[SPARK-37593]</a> Reduce default page size by LONG_ARRAY_OFFSET if G1GC and ON_HEAP are used</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39084">[SPARK-39084]</a> Fix df.rdd.isEmpty() by using TaskContext to stop iterator on task completion</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-32268">[SPARK-32268]</a> Add ColumnPruning in injectBloomFilter</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38974">[SPARK-38974]</a> Filter registered functions with a given database name in list functions</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38931">[SPARK-38931]</a> Create root dfs directory for RocksDBFileManager with an unknown number of keys on 1st checkpoint</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>April 19, 2022</p>
<ul>
<li><p>Upgraded Java AWS SDK from version 1.11.655 to 1.12.1899.</p></li>
<li><p>Fixed an issue with notebook-scoped libraries not working in batch streaming jobs.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38616">[SPARK-38616]</a> Keep track of SQL query text in Catalyst TreeNode</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>April 6, 2022</p>
<ul>
<li><p>The following Spark SQL functions are now available with this release:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">timestampadd()</span></code> and <code class="docutils literal notranslate"><span class="pre">dateadd()</span></code>: Add a time duration in a specified unit to a time stamp expression.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">timestampdiff()</span></code> and <code class="docutils literal notranslate"><span class="pre">datediff()</span></code>: Calculate the time difference between two-time stamp expressions in a specified unit.</p></li>
</ul>
</li>
<li><p>Parquet-MR has been upgraded to 1.12.2</p></li>
<li><p>Improved support for comprehensive schemas in parquet files</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38631">[SPARK-38631]</a> Uses Java-based implementation for un-tarring at Utils.unpack</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38509">[SPARK-38509]</a><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38481">[SPARK-38481]</a> Cherry-pick three <code class="docutils literal notranslate"><span class="pre">timestmapadd/diff</span></code> changes.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38523">[SPARK-38523]</a> Fix referring to the corrupt record column from CSV</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38237">[SPARK-38237]</a> Allow <code class="docutils literal notranslate"><span class="pre">ClusteredDistribution</span></code> to require full clustering keys</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38437">[SPARK-38437]</a> Lenient serialization of datetime from datasource</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38180">[SPARK-38180]</a> Allow safe up-cast expressions in correlated equality predicates</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38155">[SPARK-38155]</a> Disallow distinct aggregate in lateral subqueries with unsupported predicates</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="databricks-runtime-91-lts">
<span id="dbr-91-lts"></span><span id="91"></span><h3><a class="toc-backref" href="#id9">Databricks Runtime 9.1 LTS</a><a class="headerlink" href="#databricks-runtime-91-lts" title="Permalink to this headline"> </a></h3>
<p>See <a class="reference internal" href="9.1lts.html"><span class="doc">Databricks Runtime 9.1 LTS</span></a>.</p>
<ul class="simple">
<li><p>November 29, 2023</p>
<ul>
<li><p>Installed a new package, <code class="docutils literal notranslate"><span class="pre">pyarrow-hotfix</span></code> to remediate a PyArrow RCE vulnerability.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45859">[SPARK-45859]</a> Made UDF objects in <code class="docutils literal notranslate"><span class="pre">ml.functions</span></code> lazy.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45544">[SPARK-45544]</a> Integrated SSL support into <code class="docutils literal notranslate"><span class="pre">TransportContext</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45730">[SPARK-45730]</a> Improved time constraints for <code class="docutils literal notranslate"><span class="pre">ReloadingX509TrustManagerSuite</span></code>.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>November 14, 2023</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45545">[SPARK-45545]</a> <code class="docutils literal notranslate"><span class="pre">SparkTransportConf</span></code> inherits <code class="docutils literal notranslate"><span class="pre">SSLOptions</span></code> upon creation.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45429">[SPARK-45429]</a> Added helper classes for SSL RPC communication.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45427">[SPARK-45427]</a> Added RPC SSL settings to <code class="docutils literal notranslate"><span class="pre">SSLOptions</span></code> and <code class="docutils literal notranslate"><span class="pre">SparkTransportConf</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45584">[SPARK-45584]</a> Fixed subquery run failure with <code class="docutils literal notranslate"><span class="pre">TakeOrderedAndProjectExec</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45541">[SPARK-45541]</a> Added <code class="docutils literal notranslate"><span class="pre">SSLFactory</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42205">[SPARK-42205]</a> Removed logging accumulables in Stage and Task start events.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>October 24, 2023</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45426">[SPARK-45426]</a> Added support for <code class="docutils literal notranslate"><span class="pre">ReloadingX509TrustManager</span></code>.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>October 13, 2023</p>
<ul>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>September 10, 2023</p>
<ul>
<li><p>Miscellaneous fixes.</p></li>
</ul>
</li>
<li><p>August 30, 2023</p>
<ul>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>August 15, 2023</p>
<ul>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>June 23, 2023</p>
<ul>
<li><p>Snowflake-jdbc library is upgraded to 3.13.29 to address a security issue.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>June 15, 2023</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43098">[SPARK-43098]</a> Fix correctness COUNT bug when scalar subquery has a group by clause</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43156">[SPARK-43156]</a><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43098">[SPARK-43098]</a> Extend scalar subquery count bug test with <code class="docutils literal notranslate"><span class="pre">decorrelateInnerQuery</span></code> turned off.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40862">[SPARK-40862]</a> Support non-aggregated subqueries in RewriteCorrelatedScalarSubquery</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>June 2, 2023</p>
<ul>
<li><p>The JSON parser in <code class="docutils literal notranslate"><span class="pre">failOnUnknownFields</span></code> mode drops a record in <code class="docutils literal notranslate"><span class="pre">DROPMALFORMED</span></code> mode and fails directly in <code class="docutils literal notranslate"><span class="pre">FAILFAST</span></code> mode.</p></li>
<li><p>Fixed an issue in JSON rescued data parsing to prevent <code class="docutils literal notranslate"><span class="pre">UnknownFieldException</span></code>.</p></li>
<li><p>Fixed an issue in Auto Loader where different source file formats were inconsistent when the provided schema did not include inferred partitions. This issue could cause unexpected failures when reading files with missing columns in the inferred partition schema.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-37520">[SPARK-37520]</a> Add the <code class="docutils literal notranslate"><span class="pre">startswith()</span></code> and <code class="docutils literal notranslate"><span class="pre">endswith()</span></code> string functions</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43413">[SPARK-43413]</a> Fixed <code class="docutils literal notranslate"><span class="pre">IN</span></code> subquery <code class="docutils literal notranslate"><span class="pre">ListQuery</span></code> nullability.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>May 17, 2023</p>
<ul>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>April 25, 2023</p>
<ul>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>April 11, 2023</p>
<ul>
<li><p>Fixed an issue where Auto Loader schema evolution can go into an infinite fail loop when a new column is detected in the schema of a nested JSON object.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42967">[SPARK-42967]</a> Fix SparkListenerTaskStart.stageAttemptId when a task is started after the stage is canceled.</p></li>
</ul>
</li>
<li><p>March 29, 2023</p>
<ul>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>March 14, 2023</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42484">[SPARK-42484]</a> Improved error message for <code class="docutils literal notranslate"><span class="pre">UnsafeRowUtils</span></code>.</p></li>
<li><p>Miscellaneous fixes.</p></li>
</ul>
</li>
<li><p>February 28, 2023</p>
<ul>
<li><p>Users can now read and write specific Delta tables requiring Reader version 3 and Writer version 7, using Databricks Runtime 9.1 LTS or later. To succeed, table features listed in the tables’ protocol must be supported by the current version of Databricks Runtime.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>February 16, 2023</p>
<ul>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>January 31, 2023</p>
<ul>
<li><p>Table types of JDBC tables are now EXTERNAL by default.</p></li>
</ul>
</li>
<li><p>January 18, 2023</p>
<ul>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>November 29, 2022</p>
<ul>
<li><p>Fixed an issue with JSON parsing in Auto Loader when all columns were left as strings (<code class="docutils literal notranslate"><span class="pre">cloudFiles.inferColumnTypes</span></code> was not set or set to <code class="docutils literal notranslate"><span class="pre">false</span></code>) and the JSON contained nested objects.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>November 15, 2022</p>
<ul>
<li><p>Upgraded Apache commons-text to 1.10.0.</p></li>
<li><p>Operating system security updates.</p></li>
<li><p>Miscellaneous fixes.</p></li>
</ul>
</li>
<li><p>November 1, 2022</p>
<ul>
<li><p>Fixed an issue where if a Delta table had a user-defined column named <code class="docutils literal notranslate"><span class="pre">_change_type</span></code>, but <strong>Change data feed</strong> was turned off on that table, data in that column would incorrectly fill with NULL values when running <code class="docutils literal notranslate"><span class="pre">MERGE</span></code>.</p></li>
<li><p>Fixed an issue with Auto Loader where a file can be duplicated in the same micro-batch when <code class="docutils literal notranslate"><span class="pre">allowOverwrites</span></code> is enabled</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40596">[SPARK-40596]</a> Populate ExecutorDecommission with messages in ExecutorDecommissionInfo</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>October 18, 2022</p>
<ul>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>October 5, 2022</p>
<ul>
<li><p>Miscellaneous fixes.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>September 22, 2022</p>
<ul>
<li><p>Users can set spark.conf.set(“spark.databricks.io.listKeysWithPrefix.azure.enabled”, “true”) to re-enable the built-in listing for Auto Loader on ADLS Gen2. Built-in listing was previously turned off due to performance issues but can have led to increased storage costs for customers.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40315">[SPARK-40315]</a> Add hashCode() for Literal of ArrayBasedMapData</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40089">[SPARK-40089]</a> Fix sorting for some Decimal types</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39887">[SPARK-39887]</a> RemoveRedundantAliases should keep aliases that make the output of projection nodes unique</p></li>
</ul>
</li>
<li><p>September 6, 2022</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40235">[SPARK-40235]</a> Use interruptible lock instead of synchronized in Executor.updateDependencies()</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-35542">[SPARK-35542]</a> Fix: Bucketizer created for multiple columns with parameters splitsArray, inputCols and outputCols can not be loaded after saving it</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40079">[SPARK-40079]</a> Add Imputer inputCols validation for empty input case</p></li>
</ul>
</li>
<li><p>August 24, 2022</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39666">[SPARK-39666]</a> Use UnsafeProjection.create to respect <code class="docutils literal notranslate"><span class="pre">spark.sql.codegen.factoryMode</span></code> in ExpressionEncoder</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39962">[SPARK-39962]</a> Apply projection when group attributes are empty</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>August 9, 2022</p>
<ul>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>July 27, 2022</p>
<ul>
<li><p>Make Delta MERGE operation results consistent when the source is non-deterministic.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39689">[SPARK-39689]</a> Support for 2-chars <code class="docutils literal notranslate"><span class="pre">lineSep</span></code> in CSV data source</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39575">[SPARK-39575]</a> Added <code class="docutils literal notranslate"><span class="pre">ByteBuffer#rewind</span></code> after <code class="docutils literal notranslate"><span class="pre">ByteBuffer#get</span></code> in <code class="docutils literal notranslate"><span class="pre">AvroDeserializer</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-37392">[SPARK-37392]</a> Fixed the performance error for catalyst optimizer.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>July 13, 2022</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39419">[SPARK-39419]</a> <code class="docutils literal notranslate"><span class="pre">ArraySort</span></code> throws an exception when the comparator returns null.</p></li>
<li><p>Turned off Auto Loader’s use of built-in cloud APIs for directory listing on Azure.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>July 5, 2022</p>
<ul>
<li><p>Operating system security updates.</p></li>
<li><p>Miscellaneous fixes.</p></li>
</ul>
</li>
<li><p>June 15, 2022</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39283">[SPARK-39283]</a> Fix deadlock between <code class="docutils literal notranslate"><span class="pre">TaskMemoryManager</span></code> and <code class="docutils literal notranslate"><span class="pre">UnsafeExternalSorter.SpillableIterator</span></code>.</p></li>
</ul>
</li>
<li><p>June 2, 2022</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-34554">[SPARK-34554]</a> Implement the <code class="docutils literal notranslate"><span class="pre">copy()</span></code> method in <code class="docutils literal notranslate"><span class="pre">ColumnarMap</span></code>.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>May 18, 2022</p>
<ul>
<li><p>Fixed a potential built-in memory leak in Auto Loader.</p></li>
<li><p>Upgrade AWS SDK version from 1.11.655 to 1.11.678.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38918">[SPARK-38918]</a> Nested column pruning should filter out attributes that do not belong to the current relation</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39084">[SPARK-39084]</a> Fix <code class="docutils literal notranslate"><span class="pre">df.rdd.isEmpty()</span></code> by using <code class="docutils literal notranslate"><span class="pre">TaskContext</span></code> to stop iterator on task completion</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>April 19, 2022</p>
<ul>
<li><p>Operating system security updates.</p></li>
<li><p>Miscellaneous fixes.</p></li>
</ul>
</li>
<li><p>April 6, 2022</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38631">[SPARK-38631]</a> Uses Java-based implementation for un-tarring at Utils.unpack</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>March 22, 2022</p>
<ul>
<li><p>Changed the current working directory of notebooks on High Concurrency clusters with either table access control or credential passthrough enabled to the user’s home directory. Previously, the active directory was <code class="docutils literal notranslate"><span class="pre">/databricks/driver</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38437">[SPARK-38437]</a> Lenient serialization of datetime from datasource</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38180">[SPARK-38180]</a> Allow safe up-cast expressions in correlated equality predicates</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38155">[SPARK-38155]</a> Disallow distinct aggregate in lateral subqueries with unsupported predicates</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-27442">[SPARK-27442]</a> Removed a check field when reading or writing data in a parquet.</p></li>
</ul>
</li>
<li><p>March 14, 2022</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38236">[SPARK-38236]</a> Absolute file paths specified in the create/alter table are treated as relative</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-34069">[SPARK-34069]</a> Interrupt task thread if local property <code class="docutils literal notranslate"><span class="pre">SPARK_JOB_INTERRUPT_ON_CANCEL</span></code> is set to true.</p></li>
</ul>
</li>
<li><p>February 23, 2022</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-37859">[SPARK-37859]</a> SQL tables created with JDBC with Spark 3.1 are not readable with Spark 3.2.</p></li>
</ul>
</li>
<li><p>February 8, 2022</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-27442">[SPARK-27442]</a> Removed a check field when reading or writing data in a parquet.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>February 1, 2022</p>
<ul>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>January 26, 2022</p>
<ul>
<li><p>Fixed an issue where concurrent transactions on Delta tables could commit in a non-serializable order under certain rare conditions.</p></li>
<li><p>Fixed an issue where the <code class="docutils literal notranslate"><span class="pre">OPTIMIZE</span></code> command could fail when the ANSI SQL dialect was enabled.</p></li>
</ul>
</li>
<li><p>January 19, 2022</p>
<ul>
<li><p>Minor fixes and security enhancements.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>November 4, 2021</p>
<ul>
<li><p>Fixed an issue that could cause Structured Streaming streams to fail with an <code class="docutils literal notranslate"><span class="pre">ArrayIndexOutOfBoundsException</span></code>.</p></li>
<li><p>Fixed a race condition that might cause a query failure with an IOException like <code class="docutils literal notranslate"><span class="pre">java.io.IOException:</span> <span class="pre">No</span> <span class="pre">FileSystem</span> <span class="pre">for</span> <span class="pre">scheme</span></code> or that might cause modifications to <code class="docutils literal notranslate"><span class="pre">sparkContext.hadoopConfiguration</span></code> to not take effect in queries.</p></li>
<li><p>The Apache Spark Connector for Delta Sharing was upgraded to 0.2.0.</p></li>
</ul>
</li>
<li><p>October 20, 2021</p>
<ul>
<li><p>Upgraded BigQuery connector from 0.18.1 to 0.22.2. This adds support for the BigNumeric type.</p></li>
</ul>
</li>
</ul>
</div>
</div>
</div>


    
          </div>
        </div>
        <div  class="suapp-rating">
  <div id="suPageRateApp">
     <su-app></su-app>
   </div> 
 </div>
<hr> 
<footer>
  <div role="contentinfo">
      <p class="copyright">
          &copy; Databricks 2023. All rights reserved. Apache, Apache Spark, Spark, and the Spark logo are trademarks of the <a href="http://www.apache.org/">Apache Software Foundation</a>.
      </p>
      <p> 
        
          <a id='feedbacklink' href="mailto:doc-feedback@databricks.com?subject=Documentation Feedback">Send us feedback</a>
        
     | <a href="https://databricks.com/privacy-policy">Privacy Policy</a> | <a href="https://databricks.com/terms-of-use">Terms of Use</a></p>

  </div> 

</footer>
      </div>
    </div>
  </section>
</main>

  </page>
  
  <script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
      URL_ROOT: '../../',
      VERSION: '1.0',
      COLLAPSE_INDEX: false,
      FILE_SUFFIX: '.html',
      HAS_SOURCE: 'false'
    };
  </script>
  <script type="text/javascript" src="../../_static/jquery.js"></script>
  <script type="text/javascript" src="../../_static/underscore.js"></script>
  <script type="text/javascript" src="../../_static/doctools.js"></script>
  <script type="text/javascript" src="../../_static/language_data.js"></script>
  

  <script type="text/javascript" src="../../_static/js/clipboard.min.js"></script>
  <script type="text/javascript" src="../../_static/js/jquery.waypoints.min.js"></script>

  <!-- Select2 (https://select2.org/) -->
  <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
  <!-- End Select2 -->

  
  
  <script type="text/javascript" src="../../_static/js/localized.js"></script>
  <script type="text/javascript" src="../../_static/js/custom.js"></script>
  

  
  
  <script type="text/javascript">
    jQuery(function () {
      SphinxRtdTheme.StickyNav.enable();
    });

  </script>
  
 



  <script>
  window.__searchunifyLoaderConfig = JSON.parse('{"clients": {"en": "02c2e804-27e9-11ee-aefb-0242ac120011", "ja": "6a42c3f2-2820-11ee-aefb-0242ac120011", "pt": "6a86badd-2821-11ee-aefb-0242ac120011"}}')
</script>
<script type="text/javascript" src="../../_static/js/search-loader.js"></script>
</body>
<script type='text/javascript'>
  window.onload = function () {
    var description = document.querySelector('meta[name="description"]').getAttribute("content");
    let titleText = document.querySelector('h1').textContent;
    document.querySelector('meta[property="og:title"]').setAttribute("content", titleText);
    document.querySelector('meta[property="og:description"]').setAttribute("content", description);
    document.querySelector('meta[property="twitter:description"]').setAttribute("content", description);
  };
</script>

</html>