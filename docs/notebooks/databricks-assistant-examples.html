

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en-US" > <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en-US"> <!--<![endif]-->

<head>
  <!-- cookie consent -->
  
    <!-- Combined Onetrust and Rudderstack Implementation Scripts -->
    <!-- Onetrust Initialization -->
    <script type="text/javascript" src="https://cdn.cookielaw.org/consent/92466579-1717-44d3-809d-a05fb02843ed-test/OtAutoBlock.js"></script>
    <script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" data-document-language="true" type="text/javascript" charset="UTF-8" data-domain-script="92466579-1717-44d3-809d-a05fb02843ed-test"></script>
    <link rel="stylesheet" id="db-onetrust-style" href="https://www.databricks.com/wp-content/uploads/db_onetrust.css" media="all" />
    <!-- Setting Rudderstack Write Key -->
    <script>window.rudderstackKey = "2SOR9fvSr5Fi6tN2ihPbVHnX1SZ" </script>
    <!-- Rudderstack Initialization + Onetrust Integration + Rudderstack Custom Events -->
    <script type="text/javascript" src="https://www.databricks.com/sites/default/files/rudderstack/v1/db-rudderstack-events.js"></script>

  <!-- cookie consent -->

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="X-UA-Compatible" content="IE=9" />
  <meta content="Sample prompts for Databricks Assistant." name="description" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
  <meta property="og:image" content="https://www.databricks.com/wp-content/uploads/2020/04/og-databricks.png">
  <meta property="og:image:type" content="image/png">
  <meta property="og:title" content="Databricks Assistant: sample tasks">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://docs.databricks.com">
  <meta property="og:description" content="" id="og-description">
  <meta name="twitter:image" content="https://www.databricks.com/wp-content/uploads/2020/04/og-databricks.png">
  <meta name="twitter:site" content="@databricks">
  <meta name="twitter:creator" content="@databricks">
  <meta property="twitter:description" content="">
  
  <title>Databricks Assistant: sample tasks &#124; Databricks on AWS</title>
  
  
  <link rel="canonical" href="https://docs.databricks.com/en/notebooks/databricks-assistant-examples.html">
  <!-- Start hreflang tag -->
  <link rel="alternate" hreflang="en" href="https://docs.databricks.com/en/notebooks/databricks-assistant-examples.html" />
<link rel="alternate" hreflang="x-default" href="https://docs.databricks.com/en/notebooks/databricks-assistant-examples.html" />
  <!-- End hreflang tag -->
  
  
  <link rel="shortcut icon" href="../_static/favicon.ico" />
  

  

  

  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;
j.setAttributeNode(d.createAttribute('data-ot-ignore'));
f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-T85FQ33');</script>
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;
j.setAttributeNode(d.createAttribute('data-ot-ignore'));
f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-TWTKQQ');</script>
    
  <!-- End Google Tag Manager -->


  <!-- MaxMind / GEO IP -->
  <script src="//js.maxmind.com/js/apis/geoip2/v2.1/geoip2.js" type="text/javascript"></script>
  <!-- End MaxMind / GEO IP -->

  
  
  <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600&display=swap" rel="stylesheet">
  <link rel="preload" href="../_static/fonts/DMSans-Bold.ttf" as="font">
  <link rel="preload" href="../_static/fonts/DMSans-Regular.ttf" as="font">
  <link rel="preload" href="../_static/fonts/DMMono-Regular.ttf" as="font">
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/cloud-provider-selector.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/translation-selector.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/searchunify/main.css" type="text/css" />

  
  <link rel="index" title="Index" href="../genindex.html" />
  <link rel="search" title="Search" href="../search.html" />
  <link rel="top" title="Databricks on AWS" href="../index.html" /> 
</head>

<body class="wy-body-for-nav" role="document">

  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T85FQ33"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TWTKQQ"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->

  
  <nav class="wy-nav-top header su_header" role="navigation" aria-label="top navigation">
    
<nav class="wy-nav-top header su_header" role="navigation" aria-label="top navigation">
  <div class="container-logo">
    <ul class="mobile-menu-toggle">
        <li class="menu-toggle">
            <i data-toggle="wy-nav-top" class="wy-nav-top-menu-button db-icon db-icon-menu pull-left"></i>
            
            <a href="https://www.databricks.com/" class="wy-nav-top-logo"><img src="../_static/small-scale-lockup-full-color-rgb.svg" width="137" height="21"
              alt="Databricks" /></a>   
               
              </li>
    </ul>
    <ul class="su_nav-menu">
      <li class="menu-toggle">
        <i data-toggle="wy-nav-top" class="wy-nav-top-menu-button db-icon db-icon-menu pull-left"></i>
        
          
        
        <a href="https://www.databricks.com/" class="wy-nav-top-logo"><img src="../_static/small-scale-lockup-full-color-rgb.svg" width="137" height="21"
            alt="Databricks" /></a></li>
        <!-- 
<li><a href="https://help.databricks.com/s/">Help Center</a></li>
<li class="active"><a href="https://docs.databricks.com/en/">Documentation</a></li>
<li><a href="https://kb.databricks.com/">Knowledge Base</a></li>
 -->
    </ul>
  </div>
  <div class="su_nav-right">
    <ul class="su_link-mobile">
  <!-- Mobile header code can go here -->
</ul>
<ul class="right-try-list">
   
</ul>
  </div>
</nav>
  </nav>

  <div class="su_sub-header">
    <div class="container">
      <div class="su_sub-header-inner">
        <!-- <div class="su_subnav-menu-right">
  <div id="auto" style="width: 100%;">
    <div ng-controller="SearchautoController">
      <div bind-html-compile="autocompleteHtml">
        <form class="su__search-box-1" disabled="disabled">
          <input class="su__search-input" type="search" name="Search box" id="su__search-b" placeholder="Search Documentation" disabled="disabled"/>
          <button class="su__search-button" type="submit" class="button button-success" disabled="disabled">
            <svg width="24" height="24" viewBox="0 0 24 24">
              <path
                d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"
                fill="#333"></path>
            </svg>
          </button>
        </form>
      </div>
    </div>
  </div>
</div> -->
        <div class="search-lng-gap"></div>
        <div style="margin-left: 16px; margin-right: 16px;">
          <!-- <select name="lng selector" id="lng-selector">
    <option value="../../en/notebooks/databricks-assistant-examples.html" class="notranslate">English</option>
    <option value="../../ja/notebooks/databricks-assistant-examples.html" class="notranslate">日本語</option>
    <option value="../../pt/notebooks/databricks-assistant-examples.html" class="notranslate">Português (Brasil)</option>
</select> -->
        </div>
        <div class="cloud-selector-container">
          <!-- <select name="cloud provider selector" id="cloud-provider-selector">
    <option value="aws" selected class="notranslate">
        Amazon Web Services
    </option>
    <option value="azure"  class="notranslate">
        Microsoft Azure
    </option>
    <option value="gcp"  class="notranslate">
        Google Cloud Platform
    </option>
</select> -->
        </div>
      </div>
    </div>
  </div>
  <page class="js-page-container">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side su_nav-side">
<div class="wy-side-scroll">
  <div class="wy-side-nav-search">
    

    

    

    
  </div>

  <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
    
      <a href="../index.html" class="main-navigation-home">Databricks on AWS</a>
    

    
      

      
        <p class="caption"><span class="caption-text">Load &amp; manage data</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../rag-temp/index.html">RAG Studio</a></li>
</ul>

      
    
  </div>

  <div role="contentinfo">
    
  <p class="build_info notranslate"data-last-edit="December 23, 2023">
    Updated Jan 11, 2024
  </p>
<script>
  window.addEventListener('DOMContentLoaded',function(){
    var h1=document.querySelector('h1');
    var bi=document.querySelector('[data-last-edit]');
    if(h1 && bi){
      var ver = document.createElement('p');
      ver.className = 'version_info';
      ver.textContent = bi.getAttribute('data-last-edit');
      h1.parentElement.insertBefore(ver, h1.nextElementSibling);
    }
  });
</script>

    <p>
      
        <a id='feedbacklink' href="mailto:doc-feedback@databricks.com?subject=Documentation Feedback">Send us feedback</a>
      
    </p>
  </div>
</div>
</nav>
    
    
<main class="wy-grid-for-nav su_nav-grid">
  <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
    <div class="wy-nav-content su__nav_content">
      <div class="rst-content">
        





<div role="navigation" aria-label="breadcrumbs navigation" class="wy-breadcrumbs-wrapper">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Documentation</a> <span class="db-icon db-icon-chevron-right"></span></li>
    
    
      <li>Databricks Assistant: sample tasks</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>
</div>
        
        <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
          <div itemprop="articleBody">
            
    
  <div class="section" id="databricks-assistant-sample-tasks">
<h1>Databricks Assistant: sample tasks<a class="headerlink" href="#databricks-assistant-sample-tasks" title="Permalink to this headline"> </a></h1>
<div class="preview admonition">
<p class="admonition-title">Preview</p>
<p>This feature is in <a class="reference internal" href="../release-notes/release-types.html"><span class="doc">Public Preview</span></a>.</p>
</div>
<p>Databricks Assistant works as an AI-based companion pair-programmer to make you more efficient as you create notebooks, queries, and files. It can help you rapidly answer questions by generating, optimizing, completing, explaining, and fixing code and queries.</p>
<p>You can also use Databricks Assistant to generate visualizations for Lakeview dashboards. To learn how to use the Assistant for generating visualizations, see <a class="reference internal" href="../dashboards/lakeview-create-w-db-assistant.html"><span class="doc">Create visualizations with Databricks Assistant for Lakeview</span></a>.</p>
<p>For general information about Databricks Assistant, see <a class="reference internal" href="databricks-assistant-faq.html"><span class="doc">Databricks Assistant FAQ</span></a>.</p>
<p>The prompt you provide can significantly change the output of the assistant. Try adding one of the following to your prompts:</p>
<ul class="simple">
<li><p>“No explanatory text” when generating code.</p></li>
<li><p>“Explain the code to me step by step”.</p></li>
<li><p>“Show me two/three options that I can try”.</p></li>
<li><p>“Be concise”.</p></li>
</ul>
<p>You can also experiment with the following types of queries:</p>
<ul class="simple">
<li><p>Write a SQL UDF to reverse a string.</p></li>
<li><p>Add a date filter to this query to restrict results to the last 30 days.</p></li>
<li><p>Help me plot a graph from the results of a SQL query. The query results are in the format of a Pandas DataFrame. The x-axis should be labeled ‘Week’ and the y-axis should be labeled ‘Distinct weekly users’.</p></li>
</ul>
<div class="section" id="generate-code-examples">
<h2>Generate code examples<a class="headerlink" href="#generate-code-examples" title="Permalink to this headline"> </a></h2>
<div class="section" id="analyze-data">
<h3>Analyze data<a class="headerlink" href="#analyze-data" title="Permalink to this headline"> </a></h3>
<p><strong>Starting code:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Read the sample NYC Taxi Trips dataset and load it into a DataFrame</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="s1">&#39;samples.nyctaxi.trips&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Assistant prompt:</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>generate pandas code to convert the pyspark dataframe to a pandas dataframe and select the 10 most expensive trips from df based on the fare_amount column
</pre></div>
</div>
</div>
<div class="section" id="create-a-dataframe-reader">
<h3>Create a DataFrame reader<a class="headerlink" href="#create-a-dataframe-reader" title="Permalink to this headline"> </a></h3>
<p><strong>Starting code:</strong></p>
<p>View the data in the bikeSharing dataset.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">dbutils</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">ls</span><span class="p">(</span><span class="s2">&quot;dbfs:/databricks-datasets/bikeSharing/data-001/&quot;</span><span class="p">))</span>
</pre></div>
</div>
<p><strong>Assistant prompt:</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Generate code to read the day.csv file in the bikeSharing dataset
</pre></div>
</div>
</div>
</div>
<div class="section" id="transform-or-optimize-code-examples">
<h2>Transform or optimize code examples<a class="headerlink" href="#transform-or-optimize-code-examples" title="Permalink to this headline"> </a></h2>
<div class="section" id="translate-pandas-to-pyspark">
<h3>Translate Pandas to PySpark<a class="headerlink" href="#translate-pandas-to-pyspark" title="Permalink to this headline"> </a></h3>
<p><strong>Starting code:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Convert Spark DataFrame to Pandas DataFrame</span>
<span class="n">pdf</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">toPandas</span><span class="p">()</span>

<span class="c1"># Select the 10 most expensive trips based on the fare_amount column</span>
<span class="n">most_expensive_trips</span> <span class="o">=</span> <span class="n">pdf</span><span class="o">.</span><span class="n">nlargest</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;fare_amount&#39;</span><span class="p">)</span>

<span class="c1"># Show the result</span>
<span class="n">most_expensive_trips</span>
</pre></div>
</div>
<p><strong>Assistant prompt:</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>convert this code to PySpark
</pre></div>
</div>
</div>
<div class="section" id="generate-more-efficient-code">
<h3>Generate more efficient code<a class="headerlink" href="#generate-more-efficient-code" title="Permalink to this headline"> </a></h3>
<p><strong>Assistant prompt:</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Show me a code example of inefficient python code, explain why it is inefficient, and then show me an improved version of that code that is more efficient. Explain why it is more efficient, then give me a list of strings to test this out with and the code to benchmark trying each one out.
</pre></div>
</div>
<p><strong>Assistant prompt:</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Write me a function to benchmark the execution of code in this cell, then give me another way to write this code that is more efficient and would perform better in the benchmark.
</pre></div>
</div>
</div>
</div>
<div class="section" id="complete-code-examples">
<span id="assistant-code-complete"></span><h2>Complete code examples<a class="headerlink" href="#complete-code-examples" title="Permalink to this headline"> </a></h2>
<p>You can use Databricks Assistant to generate code from comments in a cell.</p>
<ul class="simple">
<li><p>On macOS, press <code class="docutils literal notranslate"><span class="pre">shift</span></code> + <code class="docutils literal notranslate"><span class="pre">option</span></code> + <code class="docutils literal notranslate"><span class="pre">space</span></code> or <code class="docutils literal notranslate"><span class="pre">control</span></code> + <code class="docutils literal notranslate"><span class="pre">option</span></code> + <code class="docutils literal notranslate"><span class="pre">space</span></code> directly in a cell.</p></li>
<li><p>On Windows, press <code class="docutils literal notranslate"><span class="pre">ctrl</span></code> + <code class="docutils literal notranslate"><span class="pre">shift</span></code> + <code class="docutils literal notranslate"><span class="pre">space</span></code> directly in a cell.</p></li>
</ul>
<p>To accept the suggested code, press <code class="docutils literal notranslate"><span class="pre">tab</span></code>.</p>
<div class="section" id="reverse-a-string">
<h3>Reverse a string<a class="headerlink" href="#reverse-a-string" title="Permalink to this headline"> </a></h3>
<p><strong>Starting code:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write code to reverse a string.</span>
</pre></div>
</div>
</div>
<div class="section" id="perform-exploratory-data-analysis">
<h3>Perform exploratory data analysis<a class="headerlink" href="#perform-exploratory-data-analysis" title="Permalink to this headline"> </a></h3>
<p><strong>Starting code:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load the wine dataset into a DataFrame from sklearn, bucket the data into 3 groups by quality, then visualize in a plotly barchart.</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="explain-code-examples">
<h2>Explain code examples<a class="headerlink" href="#explain-code-examples" title="Permalink to this headline"> </a></h2>
<div class="section" id="basic-code-explanation">
<h3>Basic code explanation<a class="headerlink" href="#basic-code-explanation" title="Permalink to this headline"> </a></h3>
<p><strong>Starting code:</strong></p>
<p>PySpark code that gets the total number of trips and sum of the fare amounts between the pickup and dropoff zip codes.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyspark.sql.functions</span> <span class="k">as</span> <span class="nn">F</span>

<span class="n">fare_by_route</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupBy</span><span class="p">(</span>
<span class="s1">&#39;pickup_zip&#39;</span><span class="p">,</span> <span class="s1">&#39;dropoff_zip&#39;</span>
<span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span>
    <span class="n">F</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;fare_amount&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s1">&#39;total_fare&#39;</span><span class="p">),</span>
    <span class="n">F</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;fare_amount&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s1">&#39;num_trips&#39;</span><span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s1">&#39;num_trips&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">desc</span><span class="p">())</span>

<span class="n">display</span><span class="p">(</span><span class="n">fare_by_route</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Assistant prompt:</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Explain what this code does
</pre></div>
</div>
</div>
<div class="section" id="fast-documentation-lookups">
<h3>Fast documentation lookups<a class="headerlink" href="#fast-documentation-lookups" title="Permalink to this headline"> </a></h3>
<p><strong>Assistant prompt:</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>When should I use repartition() vs. coalesce() in Apache Spark?
</pre></div>
</div>
<p><strong>Assistant prompt:</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>What is the difference between the various pandas_udf functions (in PySpark and Pandas on Spark/Koalas) and when should I choose each?  Can you show me an example of each with the diamonds dataset?
</pre></div>
</div>
</div>
</div>
<div class="section" id="fix-code-examples">
<h2>Fix code examples<a class="headerlink" href="#fix-code-examples" title="Permalink to this headline"> </a></h2>
<div class="section" id="debugging">
<h3>Debugging<a class="headerlink" href="#debugging" title="Permalink to this headline"> </a></h3>
<p><strong>Starting code:</strong></p>
<p>This is the same code used in the <a class="reference internal" href="#basic-code-explanation"><span class="std std-ref">basic code explanation example</span></a>, but missing the import statement. It throws the error “This throws the error: NameError: name ‘F’ is not defined”.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fare_by_route</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupBy</span><span class="p">(</span>
<span class="s1">&#39;pickup_zip&#39;</span><span class="p">,</span> <span class="s1">&#39;dropoff_zip&#39;</span>
<span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span>
    <span class="n">F</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;fare_amount&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s1">&#39;total_fare&#39;</span><span class="p">),</span>
    <span class="n">F</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;fare_amount&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s1">&#39;num_trips&#39;</span><span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s1">&#39;num_trips&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">desc</span><span class="p">())</span>

<span class="n">display</span><span class="p">(</span><span class="n">fare_by_route</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Assistant prompt:</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>How do I fix this error? What is &#39;F&#39;?
</pre></div>
</div>
</div>
<div class="section" id="help-with-errors">
<h3>Help with errors<a class="headerlink" href="#help-with-errors" title="Permalink to this headline"> </a></h3>
<p><strong>Starting code:</strong></p>
<p>This code throws the error “AnalysisException: [UNRESOLVED_COLUMN.WITH_SUGGESTION]”.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyspark.sql.functions</span> <span class="kn">import</span> <span class="n">col</span>

<span class="c1"># create a dataframe with two columns: a and b</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="n">col</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">))</span>

<span class="c1"># try to select a non-existing column c</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p><strong>Assistant prompt:</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Why am I getting this error and how do I fix it?
</pre></div>
</div>
</div>
</div>
</div>


    
          </div>
        </div>
        <div  class="suapp-rating">
  <div id="suPageRateApp">
     <su-app></su-app>
   </div> 
 </div>
<hr> 
<footer>
  <div role="contentinfo">
      <p class="copyright">
          &copy; Databricks 2023. All rights reserved. Apache, Apache Spark, Spark, and the Spark logo are trademarks of the <a href="http://www.apache.org/">Apache Software Foundation</a>.
      </p>
      <p> 
        
          <a id='feedbacklink' href="mailto:doc-feedback@databricks.com?subject=Documentation Feedback">Send us feedback</a>
        
     | <a href="https://databricks.com/privacy-policy">Privacy Policy</a> | <a href="https://databricks.com/terms-of-use">Terms of Use</a></p>

  </div> 

</footer>
      </div>
    </div>
  </section>
</main>

  </page>
  
  <script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
      URL_ROOT: '../',
      VERSION: '1.0',
      COLLAPSE_INDEX: false,
      FILE_SUFFIX: '.html',
      HAS_SOURCE: 'false'
    };
  </script>
  <script type="text/javascript" src="../_static/jquery.js"></script>
  <script type="text/javascript" src="../_static/underscore.js"></script>
  <script type="text/javascript" src="../_static/doctools.js"></script>
  <script type="text/javascript" src="../_static/language_data.js"></script>
  

  <script type="text/javascript" src="../_static/js/clipboard.min.js"></script>
  <script type="text/javascript" src="../_static/js/jquery.waypoints.min.js"></script>

  <!-- Select2 (https://select2.org/) -->
  <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
  <!-- End Select2 -->

  
  
  <script type="text/javascript" src="../_static/js/localized.js"></script>
  <script type="text/javascript" src="../_static/js/custom.js"></script>
  

  
  
  <script type="text/javascript">
    jQuery(function () {
      SphinxRtdTheme.StickyNav.enable();
    });

  </script>
  
 



  <script>
  window.__searchunifyLoaderConfig = JSON.parse('{"clients": {"en": "02c2e804-27e9-11ee-aefb-0242ac120011", "ja": "6a42c3f2-2820-11ee-aefb-0242ac120011", "pt": "6a86badd-2821-11ee-aefb-0242ac120011"}}')
</script>
<script type="text/javascript" src="../_static/js/search-loader.js"></script>
</body>
<script type='text/javascript'>
  window.onload = function () {
    var description = document.querySelector('meta[name="description"]').getAttribute("content");
    let titleText = document.querySelector('h1').textContent;
    document.querySelector('meta[property="og:title"]').setAttribute("content", titleText);
    document.querySelector('meta[property="og:description"]').setAttribute("content", description);
    document.querySelector('meta[property="twitter:description"]').setAttribute("content", description);
  };
</script>

</html>