

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en-US" > <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en-US"> <!--<![endif]-->

<head>
  <!-- cookie consent -->
  
    <!-- Combined Onetrust and Rudderstack Implementation Scripts -->
    <!-- Onetrust Initialization -->
    <script type="text/javascript" src="https://cdn.cookielaw.org/consent/92466579-1717-44d3-809d-a05fb02843ed-test/OtAutoBlock.js"></script>
    <script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" data-document-language="true" type="text/javascript" charset="UTF-8" data-domain-script="92466579-1717-44d3-809d-a05fb02843ed-test"></script>
    <link rel="stylesheet" id="db-onetrust-style" href="https://www.databricks.com/wp-content/uploads/db_onetrust.css" media="all" />
    <!-- Setting Rudderstack Write Key -->
    <script>window.rudderstackKey = "2SOR9fvSr5Fi6tN2ihPbVHnX1SZ" </script>
    <!-- Rudderstack Initialization + Onetrust Integration + Rudderstack Custom Events -->
    <script type="text/javascript" src="https://www.databricks.com/sites/default/files/rudderstack/v1/db-rudderstack-events.js"></script>

  <!-- cookie consent -->

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="X-UA-Compatible" content="IE=9" />
  <meta content="Call a Databricks notebook from another notebook." name="description" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
  <meta property="og:image" content="https://www.databricks.com/wp-content/uploads/2020/04/og-databricks.png">
  <meta property="og:image:type" content="image/png">
  <meta property="og:title" content="Run a Databricks notebook from another notebook">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://docs.databricks.com">
  <meta property="og:description" content="" id="og-description">
  <meta name="twitter:image" content="https://www.databricks.com/wp-content/uploads/2020/04/og-databricks.png">
  <meta name="twitter:site" content="@databricks">
  <meta name="twitter:creator" content="@databricks">
  <meta property="twitter:description" content="">
  
  <title>Run a Databricks notebook from another notebook &#124; Databricks on AWS</title>
  
  
  <link rel="canonical" href="https://docs.databricks.com/en/notebooks/notebook-workflows.html">
  <!-- Start hreflang tag -->
  <link rel="alternate" hreflang="en" href="https://docs.databricks.com/en/notebooks/notebook-workflows.html" />
<link rel="alternate" hreflang="x-default" href="https://docs.databricks.com/en/notebooks/notebook-workflows.html" />
  <!-- End hreflang tag -->
  
  
  <link rel="shortcut icon" href="../_static/favicon.ico" />
  

  

  

  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;
j.setAttributeNode(d.createAttribute('data-ot-ignore'));
f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-T85FQ33');</script>
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;
j.setAttributeNode(d.createAttribute('data-ot-ignore'));
f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-TWTKQQ');</script>
    
  <!-- End Google Tag Manager -->


  <!-- MaxMind / GEO IP -->
  <script src="//js.maxmind.com/js/apis/geoip2/v2.1/geoip2.js" type="text/javascript"></script>
  <!-- End MaxMind / GEO IP -->

  
  
  <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600&display=swap" rel="stylesheet">
  <link rel="preload" href="../_static/fonts/DMSans-Bold.ttf" as="font">
  <link rel="preload" href="../_static/fonts/DMSans-Regular.ttf" as="font">
  <link rel="preload" href="../_static/fonts/DMMono-Regular.ttf" as="font">
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/cloud-provider-selector.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/translation-selector.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/searchunify/main.css" type="text/css" />

  
  <link rel="index" title="Index" href="../genindex.html" />
  <link rel="search" title="Search" href="../search.html" />
  <link rel="top" title="Databricks on AWS" href="../index.html" /> 
</head>

<body class="wy-body-for-nav" role="document">

  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T85FQ33"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TWTKQQ"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->

  
  <nav class="wy-nav-top header su_header" role="navigation" aria-label="top navigation">
    
<nav class="wy-nav-top header su_header" role="navigation" aria-label="top navigation">
  <div class="container-logo">
    <ul class="mobile-menu-toggle">
        <li class="menu-toggle">
            <i data-toggle="wy-nav-top" class="wy-nav-top-menu-button db-icon db-icon-menu pull-left"></i>
            
            <a href="https://www.databricks.com/" class="wy-nav-top-logo"><img src="../_static/small-scale-lockup-full-color-rgb.svg" width="137" height="21"
              alt="Databricks" /></a>   
               
              </li>
    </ul>
    <ul class="su_nav-menu">
      <li class="menu-toggle">
        <i data-toggle="wy-nav-top" class="wy-nav-top-menu-button db-icon db-icon-menu pull-left"></i>
        
          
        
        <a href="https://www.databricks.com/" class="wy-nav-top-logo"><img src="../_static/small-scale-lockup-full-color-rgb.svg" width="137" height="21"
            alt="Databricks" /></a></li>
        <!-- 
<li><a href="https://help.databricks.com/s/">Help Center</a></li>
<li class="active"><a href="https://docs.databricks.com/en/">Documentation</a></li>
<li><a href="https://kb.databricks.com/">Knowledge Base</a></li>
 -->
    </ul>
  </div>
  <div class="su_nav-right">
    <ul class="su_link-mobile">
  <!-- Mobile header code can go here -->
</ul>
<ul class="right-try-list">
   
</ul>
  </div>
</nav>
  </nav>

  <div class="su_sub-header">
    <div class="container">
      <div class="su_sub-header-inner">
        <!-- <div class="su_subnav-menu-right">
  <div id="auto" style="width: 100%;">
    <div ng-controller="SearchautoController">
      <div bind-html-compile="autocompleteHtml">
        <form class="su__search-box-1" disabled="disabled">
          <input class="su__search-input" type="search" name="Search box" id="su__search-b" placeholder="Search Documentation" disabled="disabled"/>
          <button class="su__search-button" type="submit" class="button button-success" disabled="disabled">
            <svg width="24" height="24" viewBox="0 0 24 24">
              <path
                d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"
                fill="#333"></path>
            </svg>
          </button>
        </form>
      </div>
    </div>
  </div>
</div> -->
        <div class="search-lng-gap"></div>
        <div style="margin-left: 16px; margin-right: 16px;">
          <!-- <select name="lng selector" id="lng-selector">
    <option value="../../en/notebooks/notebook-workflows.html" class="notranslate">English</option>
    <option value="../../ja/notebooks/notebook-workflows.html" class="notranslate">日本語</option>
    <option value="../../pt/notebooks/notebook-workflows.html" class="notranslate">Português (Brasil)</option>
</select> -->
        </div>
        <div class="cloud-selector-container">
          <!-- <select name="cloud provider selector" id="cloud-provider-selector">
    <option value="aws" selected class="notranslate">
        Amazon Web Services
    </option>
    <option value="azure"  class="notranslate">
        Microsoft Azure
    </option>
    <option value="gcp"  class="notranslate">
        Google Cloud Platform
    </option>
</select> -->
        </div>
      </div>
    </div>
  </div>
  <page class="js-page-container">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side su_nav-side">
<div class="wy-side-scroll">
  <div class="wy-side-nav-search">
    

    

    

    
  </div>

  <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
    
      <a href="../index.html" class="main-navigation-home">Databricks on AWS</a>
    

    
      

      
        <p class="caption"><span class="caption-text">Load &amp; manage data</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../rag-temp/index.html">RAG Studio</a></li>
</ul>

      
    
  </div>

  <div role="contentinfo">
    
  <p class="build_info notranslate"data-last-edit="December 23, 2023">
    Updated Jan 11, 2024
  </p>
<script>
  window.addEventListener('DOMContentLoaded',function(){
    var h1=document.querySelector('h1');
    var bi=document.querySelector('[data-last-edit]');
    if(h1 && bi){
      var ver = document.createElement('p');
      ver.className = 'version_info';
      ver.textContent = bi.getAttribute('data-last-edit');
      h1.parentElement.insertBefore(ver, h1.nextElementSibling);
    }
  });
</script>

    <p>
      
        <a id='feedbacklink' href="mailto:doc-feedback@databricks.com?subject=Documentation Feedback">Send us feedback</a>
      
    </p>
  </div>
</div>
</nav>
    
    
<main class="wy-grid-for-nav su_nav-grid">
  <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
    <div class="wy-nav-content su__nav_content">
      <div class="rst-content">
        





<div role="navigation" aria-label="breadcrumbs navigation" class="wy-breadcrumbs-wrapper">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Documentation</a> <span class="db-icon db-icon-chevron-right"></span></li>
    
    
      <li>Run a Databricks notebook from another notebook</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>
</div>
        
        <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
          <div itemprop="articleBody">
            
    
  <div class="section" id="run-a-databricks-notebook-from-another-notebook">
<h1>Run a Databricks notebook from another notebook<a class="headerlink" href="#run-a-databricks-notebook-from-another-notebook" title="Permalink to this headline"> </a></h1>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>For notebook orchestration, use Databricks Jobs. For code modularization scenarios, use workspace files. You should only use the techniques described in this article when your use case cannot be implemented using a Databricks job, such as for looping notebooks over a dynamic set of parameters, or if you do not have access to <a class="reference internal" href="../files/workspace.html"><span class="doc">workspace files</span></a>. For more information, see <a class="reference internal" href="../workflows/jobs/create-run-jobs.html"><span class="doc">Databricks Jobs</span></a> and <a class="reference internal" href="share-code.html"><span class="doc">share code</span></a>.</p>
</div>
<div class="section" id="comparison-of-run-and-dbutilsnotebookrun">
<h2>Comparison of <code class="docutils literal notranslate"><span class="pre">%run</span></code> and <code class="docutils literal notranslate"><span class="pre">dbutils.notebook.run()</span></code><a class="headerlink" href="#comparison-of-run-and-dbutilsnotebookrun" title="Permalink to this headline"> </a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">%run</span></code> command allows you to include another notebook within a notebook. You can use <code class="docutils literal notranslate"><span class="pre">%run</span></code> to modularize your code, for example by putting supporting functions in a separate notebook. You can also use it to concatenate notebooks that implement the steps in an analysis. When you use <code class="docutils literal notranslate"><span class="pre">%run</span></code>, the called notebook is immediately executed and the functions and variables defined in it become available in the calling notebook.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">dbutils.notebook</span></code> API is a complement to <code class="docutils literal notranslate"><span class="pre">%run</span></code> because it lets you pass parameters to and return values from a notebook. This allows you to build complex workflows and pipelines with dependencies. For example, you can get a list of files in a directory and pass the names to another notebook, which is not possible with <code class="docutils literal notranslate"><span class="pre">%run</span></code>. You can also create if-then-else workflows based on return values or call other notebooks using relative paths.</p>
<p>Unlike <code class="docutils literal notranslate"><span class="pre">%run</span></code>, the <code class="docutils literal notranslate"><span class="pre">dbutils.notebook.run()</span></code> method starts a new job to run the notebook.</p>
<p>These methods, like all of the <code class="docutils literal notranslate"><span class="pre">dbutils</span></code> APIs, are available only in Python and Scala. However, you can use <code class="docutils literal notranslate"><span class="pre">dbutils.notebook.run()</span></code> to invoke an R notebook.</p>
</div>
<div class="section" id="use-run-to-import-a-notebook">
<span id="run"></span><h2>Use <code class="docutils literal notranslate"><span class="pre">%run</span></code> to import a notebook<a class="headerlink" href="#use-run-to-import-a-notebook" title="Permalink to this headline"> </a></h2>
<p>In this example, the first notebook defines a function, <code class="docutils literal notranslate"><span class="pre">reverse</span></code>, which is available in the second notebook after you use the <code class="docutils literal notranslate"><span class="pre">%run</span></code> magic to execute <code class="docutils literal notranslate"><span class="pre">shared-code-notebook</span></code>.</p>
<div class="figure align-default">
<img alt="Shared code notebook" src="../_images/shared-code-notebook.png" />
</div>
<div class="figure align-default">
<img alt="Notebook import example" src="../_images/notebook-import-example.png" />
</div>
<p>Because both of these notebooks are in the same directory in the workspace, use the prefix <code class="docutils literal notranslate"><span class="pre">./</span></code> in <code class="docutils literal notranslate"><span class="pre">./shared-code-notebook</span></code> to indicate that the path should be resolved relative to the currently running notebook. You can organize notebooks into directories, such as <code class="docutils literal notranslate"><span class="pre">%run</span> <span class="pre">./dir/notebook</span></code>, or use an absolute path like <code class="docutils literal notranslate"><span class="pre">%run</span> <span class="pre">/Users/username&#64;organization.com/directory/notebook</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">%run</span></code> must be in a cell <em>by itself</em>, because it runs the entire notebook inline.</p></li>
<li><p>You <em>cannot</em> use <code class="docutils literal notranslate"><span class="pre">%run</span></code> to run a Python file and <code class="docutils literal notranslate"><span class="pre">import</span></code> the entities defined in that file into a notebook. To import from a Python file, see <a class="reference internal" href="share-code.html#reference-source-code-files-using-git"><span class="std std-ref">Modularize your code using files</span></a>. Or, package the file into a Python library, create a Databricks <a class="reference internal" href="../libraries/index.html"><span class="doc">library</span></a> from that Python library, and <a class="reference internal" href="../libraries/cluster-libraries.html#install-libraries"><span class="std std-ref">install the library into the cluster</span></a> you use to run your notebook.</p></li>
<li><p>When you use <code class="docutils literal notranslate"><span class="pre">%run</span></code> to run a notebook that contains widgets, by default the specified notebook runs with the widget’s default values. You can also pass in values to widgets; see <a class="reference internal" href="widgets.html#widgets-and-percent-run"><span class="std std-ref">Use Databricks widgets with %run</span></a>.</p></li>
</ul>
</div>
</div>
<div class="section" id="dbutilsnotebook-api">
<h2><code class="docutils literal notranslate"><span class="pre">dbutils.notebook</span></code> API<a class="headerlink" href="#dbutilsnotebook-api" title="Permalink to this headline"> </a></h2>
<p>The methods available in the <code class="docutils literal notranslate"><span class="pre">dbutils.notebook</span></code> API are <code class="docutils literal notranslate"><span class="pre">run</span></code> and <code class="docutils literal notranslate"><span class="pre">exit</span></code>. Both parameters and return values must be strings.</p>
<p><strong><code class="docutils literal notranslate"><span class="pre">run(path:</span> <span class="pre">String,</span>&#160; <span class="pre">timeout_seconds:</span> <span class="pre">int,</span> <span class="pre">arguments:</span> <span class="pre">Map):</span> <span class="pre">String</span></code></strong></p>
<p>Run a notebook and return its exit value. The method starts an ephemeral job that runs immediately.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">timeout_seconds</span></code> parameter controls the timeout of the run (0 means no timeout): the call to
<code class="docutils literal notranslate"><span class="pre">run</span></code> throws an exception if it doesn’t finish within the specified time. If Databricks is down for more than 10 minutes,
the notebook run fails regardless of <code class="docutils literal notranslate"><span class="pre">timeout_seconds</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">arguments</span></code> parameter sets widget values of the target notebook. Specifically, if the notebook you are running has a widget
named <code class="docutils literal notranslate"><span class="pre">A</span></code>, and you pass a key-value pair <code class="docutils literal notranslate"><span class="pre">(&quot;A&quot;:</span> <span class="pre">&quot;B&quot;)</span></code> as part of the arguments parameter to the <code class="docutils literal notranslate"><span class="pre">run()</span></code> call,
then retrieving the value of widget <code class="docutils literal notranslate"><span class="pre">A</span></code> will return <code class="docutils literal notranslate"><span class="pre">&quot;B&quot;</span></code>. You can find the instructions for creating and
working with widgets in the <a class="reference internal" href="widgets.html"><span class="doc">Databricks widgets</span></a> article.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">arguments</span></code> parameter accepts only Latin characters (ASCII character set). Using non-ASCII characters returns an error.</p></li>
<li><p>Jobs created using the <code class="docutils literal notranslate"><span class="pre">dbutils.notebook</span></code> API must complete in 30 days or less.</p></li>
</ul>
</div>
<div class="section" id="run-usage">
<h3><code class="docutils literal notranslate"><span class="pre">run</span></code> Usage<a class="headerlink" href="#run-usage" title="Permalink to this headline"> </a></h3>
<div class="js-code-language-tabs js-code-language-tabs--literal compound">
<div class="compound-first highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dbutils</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;notebook-name&quot;</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;argument&quot;</span><span class="p">:</span> <span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="s2">&quot;argument2&quot;</span><span class="p">:</span> <span class="s2">&quot;data2&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">})</span>
</pre></div>
</div>
<div class="compound-last highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">dbutils</span><span class="p">.</span><span class="n">notebook</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="s">&quot;notebook-name&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">60</span><span class="p">,</span><span class="w"> </span><span class="nc">Map</span><span class="p">(</span><span class="s">&quot;argument&quot;</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s">&quot;data&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;argument2&quot;</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s">&quot;data2&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">...))</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="run-example">
<h3><code class="docutils literal notranslate"><span class="pre">run</span></code> Example<a class="headerlink" href="#run-example" title="Permalink to this headline"> </a></h3>
<p>Suppose you have a notebook named <code class="docutils literal notranslate"><span class="pre">workflows</span></code> with a widget named <code class="docutils literal notranslate"><span class="pre">foo</span></code> that prints the widget’s value:</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">dbutils</span><span class="p">.</span><span class="n">widgets</span><span class="p">.</span><span class="n">text</span><span class="p">(</span><span class="s">&quot;foo&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;fooDefault&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;fooEmptyLabel&quot;</span><span class="p">)</span>
<span class="n">print</span><span class="p">(</span><span class="n">dbutils</span><span class="p">.</span><span class="n">widgets</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;foo&quot;</span><span class="p">))</span>
</pre></div>
</div>
<p>Running <code class="docutils literal notranslate"><span class="pre">dbutils.notebook.run(&quot;workflows&quot;,</span> <span class="pre">60,</span> <span class="pre">{&quot;foo&quot;:</span> <span class="pre">&quot;bar&quot;})</span></code> produces the following result:</p>
<div class="figure align-default">
<img alt="Notebook with widget" src="../_images/notebook-workflow-widget-example.png" />
</div>
<p>The widget had the value you passed in using <code class="docutils literal notranslate"><span class="pre">dbutils.notebook.run()</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;bar&quot;</span></code>, rather than the default.</p>
<p id="notebook-workflows-exit"><code class="docutils literal notranslate"><span class="pre">exit(value:</span> <span class="pre">String):</span> <span class="pre">void</span></code>
Exit a notebook with a value. If you call a notebook using the <code class="docutils literal notranslate"><span class="pre">run</span></code> method, this is the value returned.</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">dbutils</span><span class="p">.</span><span class="n">notebook</span><span class="p">.</span><span class="n">exit</span><span class="p">(</span><span class="s">&quot;returnValue&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Calling <code class="docutils literal notranslate"><span class="pre">dbutils.notebook.exit</span></code> in a job causes the notebook to complete successfully. If you want to cause the job to fail, throw an exception.</p>
</div>
</div>
<div class="section" id="example">
<h2>Example<a class="headerlink" href="#example" title="Permalink to this headline"> </a></h2>
<p>In the following example, you pass arguments to <code class="docutils literal notranslate"><span class="pre">DataImportNotebook</span></code> and run different notebooks (<code class="docutils literal notranslate"><span class="pre">DataCleaningNotebook</span></code> or <code class="docutils literal notranslate"><span class="pre">ErrorHandlingNotebook</span></code>) based on the result from <code class="docutils literal notranslate"><span class="pre">DataImportNotebook</span></code>.</p>
<div class="figure align-default">
<img alt="if-else example" src="../_images/notebook-workflow-example.png" />
</div>
<p>When the code runs, you see a link to the running notebook:</p>
<div class="figure align-default">
<img alt="Link to running notebook" src="../_images/dbutils.run.png" />
</div>
<p>To view the details of the run, click the notebook link <strong>Notebook job #xxxx</strong>.</p>
<div class="figure align-default">
<img alt="Result of ephemeral notebook run" src="../_images/notebook-run-results.png" />
</div>
</div>
<div class="section" id="pass-structured-data">
<h2>Pass structured data<a class="headerlink" href="#pass-structured-data" title="Permalink to this headline"> </a></h2>
<p>This section illustrates how to pass structured data between notebooks.</p>
<div class="js-code-language-tabs js-code-language-tabs--literal compound">
<div class="compound-first highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example 1 - returning data through temporary views.</span>
<span class="c1"># You can only return one string using dbutils.notebook.exit(), but since called notebooks reside in the same JVM, you can</span>
<span class="c1"># return a name referencing data stored in a temporary view.</span>

<span class="c1">## In callee notebook</span>
<span class="n">spark</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">toDF</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">createOrReplaceGlobalTempView</span><span class="p">(</span><span class="s2">&quot;my_data&quot;</span><span class="p">)</span>
<span class="n">dbutils</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="s2">&quot;my_data&quot;</span><span class="p">)</span>

<span class="c1">## In caller notebook</span>
<span class="n">returned_table</span> <span class="o">=</span> <span class="n">dbutils</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;LOCATION_OF_CALLEE_NOTEBOOK&quot;</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span>
<span class="n">global_temp_db</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">conf</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;spark.sql.globalTempDatabase&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">table</span><span class="p">(</span><span class="n">global_temp_db</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span> <span class="o">+</span> <span class="n">returned_table</span><span class="p">))</span>

<span class="c1"># Example 2 - returning data through DBFS.</span>
<span class="c1"># For larger datasets, you can write the results to DBFS and then return the DBFS path of the stored data.</span>

<span class="c1">## In callee notebook</span>
<span class="n">dbutils</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">rm</span><span class="p">(</span><span class="s2">&quot;/tmp/results/my_data&quot;</span><span class="p">,</span> <span class="n">recurse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">spark</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">toDF</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">write</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;parquet&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;dbfs:/tmp/results/my_data&quot;</span><span class="p">)</span>
<span class="n">dbutils</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="s2">&quot;dbfs:/tmp/results/my_data&quot;</span><span class="p">)</span>

<span class="c1">## In caller notebook</span>
<span class="n">returned_table</span> <span class="o">=</span> <span class="n">dbutils</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;LOCATION_OF_CALLEE_NOTEBOOK&quot;</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;parquet&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">returned_table</span><span class="p">))</span>

<span class="c1"># Example 3 - returning JSON data.</span>
<span class="c1"># To return multiple values, you can use standard JSON libraries to serialize and deserialize results.</span>

<span class="c1">## In callee notebook</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="n">dbutils</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">({</span>
  <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;OK&quot;</span><span class="p">,</span>
  <span class="s2">&quot;table&quot;</span><span class="p">:</span> <span class="s2">&quot;my_data&quot;</span>
<span class="p">}))</span>

<span class="c1">## In caller notebook</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">dbutils</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;LOCATION_OF_CALLEE_NOTEBOOK&quot;</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>
</pre></div>
</div>
<div class="compound-last highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="c1">// Example 1 - returning data through temporary views.</span>
<span class="c1">// You can only return one string using dbutils.notebook.exit(), but since called notebooks reside in the same JVM, you can</span>
<span class="c1">// return a name referencing data stored in a temporary view.</span>

<span class="cm">/** In callee notebook */</span>
<span class="n">sc</span><span class="p">.</span><span class="n">parallelize</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="mi">5</span><span class="p">).</span><span class="n">toDF</span><span class="p">().</span><span class="n">createOrReplaceGlobalTempView</span><span class="p">(</span><span class="s">&quot;my_data&quot;</span><span class="p">)</span>
<span class="n">dbutils</span><span class="p">.</span><span class="n">notebook</span><span class="p">.</span><span class="n">exit</span><span class="p">(</span><span class="s">&quot;my_data&quot;</span><span class="p">)</span>

<span class="cm">/** In caller notebook */</span>
<span class="kd">val</span><span class="w"> </span><span class="n">returned_table</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dbutils</span><span class="p">.</span><span class="n">notebook</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="s">&quot;LOCATION_OF_CALLEE_NOTEBOOK&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">60</span><span class="p">)</span>
<span class="kd">val</span><span class="w"> </span><span class="n">global_temp_db</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="n">conf</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;spark.sql.globalTempDatabase&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">table</span><span class="p">(</span><span class="n">global_temp_db</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;.&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">returned_table</span><span class="p">))</span>

<span class="c1">// Example 2 - returning data through DBFS.</span>
<span class="c1">// For larger datasets, you can write the results to DBFS and then return the DBFS path of the stored data.</span>

<span class="cm">/** In callee notebook */</span>
<span class="n">dbutils</span><span class="p">.</span><span class="n">fs</span><span class="p">.</span><span class="n">rm</span><span class="p">(</span><span class="s">&quot;/tmp/results/my_data&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">recurse</span><span class="o">=</span><span class="kc">true</span><span class="p">)</span>
<span class="n">sc</span><span class="p">.</span><span class="n">parallelize</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="mi">5</span><span class="p">).</span><span class="n">toDF</span><span class="p">().</span><span class="n">write</span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;parquet&quot;</span><span class="p">).</span><span class="n">save</span><span class="p">(</span><span class="s">&quot;dbfs:/tmp/results/my_data&quot;</span><span class="p">)</span>
<span class="n">dbutils</span><span class="p">.</span><span class="n">notebook</span><span class="p">.</span><span class="n">exit</span><span class="p">(</span><span class="s">&quot;dbfs:/tmp/results/my_data&quot;</span><span class="p">)</span>

<span class="cm">/** In caller notebook */</span>
<span class="kd">val</span><span class="w"> </span><span class="n">returned_table</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dbutils</span><span class="p">.</span><span class="n">notebook</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="s">&quot;LOCATION_OF_CALLEE_NOTEBOOK&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">60</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">sqlContext</span><span class="p">.</span><span class="n">read</span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;parquet&quot;</span><span class="p">).</span><span class="n">load</span><span class="p">(</span><span class="n">returned_table</span><span class="p">))</span>

<span class="c1">// Example 3 - returning JSON data.</span>
<span class="c1">// To return multiple values, you can use standard JSON libraries to serialize and deserialize results.</span>

<span class="cm">/** In callee notebook */</span>

<span class="c1">// Import jackson json libraries</span>
<span class="k">import</span><span class="w"> </span><span class="nn">com</span><span class="p">.</span><span class="nn">fasterxml</span><span class="p">.</span><span class="nn">jackson</span><span class="p">.</span><span class="nn">module</span><span class="p">.</span><span class="nn">scala</span><span class="p">.</span><span class="nc">DefaultScalaModule</span>
<span class="k">import</span><span class="w"> </span><span class="nn">com</span><span class="p">.</span><span class="nn">fasterxml</span><span class="p">.</span><span class="nn">jackson</span><span class="p">.</span><span class="nn">module</span><span class="p">.</span><span class="nn">scala</span><span class="p">.</span><span class="nn">experimental</span><span class="p">.</span><span class="nc">ScalaObjectMapper</span>
<span class="k">import</span><span class="w"> </span><span class="nn">com</span><span class="p">.</span><span class="nn">fasterxml</span><span class="p">.</span><span class="nn">jackson</span><span class="p">.</span><span class="nn">databind</span><span class="p">.</span><span class="nc">ObjectMapper</span>

<span class="c1">// Create a json serializer</span>
<span class="kd">val</span><span class="w"> </span><span class="n">jsonMapper</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="nc">ObjectMapper</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="nc">ScalaObjectMapper</span>
<span class="n">jsonMapper</span><span class="p">.</span><span class="n">registerModule</span><span class="p">(</span><span class="nc">DefaultScalaModule</span><span class="p">)</span>

<span class="c1">// Exit with json</span>
<span class="n">dbutils</span><span class="p">.</span><span class="n">notebook</span><span class="p">.</span><span class="n">exit</span><span class="p">(</span><span class="n">jsonMapper</span><span class="p">.</span><span class="n">writeValueAsString</span><span class="p">(</span><span class="nc">Map</span><span class="p">(</span><span class="s">&quot;status&quot;</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s">&quot;OK&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;table&quot;</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s">&quot;my_data&quot;</span><span class="p">)))</span>

<span class="cm">/** In caller notebook */</span>

<span class="c1">// Import jackson json libraries</span>
<span class="k">import</span><span class="w"> </span><span class="nn">com</span><span class="p">.</span><span class="nn">fasterxml</span><span class="p">.</span><span class="nn">jackson</span><span class="p">.</span><span class="nn">module</span><span class="p">.</span><span class="nn">scala</span><span class="p">.</span><span class="nc">DefaultScalaModule</span>
<span class="k">import</span><span class="w"> </span><span class="nn">com</span><span class="p">.</span><span class="nn">fasterxml</span><span class="p">.</span><span class="nn">jackson</span><span class="p">.</span><span class="nn">module</span><span class="p">.</span><span class="nn">scala</span><span class="p">.</span><span class="nn">experimental</span><span class="p">.</span><span class="nc">ScalaObjectMapper</span>
<span class="k">import</span><span class="w"> </span><span class="nn">com</span><span class="p">.</span><span class="nn">fasterxml</span><span class="p">.</span><span class="nn">jackson</span><span class="p">.</span><span class="nn">databind</span><span class="p">.</span><span class="nc">ObjectMapper</span>

<span class="c1">// Create a json serializer</span>
<span class="kd">val</span><span class="w"> </span><span class="n">jsonMapper</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="nc">ObjectMapper</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="nc">ScalaObjectMapper</span>
<span class="n">jsonMapper</span><span class="p">.</span><span class="n">registerModule</span><span class="p">(</span><span class="nc">DefaultScalaModule</span><span class="p">)</span>

<span class="kd">val</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dbutils</span><span class="p">.</span><span class="n">notebook</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="s">&quot;LOCATION_OF_CALLEE_NOTEBOOK&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">60</span><span class="p">)</span>
<span class="n">println</span><span class="p">(</span><span class="n">jsonMapper</span><span class="p">.</span><span class="n">readValue</span><span class="p">[</span><span class="nc">Map</span><span class="p">[</span><span class="nc">String</span><span class="p">,</span><span class="w"> </span><span class="nc">String</span><span class="p">]](</span><span class="n">result</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="handle-errors">
<h2>Handle errors<a class="headerlink" href="#handle-errors" title="Permalink to this headline"> </a></h2>
<p>This section illustrates how to handle errors.</p>
<div class="js-code-language-tabs js-code-language-tabs--literal compound">
<div class="compound-first highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Errors throw a WorkflowException.</span>

<span class="k">def</span> <span class="nf">run_with_retry</span><span class="p">(</span><span class="n">notebook</span><span class="p">,</span> <span class="n">timeout</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="p">{},</span> <span class="n">max_retries</span> <span class="o">=</span> <span class="mi">3</span><span class="p">):</span>
  <span class="n">num_retries</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="k">return</span> <span class="n">dbutils</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">notebook</span><span class="p">,</span> <span class="n">timeout</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
      <span class="k">if</span> <span class="n">num_retries</span> <span class="o">&gt;</span> <span class="n">max_retries</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">e</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Retrying error&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
        <span class="n">num_retries</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="n">run_with_retry</span><span class="p">(</span><span class="s2">&quot;LOCATION_OF_CALLEE_NOTEBOOK&quot;</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="n">max_retries</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<div class="compound-last highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="c1">// Errors throw a WorkflowException.</span>

<span class="k">import</span><span class="w"> </span><span class="nn">com</span><span class="p">.</span><span class="nn">databricks</span><span class="p">.</span><span class="nc">WorkflowException</span>

<span class="c1">// Since dbutils.notebook.run() is just a function call, you can retry failures using standard Scala try-catch</span>
<span class="c1">// control flow. Here we show an example of retrying a notebook a number of times.</span>
<span class="k">def</span><span class="w"> </span><span class="nf">runRetry</span><span class="p">(</span><span class="n">notebook</span><span class="p">:</span><span class="w"> </span><span class="nc">String</span><span class="p">,</span><span class="w"> </span><span class="n">timeout</span><span class="p">:</span><span class="w"> </span><span class="nc">Int</span><span class="p">,</span><span class="w"> </span><span class="n">args</span><span class="p">:</span><span class="w"> </span><span class="nc">Map</span><span class="p">[</span><span class="nc">String</span><span class="p">,</span><span class="w"> </span><span class="nc">String</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Map</span><span class="p">.</span><span class="n">empty</span><span class="p">,</span><span class="w"> </span><span class="n">maxTries</span><span class="p">:</span><span class="w"> </span><span class="nc">Int</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">):</span><span class="w"> </span><span class="nc">String</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="n">numTries</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">  </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="kc">true</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">dbutils</span><span class="p">.</span><span class="n">notebook</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="n">notebook</span><span class="p">,</span><span class="w"> </span><span class="n">timeout</span><span class="p">,</span><span class="w"> </span><span class="n">args</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="n">e</span><span class="p">:</span><span class="w"> </span><span class="nc">WorkflowException</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">numTries</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">maxTries</span><span class="w"> </span><span class="o">=&gt;</span>
<span class="w">        </span><span class="n">println</span><span class="p">(</span><span class="s">&quot;Error, retrying: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">e</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">numTries</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="c1">// not reached</span>
<span class="p">}</span>

<span class="n">runRetry</span><span class="p">(</span><span class="s">&quot;LOCATION_OF_CALLEE_NOTEBOOK&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">timeout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">60</span><span class="p">,</span><span class="w"> </span><span class="n">maxTries</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="run-multiple-notebooks-concurrently">
<h2>Run multiple notebooks concurrently<a class="headerlink" href="#run-multiple-notebooks-concurrently" title="Permalink to this headline"> </a></h2>
<p>You can run multiple notebooks at the same time by using standard Scala and Python constructs such as Threads (<a class="reference external" href="https://docs.oracle.com/javase/7/docs/api/java/lang/Thread.html">Scala</a>, <a class="reference external" href="https://docs.python.org/3/library/threading.html">Python</a>) and Futures (<a class="reference external" href="https://docs.scala-lang.org/overviews/core/futures.html">Scala</a>, <a class="reference external" href="https://docs.python.org/3/library/multiprocessing.html">Python</a>). The example notebooks demonstrate how to use these constructs.</p>
<ol class="arabic simple">
<li><p>Download the following 4 notebooks. The notebooks are written in Scala.</p></li>
<li><p>Import the notebooks into a single folder in the workspace.</p></li>
<li><p>Run the <strong>Run concurrently</strong> notebook.</p></li>
</ol>
<div class="embedded-notebook-section section" id="run-concurrently-notebook">
<span id="concurrent-notebooks"></span><h3>Run concurrently notebook<a class="headerlink" href="#run-concurrently-notebook" title="Permalink to this headline"> </a></h3>
<div class="embedded-notebook">
    <p class="notebook-import-help">
        <a href="/_extras/notebooks/source/concurrent-notebooks.html"            target="_blank">Open notebook in new tab</a>
        <button class="embedded-notebook-copy-to-clipboard"                copy-path-to-clipboard-on-click="/_extras/notebooks/source/concurrent-notebooks.html">            <img src="/_static/clippy.svg"                alt="Copy to clipboard">            Copy link for import        </button>    <div class="embedded-notebook-container">        <div class="loading-spinner"></div>        <iframe data-src="/_extras/notebooks/source/concurrent-notebooks.html"            id="cd925f99f7aedba5eca5e084550869c90e5e2c2a28696f1697f35eac636d13c7" height="1000px" width="100%"            style="overflow-y:hidden;" scrolling="no"></iframe>    </div></div></div>
<div class="embedded-notebook-section section" id="run-in-parallel-notebook">
<span id="parallel-notebooks"></span><h3>Run in parallel notebook<a class="headerlink" href="#run-in-parallel-notebook" title="Permalink to this headline"> </a></h3>
<div class="embedded-notebook">
    <p class="notebook-import-help">
        <a href="/_extras/notebooks/source/parallel-notebooks.html"            target="_blank">Open notebook in new tab</a>
        <button class="embedded-notebook-copy-to-clipboard"                copy-path-to-clipboard-on-click="/_extras/notebooks/source/parallel-notebooks.html">            <img src="/_static/clippy.svg"                alt="Copy to clipboard">            Copy link for import        </button>    <div class="embedded-notebook-container">        <div class="loading-spinner"></div>        <iframe data-src="/_extras/notebooks/source/parallel-notebooks.html"            id="d8da920439d21f3c8475559d86e2a40f6d27b7f029a77b1066ae2bad2b7cb3a9" height="1000px" width="100%"            style="overflow-y:hidden;" scrolling="no"></iframe>    </div></div></div>
<div class="embedded-notebook-section section" id="testing-notebook">
<span id="testing"></span><h3>Testing notebook<a class="headerlink" href="#testing-notebook" title="Permalink to this headline"> </a></h3>
<div class="embedded-notebook">
    <p class="notebook-import-help">
        <a href="/_extras/notebooks/source/testing.html"            target="_blank">Open notebook in new tab</a>
        <button class="embedded-notebook-copy-to-clipboard"                copy-path-to-clipboard-on-click="/_extras/notebooks/source/testing.html">            <img src="/_static/clippy.svg"                alt="Copy to clipboard">            Copy link for import        </button>    <div class="embedded-notebook-container">        <div class="loading-spinner"></div>        <iframe data-src="/_extras/notebooks/source/testing.html"            id="b1ba76003b37615481cff41844bef7cd1295de44910d181f02e76ab0af8609da" height="1000px" width="100%"            style="overflow-y:hidden;" scrolling="no"></iframe>    </div></div></div>
<div class="embedded-notebook-section section" id="testing-2-notebook">
<span id="testing-2"></span><h3>Testing-2 notebook<a class="headerlink" href="#testing-2-notebook" title="Permalink to this headline"> </a></h3>
<div class="embedded-notebook">
    <p class="notebook-import-help">
        <a href="/_extras/notebooks/source/testing-2.html"            target="_blank">Open notebook in new tab</a>
        <button class="embedded-notebook-copy-to-clipboard"                copy-path-to-clipboard-on-click="/_extras/notebooks/source/testing-2.html">            <img src="/_static/clippy.svg"                alt="Copy to clipboard">            Copy link for import        </button>    <div class="embedded-notebook-container">        <div class="loading-spinner"></div>        <iframe data-src="/_extras/notebooks/source/testing-2.html"            id="3aae0989ced247fb47b3acc27920b8ed2104e9a089b989a108b219f6467230c2" height="1000px" width="100%"            style="overflow-y:hidden;" scrolling="no"></iframe>    </div></div></div>
</div>
</div>


    
          </div>
        </div>
        <div  class="suapp-rating">
  <div id="suPageRateApp">
     <su-app></su-app>
   </div> 
 </div>
<hr> 
<footer>
  <div role="contentinfo">
      <p class="copyright">
          &copy; Databricks 2023. All rights reserved. Apache, Apache Spark, Spark, and the Spark logo are trademarks of the <a href="http://www.apache.org/">Apache Software Foundation</a>.
      </p>
      <p> 
        
          <a id='feedbacklink' href="mailto:doc-feedback@databricks.com?subject=Documentation Feedback">Send us feedback</a>
        
     | <a href="https://databricks.com/privacy-policy">Privacy Policy</a> | <a href="https://databricks.com/terms-of-use">Terms of Use</a></p>

  </div> 

</footer>
      </div>
    </div>
  </section>
</main>

  </page>
  
  <script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
      URL_ROOT: '../',
      VERSION: '1.0',
      COLLAPSE_INDEX: false,
      FILE_SUFFIX: '.html',
      HAS_SOURCE: 'false'
    };
  </script>
  <script type="text/javascript" src="../_static/jquery.js"></script>
  <script type="text/javascript" src="../_static/underscore.js"></script>
  <script type="text/javascript" src="../_static/doctools.js"></script>
  <script type="text/javascript" src="../_static/language_data.js"></script>
  

  <script type="text/javascript" src="../_static/js/clipboard.min.js"></script>
  <script type="text/javascript" src="../_static/js/jquery.waypoints.min.js"></script>

  <!-- Select2 (https://select2.org/) -->
  <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
  <!-- End Select2 -->

  
  
  <script type="text/javascript" src="../_static/js/localized.js"></script>
  <script type="text/javascript" src="../_static/js/custom.js"></script>
  

  
  
  <script type="text/javascript">
    jQuery(function () {
      SphinxRtdTheme.StickyNav.enable();
    });

  </script>
  
 



  <script>
  window.__searchunifyLoaderConfig = JSON.parse('{"clients": {"en": "02c2e804-27e9-11ee-aefb-0242ac120011", "ja": "6a42c3f2-2820-11ee-aefb-0242ac120011", "pt": "6a86badd-2821-11ee-aefb-0242ac120011"}}')
</script>
<script type="text/javascript" src="../_static/js/search-loader.js"></script>
</body>
<script type='text/javascript'>
  window.onload = function () {
    var description = document.querySelector('meta[name="description"]').getAttribute("content");
    let titleText = document.querySelector('h1').textContent;
    document.querySelector('meta[property="og:title"]').setAttribute("content", titleText);
    document.querySelector('meta[property="og:description"]').setAttribute("content", description);
    document.querySelector('meta[property="twitter:description"]').setAttribute("content", description);
  };
</script>

</html>