

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en-US" > <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en-US"> <!--<![endif]-->

<head>
  <!-- cookie consent -->
  
    <!-- Combined Onetrust and Rudderstack Implementation Scripts -->
    <!-- Onetrust Initialization -->
    <script type="text/javascript" src="https://cdn.cookielaw.org/consent/92466579-1717-44d3-809d-a05fb02843ed-test/OtAutoBlock.js"></script>
    <script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" data-document-language="true" type="text/javascript" charset="UTF-8" data-domain-script="92466579-1717-44d3-809d-a05fb02843ed-test"></script>
    <link rel="stylesheet" id="db-onetrust-style" href="https://www.databricks.com/wp-content/uploads/db_onetrust.css" media="all" />
    <!-- Setting Rudderstack Write Key -->
    <script>window.rudderstackKey = "2SOR9fvSr5Fi6tN2ihPbVHnX1SZ" </script>
    <!-- Rudderstack Initialization + Onetrust Integration + Rudderstack Custom Events -->
    <script type="text/javascript" src="https://www.databricks.com/sites/default/files/rudderstack/v1/db-rudderstack-events.js"></script>

  <!-- cookie consent -->

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="X-UA-Compatible" content="IE=9" />
  <meta content="Develop code in Databricks notebooks, including code formatting, mixing languages, variable explorer, code modularization with files, and version history." name="description" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
  <meta property="og:image" content="https://www.databricks.com/wp-content/uploads/2020/04/og-databricks.png">
  <meta property="og:image:type" content="image/png">
  <meta property="og:title" content="Develop code in Databricks notebooks">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://docs.databricks.com">
  <meta property="og:description" content="" id="og-description">
  <meta name="twitter:image" content="https://www.databricks.com/wp-content/uploads/2020/04/og-databricks.png">
  <meta name="twitter:site" content="@databricks">
  <meta name="twitter:creator" content="@databricks">
  <meta property="twitter:description" content="">
  
  <title>Develop code in Databricks notebooks &#124; Databricks on AWS</title>
  
  
  <link rel="canonical" href="https://docs.databricks.com/en/notebooks/notebooks-code.html">
  <!-- Start hreflang tag -->
  <link rel="alternate" hreflang="en" href="https://docs.databricks.com/en/notebooks/notebooks-code.html" />
<link rel="alternate" hreflang="x-default" href="https://docs.databricks.com/en/notebooks/notebooks-code.html" />
  <!-- End hreflang tag -->
  
  
  <link rel="shortcut icon" href="../_static/favicon.ico" />
  

  

  

  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;
j.setAttributeNode(d.createAttribute('data-ot-ignore'));
f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-T85FQ33');</script>
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;
j.setAttributeNode(d.createAttribute('data-ot-ignore'));
f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-TWTKQQ');</script>
    
  <!-- End Google Tag Manager -->


  <!-- MaxMind / GEO IP -->
  <script src="//js.maxmind.com/js/apis/geoip2/v2.1/geoip2.js" type="text/javascript"></script>
  <!-- End MaxMind / GEO IP -->

  
  
  <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600&display=swap" rel="stylesheet">
  <link rel="preload" href="../_static/fonts/DMSans-Bold.ttf" as="font">
  <link rel="preload" href="../_static/fonts/DMSans-Regular.ttf" as="font">
  <link rel="preload" href="../_static/fonts/DMMono-Regular.ttf" as="font">
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/cloud-provider-selector.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/translation-selector.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/searchunify/main.css" type="text/css" />

  
  <link rel="index" title="Index" href="../genindex.html" />
  <link rel="search" title="Search" href="../search.html" />
  <link rel="top" title="Databricks on AWS" href="../index.html" /> 
</head>

<body class="wy-body-for-nav" role="document">

  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T85FQ33"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TWTKQQ"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->

  
  <nav class="wy-nav-top header su_header" role="navigation" aria-label="top navigation">
    
<nav class="wy-nav-top header su_header" role="navigation" aria-label="top navigation">
  <div class="container-logo">
    <ul class="mobile-menu-toggle">
        <li class="menu-toggle">
            <i data-toggle="wy-nav-top" class="wy-nav-top-menu-button db-icon db-icon-menu pull-left"></i>
            
            <a href="https://www.databricks.com/" class="wy-nav-top-logo"><img src="../_static/small-scale-lockup-full-color-rgb.svg" width="137" height="21"
              alt="Databricks" /></a>   
               
              </li>
    </ul>
    <ul class="su_nav-menu">
      <li class="menu-toggle">
        <i data-toggle="wy-nav-top" class="wy-nav-top-menu-button db-icon db-icon-menu pull-left"></i>
        
          
        
        <a href="https://www.databricks.com/" class="wy-nav-top-logo"><img src="../_static/small-scale-lockup-full-color-rgb.svg" width="137" height="21"
            alt="Databricks" /></a></li>
        <!-- 
<li><a href="https://help.databricks.com/s/">Help Center</a></li>
<li class="active"><a href="https://docs.databricks.com/en/">Documentation</a></li>
<li><a href="https://kb.databricks.com/">Knowledge Base</a></li>
 -->
    </ul>
  </div>
  <div class="su_nav-right">
    <ul class="su_link-mobile">
  <!-- Mobile header code can go here -->
</ul>
<ul class="right-try-list">
   
</ul>
  </div>
</nav>
  </nav>

  <div class="su_sub-header">
    <div class="container">
      <div class="su_sub-header-inner">
        <!-- <div class="su_subnav-menu-right">
  <div id="auto" style="width: 100%;">
    <div ng-controller="SearchautoController">
      <div bind-html-compile="autocompleteHtml">
        <form class="su__search-box-1" disabled="disabled">
          <input class="su__search-input" type="search" name="Search box" id="su__search-b" placeholder="Search Documentation" disabled="disabled"/>
          <button class="su__search-button" type="submit" class="button button-success" disabled="disabled">
            <svg width="24" height="24" viewBox="0 0 24 24">
              <path
                d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"
                fill="#333"></path>
            </svg>
          </button>
        </form>
      </div>
    </div>
  </div>
</div> -->
        <div class="search-lng-gap"></div>
        <div style="margin-left: 16px; margin-right: 16px;">
          <!-- <select name="lng selector" id="lng-selector">
    <option value="../../en/notebooks/notebooks-code.html" class="notranslate">English</option>
    <option value="../../ja/notebooks/notebooks-code.html" class="notranslate">日本語</option>
    <option value="../../pt/notebooks/notebooks-code.html" class="notranslate">Português (Brasil)</option>
</select> -->
        </div>
        <div class="cloud-selector-container">
          <!-- <select name="cloud provider selector" id="cloud-provider-selector">
    <option value="aws" selected class="notranslate">
        Amazon Web Services
    </option>
    <option value="azure"  class="notranslate">
        Microsoft Azure
    </option>
    <option value="gcp"  class="notranslate">
        Google Cloud Platform
    </option>
</select> -->
        </div>
      </div>
    </div>
  </div>
  <page class="js-page-container">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side su_nav-side">
<div class="wy-side-scroll">
  <div class="wy-side-nav-search">
    

    

    

    
  </div>

  <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
    
      <a href="../index.html" class="main-navigation-home">Databricks on AWS</a>
    

    
      

      
        <p class="caption"><span class="caption-text">Load &amp; manage data</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../rag-temp/index.html">RAG Studio</a></li>
</ul>

      
    
  </div>

  <div role="contentinfo">
    
  <p class="build_info notranslate"data-last-edit="December 23, 2023">
    Updated Jan 11, 2024
  </p>
<script>
  window.addEventListener('DOMContentLoaded',function(){
    var h1=document.querySelector('h1');
    var bi=document.querySelector('[data-last-edit]');
    if(h1 && bi){
      var ver = document.createElement('p');
      ver.className = 'version_info';
      ver.textContent = bi.getAttribute('data-last-edit');
      h1.parentElement.insertBefore(ver, h1.nextElementSibling);
    }
  });
</script>

    <p>
      
        <a id='feedbacklink' href="mailto:doc-feedback@databricks.com?subject=Documentation Feedback">Send us feedback</a>
      
    </p>
  </div>
</div>
</nav>
    
    
<main class="wy-grid-for-nav su_nav-grid">
  <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
    <div class="wy-nav-content su__nav_content">
      <div class="rst-content">
        





<div role="navigation" aria-label="breadcrumbs navigation" class="wy-breadcrumbs-wrapper">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Documentation</a> <span class="db-icon db-icon-chevron-right"></span></li>
    
    
      <li>Develop code in Databricks notebooks</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>
</div>
        
        <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
          <div itemprop="articleBody">
            
    
  <div class="section" id="develop-code-in-databricks-notebooks">
<h1>Develop code in Databricks notebooks<a class="headerlink" href="#develop-code-in-databricks-notebooks" title="Permalink to this headline"> </a></h1>
<p>This page describes how to develop code in Databricks notebooks, including autocomplete, automatic formatting for Python and SQL, combining Python and SQL in a notebook, and tracking the notebook version history.</p>
<p>For more details about advanced functionality available with the editor, such as autocomplete, variable selection, multi-cursor support, and side-by-side diffs, see <a class="reference internal" href="notebook-editor.html"><span class="doc">Use the Databricks notebook and file editor</span></a>.</p>
<div class="section" id="access-notebook-for-editing">
<h2>Access notebook for editing<a class="headerlink" href="#access-notebook-for-editing" title="Permalink to this headline"> </a></h2>
<p>To open a notebook, use the workspace <a class="reference internal" href="../search/index.html"><span class="doc">Search function</span></a> or use the workspace browser to <a class="reference internal" href="../workspace/workspace-objects.html"><span class="doc">navigate to the notebook</span></a> and click on the notebook’s name or icon.</p>
</div>
<div class="section" id="browse-data">
<h2>Browse data<a class="headerlink" href="#browse-data" title="Permalink to this headline"> </a></h2>
<p>Use the schema browser to explore tables and volumes available for the notebook. Click <img alt="notebook data icon" src="../_images/notebook-data-icon.png" /> at the left side of the notebook to open the schema browser.</p>
<p>The <strong>For you</strong> button displays only those tables that you’ve used in the current session or previously marked as a Favorite.</p>
<p>As you type text into the <strong>Filter</strong> box, the display changes to show only those items that contain the text you type. Only items that are currently open or have been opened in the current session appear. The <strong>Filter</strong> box does not do a complete search of the catalogs, schemas, and tables available for the notebook.</p>
<p>To open the <img alt="Kebab menu" src="../_images/kebab-menu.png" /> kebab menu, hover the cursor over the item’s name as shown:</p>
<div class="figure align-default">
<img alt="kebab menu in schema browser" src="../_images/schema-browser-kebab.png" />
</div>
<p>If the item is a table, you can do the following:</p>
<ul class="simple">
<li><p>Automatically create and run a cell to display a preview of the data in the table. Select <strong>Preview in a new cell</strong> from the kebab menu for the table.</p></li>
<li><p>View a catalog, schema, or table in Catalog Explorer. Select <strong>Open in Catalog Explorer</strong> from the kebab menu. A new tab opens showing the selected item.</p></li>
<li><p>Get the path to a catalog, schema, or table. Select <strong>Copy … path</strong> from the kebab menu for the item.</p></li>
<li><p>Add a table to Favorites. Select <strong>Add table to favorites</strong> from the kebab menu for the table.</p></li>
</ul>
<p>If the item is a catalog, schema, or volume, you can copy the item’s path or open it in Catalog Explorer.</p>
<p>To insert a table or column name directly into a cell:</p>
<ol class="arabic simple">
<li><p>Click your cursor in the cell at the location you want to enter the name.</p></li>
<li><p>Move your cursor over the table name or column name in the schema browser.</p></li>
<li><p>Click the double arrow <img alt="double arrow" src="../_images/schema-browser-double-arrow.png" />that appears at the right of the item’s name.</p></li>
</ol>
</div>
<div class="section" id="keyboard-shortcuts">
<h2>Keyboard shortcuts<a class="headerlink" href="#keyboard-shortcuts" title="Permalink to this headline"> </a></h2>
<p>To display keyboard shortcuts, select <strong>Help &gt; Keyboard shortcuts</strong>. The keyboard shortcuts available depend on whether the cursor is in a code cell (edit mode) or not (command mode).</p>
</div>
<div class="section" id="find-and-replace-text">
<h2>Find and replace text<a class="headerlink" href="#find-and-replace-text" title="Permalink to this headline"> </a></h2>
<p>To find and replace text within a notebook, select <strong>Edit &gt; Find and Replace</strong>. The current match is highlighted in orange and all other matches are highlighted in yellow.</p>
<div class="figure align-default">
<img alt="Matching text" src="../_images/find-replace-example.png" />
</div>
<p>To replace the current match, click <strong>Replace</strong>. To replace all matches in the notebook, click <strong>Replace All</strong>.</p>
<p>To move between matches, click the <strong>Prev</strong> and <strong>Next</strong> buttons. You can also press
<strong>shift+enter</strong> and <strong>enter</strong> to go to the previous and next matches, respectively.</p>
<p>To close the find and replace tool, click <img alt="Delete Icon" src="../_images/delete-icon.png" /> or press <strong>esc</strong>.</p>
</div>
<div class="section" id="variable-explorer">
<h2>Variable explorer<a class="headerlink" href="#variable-explorer" title="Permalink to this headline"> </a></h2>
<p>You can directly observe Python, Scala, and R variables in the notebook UI. For Python on Databricks Runtime 12.1 and above, the variables update as a cell runs. For Scala, R, and for Python on Databricks Runtime 12.0 and below, variables update after a cell finishes running.</p>
<p>To open the variable explorer, click <img alt="the variable explorer icon" src="../_images/variable-explorer-icon.png" /> in <a class="reference internal" href="notebook-ui.html#right-sidebar"><span class="std std-ref">the right sidebar</span></a>. The variable explorer opens, showing the value and data type, including shape, for each variable that is currently defined in the notebook. (The shape of a PySpark dataframe is ‘?’, because calculating the shape can be computationally expensive.)</p>
<p>To filter the display, enter text into the search box. The list is automatically filtered as you type.</p>
<p>Variable values are automatically updated as you run notebook cells.</p>
<div class="figure align-default">
<img alt="example variable explorer panel" src="../_images/variable-explorer-example.png" />
</div>
</div>
<div class="section" id="run-selected-cells">
<h2>Run selected cells<a class="headerlink" href="#run-selected-cells" title="Permalink to this headline"> </a></h2>
<p>You can run a single cell or a collection of cells. To select a single cell, click anywhere in the cell. To select multiple cells, hold down the <code class="docutils literal notranslate"><span class="pre">Command</span></code> key on MacOS or the <code class="docutils literal notranslate"><span class="pre">Ctrl</span></code> key on Windows, and click in the cell outside of the text area as shown in the screen shot.</p>
<div class="figure align-default">
<img alt="how to select multiple cells" src="../_images/select-multiple-cells.png" />
</div>
<p>To run the selected cells, select <strong>Run &gt; Run selected cell(s)</strong>.</p>
<p>The behavior of this command depends on the cluster that the notebook is attached to.</p>
<ul class="simple">
<li><p>On a cluster running Databricks Runtime 13.3 LTS or below, selected cells are executed individually. If an error occurs in a cell, the execution continues with subsequent cells.</p></li>
<li><p>On a cluster running Databricks Runtime 14.0 or above, or on a SQL warehouse, selected cells are executed as a batch. Any error halts execution, and you cannot cancel the execution of individual cells. You can use the <strong>Interrupt</strong> button to stop execution of all cells.</p></li>
</ul>
</div>
<div class="section" id="modularize-your-code">
<h2>Modularize your code<a class="headerlink" href="#modularize-your-code" title="Permalink to this headline"> </a></h2>
<div class="preview admonition">
<p class="admonition-title">Preview</p>
<p>This feature is in <a class="reference internal" href="../release-notes/release-types.html"><span class="doc">Public Preview</span></a>.</p>
</div>
<p>With Databricks Runtime 11.2 and above, you can create and manage source code files in the Databricks workspace, and then import these files into your notebooks as needed.</p>
<p>For more information on working with source code files, see <a class="reference internal" href="share-code.html"><span class="doc">Share code between Databricks notebooks</span></a> and <a class="reference internal" href="../files/workspace-modules.html"><span class="doc">Work with Python and R modules</span></a>.</p>
</div>
<div class="section" id="run-selected-text">
<h2>Run selected text<a class="headerlink" href="#run-selected-text" title="Permalink to this headline"> </a></h2>
<p>You can highlight code or SQL statements in a notebook cell and run only that selection. This is useful when you want to quickly iterate on code and queries.</p>
<ol class="arabic">
<li><p>Highlight the lines you want to run.</p></li>
<li><p>Select <strong>Run &gt; Run selected text</strong> or use the keyboard shortcut <code class="docutils literal notranslate"><span class="pre">Ctrl</span></code>+<code class="docutils literal notranslate"><span class="pre">Shift</span></code>+<code class="docutils literal notranslate"><span class="pre">Enter</span></code>. If no text is highlighted, <strong>Run Selected Text</strong> executes the current line.</p>
<div class="figure align-default">
<img alt="run selected lines" src="../_images/run-selected-text.gif" />
</div>
</li>
</ol>
<p>If you are using <a class="reference internal" href="#language-magic"><span class="std std-ref">mixed languages in a cell</span></a>, you must include the <code class="docutils literal notranslate"><span class="pre">%&lt;language&gt;</span></code> line in the selection.</p>
<p><strong>Run selected text</strong> also executes collapsed code, if there is any in the highlighted selection.</p>
<p>Special cell commands such as <code class="docutils literal notranslate"><span class="pre">%run</span></code>, <code class="docutils literal notranslate"><span class="pre">%pip</span></code>, and <code class="docutils literal notranslate"><span class="pre">%sh</span></code> are supported.</p>
<p>You cannot use <strong>Run selected text</strong> on cells that have multiple output tabs (that is, cells where you have defined a data profile or visualization).</p>
</div>
<div class="section" id="format-code-cells">
<span id="sql-format"></span><span id="notebook-format"></span><h2>Format code cells<a class="headerlink" href="#format-code-cells" title="Permalink to this headline"> </a></h2>
<p>Databricks provides tools that allow you to format Python and SQL code in notebook cells quickly and easily. These tools reduce the effort to keep your code formatted and help to enforce the same coding standards across your notebooks.</p>
<div class="section" id="format-python-cells">
<h3>Format Python cells<a class="headerlink" href="#format-python-cells" title="Permalink to this headline"> </a></h3>
<div class="preview admonition">
<p class="admonition-title">Preview</p>
<p>This feature is in <a class="reference internal" href="../release-notes/release-types.html"><span class="doc">Public Preview</span></a>.</p>
</div>
<p>Databricks supports Python code formatting using <a class="reference external" href="https://black.readthedocs.io/en/stable/">Black</a> within the notebook. The notebook must be attached to a cluster with <code class="docutils literal notranslate"><span class="pre">black</span></code> and <code class="docutils literal notranslate"><span class="pre">tokenize-rt</span></code> Python packages installed, and the Black formatter executes on the cluster that the notebook is attached to.</p>
<p>On Databricks Runtime 11.2 and above, Databricks preinstalls <code class="docutils literal notranslate"><span class="pre">black</span></code> and <code class="docutils literal notranslate"><span class="pre">tokenize-rt</span></code>. You can use the formatter directly without needing to install these libraries.</p>
<p>On Databricks Runtime 11.1 and below, you must install <code class="docutils literal notranslate"><span class="pre">black==22.3.0</span></code> and <code class="docutils literal notranslate"><span class="pre">tokenize-rt==4.2.1</span></code> from PyPI on your notebook or cluster to use the Python formatter. You can run the following command in your notebook:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="n">pip</span> <span class="n">install</span> <span class="n">black</span><span class="o">==</span><span class="mf">22.3.0</span> <span class="n">tokenize</span><span class="o">-</span><span class="n">rt</span><span class="o">==</span><span class="mf">4.2.1</span>
</pre></div>
</div>
<p>or <a class="reference internal" href="../libraries/cluster-libraries.html"><span class="doc">install the library on your cluster</span></a>.</p>
<p>For more details about installing libraries, see <a class="reference internal" href="../libraries/index.html#python-environment-management"><span class="std std-ref">Python environment management</span></a>.</p>
<p>For files and notebooks in Databricks Repos, you can configure the Python formatter based on the <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code> file. To use this feature, create a <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code> file in the Repo root directory and configure it according to the <a class="reference external" href="https://black.readthedocs.io/en/stable/usage_and_configuration/the_basics.html#configuration-format">Black configuration format</a>. Edit the [tool.black] section in the file. The configuration is applied when you format any file and notebook in that Repo.</p>
</div>
<div class="section" id="how-to-format-python-and-sql-cells">
<h3>How to format Python and SQL cells<a class="headerlink" href="#how-to-format-python-and-sql-cells" title="Permalink to this headline"> </a></h3>
<p>You must have <a class="reference internal" href="notebooks-collaborate.html#notebook-permissions"><span class="std std-ref">Can Edit permission</span></a> on the notebook to format code.</p>
<p>You can trigger the formatter in the following ways:</p>
<ul>
<li><p><strong>Format a single cell</strong></p>
<ul class="simple">
<li><p>Keyboard shortcut: Press <strong>Cmd+Shift+F</strong>.</p></li>
<li><p>Command context menu:</p>
<ul>
<li><p>Format SQL cell: Select <strong>Format SQL</strong> in the command context dropdown menu of a SQL cell. This menu item is visible only in SQL notebook cells or those with a <code class="docutils literal notranslate"><span class="pre">%sql</span></code> <a class="reference internal" href="#language-magic"><span class="std std-ref">language magic</span></a>.</p></li>
<li><p>Format Python cell: Select <strong>Format Python</strong> in the command context dropdown menu of a Python cell. This menu item is visible only in Python notebook cells or those with a <code class="docutils literal notranslate"><span class="pre">%python</span></code> <a class="reference internal" href="#language-magic"><span class="std std-ref">language magic</span></a>.</p></li>
</ul>
</li>
<li><p>Notebook <strong>Edit</strong> menu: Select a Python or SQL cell, and then select <strong>Edit &gt; Format Cell(s)</strong>.</p></li>
</ul>
</li>
<li><p><strong>Format multiple cells</strong></p>
<p><a class="reference internal" href="#run-selected-cells"><span class="std std-ref">Select multiple cells</span></a> and then select <strong>Edit &gt; Format Cell(s)</strong>. If you select cells of more than one language, only SQL and Python cells are formatted. This includes those that use <code class="docutils literal notranslate"><span class="pre">%sql</span></code> and <code class="docutils literal notranslate"><span class="pre">%python</span></code>.</p>
</li>
<li><p><strong>Format all Python and SQL cells in the notebook</strong></p>
<p>Select <strong>Edit &gt; Format Notebook</strong>. If your notebook contains more than one language, only SQL and Python cells are formatted. This includes those that use <code class="docutils literal notranslate"><span class="pre">%sql</span></code> and <code class="docutils literal notranslate"><span class="pre">%python</span></code>.</p>
</li>
</ul>
</div>
<div class="section" id="limitations-of-code-formatting">
<h3>Limitations of code formatting<a class="headerlink" href="#limitations-of-code-formatting" title="Permalink to this headline"> </a></h3>
<ul class="simple">
<li><p>Black enforces <a class="reference external" href="https://peps.python.org/pep-0008/">PEP 8</a> standards for 4-space indentation. Indentation is not configurable.</p></li>
<li><p>Formatting embedded Python strings inside a SQL UDF is not supported. Similarly, formatting SQL strings inside a Python UDF is not supported.</p></li>
</ul>
</div>
</div>
<div class="section" id="version-history">
<span id="version-control"></span><h2>Version history<a class="headerlink" href="#version-history" title="Permalink to this headline"> </a></h2>
<p>Databricks notebooks maintain a history of notebook versions, allowing you to view and restore previous snapshots of the notebook. You can perform the following actions on versions: add comments, restore and delete versions, and clear version history.</p>
<p>You can also <a class="reference internal" href="../repos/index.html"><span class="doc">sync your work in Databricks with a remote Git repository</span></a>.</p>
<p>To access notebook versions, click <img alt="version history icon" src="../_images/version-history.png" /> in the right sidebar. The notebook version history appears. You can also select <strong>File &gt; Version history</strong>.</p>
<div class="section" id="add-a-comment">
<h3>Add a comment<a class="headerlink" href="#add-a-comment" title="Permalink to this headline"> </a></h3>
<p>To add a comment to the latest version:</p>
<ol class="arabic">
<li><p>Click the version.</p></li>
<li><p>Click <strong>Save now</strong>.</p>
<div class="figure align-default">
<img alt="Save comment" src="../_images/version-comment.png" />
</div>
</li>
<li><p>In the Save Notebook Version dialog, enter a comment.</p></li>
<li><p>Click <strong>Save</strong>. The notebook version is saved with the entered comment.</p></li>
</ol>
</div>
<div class="section" id="restore-a-version">
<h3>Restore a version<a class="headerlink" href="#restore-a-version" title="Permalink to this headline"> </a></h3>
<p>To restore a version:</p>
<ol class="arabic">
<li><p>Click the version.</p></li>
<li><p>Click <strong>Restore this version</strong>.</p>
<div class="figure align-default">
<img alt="Restore version" src="../_images/restore-version.png" />
</div>
</li>
<li><p>Click <strong>Confirm</strong>. The selected version becomes the latest version of the notebook.</p></li>
</ol>
</div>
<div class="section" id="delete-a-version">
<h3>Delete a version<a class="headerlink" href="#delete-a-version" title="Permalink to this headline"> </a></h3>
<p>To delete a version entry:</p>
<ol class="arabic">
<li><p>Click the version.</p></li>
<li><p>Click the trash icon <img alt="Trash" src="../_images/trash-icon.png" />.</p>
<div class="figure align-default">
<img alt="Delete version" src="../_images/delete-version.png" />
</div>
</li>
<li><p>Click <strong>Yes, erase</strong>. The selected version is deleted from the history.</p></li>
</ol>
</div>
<div class="section" id="clear-version-history">
<h3>Clear version history<a class="headerlink" href="#clear-version-history" title="Permalink to this headline"> </a></h3>
<p>The version history cannot be recovered after it has been cleared.</p>
<p>To clear the version history for a notebook:</p>
<ol class="arabic simple">
<li><p>Select <strong>File &gt; Clear version history</strong>.</p></li>
<li><p>Click <strong>Yes, clear</strong>. The notebook version history is cleared.</p></li>
</ol>
</div>
</div>
<div class="section" id="code-languages-in-notebooks">
<h2>Code languages in notebooks<a class="headerlink" href="#code-languages-in-notebooks" title="Permalink to this headline"> </a></h2>
<div class="section" id="set-default-language">
<span id="default-language"></span><h3>Set default language<a class="headerlink" href="#set-default-language" title="Permalink to this headline"> </a></h3>
<p>The default language for the notebook appears next to the notebook name.</p>
<div class="figure align-default">
<img alt="Notebook default language" src="../_images/toolbar.png" />
</div>
<p>To change the default language, click the language button and select the new language from the dropdown menu. To ensure that existing commands continue to work, commands of the previous default language are automatically prefixed with a language magic command.</p>
</div>
<div class="section" id="mix-languages">
<span id="language-magic"></span><h3>Mix languages<a class="headerlink" href="#mix-languages" title="Permalink to this headline"> </a></h3>
<p>By default, cells use the default language of the notebook. You can override the default language in a cell by clicking the language button and selecting a language from the dropdown menu.</p>
<div class="figure align-default">
<img alt="Cell language drop down" src="../_images/cell-language-button.png" />
</div>
<p>Alternately, you can use the language magic command <code class="docutils literal notranslate"><span class="pre">%&lt;language&gt;</span></code> at the beginning of a cell. The supported magic commands are: <code class="docutils literal notranslate"><span class="pre">%python</span></code>, <code class="docutils literal notranslate"><span class="pre">%r</span></code>, <code class="docutils literal notranslate"><span class="pre">%scala</span></code>, and  <code class="docutils literal notranslate"><span class="pre">%sql</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When you invoke a language magic command, the command is dispatched to the REPL in the <a class="reference internal" href="execution-context.html"><span class="doc">execution context</span></a> for the notebook. Variables defined in one language (and hence in the REPL for that language) are not available in the REPL of another language. REPLs can share state only through external resources such as files in DBFS or objects in object storage.</p>
</div>
<p>Notebooks also support a few auxiliary magic commands:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">%sh</span></code>: Allows you to run shell code in your notebook. To fail the cell if the shell command has a non-zero exit status, add the <code class="docutils literal notranslate"><span class="pre">-e</span></code> option. This command runs only on the Apache Spark driver, and not the workers. To run a shell command on all nodes, use an <a class="reference internal" href="../init-scripts/index.html"><span class="doc">init script</span></a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">%fs</span></code>: Allows you to use <code class="docutils literal notranslate"><span class="pre">dbutils</span></code> filesystem commands. For example, to run the <code class="docutils literal notranslate"><span class="pre">dbutils.fs.ls</span></code> command to list files, you can specify <code class="docutils literal notranslate"><span class="pre">%fs</span> <span class="pre">ls</span></code> instead. For more information, see <a class="reference internal" href="../files/index.html"><span class="doc">Work with files on Databricks</span></a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">%md</span></code>: Allows you to include various types of documentation, including text, images, and mathematical formulas and equations. See the next section.</p></li>
</ul>
</div>
<div class="section" id="sql-syntax-highlighting-and-autocomplete-in-python-commands">
<h3>SQL syntax highlighting and autocomplete in Python commands<a class="headerlink" href="#sql-syntax-highlighting-and-autocomplete-in-python-commands" title="Permalink to this headline"> </a></h3>
<p>Syntax highlighting and SQL <a class="reference internal" href="notebook-editor.html#autocomplete"><span class="std std-ref">autocomplete</span></a> are available when you use SQL inside a Python command, such as in a <code class="docutils literal notranslate"><span class="pre">spark.sql</span></code> command.</p>
</div>
<div class="section" id="explore-sql-cell-results-in-python-notebooks-using-python">
<span id="implicit-sql-df"></span><h3>Explore SQL cell results in Python notebooks using Python<a class="headerlink" href="#explore-sql-cell-results-in-python-notebooks-using-python" title="Permalink to this headline"> </a></h3>
<p>You might want to load data using SQL and explore it using Python. In a Databricks Python notebook, table results from a SQL language cell are automatically made available as a Python DataFrame assigned to the variable <code class="docutils literal notranslate"><span class="pre">_sqldf</span></code>.</p>
<p>In Databricks Runtime 13.0 and above, you can also access the DataFrame result using <a class="reference external" href="https://ipython.readthedocs.io/en/stable/interactive/reference.html#output-caching-system">IPython’s output caching system</a>. The prompt counter appears in the output message displayed at the bottom of the cell results. For the example shown, you would reference the result as <code class="docutils literal notranslate"><span class="pre">Out[2]</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul>
<li><p>The variable <code class="docutils literal notranslate"><span class="pre">_sqldf</span></code> may be reassigned each time a <code class="docutils literal notranslate"><span class="pre">%sql</span></code> cell is run. To avoid losing reference to the DataFrame result, assign it to a new variable name before you run the next <code class="docutils literal notranslate"><span class="pre">%sql</span></code> cell:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">new_dataframe_name</span> <span class="o">=</span> <span class="n">_sqldf</span>
</pre></div>
</div>
</li>
<li><p>If the query uses a <a class="reference internal" href="widgets.html"><span class="doc">widget</span></a> for parameterization, the results are not available as a Python DataFrame.</p></li>
<li><p>If the query uses the keywords <code class="docutils literal notranslate"><span class="pre">CACHE</span> <span class="pre">TABLE</span></code> or <code class="docutils literal notranslate"><span class="pre">UNCACHE</span> <span class="pre">TABLE</span></code>, the results are not available as a Python DataFrame.</p></li>
</ul>
</div>
<p>The screenshot shows an example:</p>
<div class="figure align-default">
<img alt="sql results dataframe" src="../_images/implicit-df.png" />
</div>
</div>
<div class="section" id="execute-sql-cells-in-parallel">
<span id="sql-run-now"></span><h3>Execute SQL cells in parallel<a class="headerlink" href="#execute-sql-cells-in-parallel" title="Permalink to this headline"> </a></h3>
<p>While a command is running and your notebook is attached to an interactive cluster, you can run a SQL cell simultaneously with the current command. The SQL cell is executed in a new, parallel session.</p>
<p>To execute a cell in parallel:</p>
<ol class="arabic">
<li><p><a class="reference internal" href="run-notebook.html"><span class="doc">Run the cell</span></a>.</p></li>
<li><p>Click <strong>Run Now</strong>. The cell is immediately executed.</p>
<div class="figure align-default">
<img alt="Run a SQL cell in parallel with current running cell" src="../_images/parallel-sql-execution.png" />
</div>
</li>
</ol>
<p>Because the cell is run in a new session, temporary views, UDFs, and the <a class="reference internal" href="#implicit-sql-df"><span class="std std-ref">implicit Python DataFrame</span></a> (<code class="docutils literal notranslate"><span class="pre">_sqldf</span></code>) are not supported for cells that are executed in parallel. In addition, the default catalog and database names are used during parallel execution. If your code refers to a table in a different catalog or database, you must specify the table name using three-level namespace (<code class="docutils literal notranslate"><span class="pre">catalog</span></code>.<code class="docutils literal notranslate"><span class="pre">schema</span></code>.<code class="docutils literal notranslate"><span class="pre">table</span></code>).</p>
</div>
<div class="section" id="execute-sql-cells-on-a-sql-warehouse">
<span id="execute-sql-cells-in-parallel"></span><h3>Execute SQL cells on a SQL warehouse<a class="headerlink" href="#execute-sql-cells-on-a-sql-warehouse" title="Permalink to this headline"> </a></h3>
<div class="preview admonition">
<p class="admonition-title">Preview</p>
<p>This feature is in <a class="reference internal" href="../release-notes/release-types.html"><span class="doc">Public Preview</span></a>.</p>
</div>
<p>You can run SQL commands in a Databricks notebook on a <a class="reference internal" href="../compute/sql-warehouse/create-sql-warehouse.html"><span class="doc">SQL warehouse</span></a>, a type of compute that is optimized for SQL analytics. See <a class="reference internal" href="notebook-ui.html#notebook-sql-warehouse"><span class="std std-ref">Use a notebook with a SQL warehouse</span></a>.</p>
</div>
</div>
<div class="section" id="display-images">
<h2>Display images<a class="headerlink" href="#display-images" title="Permalink to this headline"> </a></h2>
<p>To display images stored in the <a class="reference internal" href="../dbfs/filestore.html#static-images"><span class="std std-ref">FileStore</span></a>, use the syntax:</p>
<div class="highlight-md notranslate"><div class="highlight"><pre><span></span>%md
![<span class="nt">test</span>](<span class="na">files/image.png</span>)
</pre></div>
</div>
<p>For example, suppose you have the Databricks logo image file in FileStore:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>dbfs<span class="w"> </span>ls<span class="w"> </span>dbfs:/FileStore/
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">databricks-logo-mobile.png</span>
</pre></div>
</div>
<p>When you include the following code in a Markdown cell:</p>
<div class="figure align-default">
<img alt="Image in Markdown cell" src="../_images/image-code.png" />
</div>
<p>the image is rendered in the cell:</p>
<div class="figure align-default">
<img alt="Rendered image" src="../_images/image-render.png" />
</div>
</div>
<div class="section" id="display-mathematical-equations">
<h2>Display mathematical equations<a class="headerlink" href="#display-mathematical-equations" title="Permalink to this headline"> </a></h2>
<p>Notebooks support <a class="reference external" href="https://github.com/Khan/KaTeX/wiki">KaTeX</a> for displaying mathematical formulas and equations. For example,</p>
<div class="highlight-md notranslate"><div class="highlight"><pre><span></span>%md
\\(c = \\pm\\sqrt{a^2 + b^2} \\)

\\(A{_i}{_j}=B{_i}{_j}\\)

$$c = \\pm\\sqrt{a^2 + b^2}$$

\\[A{_i}{_j}=B{_i}{_j}\\]
</pre></div>
</div>
<p>renders as:</p>
<div class="figure align-default">
<img alt="Rendered equation 1" src="../_images/equations.png" />
</div>
<p>and</p>
<div class="highlight-md notranslate"><div class="highlight"><pre><span></span>%md
\\( f(\beta)= -Y_t^T X<span class="ge">_t \beta + \sum log( 1+{e}^{X_</span>t\bullet\beta}) + \frac{1}{2}\delta^t S_t^{-1}\delta\\)

where \\(\delta=(\beta - \mu_{t-1})\\)
</pre></div>
</div>
<p>renders as:</p>
<div class="figure align-default">
<img alt="Rendered equation 2" src="../_images/equations2.png" />
</div>
</div>
<div class="section" id="include-html">
<h2>Include HTML<a class="headerlink" href="#include-html" title="Permalink to this headline"> </a></h2>
<p>You can include HTML in a notebook by using the function <code class="docutils literal notranslate"><span class="pre">displayHTML</span></code>. See <a class="reference internal" href="../visualizations/html-d3-and-svg.html"><span class="doc">HTML, D3, and SVG in notebooks</span></a> for an example of how to do this.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">displayHTML</span></code> iframe is served from the domain <code class="docutils literal notranslate"><span class="pre">databricksusercontent.com</span></code> and the iframe sandbox includes the <code class="docutils literal notranslate"><span class="pre">allow-same-origin</span></code> attribute. <code class="docutils literal notranslate"><span class="pre">databricksusercontent.com</span></code> must be accessible from your browser. If it is currently blocked by your corporate network, it must added to an allow list.</p>
</div>
</div>
<div class="section" id="link-to-other-notebooks">
<h2>Link to other notebooks<a class="headerlink" href="#link-to-other-notebooks" title="Permalink to this headline"> </a></h2>
<p>You can link to other notebooks or folders in Markdown cells using relative paths. Specify the <code class="docutils literal notranslate"><span class="pre">href</span></code>
attribute of an anchor tag as the relative path, starting with a <code class="docutils literal notranslate"><span class="pre">$</span></code> and then follow the same
pattern as in Unix file systems:</p>
<div class="highlight-md notranslate"><div class="highlight"><pre><span></span>%md
&lt;a href=&quot;$./myNotebook&quot;&gt;Link to notebook in same folder as current notebook&lt;/a&gt;
&lt;a href=&quot;$../myFolder&quot;&gt;Link to folder in parent folder of current notebook&lt;/a&gt;
&lt;a href=&quot;$./myFolder2/myNotebook2&quot;&gt;Link to nested notebook&lt;/a&gt;
</pre></div>
</div>
</div>
</div>


    
          </div>
        </div>
        <div  class="suapp-rating">
  <div id="suPageRateApp">
     <su-app></su-app>
   </div> 
 </div>
<hr> 
<footer>
  <div role="contentinfo">
      <p class="copyright">
          &copy; Databricks 2023. All rights reserved. Apache, Apache Spark, Spark, and the Spark logo are trademarks of the <a href="http://www.apache.org/">Apache Software Foundation</a>.
      </p>
      <p> 
        
          <a id='feedbacklink' href="mailto:doc-feedback@databricks.com?subject=Documentation Feedback">Send us feedback</a>
        
     | <a href="https://databricks.com/privacy-policy">Privacy Policy</a> | <a href="https://databricks.com/terms-of-use">Terms of Use</a></p>

  </div> 

</footer>
      </div>
    </div>
  </section>
</main>

  </page>
  
  <script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
      URL_ROOT: '../',
      VERSION: '1.0',
      COLLAPSE_INDEX: false,
      FILE_SUFFIX: '.html',
      HAS_SOURCE: 'false'
    };
  </script>
  <script type="text/javascript" src="../_static/jquery.js"></script>
  <script type="text/javascript" src="../_static/underscore.js"></script>
  <script type="text/javascript" src="../_static/doctools.js"></script>
  <script type="text/javascript" src="../_static/language_data.js"></script>
  

  <script type="text/javascript" src="../_static/js/clipboard.min.js"></script>
  <script type="text/javascript" src="../_static/js/jquery.waypoints.min.js"></script>

  <!-- Select2 (https://select2.org/) -->
  <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
  <!-- End Select2 -->

  
  
  <script type="text/javascript" src="../_static/js/localized.js"></script>
  <script type="text/javascript" src="../_static/js/custom.js"></script>
  

  
  
  <script type="text/javascript">
    jQuery(function () {
      SphinxRtdTheme.StickyNav.enable();
    });

  </script>
  
 



  <script>
  window.__searchunifyLoaderConfig = JSON.parse('{"clients": {"en": "02c2e804-27e9-11ee-aefb-0242ac120011", "ja": "6a42c3f2-2820-11ee-aefb-0242ac120011", "pt": "6a86badd-2821-11ee-aefb-0242ac120011"}}')
</script>
<script type="text/javascript" src="../_static/js/search-loader.js"></script>
</body>
<script type='text/javascript'>
  window.onload = function () {
    var description = document.querySelector('meta[name="description"]').getAttribute("content");
    let titleText = document.querySelector('h1').textContent;
    document.querySelector('meta[property="og:title"]').setAttribute("content", titleText);
    document.querySelector('meta[property="og:description"]').setAttribute("content", description);
    document.querySelector('meta[property="twitter:description"]').setAttribute("content", description);
  };
</script>

</html>