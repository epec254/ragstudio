

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en-US" > <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en-US"> <!--<![endif]-->

<head>
  <!-- cookie consent -->
  
    <!-- Combined Onetrust and Rudderstack Implementation Scripts -->
    <!-- Onetrust Initialization -->
    <script type="text/javascript" src="https://cdn.cookielaw.org/consent/92466579-1717-44d3-809d-a05fb02843ed-test/OtAutoBlock.js"></script>
    <script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" data-document-language="true" type="text/javascript" charset="UTF-8" data-domain-script="92466579-1717-44d3-809d-a05fb02843ed-test"></script>
    <link rel="stylesheet" id="db-onetrust-style" href="https://www.databricks.com/wp-content/uploads/db_onetrust.css" media="all" />
    <!-- Setting Rudderstack Write Key -->
    <script>window.rudderstackKey = "2SOR9fvSr5Fi6tN2ihPbVHnX1SZ" </script>
    <!-- Rudderstack Initialization + Onetrust Integration + Rudderstack Custom Events -->
    <script type="text/javascript" src="https://www.databricks.com/sites/default/files/rudderstack/v1/db-rudderstack-events.js"></script>

  <!-- cookie consent -->

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="X-UA-Compatible" content="IE=9" />
  <meta content="Learn how to enable inference tables to automatically capture and log requests and responses to model serving endpoints." name="description" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
  <meta property="og:image" content="https://www.databricks.com/wp-content/uploads/2020/04/og-databricks.png">
  <meta property="og:image:type" content="image/png">
  <meta property="og:title" content="Enable inference tables on model serving endpoints using the API">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://docs.databricks.com">
  <meta property="og:description" content="" id="og-description">
  <meta name="twitter:image" content="https://www.databricks.com/wp-content/uploads/2020/04/og-databricks.png">
  <meta name="twitter:site" content="@databricks">
  <meta name="twitter:creator" content="@databricks">
  <meta property="twitter:description" content="">
  
  <title>Enable inference tables on model serving endpoints using the API &#124; Databricks on AWS</title>
  
  
  <link rel="canonical" href="https://docs.databricks.com/en/machine-learning/model-serving/enable-model-serving-inference-tables.html">
  <!-- Start hreflang tag -->
  <link rel="alternate" hreflang="en" href="https://docs.databricks.com/en/machine-learning/model-serving/enable-model-serving-inference-tables.html" />
<link rel="alternate" hreflang="x-default" href="https://docs.databricks.com/en/machine-learning/model-serving/enable-model-serving-inference-tables.html" />
  <!-- End hreflang tag -->
  
  
  <link rel="shortcut icon" href="../../_static/favicon.ico" />
  

  

  

  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;
j.setAttributeNode(d.createAttribute('data-ot-ignore'));
f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-T85FQ33');</script>
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;
j.setAttributeNode(d.createAttribute('data-ot-ignore'));
f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-TWTKQQ');</script>
    
  <!-- End Google Tag Manager -->


  <!-- MaxMind / GEO IP -->
  <script src="//js.maxmind.com/js/apis/geoip2/v2.1/geoip2.js" type="text/javascript"></script>
  <!-- End MaxMind / GEO IP -->

  
  
  <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600&display=swap" rel="stylesheet">
  <link rel="preload" href="../../_static/fonts/DMSans-Bold.ttf" as="font">
  <link rel="preload" href="../../_static/fonts/DMSans-Regular.ttf" as="font">
  <link rel="preload" href="../../_static/fonts/DMMono-Regular.ttf" as="font">
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/cloud-provider-selector.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/translation-selector.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/searchunify/main.css" type="text/css" />

  
  <link rel="index" title="Index" href="../../genindex.html" />
  <link rel="search" title="Search" href="../../search.html" />
  <link rel="top" title="Databricks on AWS" href="../../index.html" /> 
</head>

<body class="wy-body-for-nav" role="document">

  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T85FQ33"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TWTKQQ"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->

  
  <nav class="wy-nav-top header su_header" role="navigation" aria-label="top navigation">
    
<nav class="wy-nav-top header su_header" role="navigation" aria-label="top navigation">
  <div class="container-logo">
    <ul class="mobile-menu-toggle">
        <li class="menu-toggle">
            <i data-toggle="wy-nav-top" class="wy-nav-top-menu-button db-icon db-icon-menu pull-left"></i>
            
            <a href="https://www.databricks.com/" class="wy-nav-top-logo"><img src="../../_static/small-scale-lockup-full-color-rgb.svg" width="137" height="21"
              alt="Databricks" /></a>   
               
              </li>
    </ul>
    <ul class="su_nav-menu">
      <li class="menu-toggle">
        <i data-toggle="wy-nav-top" class="wy-nav-top-menu-button db-icon db-icon-menu pull-left"></i>
        
          
        
        <a href="https://www.databricks.com/" class="wy-nav-top-logo"><img src="../../_static/small-scale-lockup-full-color-rgb.svg" width="137" height="21"
            alt="Databricks" /></a></li>
        <!-- 
<li><a href="https://help.databricks.com/s/">Help Center</a></li>
<li class="active"><a href="https://docs.databricks.com/en/">Documentation</a></li>
<li><a href="https://kb.databricks.com/">Knowledge Base</a></li>
 -->
    </ul>
  </div>
  <div class="su_nav-right">
    <ul class="su_link-mobile">
  <!-- Mobile header code can go here -->
</ul>
<ul class="right-try-list">
   
</ul>
  </div>
</nav>
  </nav>

  <div class="su_sub-header">
    <div class="container">
      <div class="su_sub-header-inner">
        <!-- <div class="su_subnav-menu-right">
  <div id="auto" style="width: 100%;">
    <div ng-controller="SearchautoController">
      <div bind-html-compile="autocompleteHtml">
        <form class="su__search-box-1" disabled="disabled">
          <input class="su__search-input" type="search" name="Search box" id="su__search-b" placeholder="Search Documentation" disabled="disabled"/>
          <button class="su__search-button" type="submit" class="button button-success" disabled="disabled">
            <svg width="24" height="24" viewBox="0 0 24 24">
              <path
                d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"
                fill="#333"></path>
            </svg>
          </button>
        </form>
      </div>
    </div>
  </div>
</div> -->
        <div class="search-lng-gap"></div>
        <div style="margin-left: 16px; margin-right: 16px;">
          <!-- <select name="lng selector" id="lng-selector">
    <option value="../../../en/machine-learning/model-serving/enable-model-serving-inference-tables.html" class="notranslate">English</option>
    <option value="../../../ja/machine-learning/model-serving/enable-model-serving-inference-tables.html" class="notranslate">日本語</option>
    <option value="../../../pt/machine-learning/model-serving/enable-model-serving-inference-tables.html" class="notranslate">Português (Brasil)</option>
</select> -->
        </div>
        <div class="cloud-selector-container">
          <!-- <select name="cloud provider selector" id="cloud-provider-selector">
    <option value="aws" selected class="notranslate">
        Amazon Web Services
    </option>
    <option value="azure"  class="notranslate">
        Microsoft Azure
    </option>
    <option value="gcp"  class="notranslate">
        Google Cloud Platform
    </option>
</select> -->
        </div>
      </div>
    </div>
  </div>
  <page class="js-page-container">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side su_nav-side">
<div class="wy-side-scroll">
  <div class="wy-side-nav-search">
    

    

    

    
  </div>

  <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
    
      <a href="../../index.html" class="main-navigation-home">Databricks on AWS</a>
    

    
      

      
        <p class="caption"><span class="caption-text">Load &amp; manage data</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../rag-temp/index.html">RAG Studio</a></li>
</ul>

      
    
  </div>

  <div role="contentinfo">
    
  <p class="build_info notranslate"data-last-edit="December 23, 2023">
    Updated Jan 11, 2024
  </p>
<script>
  window.addEventListener('DOMContentLoaded',function(){
    var h1=document.querySelector('h1');
    var bi=document.querySelector('[data-last-edit]');
    if(h1 && bi){
      var ver = document.createElement('p');
      ver.className = 'version_info';
      ver.textContent = bi.getAttribute('data-last-edit');
      h1.parentElement.insertBefore(ver, h1.nextElementSibling);
    }
  });
</script>

    <p>
      
        <a id='feedbacklink' href="mailto:doc-feedback@databricks.com?subject=Documentation Feedback">Send us feedback</a>
      
    </p>
  </div>
</div>
</nav>
    
    
<main class="wy-grid-for-nav su_nav-grid">
  <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
    <div class="wy-nav-content su__nav_content">
      <div class="rst-content">
        





<div role="navigation" aria-label="breadcrumbs navigation" class="wy-breadcrumbs-wrapper">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Documentation</a> <span class="db-icon db-icon-chevron-right"></span></li>
    
    
      <li>Enable inference tables on model serving endpoints using the API</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>
</div>
        
        <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
          <div itemprop="articleBody">
            
    
  <div class="section" id="enable-inference-tables-on-model-serving-endpoints-using-the-api">
<h1>Enable inference tables on model serving endpoints using the API<a class="headerlink" href="#enable-inference-tables-on-model-serving-endpoints-using-the-api" title="Permalink to this headline"> </a></h1>
<div class="preview admonition">
<p class="admonition-title">Preview</p>
<p>This feature is in <a class="reference internal" href="../../release-notes/release-types.html"><span class="doc">Public Preview</span></a>.</p>
</div>
<p>This article explains how to use the Databricks API to enable inference tables for a <a class="reference internal" href="index.html"><span class="doc">model serving endpoint</span></a>. For general information about using inference tables, including how to enable them using the Databricks UI, see <a class="reference internal" href="inference-tables.html"><span class="doc">Inference tables for monitoring and debugging models</span></a>.</p>
<p>You can enable inference tables when you create a new endpoint or on an existing endpoint. Databricks recommends that you create the endpoint with a service principal so that the inference table is not affected if the user who created the endpoint is removed from the workspace.</p>
<p>The owner of the inference tables is the user who created the endpoint. All access control lists (ACLs) on the table follow the standard Unity Catalog permissions and can be modified by the table owner.</p>
<div class="section" id="requirements">
<span id="requirement"></span><h2>Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline"> </a></h2>
<ul class="simple">
<li><p>Your workspace must have Unity Catalog enabled.</p></li>
<li><p>To enable inference tables on an endpoint both the creator of the endpoint and the modifier need the following permissions:</p>
<ul>
<li><p><strong>Can Manage</strong> permission on the endpoint.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">USE</span> <span class="pre">CATALOG</span></code> permissions on the specified catalog.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">USE</span> <span class="pre">SCHEMA</span></code> permissions on the specified schema.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CREATE</span> <span class="pre">TABLE</span></code> permissions in the schema.</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="enable-inference-tables-at-endpoint-creation-using-the-api">
<h2>Enable inference tables at endpoint creation using the API<a class="headerlink" href="#enable-inference-tables-at-endpoint-creation-using-the-api" title="Permalink to this headline"> </a></h2>
<p>You can enable inference tables for an endpoint during endpoint creation using the API. For instructions on creating an endpoint, see <a class="reference internal" href="create-manage-serving-endpoints.html"><span class="doc">Create and configure model serving endpoints</span></a>.</p>
<p>In the API, the request body has an <code class="docutils literal notranslate"><span class="pre">auto_capture_config</span></code> to specify:</p>
<ul class="simple">
<li><p>The Unity Catalog catalog: string representing the catalog to store the table</p></li>
<li><p>The Unity Catalog schema: string representing the schema to store the table</p></li>
<li><p>(optional) table prefix: string used as a prefix for the inference table name. If this isn’t specified, the endpoint name is used.</p></li>
<li><p>(optional) enabled: boolean value used to enable or disable inference tables. This true by default.</p></li>
</ul>
<p>After specifying a catalog, schema, and optionally table prefix, a table is created at <code class="docutils literal notranslate"><span class="pre">&lt;catalog&gt;.&lt;schema&gt;.&lt;table_prefix&gt;_payload</span></code>. This table automatically creates a <a class="reference internal" href="../../data-governance/unity-catalog/create-tables.html"><span class="doc">Unity Catalog managed table</span></a>. The owner of the table is the user who creates the endpoint.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Specifying an existing table is not supported since the inference table is always automatically created on endpoint creation or endpoint updates.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The inference table could become corrupted if you do any of the following:</p>
<ul class="simple">
<li><p>Change the table schema.</p></li>
<li><p>Change the table name.</p></li>
<li><p>Delete the table.</p></li>
<li><p>Lose permissions to the Unity Catalog catalog or schema.</p></li>
</ul>
<p>In this case, the <code class="docutils literal notranslate"><span class="pre">auto_capture_config</span></code> of the endpoint status shows a <code class="docutils literal notranslate"><span class="pre">FAILED</span></code> state for the payload table. If this happens, you must create a new endpoint to continue using inference tables.</p>
</div>
<p>The following example demonstrates how to enable inference tables during endpoint creation.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>POST<span class="w"> </span>/api/2.0/serving-endpoints

<span class="o">{</span>
<span class="w">  </span><span class="s2">&quot;name&quot;</span>:<span class="w"> </span><span class="s2">&quot;feed-ads&quot;</span>,
<span class="w">  </span><span class="s2">&quot;config&quot;</span>:<span class="o">{</span>
<span class="w">    </span><span class="s2">&quot;served_models&quot;</span>:<span class="w"> </span><span class="o">[</span>
<span class="w">      </span><span class="o">{</span>
<span class="w">       </span><span class="s2">&quot;model_name&quot;</span>:<span class="w"> </span><span class="s2">&quot;ads1&quot;</span>,
<span class="w">       </span><span class="s2">&quot;model_version&quot;</span>:<span class="w"> </span><span class="s2">&quot;1&quot;</span>,
<span class="w">       </span><span class="s2">&quot;workload_size&quot;</span>:<span class="w"> </span><span class="s2">&quot;Small&quot;</span>,
<span class="w">       </span><span class="s2">&quot;scale_to_zero_enabled&quot;</span>:<span class="w"> </span><span class="nb">true</span>
<span class="w">      </span><span class="o">}</span>
<span class="w">    </span><span class="o">]</span>,
<span class="w">    </span><span class="s2">&quot;auto_capture_config&quot;</span>:<span class="o">{</span>
<span class="w">       </span><span class="s2">&quot;catalog_name&quot;</span>:<span class="w"> </span><span class="s2">&quot;ml&quot;</span>,
<span class="w">       </span><span class="s2">&quot;schema_name&quot;</span>:<span class="w"> </span><span class="s2">&quot;ads&quot;</span>,
<span class="w">       </span><span class="s2">&quot;table_name_prefix&quot;</span>:<span class="w"> </span><span class="s2">&quot;feed-ads-prod&quot;</span>
<span class="w">    </span><span class="o">}</span>
<span class="w">  </span><span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<p>The response looks like:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;feed-ads&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;creator&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;customer@example.com&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;creation_timestamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1666829055000</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;last_updated_timestamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1666829055000</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;state&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;ready&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;NOT_READY&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;config_update&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;IN_PROGRESS&quot;</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;pending_config&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;start_time&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1666718879000</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;served_models&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">      </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ads1-1&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;model_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ads1&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;model_version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;workload_size&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Small&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;scale_to_zero_enabled&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;state&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;deployment&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;DEPLOYMENT_CREATING&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;deployment_state_message&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Creating&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;creator&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;customer@example.com&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;creation_timestamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1666829055000</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">   </span><span class="p">],</span>
<span class="w">   </span><span class="nt">&quot;config_version&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<span class="w">   </span><span class="nt">&quot;traffic_config&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="nt">&quot;routes&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">       </span><span class="p">{</span>
<span class="w">         </span><span class="nt">&quot;served_model_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ads1-1&quot;</span><span class="p">,</span>
<span class="w">         </span><span class="nt">&quot;traffic_percentage&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span>
<span class="w">       </span><span class="p">}</span>
<span class="w">      </span><span class="p">]</span>
<span class="w">   </span><span class="p">},</span>
<span class="w">   </span><span class="nt">&quot;auto_capture_config&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="nt">&quot;catalog_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ml&quot;</span><span class="p">,</span>
<span class="w">     </span><span class="nt">&quot;schema_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ads&quot;</span><span class="p">,</span>
<span class="w">     </span><span class="nt">&quot;table_name_prefix&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;feed-ads-prod&quot;</span><span class="p">,</span>
<span class="w">     </span><span class="nt">&quot;state&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">       </span><span class="nt">&quot;payload_table&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">         </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;feed-ads-prod_payload&quot;</span>
<span class="w">       </span><span class="p">}</span>
<span class="w">     </span><span class="p">},</span>
<span class="w">     </span><span class="nt">&quot;enabled&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">   </span><span class="p">}</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;permission_level&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;CAN_MANAGE&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Once logging to inference tables has been enabled, wait until your endpoint is ready. Then you can start calling it.</p>
<p>After you create an inference table, schema evolution and adding data should be handled by the system.</p>
<p>The following operations do not impact the integrity of the table:</p>
<ul class="simple">
<li><p>Running OPTIMIZE, ANALYZE, and VACUUM against the table.</p></li>
<li><p>Deleting old unused data.</p></li>
</ul>
<p>If you don’t specify an <code class="docutils literal notranslate"><span class="pre">auto_capture_config</span></code>, by default the settings configuration from the previous configuration version is re-used. For example, if inference tables was already enabled, the same settings are used on the next endpoint update or if inference tables was disabled, then it continues being disabled.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;served_models&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;current&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;model_name&quot;</span><span class="p">:</span><span class="s2">&quot;model-A&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;model_version&quot;</span><span class="p">:</span><span class="s2">&quot;1&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;workload_size&quot;</span><span class="p">:</span><span class="s2">&quot;Small&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;scale_to_zero_enabled&quot;</span><span class="p">:</span><span class="kc">true</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">],</span>
<span class="w">  </span><span class="nt">&quot;auto_capture_config&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;enabled&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="enable-inference-tables-on-an-existing-endpoint-using-the-api">
<h2>Enable inference tables on an existing endpoint using the API<a class="headerlink" href="#enable-inference-tables-on-an-existing-endpoint-using-the-api" title="Permalink to this headline"> </a></h2>
<p>You can also enable inference tables on an existing endpoint using the API. After inference tables are enabled, continue specifying the same <code class="docutils literal notranslate"><span class="pre">auto_capture_config</span></code> body in future update endpoint API calls to continue using inference tables.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Changing the table location after enabling inference tables is not supported.</p>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>PUT<span class="w"> </span>/api/2.0/serving-endpoints/<span class="o">{</span>name<span class="o">}</span>/config

<span class="o">{</span>
<span class="w">  </span><span class="s2">&quot;served_models&quot;</span>:<span class="w"> </span><span class="o">[</span>
<span class="w">    </span><span class="o">{</span>
<span class="w">      </span><span class="s2">&quot;name&quot;</span>:<span class="s2">&quot;current&quot;</span>,
<span class="w">      </span><span class="s2">&quot;model_name&quot;</span>:<span class="s2">&quot;model-A&quot;</span>,
<span class="w">      </span><span class="s2">&quot;model_version&quot;</span>:<span class="s2">&quot;1&quot;</span>,
<span class="w">      </span><span class="s2">&quot;workload_size&quot;</span>:<span class="s2">&quot;Small&quot;</span>,
<span class="w">      </span><span class="s2">&quot;scale_to_zero_enabled&quot;</span>:true
<span class="w">    </span><span class="o">}</span>,
<span class="w">    </span><span class="o">{</span>
<span class="w">      </span><span class="s2">&quot;name&quot;</span>:<span class="s2">&quot;challenger&quot;</span>,
<span class="w">      </span><span class="s2">&quot;model_name&quot;</span>:<span class="s2">&quot;model-B&quot;</span>,
<span class="w">      </span><span class="s2">&quot;model_version&quot;</span>:<span class="s2">&quot;1&quot;</span>,
<span class="w">      </span><span class="s2">&quot;workload_size&quot;</span>:<span class="s2">&quot;Small&quot;</span>,
<span class="w">      </span><span class="s2">&quot;scale_to_zero_enabled&quot;</span>:true
<span class="w">    </span><span class="o">}</span>
<span class="w">  </span><span class="o">]</span>,
<span class="w">  </span><span class="s2">&quot;traffic_config&quot;</span>:<span class="o">{</span>
<span class="w">    </span><span class="s2">&quot;routes&quot;</span>:<span class="w"> </span><span class="o">[</span>
<span class="w">      </span><span class="o">{</span>
<span class="w">        </span><span class="s2">&quot;served_model_name&quot;</span>:<span class="s2">&quot;current&quot;</span>,
<span class="w">        </span><span class="s2">&quot;traffic_percentage&quot;</span>:<span class="s2">&quot;50&quot;</span>
<span class="w">      </span><span class="o">}</span>,
<span class="w">      </span><span class="o">{</span>
<span class="w">        </span><span class="s2">&quot;served_model_name&quot;</span>:<span class="s2">&quot;challenger&quot;</span>,
<span class="w">        </span><span class="s2">&quot;traffic_percentage&quot;</span>:<span class="s2">&quot;50&quot;</span>
<span class="w">      </span><span class="o">}</span>
<span class="w">    </span><span class="o">]</span>
<span class="w">  </span><span class="o">}</span>,
<span class="w">  </span><span class="s2">&quot;auto_capture_config&quot;</span>:<span class="o">{</span>
<span class="w">   </span><span class="s2">&quot;catalog_name&quot;</span>:<span class="w"> </span><span class="s2">&quot;catalog&quot;</span>,
<span class="w">   </span><span class="s2">&quot;schema_name&quot;</span>:<span class="w"> </span><span class="s2">&quot;schema&quot;</span>,
<span class="w">   </span><span class="s2">&quot;table_name_prefix&quot;</span>:<span class="w"> </span><span class="s2">&quot;my-endpoint&quot;</span>
<span class="w">  </span><span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
<div class="section" id="disable-inference-tables">
<h2>Disable inference tables<a class="headerlink" href="#disable-inference-tables" title="Permalink to this headline"> </a></h2>
<p>When disabling inference tables, you do not need to specify catalog, schema, or table prefix. The only required field is <code class="docutils literal notranslate"><span class="pre">enabled:</span> <span class="pre">false</span></code>.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>When you disable inference tables on an endpoint, you cannot re-enable them. To continue using inference tables, you must create a new endpoint and enable inference tables on it.</p>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>POST<span class="w"> </span>/api/2.0/serving-endpoints

<span class="o">{</span>
<span class="w">  </span><span class="s2">&quot;name&quot;</span>:<span class="w"> </span><span class="s2">&quot;feed-ads&quot;</span>,
<span class="w">  </span><span class="s2">&quot;config&quot;</span>:<span class="o">{</span>
<span class="w">    </span><span class="s2">&quot;served_models&quot;</span>:<span class="w"> </span><span class="o">[</span>
<span class="w">      </span><span class="o">{</span>
<span class="w">       </span><span class="s2">&quot;model_name&quot;</span>:<span class="w"> </span><span class="s2">&quot;ads1&quot;</span>,
<span class="w">       </span><span class="s2">&quot;model_version&quot;</span>:<span class="w"> </span><span class="s2">&quot;1&quot;</span>,
<span class="w">       </span><span class="s2">&quot;workload_size&quot;</span>:<span class="w"> </span><span class="s2">&quot;Small&quot;</span>,
<span class="w">       </span><span class="s2">&quot;scale_to_zero_enabled&quot;</span>:<span class="w"> </span><span class="nb">true</span>
<span class="w">      </span><span class="o">}</span>
<span class="w">    </span><span class="o">]</span>,
<span class="w">    </span><span class="s2">&quot;auto_capture_config&quot;</span>:<span class="o">{</span>
<span class="w">       </span><span class="s2">&quot;enabled&quot;</span>:<span class="w"> </span><span class="nb">false</span>
<span class="w">    </span><span class="o">}</span>
<span class="w">  </span><span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
<div class="section" id="next-steps">
<h2>Next steps<a class="headerlink" href="#next-steps" title="Permalink to this headline"> </a></h2>
<p>After you enable inference tables, you can monitor the served models in your model serving endpoint with Databricks Lakehouse Monitoring. For details, see <a class="reference internal" href="inference-tables.html#model-monitoring"><span class="std std-ref">Workflow: Monitor model performance using inference tables</span></a>.</p>
</div>
</div>


    
          </div>
        </div>
        <div  class="suapp-rating">
  <div id="suPageRateApp">
     <su-app></su-app>
   </div> 
 </div>
<hr> 
<footer>
  <div role="contentinfo">
      <p class="copyright">
          &copy; Databricks 2023. All rights reserved. Apache, Apache Spark, Spark, and the Spark logo are trademarks of the <a href="http://www.apache.org/">Apache Software Foundation</a>.
      </p>
      <p> 
        
          <a id='feedbacklink' href="mailto:doc-feedback@databricks.com?subject=Documentation Feedback">Send us feedback</a>
        
     | <a href="https://databricks.com/privacy-policy">Privacy Policy</a> | <a href="https://databricks.com/terms-of-use">Terms of Use</a></p>

  </div> 

</footer>
      </div>
    </div>
  </section>
</main>

  </page>
  
  <script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
      URL_ROOT: '../../',
      VERSION: '1.0',
      COLLAPSE_INDEX: false,
      FILE_SUFFIX: '.html',
      HAS_SOURCE: 'false'
    };
  </script>
  <script type="text/javascript" src="../../_static/jquery.js"></script>
  <script type="text/javascript" src="../../_static/underscore.js"></script>
  <script type="text/javascript" src="../../_static/doctools.js"></script>
  <script type="text/javascript" src="../../_static/language_data.js"></script>
  

  <script type="text/javascript" src="../../_static/js/clipboard.min.js"></script>
  <script type="text/javascript" src="../../_static/js/jquery.waypoints.min.js"></script>

  <!-- Select2 (https://select2.org/) -->
  <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
  <!-- End Select2 -->

  
  
  <script type="text/javascript" src="../../_static/js/localized.js"></script>
  <script type="text/javascript" src="../../_static/js/custom.js"></script>
  

  
  
  <script type="text/javascript">
    jQuery(function () {
      SphinxRtdTheme.StickyNav.enable();
    });

  </script>
  
 



  <script>
  window.__searchunifyLoaderConfig = JSON.parse('{"clients": {"en": "02c2e804-27e9-11ee-aefb-0242ac120011", "ja": "6a42c3f2-2820-11ee-aefb-0242ac120011", "pt": "6a86badd-2821-11ee-aefb-0242ac120011"}}')
</script>
<script type="text/javascript" src="../../_static/js/search-loader.js"></script>
</body>
<script type='text/javascript'>
  window.onload = function () {
    var description = document.querySelector('meta[name="description"]').getAttribute("content");
    let titleText = document.querySelector('h1').textContent;
    document.querySelector('meta[property="og:title"]').setAttribute("content", titleText);
    document.querySelector('meta[property="og:description"]').setAttribute("content", description);
    document.querySelector('meta[property="twitter:description"]').setAttribute("content", description);
  };
</script>

</html>