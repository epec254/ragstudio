

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en-US" > <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en-US"> <!--<![endif]-->

<head>
  <!-- cookie consent -->
  
    <!-- Combined Onetrust and Rudderstack Implementation Scripts -->
    <!-- Onetrust Initialization -->
    <script type="text/javascript" src="https://cdn.cookielaw.org/consent/92466579-1717-44d3-809d-a05fb02843ed-test/OtAutoBlock.js"></script>
    <script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" data-document-language="true" type="text/javascript" charset="UTF-8" data-domain-script="92466579-1717-44d3-809d-a05fb02843ed-test"></script>
    <link rel="stylesheet" id="db-onetrust-style" href="https://www.databricks.com/wp-content/uploads/db_onetrust.css" media="all" />
    <!-- Setting Rudderstack Write Key -->
    <script>window.rudderstackKey = "2SOR9fvSr5Fi6tN2ihPbVHnX1SZ" </script>
    <!-- Rudderstack Initialization + Onetrust Integration + Rudderstack Custom Events -->
    <script type="text/javascript" src="https://www.databricks.com/sites/default/files/rudderstack/v1/db-rudderstack-events.js"></script>

  <!-- cookie consent -->

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="X-UA-Compatible" content="IE=9" />
  <meta content="Learn how to upgrade workspace tables and views to Unity Catalog." name="description" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
  <meta property="og:image" content="https://www.databricks.com/wp-content/uploads/2020/04/og-databricks.png">
  <meta property="og:image:type" content="image/png">
  <meta property="og:title" content="Upgrade tables and views to Unity Catalog">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://docs.databricks.com">
  <meta property="og:description" content="" id="og-description">
  <meta name="twitter:image" content="https://www.databricks.com/wp-content/uploads/2020/04/og-databricks.png">
  <meta name="twitter:site" content="@databricks">
  <meta name="twitter:creator" content="@databricks">
  <meta property="twitter:description" content="">
  
  <title>Upgrade tables and views to Unity Catalog &#124; Databricks on AWS</title>
  
  
  <link rel="canonical" href="https://docs.databricks.com/en/data-governance/unity-catalog/migrate.html">
  <!-- Start hreflang tag -->
  <link rel="alternate" hreflang="en" href="https://docs.databricks.com/en/data-governance/unity-catalog/migrate.html" />
<link rel="alternate" hreflang="x-default" href="https://docs.databricks.com/en/data-governance/unity-catalog/migrate.html" />
  <!-- End hreflang tag -->
  
  
  <link rel="shortcut icon" href="../../_static/favicon.ico" />
  

  

  

  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;
j.setAttributeNode(d.createAttribute('data-ot-ignore'));
f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-T85FQ33');</script>
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;
j.setAttributeNode(d.createAttribute('data-ot-ignore'));
f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-TWTKQQ');</script>
    
  <!-- End Google Tag Manager -->


  <!-- MaxMind / GEO IP -->
  <script src="//js.maxmind.com/js/apis/geoip2/v2.1/geoip2.js" type="text/javascript"></script>
  <!-- End MaxMind / GEO IP -->

  
  
  <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600&display=swap" rel="stylesheet">
  <link rel="preload" href="../../_static/fonts/DMSans-Bold.ttf" as="font">
  <link rel="preload" href="../../_static/fonts/DMSans-Regular.ttf" as="font">
  <link rel="preload" href="../../_static/fonts/DMMono-Regular.ttf" as="font">
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/cloud-provider-selector.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/translation-selector.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/searchunify/main.css" type="text/css" />

  
  <link rel="index" title="Index" href="../../genindex.html" />
  <link rel="search" title="Search" href="../../search.html" />
  <link rel="top" title="Databricks on AWS" href="../../index.html" /> 
</head>

<body class="wy-body-for-nav" role="document">

  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T85FQ33"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TWTKQQ"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->

  
  <nav class="wy-nav-top header su_header" role="navigation" aria-label="top navigation">
    
<nav class="wy-nav-top header su_header" role="navigation" aria-label="top navigation">
  <div class="container-logo">
    <ul class="mobile-menu-toggle">
        <li class="menu-toggle">
            <i data-toggle="wy-nav-top" class="wy-nav-top-menu-button db-icon db-icon-menu pull-left"></i>
            
            <a href="https://www.databricks.com/" class="wy-nav-top-logo"><img src="../../_static/small-scale-lockup-full-color-rgb.svg" width="137" height="21"
              alt="Databricks" /></a>   
               
              </li>
    </ul>
    <ul class="su_nav-menu">
      <li class="menu-toggle">
        <i data-toggle="wy-nav-top" class="wy-nav-top-menu-button db-icon db-icon-menu pull-left"></i>
        
          
        
        <a href="https://www.databricks.com/" class="wy-nav-top-logo"><img src="../../_static/small-scale-lockup-full-color-rgb.svg" width="137" height="21"
            alt="Databricks" /></a></li>
        <!-- 
<li><a href="https://help.databricks.com/s/">Help Center</a></li>
<li class="active"><a href="https://docs.databricks.com/en/">Documentation</a></li>
<li><a href="https://kb.databricks.com/">Knowledge Base</a></li>
 -->
    </ul>
  </div>
  <div class="su_nav-right">
    <ul class="su_link-mobile">
  <!-- Mobile header code can go here -->
</ul>
<ul class="right-try-list">
   
</ul>
  </div>
</nav>
  </nav>

  <div class="su_sub-header">
    <div class="container">
      <div class="su_sub-header-inner">
        <!-- <div class="su_subnav-menu-right">
  <div id="auto" style="width: 100%;">
    <div ng-controller="SearchautoController">
      <div bind-html-compile="autocompleteHtml">
        <form class="su__search-box-1" disabled="disabled">
          <input class="su__search-input" type="search" name="Search box" id="su__search-b" placeholder="Search Documentation" disabled="disabled"/>
          <button class="su__search-button" type="submit" class="button button-success" disabled="disabled">
            <svg width="24" height="24" viewBox="0 0 24 24">
              <path
                d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"
                fill="#333"></path>
            </svg>
          </button>
        </form>
      </div>
    </div>
  </div>
</div> -->
        <div class="search-lng-gap"></div>
        <div style="margin-left: 16px; margin-right: 16px;">
          <!-- <select name="lng selector" id="lng-selector">
    <option value="../../../en/data-governance/unity-catalog/migrate.html" class="notranslate">English</option>
    <option value="../../../ja/data-governance/unity-catalog/migrate.html" class="notranslate">日本語</option>
    <option value="../../../pt/data-governance/unity-catalog/migrate.html" class="notranslate">Português (Brasil)</option>
</select> -->
        </div>
        <div class="cloud-selector-container">
          <!-- <select name="cloud provider selector" id="cloud-provider-selector">
    <option value="aws" selected class="notranslate">
        Amazon Web Services
    </option>
    <option value="azure"  class="notranslate">
        Microsoft Azure
    </option>
    <option value="gcp"  class="notranslate">
        Google Cloud Platform
    </option>
</select> -->
        </div>
      </div>
    </div>
  </div>
  <page class="js-page-container">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side su_nav-side">
<div class="wy-side-scroll">
  <div class="wy-side-nav-search">
    

    

    

    
  </div>

  <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
    
      <a href="../../index.html" class="main-navigation-home">Databricks on AWS</a>
    

    
      

      
        <p class="caption"><span class="caption-text">Load &amp; manage data</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../rag-temp/index.html">RAG Studio</a></li>
</ul>

      
    
  </div>

  <div role="contentinfo">
    
  <p class="build_info notranslate"data-last-edit="December 23, 2023">
    Updated Jan 11, 2024
  </p>
<script>
  window.addEventListener('DOMContentLoaded',function(){
    var h1=document.querySelector('h1');
    var bi=document.querySelector('[data-last-edit]');
    if(h1 && bi){
      var ver = document.createElement('p');
      ver.className = 'version_info';
      ver.textContent = bi.getAttribute('data-last-edit');
      h1.parentElement.insertBefore(ver, h1.nextElementSibling);
    }
  });
</script>

    <p>
      
        <a id='feedbacklink' href="mailto:doc-feedback@databricks.com?subject=Documentation Feedback">Send us feedback</a>
      
    </p>
  </div>
</div>
</nav>
    
    
<main class="wy-grid-for-nav su_nav-grid">
  <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
    <div class="wy-nav-content su__nav_content">
      <div class="rst-content">
        





<div role="navigation" aria-label="breadcrumbs navigation" class="wy-breadcrumbs-wrapper">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Documentation</a> <span class="db-icon db-icon-chevron-right"></span></li>
    
    
      <li>Upgrade tables and views to Unity Catalog</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>
</div>
        
        <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
          <div itemprop="articleBody">
            
    
  <div class="section" id="upgrade-tables-and-views-to-unity-catalog">
<span id="upgrade-tables-and-views-to-uc"></span><h1>Upgrade tables and views to Unity Catalog<a class="headerlink" href="#upgrade-tables-and-views-to-unity-catalog" title="Permalink to this headline"> </a></h1>
<p>This article describes how to upgrade tables and views registered in your existing Hive metastore to Unity Catalog.</p>
<p>To determine whether a table is currently registered in Unity Catalog, check the catalog name. Tables in the catalog <code class="docutils literal notranslate"><span class="pre">hive_metastore</span></code> are registered in the Hive metastore. Any other catalogs listed are governed by Unity Catalog.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Unity Catalog manages partitions differently than Hive. Hive commands that directly manipulate partitions are not supported on tables managed by Unity Catalog.</p>
</div>
<div class="section" id="upgrade-a-schema-or-multiple-tables-to-unity-catalog">
<h2>Upgrade a schema or multiple tables to Unity Catalog<a class="headerlink" href="#upgrade-a-schema-or-multiple-tables-to-unity-catalog" title="Permalink to this headline"> </a></h2>
<p>You can copy complete schemas (databases) and multiple external tables from your default Hive metastore to the Unity Catalog metastore using the <strong>Catalog Explorer</strong> upgrade wizard.</p>
<div class="section" id="requirements">
<h3>Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline"> </a></h3>
<p>Before you begin, you must have:</p>
<ul class="simple">
<li><p>A <a class="reference internal" href="../../connect/unity-catalog/storage-credentials.html"><span class="doc">storage credential</span></a> with an IAM role that authorizes Unity Catalog to access the tables’ location path.</p></li>
<li><p>An <a class="reference internal" href="../../connect/unity-catalog/external-locations.html"><span class="doc">external location</span></a> that references the storage credential you just created and the path to the data on your cloud tenant.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CREATE</span> <span class="pre">EXTERNAL</span> <span class="pre">TABLE</span></code> permission on the external locations of the tables to be upgraded.</p></li>
</ul>
</div>
<div class="section" id="upgrade-process">
<h3>Upgrade process<a class="headerlink" href="#upgrade-process" title="Permalink to this headline"> </a></h3>
<ol class="arabic">
<li><p>Click <img alt="Catalog icon" src="../../_images/data-icon.png" /> <strong>Catalog</strong> in the sidebar to open the <a class="reference internal" href="../../catalog-explorer/index.html"><span class="doc">Catalog Explorer</span></a>.</p></li>
<li><p>Select <code class="docutils literal notranslate"><span class="pre">hive_metastore</span></code> as your catalog and select the schema (database) that you want to upgrade.</p>
<div class="figure align-default">
<img alt="Select database" src="../../_images/data-explorer-select-database.png" />
</div>
</li>
<li><p>Click <strong>Upgrade</strong> at the top right of the schema detail view.</p>
<p></p>
</li>
<li><p>Select all of the tables that you want to upgrade and click <strong>Next</strong>.</p>
<p>Only <a class="reference internal" href="create-tables.html#create-an-external-table"><span class="std std-ref">external tables</span></a> in <a class="reference internal" href="index.html#external-table"><span class="std std-ref">formats supported by Unity Catalog</span></a> can be upgraded using the upgrade wizard.</p>
</li>
<li><p>Set the destination catalog, schema (database), and owner for each table.</p>
<p>Users will be able to access the newly created table in the context of their privileges on the <a class="reference internal" href="index.html#object-model"><span class="std std-ref">catalog and schema</span></a>.</p>
<p>Table owners have all privileges on the table, including <code class="docutils literal notranslate"><span class="pre">SELECT</span></code> and <code class="docutils literal notranslate"><span class="pre">MODIFY</span></code>. If you don’t select an owner, the managed tables are created with you as the owner. Databricks generally recommends that you grant table ownership to groups. To learn more about object ownership in Unity Catalog, see <a class="reference internal" href="manage-privileges/ownership.html"><span class="doc">Manage Unity Catalog object ownership</span></a>.</p>
<p>To assign the same catalog and schema to multiple tables, select the tables and click the <strong>Set destination</strong> button.</p>
<p>To assign the same owner to multiple tables, select the tables and click the <strong>Set owner</strong> button.</p>
</li>
<li><p>Review the table configurations. To modify them, click the <strong>Previous</strong> button.</p></li>
<li><p>Click <strong>Create Query for Upgrade</strong>.</p>
<p>A query editor appears with generated SQL statements.</p>
</li>
<li><p>Run the query.</p>
<p>When the query is done, each table’s metadata has been copied from Hive metastore to Unity Catalog. These tables are marked as upgraded in the upgrade wizard.</p>
</li>
<li><p>Define fine-grained access control using the <strong>Permissions</strong> tab of each new table.</p></li>
<li><p>Modify your workloads to use the new table.</p></li>
</ol>
</div>
</div>
<div class="section" id="upgrade-a-single-external-table-to-unity-catalog">
<span id="upgrade-a-single-external-table-to-uc"></span><span id="migrate-external"></span><h2>Upgrade a single external table to Unity Catalog<a class="headerlink" href="#upgrade-a-single-external-table-to-unity-catalog" title="Permalink to this headline"> </a></h2>
<p>You can copy an external table from your default Hive metastore to the Unity Catalog metastore using the <strong>Catalog Explorer</strong>.</p>
<div class="section" id="requirements">
<span id="requirements-1"></span><h3>Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline"> </a></h3>
<p>Before you begin, you must have:</p>
<ul class="simple">
<li><p>A <a class="reference internal" href="../../connect/unity-catalog/storage-credentials.html"><span class="doc">storage credential</span></a> with an IAM role that authorizes Unity Catalog to access the table’s location path.</p></li>
<li><p>An <a class="reference internal" href="../../connect/unity-catalog/external-locations.html"><span class="doc">external location</span></a> that references the storage credential you just created and the path to the data on your cloud tenant.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CREATE</span> <span class="pre">EXTERNAL</span> <span class="pre">TABLE</span></code> permission on the external location of the table to be upgraded.</p></li>
</ul>
</div>
<div class="section" id="upgrade-process">
<span id="upgrade-process-1"></span><h3>Upgrade process<a class="headerlink" href="#upgrade-process" title="Permalink to this headline"> </a></h3>
<p>To upgrade an external table:</p>
<ol class="arabic">
<li><p>Click <img alt="Catalog icon" src="../../_images/data-icon.png" /> <strong>Catalog</strong> in the sidebar to open <a class="reference internal" href="../../catalog-explorer/index.html"><span class="doc">Catalog Explorer</span></a>.</p></li>
<li><p>Select the database, then the table, that you want to upgrade.</p></li>
<li><p>Click <strong>Upgrade action</strong> in the top-right corner of the table detail view.</p></li>
<li><p>Select your destination catalog, schema (database), and owner.</p>
<p>Users will be able to access the newly created table in the context of their privileges on the <a class="reference internal" href="index.html#object-model"><span class="std std-ref">catalog and schema</span></a>.</p>
<p>Table owners have all privileges on the table, including <code class="docutils literal notranslate"><span class="pre">SELECT</span></code> and <code class="docutils literal notranslate"><span class="pre">MODIFY</span></code>. If you don’t select an owner, the managed table is created with you as the owner. Databricks generally recommends that you grant table ownership to groups. To learn more about object ownership in Unity Catalog, see <a class="reference internal" href="manage-privileges/ownership.html"><span class="doc">Manage Unity Catalog object ownership</span></a>.</p>
</li>
<li><p>Click <strong>Upgrade</strong>.</p>
<p>The table metadata is now copied to Unity Catalog, and a new table has been created. You can now use the <strong>Permissions</strong> tab to define fine-grained access control.</p>
</li>
<li><p>Modify existing workloads to use the new table.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you no longer need the old table, you can drop it from the Hive Metastore. Dropping an external table does not modify the data files on your cloud tenant.</p>
</div>
</li>
</ol>
</div>
</div>
<div class="section" id="upgrade-a-view-to-unity-catalog">
<span id="upgrade-a-view-to-uc"></span><h2>Upgrade a view to Unity Catalog<a class="headerlink" href="#upgrade-a-view-to-unity-catalog" title="Permalink to this headline"> </a></h2>
<p>After you upgrade all of a view’s referenced tables to the same Unity Catalog metastore, you can <a class="reference internal" href="create-views.html"><span class="doc">create a new view</span></a> that references the new tables.</p>
</div>
<div class="section" id="upgrade-a-table-to-a-unity-catalog-managed-table">
<span id="upgrade-a-table-to-a-uc-managed-table"></span><span id="migrate-managed"></span><h2>Upgrade a table to a Unity Catalog managed table<a class="headerlink" href="#upgrade-a-table-to-a-unity-catalog-managed-table" title="Permalink to this headline"> </a></h2>
<p>To upgrade a table to Unity Catalog as a managed table:</p>
<ol class="arabic">
<li><p>Create a new Unity Catalog table by querying the existing table. Replace the placeholder values:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;catalog&gt;</span></code>: The Unity Catalog catalog for the new table.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;new-schema&gt;</span></code>: The Unity Catalog schema for the new table.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;new-table&gt;</span></code>: A name for the Unity Catalog table.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;old-schema&gt;</span></code>: The schema for the old table, such as <code class="docutils literal notranslate"><span class="pre">default</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;old-table&gt;</span></code>: The name of the old table.</p></li>
</ul>
<div class="js-code-language-tabs js-code-language-tabs--literal compound">
<div class="compound-first highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="o">&lt;</span><span class="k">catalog</span><span class="o">&gt;</span><span class="p">.</span><span class="o">&lt;</span><span class="k">new</span><span class="o">-</span><span class="k">schema</span><span class="o">&gt;</span><span class="p">.</span><span class="o">&lt;</span><span class="k">new</span><span class="o">-</span><span class="k">table</span><span class="o">&gt;</span>
<span class="k">AS</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">hive_metastore</span><span class="p">.</span><span class="o">&lt;</span><span class="k">old</span><span class="o">-</span><span class="k">schema</span><span class="o">&gt;</span><span class="p">.</span><span class="o">&lt;</span><span class="k">old</span><span class="o">-</span><span class="k">table</span><span class="o">&gt;</span><span class="p">;</span>
</pre></div>
</div>
<div class="compound-middle highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="s2">&quot;hive_metastore.&lt;old-schema&gt;.&lt;old-table&gt;&quot;</span><span class="p">)</span>

<span class="n">df</span><span class="o">.</span><span class="n">write</span><span class="o">.</span><span class="n">saveAsTable</span><span class="p">(</span>
  <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;&lt;catalog&gt;.&lt;new-schema&gt;.&lt;new-table&gt;&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="compound-middle highlight-r notranslate"><div class="highlight"><pre><span></span>%<span class="n">r</span>
<span class="nf">library</span><span class="p">(</span><span class="n">SparkR</span><span class="p">)</span>

<span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">tableToDF</span><span class="p">(</span><span class="s">&quot;hive_metastore.&lt;old-schema&gt;.&lt;old-table&gt;&quot;</span><span class="p">)</span>

<span class="nf">saveAsTable</span><span class="p">(</span>
<span class="w">  </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df</span><span class="p">,</span>
<span class="w">  </span><span class="n">tableName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&lt;catalog&gt;.&lt;new-schema&gt;.&lt;new-table&gt;&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="compound-last highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="n">table</span><span class="p">(</span><span class="s">&quot;hive_metastore.&lt;old-schema&gt;.&lt;old-table&gt;&quot;</span><span class="p">)</span>

<span class="n">df</span><span class="p">.</span><span class="n">write</span><span class="p">.</span><span class="n">saveAsTable</span><span class="p">(</span>
<span class="w">  </span><span class="n">tableName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&lt;catalog&gt;.&lt;new-schema&gt;.&lt;new-table&gt;&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<p>If you want to migrate only some columns or rows, modify the <code class="docutils literal notranslate"><span class="pre">SELECT</span></code> statement.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This command creates a <a class="reference internal" href="create-tables.html#create-a-managed-table"><span class="std std-ref">managed table</span></a> in which data is copied into the storage location that was nominated when the metastore was set up. To create an <a class="reference internal" href="create-tables.html#create-an-external-table"><span class="std std-ref">external table</span></a>, where a table is registered in Unity Catalog without moving the data in cloud storage, see <a class="reference internal" href="#migrate-external"><span class="std std-ref">Upgrade a single external table to Unity Catalog</span></a>.</p>
</div>
</li>
<li><p>Grant account-level users or groups access to the new table. See <a class="reference internal" href="manage-privileges/index.html"><span class="doc">Manage privileges in Unity Catalog</span></a>.</p></li>
<li><p>After the table is migrated, users should update their existing queries and workloads to use the new table.</p></li>
<li><p>Before you drop the old table, test for dependencies by revoking access to it and re-running related queries and workloads.</p></li>
</ol>
</div>
</div>


    
          </div>
        </div>
        <div  class="suapp-rating">
  <div id="suPageRateApp">
     <su-app></su-app>
   </div> 
 </div>
<hr> 
<footer>
  <div role="contentinfo">
      <p class="copyright">
          &copy; Databricks 2023. All rights reserved. Apache, Apache Spark, Spark, and the Spark logo are trademarks of the <a href="http://www.apache.org/">Apache Software Foundation</a>.
      </p>
      <p> 
        
          <a id='feedbacklink' href="mailto:doc-feedback@databricks.com?subject=Documentation Feedback">Send us feedback</a>
        
     | <a href="https://databricks.com/privacy-policy">Privacy Policy</a> | <a href="https://databricks.com/terms-of-use">Terms of Use</a></p>

  </div> 

</footer>
      </div>
    </div>
  </section>
</main>

  </page>
  
  <script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
      URL_ROOT: '../../',
      VERSION: '1.0',
      COLLAPSE_INDEX: false,
      FILE_SUFFIX: '.html',
      HAS_SOURCE: 'false'
    };
  </script>
  <script type="text/javascript" src="../../_static/jquery.js"></script>
  <script type="text/javascript" src="../../_static/underscore.js"></script>
  <script type="text/javascript" src="../../_static/doctools.js"></script>
  <script type="text/javascript" src="../../_static/language_data.js"></script>
  

  <script type="text/javascript" src="../../_static/js/clipboard.min.js"></script>
  <script type="text/javascript" src="../../_static/js/jquery.waypoints.min.js"></script>

  <!-- Select2 (https://select2.org/) -->
  <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
  <!-- End Select2 -->

  
  
  <script type="text/javascript" src="../../_static/js/localized.js"></script>
  <script type="text/javascript" src="../../_static/js/custom.js"></script>
  

  
  
  <script type="text/javascript">
    jQuery(function () {
      SphinxRtdTheme.StickyNav.enable();
    });

  </script>
  
 



  <script>
  window.__searchunifyLoaderConfig = JSON.parse('{"clients": {"en": "02c2e804-27e9-11ee-aefb-0242ac120011", "ja": "6a42c3f2-2820-11ee-aefb-0242ac120011", "pt": "6a86badd-2821-11ee-aefb-0242ac120011"}}')
</script>
<script type="text/javascript" src="../../_static/js/search-loader.js"></script>
</body>
<script type='text/javascript'>
  window.onload = function () {
    var description = document.querySelector('meta[name="description"]').getAttribute("content");
    let titleText = document.querySelector('h1').textContent;
    document.querySelector('meta[property="og:title"]').setAttribute("content", titleText);
    document.querySelector('meta[property="og:description"]').setAttribute("content", description);
    document.querySelector('meta[property="twitter:description"]').setAttribute("content", description);
  };
</script>

</html>