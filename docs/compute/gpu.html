

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en-US" > <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en-US"> <!--<![endif]-->

<head>
  <!-- cookie consent -->
  
    <!-- Combined Onetrust and Rudderstack Implementation Scripts -->
    <!-- Onetrust Initialization -->
    <script type="text/javascript" src="https://cdn.cookielaw.org/consent/92466579-1717-44d3-809d-a05fb02843ed-test/OtAutoBlock.js"></script>
    <script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" data-document-language="true" type="text/javascript" charset="UTF-8" data-domain-script="92466579-1717-44d3-809d-a05fb02843ed-test"></script>
    <link rel="stylesheet" id="db-onetrust-style" href="https://www.databricks.com/wp-content/uploads/db_onetrust.css" media="all" />
    <!-- Setting Rudderstack Write Key -->
    <script>window.rudderstackKey = "2SOR9fvSr5Fi6tN2ihPbVHnX1SZ" </script>
    <!-- Rudderstack Initialization + Onetrust Integration + Rudderstack Custom Events -->
    <script type="text/javascript" src="https://www.databricks.com/sites/default/files/rudderstack/v1/db-rudderstack-events.js"></script>

  <!-- cookie consent -->

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="X-UA-Compatible" content="IE=9" />
  <meta content="Learn about GPU-enabled Databricks clusters, when to use them, what they require, and how to create them." name="description" />
<meta content="single-node" name="keywords" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
  <meta property="og:image" content="https://www.databricks.com/wp-content/uploads/2020/04/og-databricks.png">
  <meta property="og:image:type" content="image/png">
  <meta property="og:title" content="GPU-enabled clusters">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://docs.databricks.com">
  <meta property="og:description" content="" id="og-description">
  <meta name="twitter:image" content="https://www.databricks.com/wp-content/uploads/2020/04/og-databricks.png">
  <meta name="twitter:site" content="@databricks">
  <meta name="twitter:creator" content="@databricks">
  <meta property="twitter:description" content="">
  
  <title>GPU-enabled clusters &#124; Databricks on AWS</title>
  
  
  <link rel="canonical" href="https://docs.databricks.com/en/compute/gpu.html">
  <!-- Start hreflang tag -->
  <link rel="alternate" hreflang="en" href="https://docs.databricks.com/en/compute/gpu.html" />
<link rel="alternate" hreflang="x-default" href="https://docs.databricks.com/en/compute/gpu.html" />
  <!-- End hreflang tag -->
  
  
  <link rel="shortcut icon" href="../_static/favicon.ico" />
  

  

  

  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;
j.setAttributeNode(d.createAttribute('data-ot-ignore'));
f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-T85FQ33');</script>
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;
j.setAttributeNode(d.createAttribute('data-ot-ignore'));
f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-TWTKQQ');</script>
    
  <!-- End Google Tag Manager -->


  <!-- MaxMind / GEO IP -->
  <script src="//js.maxmind.com/js/apis/geoip2/v2.1/geoip2.js" type="text/javascript"></script>
  <!-- End MaxMind / GEO IP -->

  
  
  <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600&display=swap" rel="stylesheet">
  <link rel="preload" href="../_static/fonts/DMSans-Bold.ttf" as="font">
  <link rel="preload" href="../_static/fonts/DMSans-Regular.ttf" as="font">
  <link rel="preload" href="../_static/fonts/DMMono-Regular.ttf" as="font">
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/cloud-provider-selector.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/translation-selector.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/searchunify/main.css" type="text/css" />

  
  <link rel="index" title="Index" href="../genindex.html" />
  <link rel="search" title="Search" href="../search.html" />
  <link rel="top" title="Databricks on AWS" href="../index.html" /> 
</head>

<body class="wy-body-for-nav" role="document">

  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T85FQ33"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TWTKQQ"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->

  
  <nav class="wy-nav-top header su_header" role="navigation" aria-label="top navigation">
    
<nav class="wy-nav-top header su_header" role="navigation" aria-label="top navigation">
  <div class="container-logo">
    <ul class="mobile-menu-toggle">
        <li class="menu-toggle">
            <i data-toggle="wy-nav-top" class="wy-nav-top-menu-button db-icon db-icon-menu pull-left"></i>
            
            <a href="https://www.databricks.com/" class="wy-nav-top-logo"><img src="../_static/small-scale-lockup-full-color-rgb.svg" width="137" height="21"
              alt="Databricks" /></a>   
               
              </li>
    </ul>
    <ul class="su_nav-menu">
      <li class="menu-toggle">
        <i data-toggle="wy-nav-top" class="wy-nav-top-menu-button db-icon db-icon-menu pull-left"></i>
        
          
        
        <a href="https://www.databricks.com/" class="wy-nav-top-logo"><img src="../_static/small-scale-lockup-full-color-rgb.svg" width="137" height="21"
            alt="Databricks" /></a></li>
        <!-- 
<li><a href="https://help.databricks.com/s/">Help Center</a></li>
<li class="active"><a href="https://docs.databricks.com/en/">Documentation</a></li>
<li><a href="https://kb.databricks.com/">Knowledge Base</a></li>
 -->
    </ul>
  </div>
  <div class="su_nav-right">
    <ul class="su_link-mobile">
  <!-- Mobile header code can go here -->
</ul>
<ul class="right-try-list">
   
</ul>
  </div>
</nav>
  </nav>

  <div class="su_sub-header">
    <div class="container">
      <div class="su_sub-header-inner">
        <!-- <div class="su_subnav-menu-right">
  <div id="auto" style="width: 100%;">
    <div ng-controller="SearchautoController">
      <div bind-html-compile="autocompleteHtml">
        <form class="su__search-box-1" disabled="disabled">
          <input class="su__search-input" type="search" name="Search box" id="su__search-b" placeholder="Search Documentation" disabled="disabled"/>
          <button class="su__search-button" type="submit" class="button button-success" disabled="disabled">
            <svg width="24" height="24" viewBox="0 0 24 24">
              <path
                d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"
                fill="#333"></path>
            </svg>
          </button>
        </form>
      </div>
    </div>
  </div>
</div> -->
        <div class="search-lng-gap"></div>
        <div style="margin-left: 16px; margin-right: 16px;">
          <!-- <select name="lng selector" id="lng-selector">
    <option value="../../en/compute/gpu.html" class="notranslate">English</option>
    <option value="../../ja/compute/gpu.html" class="notranslate">日本語</option>
    <option value="../../pt/compute/gpu.html" class="notranslate">Português (Brasil)</option>
</select> -->
        </div>
        <div class="cloud-selector-container">
          <!-- <select name="cloud provider selector" id="cloud-provider-selector">
    <option value="aws" selected class="notranslate">
        Amazon Web Services
    </option>
    <option value="azure"  class="notranslate">
        Microsoft Azure
    </option>
    <option value="gcp"  class="notranslate">
        Google Cloud Platform
    </option>
</select> -->
        </div>
      </div>
    </div>
  </div>
  <page class="js-page-container">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side su_nav-side">
<div class="wy-side-scroll">
  <div class="wy-side-nav-search">
    

    

    

    
  </div>

  <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
    
      <a href="../index.html" class="main-navigation-home">Databricks on AWS</a>
    

    
      

      
        <p class="caption"><span class="caption-text">Load &amp; manage data</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../rag-temp/index.html">RAG Studio</a></li>
</ul>

      
    
  </div>

  <div role="contentinfo">
    
  <p class="build_info notranslate"data-last-edit="December 23, 2023">
    Updated Jan 11, 2024
  </p>
<script>
  window.addEventListener('DOMContentLoaded',function(){
    var h1=document.querySelector('h1');
    var bi=document.querySelector('[data-last-edit]');
    if(h1 && bi){
      var ver = document.createElement('p');
      ver.className = 'version_info';
      ver.textContent = bi.getAttribute('data-last-edit');
      h1.parentElement.insertBefore(ver, h1.nextElementSibling);
    }
  });
</script>

    <p>
      
        <a id='feedbacklink' href="mailto:doc-feedback@databricks.com?subject=Documentation Feedback">Send us feedback</a>
      
    </p>
  </div>
</div>
</nav>
    
    
<main class="wy-grid-for-nav su_nav-grid">
  <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
    <div class="wy-nav-content su__nav_content">
      <div class="rst-content">
        





<div role="navigation" aria-label="breadcrumbs navigation" class="wy-breadcrumbs-wrapper">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Documentation</a> <span class="db-icon db-icon-chevron-right"></span></li>
    
    
      <li>GPU-enabled clusters</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>
</div>
        
        <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
          <div itemprop="articleBody">
            
    
  <div class="section" id="gpu-enabled-clusters">
<h1>GPU-enabled clusters<a class="headerlink" href="#gpu-enabled-clusters" title="Permalink to this headline"> </a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Some GPU-enabled instance types are in <strong>Beta</strong> and are marked as such in the drop-down list when you select the driver and worker types during cluster creation.</p>
</div>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline"> </a></h2>
<p>Databricks supports clusters accelerated with graphics processing units (GPUs).
This article describes how to create clusters with GPU-enabled instances and describes
the GPU drivers and libraries installed on those instances.</p>
<p>To learn more about deep learning on GPU-enabled clusters, see <a class="reference internal" href="../machine-learning/train-model/deep-learning.html"><span class="doc">Deep learning</span></a>.</p>
</div>
<div class="section" id="create-a-gpu-cluster">
<h2>Create a GPU cluster<a class="headerlink" href="#create-a-gpu-cluster" title="Permalink to this headline"> </a></h2>
<p>Creating a GPU cluster is similar to creating any Spark cluster. You should keep in mind the following:</p>
<ul class="simple">
<li><p>The <strong>Databricks Runtime Version</strong> must be a GPU-enabled version, such as <strong>Runtime 13.3 LTS ML (GPU, Scala 2.12.15, Spark 3.4.1)</strong>.</p></li>
<li><p>The <strong>Worker Type</strong> and <strong>Driver Type</strong> must be GPU instance types.</p></li>
<li><p>For single-machine workflows without Spark, you can set the number of workers to zero.</p></li>
</ul>
<div class="section" id="supported-instance-types">
<span id="gpu-list"></span><h3>Supported instance types<a class="headerlink" href="#supported-instance-types" title="Permalink to this headline"> </a></h3>
<p>Databricks supports the following GPU-accelerated instance types:</p>
<ul>
<li><p><a class="reference external" href="https://aws.amazon.com/ec2/instance-types/p2/">[Deprecated] P2 instance type series</a>: p2.xlarge, p2.8xlarge, and p2.16xlarge</p>
<ul class="simple">
<li><p>P2 instances are available only in select AWS regions. For information, see <a class="reference external" href="https://aws.amazon.com/ec2/pricing/on-demand/">Amazon EC2 Pricing</a>. Your Databricks deployment must reside in a supported region to launch GPU-enabled clusters.</p></li>
<li><p>The <a class="reference external" href="https://aws.amazon.com/ec2/faqs/#How_many_instances_can_I_run_in_Amazon_EC2">default on-demand limit for P2 instances is one</a>.</p></li>
<li><p>P2 instances require EBS volumes for storage.</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>After August 31 2023, Databricks will no longer support spinning up clusters using Amazon EC2 P2 instances.</p>
</div>
</li>
<li><p><a class="reference external" href="https://aws.amazon.com/ec2/instance-types/p3/">P3 instance type series</a>: p3.2xlarge, p3.8xlarge, and p3.16xlarge.</p>
<ul class="simple">
<li><p>P3 instances are available only in select AWS regions. For information, see <a class="reference external" href="https://aws.amazon.com/ec2/pricing/on-demand/">Amazon EC2 Pricing</a>. Your Databricks deployment must reside in a supported region to launch GPU-enabled clusters.</p></li>
</ul>
</li>
<li><p><a class="reference external" href="https://aws.amazon.com/ec2/instance-types/p4/">P4d instance type series</a>: p4d.24xlarge, p4de.24xlarge.</p></li>
<li><p><a class="reference external" href="https://aws.amazon.com/ec2/instance-types/p5/">P5 instance type series</a>: p5.48xlarge.</p></li>
<li><p><a class="reference external" href="https://aws.amazon.com/ec2/instance-types/g4/">G4 instance type series</a>, which are optimized for deploying machine learning models in production.</p></li>
<li><p><a class="reference external" href="https://aws.amazon.com/ec2/instance-types/g5/">G5 instance type series</a>, which can be used for a wide range of graphics-intensive and machine learning use cases.</p>
<ul class="simple">
<li><p>G5 instances require Databricks Runtime 9.1 LTS ML or above.</p></li>
</ul>
</li>
</ul>
<div class="section" id="considerations">
<h4>Considerations<a class="headerlink" href="#considerations" title="Permalink to this headline"> </a></h4>
<p>For all GPU-accelerated instance types, keep the following in mind:</p>
<ul class="simple">
<li><p>Due to Amazon spot instance price surges, GPU spot instances are difficult to retain. Use on-demand if needed.</p></li>
<li><p>You might need to <a class="reference external" href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-resource-limits.html">request a limit increase</a> in order to create
GPU-enabled clusters.</p></li>
</ul>
<p>See <a class="reference external" href="https://databricks.com/product/aws-pricing/instance-types">Supported Instance Types</a> for a list of supported GPU instance types and their attributes.</p>
</div>
</div>
</div>
<div class="section" id="gpu-scheduling">
<h2>GPU scheduling<a class="headerlink" href="#gpu-scheduling" title="Permalink to this headline"> </a></h2>
<p>Databricks Runtime supports <a class="reference external" href="https://spark.apache.org/docs/3.0.0-preview/configuration.html#custom-resource-scheduling-and-configuration-overview">GPU-aware scheduling</a> from Apache Spark 3.0. Databricks preconfigures it on GPU clusters.</p>
<p>GPU scheduling is not enabled on Single Node clusters.</p>
<p><code class="docutils literal notranslate"><span class="pre">spark.task.resource.gpu.amount</span></code> is the only Spark config related to GPU-aware scheduling that you might need to change.
The default configuration uses one GPU per task, which is ideal for distributed inference workloads and distributed training, if you use all GPU nodes.
To do distributed training on a subset of nodes, which helps reduce communication overhead during distributed training, Databricks recommends setting <code class="docutils literal notranslate"><span class="pre">spark.task.resource.gpu.amount</span></code> to the number of GPUs per worker node
in the cluster <a class="reference internal" href="configure.html#spark-configuration"><span class="std std-ref">Spark configuration</span></a>.</p>
<p>For PySpark tasks, Databricks automatically remaps assigned GPU(s) to indices 0, 1, ….
Under the default configuration that uses one GPU per task, your code can simply use the default GPU without checking which GPU is assigned to the task.
If you set multiple GPUs per task, for example 4, your code can assume that the indices of the assigned GPUs are always 0, 1, 2, and 3. If you do need the physical indices of the assigned GPUs, you can get them from the <code class="docutils literal notranslate"><span class="pre">CUDA_VISIBLE_DEVICES</span></code> environment variable.</p>
<p>If you use Scala, you can get the indices of the GPUs assigned to the task from <code class="docutils literal notranslate"><span class="pre">TaskContext.resources().get(&quot;gpu&quot;)</span></code>.</p>
<p>For Databricks Runtime releases below 7.0, to avoid conflicts among multiple Spark tasks trying to use the same GPU, Databricks automatically configures GPU clusters so that there is at most one running task per node.
That way the task can use all GPUs on the node without running into conflicts with other tasks.</p>
</div>
<div class="section" id="nvidia-gpu-driver-cuda-and-cudnn">
<span id="nvidia"></span><h2>NVIDIA GPU driver, CUDA, and cuDNN<a class="headerlink" href="#nvidia-gpu-driver-cuda-and-cudnn" title="Permalink to this headline"> </a></h2>
<p>Databricks installs the NVIDIA driver and libraries required to use GPUs on Spark driver and worker instances:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://developer.nvidia.com/cuda-toolkit">CUDA Toolkit</a>, installed under <code class="docutils literal notranslate"><span class="pre">/usr/local/cuda</span></code>.</p></li>
<li><p><a class="reference external" href="https://developer.nvidia.com/cudnn">cuDNN</a>: NVIDIA CUDA Deep Neural Network Library.</p></li>
<li><p><a class="reference external" href="https://developer.nvidia.com/nccl">NCCL</a>: NVIDIA Collective Communications Library.</p></li>
</ul>
<p>The version of the NVIDIA driver included is 535.54.03, which supports CUDA 11.0.</p>
<p>For the versions of the libraries included, see the <a class="reference internal" href="../release-notes/runtime/index.html"><span class="doc">release notes</span></a> for the specific Databricks Runtime version you are using.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This software contains source code provided by NVIDIA Corporation. Specifically, to support GPUs, Databricks includes code from <a class="reference external" href="https://docs.nvidia.com/cuda/eula/#nvidia-cuda-samples-preface">CUDA Samples</a>.</p>
</div>
<div class="section" id="nvidia-end-user-license-agreement-eula">
<h3>NVIDIA End User License Agreement (EULA)<a class="headerlink" href="#nvidia-end-user-license-agreement-eula" title="Permalink to this headline"> </a></h3>
<p>When you select a GPU-enabled “Databricks Runtime Version” in Databricks, you implicitly agree to the terms and conditions outlined in the
NVIDIA EULA with respect to the CUDA, cuDNN, and Tesla libraries,
and the <a class="reference external" href="https://docs.nvidia.com/deeplearning/sdk/nccl-sla/index.html#supplement/">NVIDIA End User License Agreement (with NCCL Supplement)</a> for the NCCL library.</p>
</div>
</div>
<div class="section" id="databricks-container-services-on-gpu-clusters">
<span id="databricks-container-services-on-gpu"></span><h2>Databricks Container Services on GPU clusters<a class="headerlink" href="#databricks-container-services-on-gpu-clusters" title="Permalink to this headline"> </a></h2>
<div class="preview admonition">
<p class="admonition-title">Preview</p>
<p>This feature is in <a class="reference internal" href="../release-notes/release-types.html"><span class="doc">Public Preview</span></a>.</p>
</div>
<p>You can use <a class="reference internal" href="custom-containers.html"><span class="doc">Databricks Container Services</span></a> on clusters with GPUs to create portable deep learning environments with customized libraries. See <a class="reference internal" href="custom-containers.html"><span class="doc">Customize containers with Databricks Container Service</span></a> for instructions.</p>
<p>To create custom images for GPU clusters, you must select a standard runtime version instead of Databricks Runtime ML for GPU. When you select <strong>Use your own Docker container</strong>, you can choose GPU clusters with a standard runtime version. The custom images for GPU clusters are based on the <a class="reference external" href="https://hub.docker.com/r/nvidia/cuda/">official CUDA containers</a>, which is different from Databricks Runtime ML for GPU.</p>
<p>When you create custom images for GPU clusters, you cannot change the NVIDIA driver version, because it must match the driver version on the host machine.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">databricksruntime</span></code> <a class="reference external" href="https://hub.docker.com/u/databricksruntime">Docker Hub</a> contains example base images with GPU capability. The Dockerfiles used to generate these images are located in the <a class="reference external" href="https://github.com/databricks/containers/tree/master/ubuntu/gpu">example containers GitHub repository</a>, which also has details on what the example images provide and how to customize them.</p>
</div>
<div class="section" id="error-messages">
<span id="nvidia-gpu-driver-cuda-and-cudnn"></span><h2>Error messages<a class="headerlink" href="#error-messages" title="Permalink to this headline"> </a></h2>
<ul>
<li><p>The following error indicates that the AWS cloud provider does not have enough capacity for the requested compute resource.
<code class="docutils literal notranslate"><span class="pre">Error:</span> <span class="pre">Cluster</span> <span class="pre">terminated.</span> <span class="pre">Reason:</span> <span class="pre">AWS</span> <span class="pre">Insufficient</span> <span class="pre">Instance</span> <span class="pre">Capacity</span> <span class="pre">Failure</span></code></p>
<p>To resolve, you can try to create a cluster in a different availability zone. The availability zone is in the <a class="reference internal" href="configure.html#cluster-aws-config"><span class="std std-ref">cluster configuration</span></a>, under <strong>Advanced options</strong>. You can also review <a class="reference external" href="https://aws.amazon.com/ec2/pricing/reserved-instances/pricing/">AWS reserved instances pricing</a> to purchase additional quota.</p>
</li>
<li><p>If your cluster uses P4d or G5 instance types and Databricks Runtime 7.3 LTS ML, the CUDA package version in 7.3 is incompatible with newer GPU instances. In those cases, ML packages such as TensorFlow Keras and PyTorch will produce errors such as:</p>
<ul class="simple">
<li><p>TensorFlow Keras: <code class="docutils literal notranslate"><span class="pre">InternalError:</span> <span class="pre">CUDA</span> <span class="pre">runtime</span> <span class="pre">implicit</span> <span class="pre">initialization</span> <span class="pre">on</span> <span class="pre">GPU:x</span> <span class="pre">failed.</span> <span class="pre">Status:</span> <span class="pre">device</span> <span class="pre">kernel</span> <span class="pre">image</span> <span class="pre">is</span> <span class="pre">invalid</span></code></p></li>
<li><p>PyTorch: <code class="docutils literal notranslate"><span class="pre">UserWarning:</span> <span class="pre">NVIDIA</span> <span class="pre">A100-SXM4-40GB</span> <span class="pre">with</span> <span class="pre">CUDA</span> <span class="pre">capability</span> <span class="pre">sm_80</span> <span class="pre">is</span> <span class="pre">not</span> <span class="pre">compatible</span> <span class="pre">with</span> <span class="pre">the</span> <span class="pre">current</span> <span class="pre">PyTorch</span> <span class="pre">installation.</span></code></p></li>
</ul>
<p>You can resolve these errors by upgrading to Databricks Runtime 10.4 LTS ML or above.</p>
</li>
</ul>
</div>
</div>


    
          </div>
        </div>
        <div  class="suapp-rating">
  <div id="suPageRateApp">
     <su-app></su-app>
   </div> 
 </div>
<hr> 
<footer>
  <div role="contentinfo">
      <p class="copyright">
          &copy; Databricks 2023. All rights reserved. Apache, Apache Spark, Spark, and the Spark logo are trademarks of the <a href="http://www.apache.org/">Apache Software Foundation</a>.
      </p>
      <p> 
        
          <a id='feedbacklink' href="mailto:doc-feedback@databricks.com?subject=Documentation Feedback">Send us feedback</a>
        
     | <a href="https://databricks.com/privacy-policy">Privacy Policy</a> | <a href="https://databricks.com/terms-of-use">Terms of Use</a></p>

  </div> 

</footer>
      </div>
    </div>
  </section>
</main>

  </page>
  
  <script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
      URL_ROOT: '../',
      VERSION: '1.0',
      COLLAPSE_INDEX: false,
      FILE_SUFFIX: '.html',
      HAS_SOURCE: 'false'
    };
  </script>
  <script type="text/javascript" src="../_static/jquery.js"></script>
  <script type="text/javascript" src="../_static/underscore.js"></script>
  <script type="text/javascript" src="../_static/doctools.js"></script>
  <script type="text/javascript" src="../_static/language_data.js"></script>
  

  <script type="text/javascript" src="../_static/js/clipboard.min.js"></script>
  <script type="text/javascript" src="../_static/js/jquery.waypoints.min.js"></script>

  <!-- Select2 (https://select2.org/) -->
  <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
  <!-- End Select2 -->

  
  
  <script type="text/javascript" src="../_static/js/localized.js"></script>
  <script type="text/javascript" src="../_static/js/custom.js"></script>
  

  
  
  <script type="text/javascript">
    jQuery(function () {
      SphinxRtdTheme.StickyNav.enable();
    });

  </script>
  
 



  <script>
  window.__searchunifyLoaderConfig = JSON.parse('{"clients": {"en": "02c2e804-27e9-11ee-aefb-0242ac120011", "ja": "6a42c3f2-2820-11ee-aefb-0242ac120011", "pt": "6a86badd-2821-11ee-aefb-0242ac120011"}}')
</script>
<script type="text/javascript" src="../_static/js/search-loader.js"></script>
</body>
<script type='text/javascript'>
  window.onload = function () {
    var description = document.querySelector('meta[name="description"]').getAttribute("content");
    let titleText = document.querySelector('h1').textContent;
    document.querySelector('meta[property="og:title"]').setAttribute("content", titleText);
    document.querySelector('meta[property="og:description"]').setAttribute("content", description);
    document.querySelector('meta[property="twitter:description"]').setAttribute("content", description);
  };
</script>

</html>