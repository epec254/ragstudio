

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en-US" > <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en-US"> <!--<![endif]-->

<head>
  <!-- cookie consent -->
  
    <!-- Combined Onetrust and Rudderstack Implementation Scripts -->
    <!-- Onetrust Initialization -->
    <script type="text/javascript" src="https://cdn.cookielaw.org/consent/92466579-1717-44d3-809d-a05fb02843ed-test/OtAutoBlock.js"></script>
    <script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" data-document-language="true" type="text/javascript" charset="UTF-8" data-domain-script="92466579-1717-44d3-809d-a05fb02843ed-test"></script>
    <link rel="stylesheet" id="db-onetrust-style" href="https://www.databricks.com/wp-content/uploads/db_onetrust.css" media="all" />
    <!-- Setting Rudderstack Write Key -->
    <script>window.rudderstackKey = "2SOR9fvSr5Fi6tN2ihPbVHnX1SZ" </script>
    <!-- Rudderstack Initialization + Onetrust Integration + Rudderstack Custom Events -->
    <script type="text/javascript" src="https://www.databricks.com/sites/default/files/rudderstack/v1/db-rudderstack-events.js"></script>

  <!-- cookie consent -->

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="X-UA-Compatible" content="IE=9" />
  <meta content="Learn how to use the INSERT INTO syntax of the Apache Spark 2.x SQL language in Databricks." name="description" />
<meta content="noindex" name="robots" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
  <meta property="og:image" content="https://www.databricks.com/wp-content/uploads/2020/04/og-databricks.png">
  <meta property="og:image:type" content="image/png">
  <meta property="og:title" content="Insert">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://docs.databricks.com">
  <meta property="og:description" content="" id="og-description">
  <meta name="twitter:image" content="https://www.databricks.com/wp-content/uploads/2020/04/og-databricks.png">
  <meta name="twitter:site" content="@databricks">
  <meta name="twitter:creator" content="@databricks">
  <meta property="twitter:description" content="">
  
  <title>Insert &#124; Databricks on AWS</title>
  
  
  <link rel="canonical" href="https://docs.databricks.com/en/archive/spark-sql-2.x-language-manual/insert.html">
  <!-- Start hreflang tag -->
  <link rel="alternate" hreflang="en" href="https://docs.databricks.com/en/archive/spark-sql-2.x-language-manual/insert.html" />
<link rel="alternate" hreflang="x-default" href="https://docs.databricks.com/en/archive/spark-sql-2.x-language-manual/insert.html" />
  <!-- End hreflang tag -->
  
  
  <link rel="shortcut icon" href="../../_static/favicon.ico" />
  

  

  

  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;
j.setAttributeNode(d.createAttribute('data-ot-ignore'));
f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-T85FQ33');</script>
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;
j.setAttributeNode(d.createAttribute('data-ot-ignore'));
f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-TWTKQQ');</script>
    
  <!-- End Google Tag Manager -->


  <!-- MaxMind / GEO IP -->
  <script src="//js.maxmind.com/js/apis/geoip2/v2.1/geoip2.js" type="text/javascript"></script>
  <!-- End MaxMind / GEO IP -->

  
  
  <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600&display=swap" rel="stylesheet">
  <link rel="preload" href="../../_static/fonts/DMSans-Bold.ttf" as="font">
  <link rel="preload" href="../../_static/fonts/DMSans-Regular.ttf" as="font">
  <link rel="preload" href="../../_static/fonts/DMMono-Regular.ttf" as="font">
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/cloud-provider-selector.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/translation-selector.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/searchunify/main.css" type="text/css" />

  
  <link rel="index" title="Index" href="../../genindex.html" />
  <link rel="search" title="Search" href="../../search.html" />
  <link rel="top" title="Databricks on AWS" href="../../index.html" /> 
</head>

<body class="wy-body-for-nav" role="document">

  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T85FQ33"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TWTKQQ"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->

  
  <nav class="wy-nav-top header su_header" role="navigation" aria-label="top navigation">
    
<nav class="wy-nav-top header su_header" role="navigation" aria-label="top navigation">
  <div class="container-logo">
    <ul class="mobile-menu-toggle">
        <li class="menu-toggle">
            <i data-toggle="wy-nav-top" class="wy-nav-top-menu-button db-icon db-icon-menu pull-left"></i>
            
            <a href="https://www.databricks.com/" class="wy-nav-top-logo"><img src="../../_static/small-scale-lockup-full-color-rgb.svg" width="137" height="21"
              alt="Databricks" /></a>   
               
              </li>
    </ul>
    <ul class="su_nav-menu">
      <li class="menu-toggle">
        <i data-toggle="wy-nav-top" class="wy-nav-top-menu-button db-icon db-icon-menu pull-left"></i>
        
          
        
        <a href="https://www.databricks.com/" class="wy-nav-top-logo"><img src="../../_static/small-scale-lockup-full-color-rgb.svg" width="137" height="21"
            alt="Databricks" /></a></li>
        <!-- 
<li><a href="https://help.databricks.com/s/">Help Center</a></li>
<li class="active"><a href="https://docs.databricks.com/en/">Documentation</a></li>
<li><a href="https://kb.databricks.com/">Knowledge Base</a></li>
 -->
    </ul>
  </div>
  <div class="su_nav-right">
    <ul class="su_link-mobile">
  <!-- Mobile header code can go here -->
</ul>
<ul class="right-try-list">
   
</ul>
  </div>
</nav>
  </nav>

  <div class="su_sub-header">
    <div class="container">
      <div class="su_sub-header-inner">
        <!-- <div class="su_subnav-menu-right">
  <div id="auto" style="width: 100%;">
    <div ng-controller="SearchautoController">
      <div bind-html-compile="autocompleteHtml">
        <form class="su__search-box-1" disabled="disabled">
          <input class="su__search-input" type="search" name="Search box" id="su__search-b" placeholder="Search Documentation" disabled="disabled"/>
          <button class="su__search-button" type="submit" class="button button-success" disabled="disabled">
            <svg width="24" height="24" viewBox="0 0 24 24">
              <path
                d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"
                fill="#333"></path>
            </svg>
          </button>
        </form>
      </div>
    </div>
  </div>
</div> -->
        <div class="search-lng-gap"></div>
        <div style="margin-left: 16px; margin-right: 16px;">
          <!-- <select name="lng selector" id="lng-selector">
    <option value="../../../en/archive/spark-sql-2.x-language-manual/insert.html" class="notranslate">English</option>
    <option value="../../../ja/archive/spark-sql-2.x-language-manual/insert.html" class="notranslate">日本語</option>
    <option value="../../../pt/archive/spark-sql-2.x-language-manual/insert.html" class="notranslate">Português (Brasil)</option>
</select> -->
        </div>
        <div class="cloud-selector-container">
          <!-- <select name="cloud provider selector" id="cloud-provider-selector">
    <option value="aws" selected class="notranslate">
        Amazon Web Services
    </option>
    <option value="azure"  class="notranslate">
        Microsoft Azure
    </option>
    <option value="gcp"  class="notranslate">
        Google Cloud Platform
    </option>
</select> -->
        </div>
      </div>
    </div>
  </div>
  <page class="js-page-container">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side su_nav-side">
<div class="wy-side-scroll">
  <div class="wy-side-nav-search">
    

    

    

    
  </div>

  <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
    
      <a href="../../index.html" class="main-navigation-home">Databricks on AWS</a>
    

    
      

      
        <p class="caption"><span class="caption-text">Load &amp; manage data</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../rag-temp/index.html">RAG Studio</a></li>
</ul>

      
    
  </div>

  <div role="contentinfo">
    
  <p class="build_info notranslate"data-last-edit="December 23, 2023">
    Updated Jan 11, 2024
  </p>
<script>
  window.addEventListener('DOMContentLoaded',function(){
    var h1=document.querySelector('h1');
    var bi=document.querySelector('[data-last-edit]');
    if(h1 && bi){
      var ver = document.createElement('p');
      ver.className = 'version_info';
      ver.textContent = bi.getAttribute('data-last-edit');
      h1.parentElement.insertBefore(ver, h1.nextElementSibling);
    }
  });
</script>

    <p>
      
        <a id='feedbacklink' href="mailto:doc-feedback@databricks.com?subject=Documentation Feedback">Send us feedback</a>
      
    </p>
  </div>
</div>
</nav>
    
    
<main class="wy-grid-for-nav su_nav-grid">
  <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
    <div class="wy-nav-content su__nav_content">
      <div class="rst-content">
        





<div role="navigation" aria-label="breadcrumbs navigation" class="wy-breadcrumbs-wrapper">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Documentation</a> <span class="db-icon db-icon-chevron-right"></span></li>
    
    
      <li>Insert</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>
</div>
        
        <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
          <div itemprop="articleBody">
            
    
  <div class="section" id="insert">
<h1>Insert<a class="headerlink" href="#insert" title="Permalink to this headline"> </a></h1>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>This documentation has been retired and might not be updated. The products, services, or technologies mentioned in this content are no longer supported. See <a class="reference internal" href="../../sql/language-manual/sql-ref-syntax-dml-insert-into.html"><span class="doc">INSERT</span></a>.</p>
</div>
<div class="section" id="insert-from-select-queries">
<h2>Insert from select queries<a class="headerlink" href="#insert-from-select-queries" title="Permalink to this headline"> </a></h2>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="p">[</span><span class="k">TABLE</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="n">db_name</span><span class="p">.]</span><span class="k">table_name</span><span class="w"> </span><span class="p">[</span><span class="n">PARTITION</span><span class="w"> </span><span class="n">part_spec</span><span class="p">]</span><span class="w"> </span><span class="n">select_statement</span>

<span class="k">INSERT</span><span class="w"> </span><span class="n">OVERWRITE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="p">[</span><span class="n">db_name</span><span class="p">.]</span><span class="k">table_name</span><span class="w"> </span><span class="p">[</span><span class="n">PARTITION</span><span class="w"> </span><span class="n">part_spec</span><span class="p">]</span><span class="w"> </span><span class="n">select_statement</span>

<span class="n">part_spec</span><span class="p">:</span>
<span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">part_col_name1</span><span class="o">=</span><span class="n">val1</span><span class="w"> </span><span class="p">[,</span><span class="w"> </span><span class="n">part_col_name2</span><span class="o">=</span><span class="n">val2</span><span class="p">,</span><span class="w"> </span><span class="p">...])</span>
</pre></div>
</div>
<p>Insert data into a table or a partition from the result table of a select statement. Data is inserted by ordinal (ordering of columns) and not by names.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>(Delta Lake on Databricks) If a column has a <code class="docutils literal notranslate"><span class="pre">NOT</span> <span class="pre">NULL</span></code> <a class="reference internal" href="create-table.html#create-table-delta"><span class="std std-ref">constraint</span></a>, and an <code class="docutils literal notranslate"><span class="pre">INSERT</span> <span class="pre">INTO</span></code> statement sets a column value to <code class="docutils literal notranslate"><span class="pre">NULL</span></code>, a <code class="docutils literal notranslate"><span class="pre">SparkException</span></code> is thrown.</p>
</div>
<p><strong><code class="docutils literal notranslate"><span class="pre">OVERWRITE</span></code></strong></p>
<p>Overwrite existing data in the table or the partition. Otherwise, new data is appended.</p>
<div class="section" id="examples">
<h3>Examples<a class="headerlink" href="#examples" title="Permalink to this headline"> </a></h3>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="c1">-- Creates a partitioned native parquet table</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">data_source_tab1</span><span class="w"> </span><span class="p">(</span><span class="n">col1</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span><span class="w"> </span><span class="n">p1</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span><span class="w"> </span><span class="n">p2</span><span class="w"> </span><span class="nb">INT</span><span class="p">)</span>
<span class="w">  </span><span class="k">USING</span><span class="w"> </span><span class="n">PARQUET</span><span class="w"> </span><span class="n">PARTITIONED</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="p">(</span><span class="n">p1</span><span class="p">,</span><span class="w"> </span><span class="n">p2</span><span class="p">)</span>

<span class="c1">-- Appends two rows into the partition (p1 = 3, p2 = 4)</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">data_source_tab1</span><span class="w"> </span><span class="n">PARTITION</span><span class="w"> </span><span class="p">(</span><span class="n">p1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">p2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span>
<span class="w">  </span><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">RANGE</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span>

<span class="c1">-- Overwrites the partition (p1 = 3, p2 = 4) using two new rows</span>
<span class="k">INSERT</span><span class="w"> </span><span class="n">OVERWRITE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">default</span><span class="p">.</span><span class="n">data_source_tab1</span><span class="w"> </span><span class="n">PARTITION</span><span class="w"> </span><span class="p">(</span><span class="n">p1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">p2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span>
<span class="w">  </span><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">RANGE</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="insert-values-into-tables">
<h2>Insert values into tables<a class="headerlink" href="#insert-values-into-tables" title="Permalink to this headline"> </a></h2>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="p">[</span><span class="k">TABLE</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="n">db_name</span><span class="p">.]</span><span class="k">table_name</span><span class="w"> </span><span class="p">[</span><span class="n">PARTITION</span><span class="w"> </span><span class="n">part_spec</span><span class="p">]</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="n">values_row</span><span class="w"> </span><span class="p">[,</span><span class="w"> </span><span class="n">values_row</span><span class="w"> </span><span class="p">...]</span>

<span class="k">INSERT</span><span class="w"> </span><span class="n">OVERWRITE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="p">[</span><span class="n">db_name</span><span class="p">.]</span><span class="k">table_name</span><span class="w"> </span><span class="p">[</span><span class="n">PARTITION</span><span class="w"> </span><span class="n">part_spec</span><span class="p">]</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="n">values_row</span><span class="w"> </span><span class="p">[,</span><span class="w"> </span><span class="n">values_row</span><span class="w"> </span><span class="p">...]</span>

<span class="n">values_row</span><span class="p">:</span>
<span class="w">    </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">val1</span><span class="w"> </span><span class="p">[,</span><span class="w"> </span><span class="n">val2</span><span class="p">,</span><span class="w"> </span><span class="p">...])</span>
</pre></div>
</div>
<p>Insert data into a table or a partition from a row value list.</p>
<p><strong><code class="docutils literal notranslate"><span class="pre">OVERWRITE</span></code></strong></p>
<p>Overwrite existing data in the table or the partition. Otherwise, new data is appended.</p>
<div class="section" id="examples">
<span id="examples-1"></span><h3>Examples<a class="headerlink" href="#examples" title="Permalink to this headline"> </a></h3>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="c1">-- Creates a partitioned hive serde table (using the HiveQL syntax)</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">hive_serde_tab1</span><span class="w"> </span><span class="p">(</span><span class="n">col1</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span><span class="w"> </span><span class="n">p1</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span><span class="w"> </span><span class="n">p2</span><span class="w"> </span><span class="nb">INT</span><span class="p">)</span>
<span class="w">  </span><span class="k">USING</span><span class="w"> </span><span class="n">HIVE</span><span class="w"> </span><span class="k">OPTIONS</span><span class="p">(</span><span class="n">fileFormat</span><span class="w"> </span><span class="s1">&#39;PARQUET&#39;</span><span class="p">)</span><span class="w"> </span><span class="n">PARTITIONED</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="p">(</span><span class="n">p1</span><span class="p">,</span><span class="w"> </span><span class="n">p2</span><span class="p">)</span>

<span class="c1">-- Appends two rows into the partition (p1 = 3, p2 = 4)</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">hive_serde_tab1</span><span class="w"> </span><span class="n">PARTITION</span><span class="w"> </span><span class="p">(</span><span class="n">p1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">p2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span>
<span class="w">  </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="c1">-- Overwrites the partition (p1 = 3, p2 = 4) using two new rows</span>
<span class="k">INSERT</span><span class="w"> </span><span class="n">OVERWRITE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">hive_serde_tab1</span><span class="w"> </span><span class="n">PARTITION</span><span class="w"> </span><span class="p">(</span><span class="n">p1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">p2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span>
<span class="w">  </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="dynamic-partition-inserts">
<h2>Dynamic partition inserts<a class="headerlink" href="#dynamic-partition-inserts" title="Permalink to this headline"> </a></h2>
<p>In <code class="docutils literal notranslate"><span class="pre">part_spec</span></code>, the partition column values are optional. When the partition specification <code class="docutils literal notranslate"><span class="pre">part_spec</span></code> is not completely provided, such inserts are called <em>dynamic partition inserts</em> or <em>multi-partition inserts</em>. When the values are not specified, these columns are referred to as dynamic partition columns; otherwise, they are static partition columns. For example, the partition spec <code class="docutils literal notranslate"><span class="pre">(p1</span> <span class="pre">=</span> <span class="pre">3,</span> <span class="pre">p2,</span> <span class="pre">p3)</span></code> has a static partition column (<code class="docutils literal notranslate"><span class="pre">p1</span></code>) and two dynamic partition columns (<code class="docutils literal notranslate"><span class="pre">p2</span></code> and <code class="docutils literal notranslate"><span class="pre">p3</span></code>).</p>
<p>In <code class="docutils literal notranslate"><span class="pre">part_spec</span></code>, static partition keys must come before the dynamic partition keys. This means all partition columns having constant values must appear before other partition columns that do not have an assigned constant value.</p>
<p>The partition values of dynamic partition columns are determined during the execution. The dynamic partition columns must be specified last in both <code class="docutils literal notranslate"><span class="pre">part_spec</span></code> and the input result set (of the row value lists or the select query). They are resolved by position, instead of by names. Thus, the orders must be exactly matched.</p>
<p>The DataFrameWriter APIs do not have an interface to specify partition values. Therefore, the <code class="docutils literal notranslate"><span class="pre">insertInto()</span></code> API is always using dynamic partition mode.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>In the dynamic partition mode, the input result set could result in a large number of dynamic partitions, and thus generate a large number of partition directories.</p>
<p><strong><code class="docutils literal notranslate"><span class="pre">OVERWRITE</span></code></strong></p>
<p>The semantics are different based on the type of the target table.</p>
<ul class="simple">
<li><p>Hive SerDe tables: <code class="docutils literal notranslate"><span class="pre">INSERT</span> <span class="pre">OVERWRITE</span></code> doesn’t delete partitions ahead, and only overwrite those partitions that have data written into it at runtime. This matches Apache Hive semantics. For Hive SerDe tables, Spark SQL respects the Hive-related configuration, including <code class="docutils literal notranslate"><span class="pre">hive.exec.dynamic.partition</span></code> and <code class="docutils literal notranslate"><span class="pre">hive.exec.dynamic.partition.mode</span></code>.</p></li>
<li><p>Native data source tables: <code class="docutils literal notranslate"><span class="pre">INSERT</span> <span class="pre">OVERWRITE</span></code> first deletes all the partitions that match the partition specification (e.g., PARTITION(a=1, b)) and then inserts all the remaining values. The behavior of native data source tables can be changed to be consistent with Hive SerDe tables by changing the session-specific configuration <code class="docutils literal notranslate"><span class="pre">spark.sql.sources.partitionOverwriteMode</span></code> to <code class="docutils literal notranslate"><span class="pre">DYNAMIC</span></code>. The default mode is <code class="docutils literal notranslate"><span class="pre">STATIC</span></code>.</p></li>
</ul>
</div>
<div class="section" id="examples">
<span id="examples-2"></span><h3>Examples<a class="headerlink" href="#examples" title="Permalink to this headline"> </a></h3>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="c1">-- Create a partitioned native Parquet table</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">data_source_tab2</span><span class="w"> </span><span class="p">(</span><span class="n">col1</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span><span class="w"> </span><span class="n">p1</span><span class="w"> </span><span class="n">STRING</span><span class="p">,</span><span class="w"> </span><span class="n">p2</span><span class="w"> </span><span class="n">STRING</span><span class="p">)</span>
<span class="w">  </span><span class="k">USING</span><span class="w"> </span><span class="n">PARQUET</span><span class="w"> </span><span class="n">PARTITIONED</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="p">(</span><span class="n">p1</span><span class="p">,</span><span class="w"> </span><span class="n">p2</span><span class="p">)</span>

<span class="c1">-- Two partitions (&#39;part1&#39;, &#39;part1&#39;) and (&#39;part1&#39;, &#39;part2&#39;) are created by this dynamic insert.</span>
<span class="c1">-- The dynamic partition column p2 is resolved by the last column `&#39;part&#39; || id`</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">data_source_tab2</span><span class="w"> </span><span class="n">PARTITION</span><span class="w"> </span><span class="p">(</span><span class="n">p1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;part1&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">p2</span><span class="p">)</span>
<span class="w">  </span><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;part&#39;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">RANGE</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span>

<span class="c1">-- A new partition (&#39;partNew1&#39;, &#39;partNew2&#39;) is added by this INSERT OVERWRITE.</span>
<span class="k">INSERT</span><span class="w"> </span><span class="n">OVERWRITE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">data_source_tab2</span><span class="w"> </span><span class="n">PARTITION</span><span class="w"> </span><span class="p">(</span><span class="n">p1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;partNew1&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">p2</span><span class="p">)</span>
<span class="w">  </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;partNew2&#39;</span><span class="p">)</span>

<span class="c1">-- After this INSERT OVERWRITE, the two partitions (&#39;part1&#39;, &#39;part1&#39;) and (&#39;part1&#39;, &#39;part2&#39;) are dropped,</span>
<span class="c1">-- because both partitions are included by (p1 = &#39;part1&#39;, p2).</span>
<span class="c1">-- Then, two partitions (&#39;partNew1&#39;, &#39;partNew2&#39;), (&#39;part1&#39;, &#39;part1&#39;) exist after this operation.</span>
<span class="k">INSERT</span><span class="w"> </span><span class="n">OVERWRITE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">data_source_tab2</span><span class="w"> </span><span class="n">PARTITION</span><span class="w"> </span><span class="p">(</span><span class="n">p1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;part1&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">p2</span><span class="p">)</span>
<span class="w">  </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;part1&#39;</span><span class="p">)</span>

<span class="c1">-- Create and fill a partitioned hive serde table with three partitions:</span>
<span class="c1">-- (&#39;part1&#39;, &#39;part1&#39;), (&#39;part1&#39;, &#39;part2&#39;) and (&#39;partNew1&#39;, &#39;partNew2&#39;)</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">hive_serde_tab2</span><span class="w"> </span><span class="p">(</span><span class="n">col1</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span><span class="w"> </span><span class="n">p1</span><span class="w"> </span><span class="n">STRING</span><span class="p">,</span><span class="w"> </span><span class="n">p2</span><span class="w"> </span><span class="n">STRING</span><span class="p">)</span>
<span class="w">  </span><span class="k">USING</span><span class="w"> </span><span class="n">HIVE</span><span class="w"> </span><span class="k">OPTIONS</span><span class="p">(</span><span class="n">fileFormat</span><span class="w"> </span><span class="s1">&#39;PARQUET&#39;</span><span class="p">)</span><span class="w"> </span><span class="n">PARTITIONED</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="p">(</span><span class="n">p1</span><span class="p">,</span><span class="w"> </span><span class="n">p2</span><span class="p">)</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">hive_serde_tab2</span><span class="w"> </span><span class="n">PARTITION</span><span class="w"> </span><span class="p">(</span><span class="n">p1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;part1&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">p2</span><span class="p">)</span>
<span class="w">  </span><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;part&#39;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">RANGE</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span>
<span class="k">INSERT</span><span class="w"> </span><span class="n">OVERWRITE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">hive_serde_tab2</span><span class="w"> </span><span class="n">PARTITION</span><span class="w"> </span><span class="p">(</span><span class="n">p1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;partNew1&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">p2</span><span class="p">)</span>
<span class="w">  </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;partNew2&#39;</span><span class="p">)</span>

<span class="c1">-- After this INSERT OVERWRITE, only the partitions (&#39;part1&#39;, &#39;part1&#39;) is overwritten by the new value.</span>
<span class="c1">-- All the three partitions still exist.</span>
<span class="k">INSERT</span><span class="w"> </span><span class="n">OVERWRITE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">hive_serde_tab2</span><span class="w"> </span><span class="n">PARTITION</span><span class="w"> </span><span class="p">(</span><span class="n">p1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;part1&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">p2</span><span class="p">)</span>
<span class="w">  </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;part1&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="insert-values-into-directory">
<h2>Insert values into directory<a class="headerlink" href="#insert-values-into-directory" title="Permalink to this headline"> </a></h2>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">INSERT</span><span class="w"> </span><span class="n">OVERWRITE</span><span class="w"> </span><span class="p">[</span><span class="k">LOCAL</span><span class="p">]</span><span class="w"> </span><span class="n">DIRECTORY</span><span class="w"> </span><span class="p">[</span><span class="n">directory_path</span><span class="p">]</span>
<span class="w">  </span><span class="k">USING</span><span class="w"> </span><span class="n">data_source</span><span class="w"> </span><span class="p">[</span><span class="k">OPTIONS</span><span class="w"> </span><span class="p">(</span><span class="n">key1</span><span class="o">=</span><span class="n">val1</span><span class="p">,</span><span class="w"> </span><span class="n">key2</span><span class="o">=</span><span class="n">val2</span><span class="p">,</span><span class="w"> </span><span class="p">...)]</span>
<span class="w">  </span><span class="p">[</span><span class="k">AS</span><span class="p">]</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="p">...</span>
</pre></div>
</div>
<p>Insert the query results of <code class="docutils literal notranslate"><span class="pre">select_statement</span></code> into a directory <code class="docutils literal notranslate"><span class="pre">directory_path</span></code> using Spark native format. If the specified path exists, it is replaced with the output of the <code class="docutils literal notranslate"><span class="pre">select_statement</span></code>.</p>
<p><strong><code class="docutils literal notranslate"><span class="pre">DIRECTORY</span></code></strong></p>
<p>The path of the destination directory of the insert. The directory can also be specified in <code class="docutils literal notranslate"><span class="pre">OPTIONS</span></code> using the key <code class="docutils literal notranslate"><span class="pre">path</span></code>. If the specified path exists, it is replaced with the output of the <code class="docutils literal notranslate"><span class="pre">select_statement</span></code>. If <code class="docutils literal notranslate"><span class="pre">LOCAL</span></code> is used, the directory is on the local file system.</p>
<p><strong><code class="docutils literal notranslate"><span class="pre">USING</span></code></strong></p>
<p>The file format to use for the insert. One of <code class="docutils literal notranslate"><span class="pre">TEXT</span></code>, <code class="docutils literal notranslate"><span class="pre">CSV</span></code>, <code class="docutils literal notranslate"><span class="pre">JSON</span></code>, <code class="docutils literal notranslate"><span class="pre">JDBC</span></code>, <code class="docutils literal notranslate"><span class="pre">PARQUET</span></code>, <code class="docutils literal notranslate"><span class="pre">ORC</span></code>, <code class="docutils literal notranslate"><span class="pre">HIVE</span></code>, and <code class="docutils literal notranslate"><span class="pre">LIBSVM</span></code>, or a fully qualified class name of a custom implementation of <code class="docutils literal notranslate"><span class="pre">org.apache.spark.sql.sources.DataSourceRegister</span></code>.</p>
<p><strong><code class="docutils literal notranslate"><span class="pre">AS</span></code></strong></p>
<p>Populate the destination directory with input data from the select statement.</p>
<div class="section" id="examples">
<span id="examples-3"></span><h3>Examples<a class="headerlink" href="#examples" title="Permalink to this headline"> </a></h3>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">INSERT</span><span class="w"> </span><span class="n">OVERWRITE</span><span class="w"> </span><span class="n">DIRECTORY</span>
<span class="k">USING</span><span class="w"> </span><span class="n">parquet</span>
<span class="k">OPTIONS</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="w"> </span><span class="s1">&#39;/tmp/destination/path&#39;</span><span class="p">)</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">key</span><span class="p">,</span><span class="w"> </span><span class="n">col1</span><span class="p">,</span><span class="w"> </span><span class="n">col2</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">source_table</span>

<span class="k">INSERT</span><span class="w"> </span><span class="n">OVERWRITE</span><span class="w"> </span><span class="n">DIRECTORY</span><span class="w"> </span><span class="s1">&#39;/tmp/destination/path&#39;</span>
<span class="k">USING</span><span class="w"> </span><span class="n">json</span>
<span class="k">SELECT</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;c&#39;</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">b</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="insert-values-into-directory-with-hive-format">
<h2>Insert values into directory with Hive format<a class="headerlink" href="#insert-values-into-directory-with-hive-format" title="Permalink to this headline"> </a></h2>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">INSERT</span><span class="w"> </span><span class="n">OVERWRITE</span><span class="w"> </span><span class="p">[</span><span class="k">LOCAL</span><span class="p">]</span><span class="w"> </span><span class="n">DIRECTORY</span><span class="w"> </span><span class="n">directory_path</span>
<span class="w">  </span><span class="p">[</span><span class="k">ROW</span><span class="w"> </span><span class="n">FORMAT</span><span class="w"> </span><span class="n">row_format</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="n">STORED</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">file_format</span><span class="p">]</span>
<span class="w">  </span><span class="p">[</span><span class="k">AS</span><span class="p">]</span><span class="w"> </span><span class="n">select_statement</span>
</pre></div>
</div>
<p>Insert the query results of <code class="docutils literal notranslate"><span class="pre">select_statement</span></code> into a directory <code class="docutils literal notranslate"><span class="pre">directory_path</span></code> using Hive SerDe. If the specified path exists, it is replaced with the output of the <code class="docutils literal notranslate"><span class="pre">select_statement</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This command is supported only when Hive support is enabled.</p>
</div>
<p><strong><code class="docutils literal notranslate"><span class="pre">DIRECTORY</span></code></strong></p>
<p>The path of the destination directory of the insert. If the specified path exists, it will be replaced with the output of the <code class="docutils literal notranslate"><span class="pre">select_statement</span></code>. If <code class="docutils literal notranslate"><span class="pre">LOCAL</span></code> is used, the directory is on the local file system.</p>
<p><strong><code class="docutils literal notranslate"><span class="pre">ROW</span> <span class="pre">FORMAT</span></code></strong></p>
<p>Use the <code class="docutils literal notranslate"><span class="pre">SERDE</span></code> clause to specify a custom SerDe for this insert. Otherwise, use the <code class="docutils literal notranslate"><span class="pre">DELIMITED</span></code> clause to use the native SerDe and specify the delimiter, escape character, null character, and so on.</p>
<p><strong><code class="docutils literal notranslate"><span class="pre">STORED</span> <span class="pre">AS</span></code></strong></p>
<p>The file format for this insert. One of <code class="docutils literal notranslate"><span class="pre">TEXTFILE</span></code>, <code class="docutils literal notranslate"><span class="pre">SEQUENCEFILE</span></code>, <code class="docutils literal notranslate"><span class="pre">RCFILE</span></code>, <code class="docutils literal notranslate"><span class="pre">ORC</span></code>, <code class="docutils literal notranslate"><span class="pre">PARQUET</span></code>, and <code class="docutils literal notranslate"><span class="pre">AVRO</span></code>. Alternatively, you can specify your own input and output format through <code class="docutils literal notranslate"><span class="pre">INPUTFORMAT</span></code> and <code class="docutils literal notranslate"><span class="pre">OUTPUTFORMAT</span></code>. Only <code class="docutils literal notranslate"><span class="pre">TEXTFILE</span></code>, <code class="docutils literal notranslate"><span class="pre">SEQUENCEFILE</span></code>, and <code class="docutils literal notranslate"><span class="pre">RCFILE</span></code> can be used with <code class="docutils literal notranslate"><span class="pre">ROW</span> <span class="pre">FORMAT</span> <span class="pre">SERDE</span></code>, and only <code class="docutils literal notranslate"><span class="pre">TEXTFILE</span></code> can be used with <code class="docutils literal notranslate"><span class="pre">ROW</span> <span class="pre">FORMAT</span> <span class="pre">DELIMITED</span></code>.</p>
<p><strong><code class="docutils literal notranslate"><span class="pre">AS</span></code></strong></p>
<p>Populate the destination directory with input data from the select statement.</p>
<div class="section" id="examples">
<span id="examples-4"></span><h3>Examples<a class="headerlink" href="#examples" title="Permalink to this headline"> </a></h3>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">INSERT</span><span class="w"> </span><span class="n">OVERWRITE</span><span class="w"> </span><span class="k">LOCAL</span><span class="w"> </span><span class="n">DIRECTORY</span><span class="w"> </span><span class="s1">&#39;/tmp/destination/path&#39;</span>
<span class="n">STORED</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">orc</span>
<span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">source_table</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="k">key</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">10</span>
</pre></div>
</div>
</div>
</div>
</div>


    
          </div>
        </div>
        <div  class="suapp-rating">
  <div id="suPageRateApp">
     <su-app></su-app>
   </div> 
 </div>
<hr> 
<footer>
  <div role="contentinfo">
      <p class="copyright">
          &copy; Databricks 2023. All rights reserved. Apache, Apache Spark, Spark, and the Spark logo are trademarks of the <a href="http://www.apache.org/">Apache Software Foundation</a>.
      </p>
      <p> 
        
          <a id='feedbacklink' href="mailto:doc-feedback@databricks.com?subject=Documentation Feedback">Send us feedback</a>
        
     | <a href="https://databricks.com/privacy-policy">Privacy Policy</a> | <a href="https://databricks.com/terms-of-use">Terms of Use</a></p>

  </div> 

</footer>
      </div>
    </div>
  </section>
</main>

  </page>
  
  <script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
      URL_ROOT: '../../',
      VERSION: '1.0',
      COLLAPSE_INDEX: false,
      FILE_SUFFIX: '.html',
      HAS_SOURCE: 'false'
    };
  </script>
  <script type="text/javascript" src="../../_static/jquery.js"></script>
  <script type="text/javascript" src="../../_static/underscore.js"></script>
  <script type="text/javascript" src="../../_static/doctools.js"></script>
  <script type="text/javascript" src="../../_static/language_data.js"></script>
  

  <script type="text/javascript" src="../../_static/js/clipboard.min.js"></script>
  <script type="text/javascript" src="../../_static/js/jquery.waypoints.min.js"></script>

  <!-- Select2 (https://select2.org/) -->
  <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
  <!-- End Select2 -->

  
  
  <script type="text/javascript" src="../../_static/js/localized.js"></script>
  <script type="text/javascript" src="../../_static/js/custom.js"></script>
  

  
  
  <script type="text/javascript">
    jQuery(function () {
      SphinxRtdTheme.StickyNav.enable();
    });

  </script>
  
 



  <script>
  window.__searchunifyLoaderConfig = JSON.parse('{"clients": {"en": "02c2e804-27e9-11ee-aefb-0242ac120011", "ja": "6a42c3f2-2820-11ee-aefb-0242ac120011", "pt": "6a86badd-2821-11ee-aefb-0242ac120011"}}')
</script>
<script type="text/javascript" src="../../_static/js/search-loader.js"></script>
</body>
<script type='text/javascript'>
  window.onload = function () {
    var description = document.querySelector('meta[name="description"]').getAttribute("content");
    let titleText = document.querySelector('h1').textContent;
    document.querySelector('meta[property="og:title"]').setAttribute("content", titleText);
    document.querySelector('meta[property="og:description"]').setAttribute("content", description);
    document.querySelector('meta[property="twitter:description"]').setAttribute("content", description);
  };
</script>

</html>