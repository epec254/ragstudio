

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en-US" > <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en-US"> <!--<![endif]-->

<head>
  <!-- cookie consent -->
  
    <!-- Combined Onetrust and Rudderstack Implementation Scripts -->
    <!-- Onetrust Initialization -->
    <script type="text/javascript" src="https://cdn.cookielaw.org/consent/92466579-1717-44d3-809d-a05fb02843ed-test/OtAutoBlock.js"></script>
    <script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" data-document-language="true" type="text/javascript" charset="UTF-8" data-domain-script="92466579-1717-44d3-809d-a05fb02843ed-test"></script>
    <link rel="stylesheet" id="db-onetrust-style" href="https://www.databricks.com/wp-content/uploads/db_onetrust.css" media="all" />
    <!-- Setting Rudderstack Write Key -->
    <script>window.rudderstackKey = "2SOR9fvSr5Fi6tN2ihPbVHnX1SZ" </script>
    <!-- Rudderstack Initialization + Onetrust Integration + Rudderstack Custom Events -->
    <script type="text/javascript" src="https://www.databricks.com/sites/default/files/rudderstack/v1/db-rudderstack-events.js"></script>

  <!-- cookie consent -->

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="X-UA-Compatible" content="IE=9" />
  <meta content="Learn best practices when using Databricks compute policies." name="description" />
<meta content="noindex" name="robots" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
  <meta property="og:image" content="https://www.databricks.com/wp-content/uploads/2020/04/og-databricks.png">
  <meta property="og:image:type" content="image/png">
  <meta property="og:title" content="Best practices: Compute policies">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://docs.databricks.com">
  <meta property="og:description" content="" id="og-description">
  <meta name="twitter:image" content="https://www.databricks.com/wp-content/uploads/2020/04/og-databricks.png">
  <meta name="twitter:site" content="@databricks">
  <meta name="twitter:creator" content="@databricks">
  <meta property="twitter:description" content="">
  
  <title>Best practices: Compute policies &#124; Databricks on AWS</title>
  
  
  <link rel="canonical" href="https://docs.databricks.com/en/archive/compute/policies-best-practices.html">
  <!-- Start hreflang tag -->
  <link rel="alternate" hreflang="en" href="https://docs.databricks.com/en/archive/compute/policies-best-practices.html" />
<link rel="alternate" hreflang="x-default" href="https://docs.databricks.com/en/archive/compute/policies-best-practices.html" />
  <!-- End hreflang tag -->
  
  
  <link rel="shortcut icon" href="../../_static/favicon.ico" />
  

  

  

  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;
j.setAttributeNode(d.createAttribute('data-ot-ignore'));
f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-T85FQ33');</script>
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;
j.setAttributeNode(d.createAttribute('data-ot-ignore'));
f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-TWTKQQ');</script>
    
  <!-- End Google Tag Manager -->


  <!-- MaxMind / GEO IP -->
  <script src="//js.maxmind.com/js/apis/geoip2/v2.1/geoip2.js" type="text/javascript"></script>
  <!-- End MaxMind / GEO IP -->

  
  
  <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600&display=swap" rel="stylesheet">
  <link rel="preload" href="../../_static/fonts/DMSans-Bold.ttf" as="font">
  <link rel="preload" href="../../_static/fonts/DMSans-Regular.ttf" as="font">
  <link rel="preload" href="../../_static/fonts/DMMono-Regular.ttf" as="font">
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/cloud-provider-selector.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/translation-selector.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/searchunify/main.css" type="text/css" />

  
  <link rel="index" title="Index" href="../../genindex.html" />
  <link rel="search" title="Search" href="../../search.html" />
  <link rel="top" title="Databricks on AWS" href="../../index.html" /> 
</head>

<body class="wy-body-for-nav" role="document">

  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T85FQ33"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TWTKQQ"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->

  
  <nav class="wy-nav-top header su_header" role="navigation" aria-label="top navigation">
    
<nav class="wy-nav-top header su_header" role="navigation" aria-label="top navigation">
  <div class="container-logo">
    <ul class="mobile-menu-toggle">
        <li class="menu-toggle">
            <i data-toggle="wy-nav-top" class="wy-nav-top-menu-button db-icon db-icon-menu pull-left"></i>
            
            <a href="https://www.databricks.com/" class="wy-nav-top-logo"><img src="../../_static/small-scale-lockup-full-color-rgb.svg" width="137" height="21"
              alt="Databricks" /></a>   
               
              </li>
    </ul>
    <ul class="su_nav-menu">
      <li class="menu-toggle">
        <i data-toggle="wy-nav-top" class="wy-nav-top-menu-button db-icon db-icon-menu pull-left"></i>
        
          
        
        <a href="https://www.databricks.com/" class="wy-nav-top-logo"><img src="../../_static/small-scale-lockup-full-color-rgb.svg" width="137" height="21"
            alt="Databricks" /></a></li>
        <!-- 
<li><a href="https://help.databricks.com/s/">Help Center</a></li>
<li class="active"><a href="https://docs.databricks.com/en/">Documentation</a></li>
<li><a href="https://kb.databricks.com/">Knowledge Base</a></li>
 -->
    </ul>
  </div>
  <div class="su_nav-right">
    <ul class="su_link-mobile">
  <!-- Mobile header code can go here -->
</ul>
<ul class="right-try-list">
   
</ul>
  </div>
</nav>
  </nav>

  <div class="su_sub-header">
    <div class="container">
      <div class="su_sub-header-inner">
        <!-- <div class="su_subnav-menu-right">
  <div id="auto" style="width: 100%;">
    <div ng-controller="SearchautoController">
      <div bind-html-compile="autocompleteHtml">
        <form class="su__search-box-1" disabled="disabled">
          <input class="su__search-input" type="search" name="Search box" id="su__search-b" placeholder="Search Documentation" disabled="disabled"/>
          <button class="su__search-button" type="submit" class="button button-success" disabled="disabled">
            <svg width="24" height="24" viewBox="0 0 24 24">
              <path
                d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"
                fill="#333"></path>
            </svg>
          </button>
        </form>
      </div>
    </div>
  </div>
</div> -->
        <div class="search-lng-gap"></div>
        <div style="margin-left: 16px; margin-right: 16px;">
          <!-- <select name="lng selector" id="lng-selector">
    <option value="../../../en/archive/compute/policies-best-practices.html" class="notranslate">English</option>
    <option value="../../../ja/archive/compute/policies-best-practices.html" class="notranslate">日本語</option>
    <option value="../../../pt/archive/compute/policies-best-practices.html" class="notranslate">Português (Brasil)</option>
</select> -->
        </div>
        <div class="cloud-selector-container">
          <!-- <select name="cloud provider selector" id="cloud-provider-selector">
    <option value="aws" selected class="notranslate">
        Amazon Web Services
    </option>
    <option value="azure"  class="notranslate">
        Microsoft Azure
    </option>
    <option value="gcp"  class="notranslate">
        Google Cloud Platform
    </option>
</select> -->
        </div>
      </div>
    </div>
  </div>
  <page class="js-page-container">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side su_nav-side">
<div class="wy-side-scroll">
  <div class="wy-side-nav-search">
    

    

    

    
  </div>

  <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
    
      <a href="../../index.html" class="main-navigation-home">Databricks on AWS</a>
    

    
      

      
        <p class="caption"><span class="caption-text">Load &amp; manage data</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../rag-temp/index.html">RAG Studio</a></li>
</ul>

      
    
  </div>

  <div role="contentinfo">
    
  <p class="build_info notranslate"data-last-edit="December 23, 2023">
    Updated Jan 11, 2024
  </p>
<script>
  window.addEventListener('DOMContentLoaded',function(){
    var h1=document.querySelector('h1');
    var bi=document.querySelector('[data-last-edit]');
    if(h1 && bi){
      var ver = document.createElement('p');
      ver.className = 'version_info';
      ver.textContent = bi.getAttribute('data-last-edit');
      h1.parentElement.insertBefore(ver, h1.nextElementSibling);
    }
  });
</script>

    <p>
      
        <a id='feedbacklink' href="mailto:doc-feedback@databricks.com?subject=Documentation Feedback">Send us feedback</a>
      
    </p>
  </div>
</div>
</nav>
    
    
<main class="wy-grid-for-nav su_nav-grid">
  <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
    <div class="wy-nav-content su__nav_content">
      <div class="rst-content">
        





<div role="navigation" aria-label="breadcrumbs navigation" class="wy-breadcrumbs-wrapper">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Documentation</a> <span class="db-icon db-icon-chevron-right"></span></li>
    
    
      <li>Best practices: Compute policies</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>
</div>
        
        <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
          <div itemprop="articleBody">
            
    
  <div class="section" id="best-practices-compute-policies">
<h1>Best practices: Compute policies<a class="headerlink" href="#best-practices-compute-policies" title="Permalink to this headline"> </a></h1>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This article has been archived and may no longer reflect the current state of the product. For information about compute policies, see <a class="reference internal" href="../../administration-guide/clusters/policies.html"><span class="doc">Create and manage compute policies</span></a>.</p>
</div>
<p>Databricks <a class="reference internal" href="../../administration-guide/clusters/policies.html"><span class="doc">compute policies</span></a> provide administrators control over the creation of compute resources in a Databricks workspace. Effective use of compute policies allows administrators to:</p>
<ul class="simple">
<li><p>Enforce standardized compute configurations.</p></li>
<li><p>Prevent excessive use of resources and control spending.</p></li>
<li><p>Ensure accurate chargeback by correctly tagging compute resources.</p></li>
<li><p>Facilitate analysis and processing by providing users with pre-configured compute configurations targeted at specific workloads.</p></li>
</ul>
<p>Combined with effective onboarding, approval, and chargeback processes, compute policies can be a foundational component in Databricks platform governance. This guide presents recommendations and best practices to help you create a successful plan for integrating compute policies into your governance framework.</p>
<p>Since governance is unique to each organization’s requirements and existing governance infrastructure, this article begins by covering recommendations that apply commonly to compute policies. The last section of this article discusses specific strategies to address challenges you might see in your environment.</p>
<p>This article discusses the following best practices and recommendations to ensure a successful compute governance rollout:</p>
<ul class="simple">
<li><p>Create a plan for introducing compute policies in phases to help users transition to a governed environment.</p></li>
<li><p>Create a plan for communicating changes for each phase of the compute policies rollout.</p></li>
<li><p>Identify compute governance challenges and implement strategies to address those challenges.</p></li>
</ul>
<div class="section" id="compute-policies-rollout">
<span id="policies-rollout"></span><h2>Compute policies rollout<a class="headerlink" href="#compute-policies-rollout" title="Permalink to this headline"> </a></h2>
<p>Implementing compute policies can present a significant change to the user experience. Databricks recommends a phased approach to help guide users through the transition:</p>
<ul class="simple">
<li><p>Communicate the upcoming changes and provide users an opportunity to test compute configurations.</p></li>
<li><p>Perform a soft rollout.</p></li>
<li><p>Incrementally introduce further policy changes.</p></li>
<li><p>Perform a hard cutover to an entirely governed environment.</p></li>
</ul>
<p>A phased rollout allows users to familiarize themselves with the new policies and prevent disruption to existing workloads. The following diagram is an example of this recommended process:</p>
<div class="figure align-default">
<img alt="Compute policies rollout plan" src="../../_images/policies-rollout-stages.png" />
</div>
<div class="contents local topic" id="the-following-sections-provide-more-detailed-information-on-these-stages">
<p class="topic-title first">The following sections provide more detailed information on these stages:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#communicate-and-test-compute-policies" id="id7">Communicate and test compute policies</a></p></li>
<li><p><a class="reference internal" href="#considerations-for-introducing-compute-policies" id="id8">Considerations for introducing compute policies</a></p></li>
<li><p><a class="reference internal" href="#final-rollout" id="id9">Final rollout</a></p></li>
</ul>
</div>
<div class="section" id="communicate-and-test-compute-policies">
<span id="policies-communication"></span><h3><a class="toc-backref" href="#id7">Communicate and test compute policies</a><a class="headerlink" href="#communicate-and-test-compute-policies" title="Permalink to this headline"> </a></h3>
<p>Begin the process by communicating the upcoming changes to users. The communication plan should include:</p>
<ul class="simple">
<li><p>Details on changes that are coming.</p></li>
<li><p>Why these changes are happening.</p></li>
<li><p>What users will need to do to ensure successful transitioning of workloads.</p></li>
<li><p>How to provide feedback about the changes.</p></li>
<li><p>A timeline for each stage of the rollout.</p></li>
<li><p>At the start of each stage of the phased rollout, communicate further details relevant to that stage.</p></li>
</ul>
<p>The following diagram provides an example communication plan for a phased rollout:</p>
<div class="figure align-default">
<img alt="Compute policies communication plan" src="../../_images/policies-communication-plan.png" />
</div>
<p>Your plan might have different stages depending on your environment and compute policies strategy. This example includes four stages:</p>
<ul class="simple">
<li><p>Stage 1 includes communicating the plan to users and beginning of testing. Users must have an opportunity to test their current and anticipated workloads on compute that conform to the new policies. You want to identify any issues with existing and planned workloads early in the process.</p></li>
<li><p>Stage 2 continues testing along with the rollout of a compute tagging policy.</p></li>
<li><p>Stage 3 introduces compute types, in this case specifying compute using T-shirt sizes, for example, small, large, or extra-large compute types.</p></li>
<li><p>Stage 4 is the final rollout of compute policies along with complete user documentation.</p></li>
</ul>
<p>Users should also have the opportunity to test their workloads with the planned compute configurations in the initial stage. This testing can help identify existing workloads that have issues running with the proposed policies.</p>
</div>
<div class="section" id="considerations-for-introducing-compute-policies">
<span id="considerations-for-policies"></span><h3><a class="toc-backref" href="#id8">Considerations for introducing compute policies</a><a class="headerlink" href="#considerations-for-introducing-compute-policies" title="Permalink to this headline"> </a></h3>
<p>Consider your current management policies when planning the initial deployment of compute policies. In particular, consider whether you’re moving from an environment where users are restricted from creating compute or a more open environment.</p>
<div class="section" id="restrictive-environment">
<span id="restrictive-env-considerations"></span><h4>Restrictive environment<a class="headerlink" href="#restrictive-environment" title="Permalink to this headline"> </a></h4>
<p>In the case of an environment where users haven’t had permissions to create compute, begin by rolling out restrictive policies along with an enablement plan for users. An enablement plan might be computer-based training, workshops, or documentation. Providing users with guidance on best practices for configuring compute will improve their ability to take full advantage of the platform. Policies can be relaxed as users demonstrate compliance and competence with the platform.</p>
</div>
<div class="section" id="unrestricted-environment">
<span id="unrestricted-env-considerations"></span><h4>Unrestricted environment<a class="headerlink" href="#unrestricted-environment" title="Permalink to this headline"> </a></h4>
<p>Applying policies can be more challenging in an unrestricted environment. Some existing use cases and compute  will nearly always fall outside of the new policy’s constraints, so identifying these in a testing or soft rollout stage is crucial.</p>
<p>Users with compute create permissions or access to the unrestricted policy will maintain their access to this policy throughout the soft rollout to ensure all workloads continue to function. Users should use the soft rollout to test all of their workloads with the new policies that will be made available to them.</p>
<p>Be sure to give users a place to submit feedback about the policies. Work with users to refine the policies or define new policies when issues arise.</p>
</div>
</div>
<div class="section" id="final-rollout">
<span id="last-phase"></span><h3><a class="toc-backref" href="#id9">Final rollout</a><a class="headerlink" href="#final-rollout" title="Permalink to this headline"> </a></h3>
<p>Remove access to the unrestricted policies for restricted users when the deadline is reached. The rollout of compute policies should now be complete.</p>
</div>
</div>
<div class="section" id="specific-challenges--strategies">
<span id="specific-challenges"></span><h2>Specific challenges &amp; strategies<a class="headerlink" href="#specific-challenges--strategies" title="Permalink to this headline"> </a></h2>
<p>The following are examples of applying compute policies to address specific challenges. Many of these strategies can be employed simultaneously but will require application of each strategy across all policies. For example, if using the tag enforcement strategy with the T-shirt size strategy, each T-shirt policy will also need a <code class="docutils literal notranslate"><span class="pre">custom_tag.*</span></code> policy.</p>
<div class="section" id="tag-enforcement">
<span id="enforcing-tags"></span><h3>Tag enforcement<a class="headerlink" href="#tag-enforcement" title="Permalink to this headline"> </a></h3>
<div class="section" id="challenge">
<span id="enforcing-tags-challenge"></span><h4>Challenge<a class="headerlink" href="#challenge" title="Permalink to this headline"> </a></h4>
<p>Users can create compute freely, and there is no mechanism to enforce that they apply required tags.</p>
</div>
<div class="section" id="solution">
<span id="enforcing-tags-solution"></span><h4>Solution<a class="headerlink" href="#solution" title="Permalink to this headline"> </a></h4>
<ol class="arabic">
<li><p>Revoke <a class="reference internal" href="../../security/auth-authz/access-control/cluster-acl.html#cluster-create-permission"><span class="std std-ref">compute create permission</span></a> from users.</p></li>
<li><p>Add a compute tag rule to any applicable compute policies. To add the compute tag rule to a policy, use the <code class="docutils literal notranslate"><span class="pre">custom_tags.&lt;tag-name&gt;</span></code> attribute. The value can be anything under an <a class="reference internal" href="../../administration-guide/clusters/policy-definition.html#unlimited"><span class="std std-ref">unlimited policy</span></a>, or it can be restricted by <a class="reference internal" href="../../administration-guide/clusters/policy-definition.html#fixed"><span class="std std-ref">fixed</span></a>, <a class="reference internal" href="../../administration-guide/clusters/policy-definition.html#allow"><span class="std std-ref">allow list</span></a>, <a class="reference internal" href="../../administration-guide/clusters/policy-definition.html#block"><span class="std std-ref">block list</span></a>, <a class="reference internal" href="../../administration-guide/clusters/policy-definition.html#regex"><span class="std std-ref">regex</span></a>, or <a class="reference internal" href="../../administration-guide/clusters/policy-definition.html#range"><span class="std std-ref">range</span></a> policies. For example, to ensure correct chargeback and cost attribution, enforce a <code class="docutils literal notranslate"><span class="pre">COST_CENTER</span></code> tag on each policy restricted to a list of allowed cost center values:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="nt">&quot;custom_tags.COST_CENTER&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;allowlist&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;values&quot;</span><span class="p">:[</span><span class="s2">&quot;9999&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;9921&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;9531&quot;</span><span class="w"> </span><span class="p">]}}</span>
</pre></div>
</div>
<p>Any user using this policy will have to fill in a <code class="docutils literal notranslate"><span class="pre">COST_CENTER</span></code> tag with 9999, 9921, or 9531 for the compute to launch.</p>
</li>
<li><p>Assign the policy to users who should be able to charge against those three cost centers. Policies can be assigned at a user or group level through the <a class="reference internal" href="../../administration-guide/clusters/policies.html#manage-policy"><span class="std std-ref">compute policy UI</span></a> or the <a class="reference external" href="https://docs.databricks.com/api/workspace/clusterpolicies">Policies API</a>. The following example request body assigns a policy to the sales department:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;access_control_list&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;user_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;user@mydomain.com&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;all_permissions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;permission_level&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;CAN_USE&quot;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">]</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;group_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;sales&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;all_permissions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;permission_level&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;CAN_USE&quot;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
</ol>
</div>
</div>
<div class="section" id="inexperienced-users">
<span id="new-users"></span><h3>Inexperienced users<a class="headerlink" href="#inexperienced-users" title="Permalink to this headline"> </a></h3>
<div class="section" id="challenge">
<span id="challenge-1"></span><span id="new-users-challenge"></span><h4>Challenge<a class="headerlink" href="#challenge" title="Permalink to this headline"> </a></h4>
<p>Users are unfamiliar with compute or cloud infrastructure provisioning or overwhelmed with compute creation options.</p>
</div>
<div class="section" id="solution">
<span id="solution-1"></span><span id="new-users-solution"></span><h4>Solution<a class="headerlink" href="#solution" title="Permalink to this headline"> </a></h4>
<p>Use compute policies to define “T-shirt” sized compute configurations, for example, small, medium, or large compute .</p>
<ol class="arabic">
<li><p>Create a policy for each T-Shirt size. T-shirt size policies indicate a relative compute size to the users and can either be flexible templates or zero option configurations. Zero option or low option policies will often have <a class="reference internal" href="../../administration-guide/clusters/policy-definition.html#fixed"><span class="std std-ref">fixed</span></a> and hidden policy rules. The following example defines a policy with a fixed value of DBR 7.3 for the <code class="docutils literal notranslate"><span class="pre">spark_version</span></code>. Setting the <code class="docutils literal notranslate"><span class="pre">hidden</span></code> flag to true will ensure this option is not visible to users.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="nt">&quot;spark_version&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;fixed&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;auto:latest-ml&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;hidden&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w"> </span><span class="p">}}</span>
</pre></div>
</div>
<p>When defining flexible templates, you can use <a class="reference internal" href="../../administration-guide/clusters/policy-definition.html#range"><span class="std std-ref">range</span></a>, <a class="reference internal" href="../../administration-guide/clusters/policy-definition.html#block"><span class="std std-ref">blocklist</span></a>, <a class="reference internal" href="../../administration-guide/clusters/policy-definition.html#regex"><span class="std std-ref">regex</span></a>, and <a class="reference internal" href="../../administration-guide/clusters/policy-definition.html#unlimited"><span class="std std-ref">unlimited policy</span></a> policies to set upper boundaries, non-optional fields, and semi-restricted policy elements. The following example defines a policy that enables autoscaling nodes to a maximum of 25. You can use this definition to set upper boundaries on each T-Shirt size while providing some flexibility. To see more details of a compute template approach, see <a class="reference internal" href="#excessive-resources"><span class="std std-ref">Excessive resource usage</span></a>.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="nt">&quot;autoscale.max_workers&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;range&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;maxValue&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;25&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;defaultValue&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">}}</span>
</pre></div>
</div>
</li>
<li><p>Assign the policy to users who should be allowed to create T-shirt sized compute . Policies can be assigned at a user or a group level through the policy UI or the Policy Permissions API. For example, to assign this policy to all users through the UI:</p>
<ol class="loweralpha">
<li><p>Go to the policy and select <strong>Edit</strong>.</p></li>
<li><p>Select the <strong>Permissions</strong> tab.</p></li>
<li><p>Select the <strong>all users</strong> option under <strong>Groups</strong> in the dropdown.</p>
<div class="figure align-default">
<img alt="Assign policy to all users" src="../../_images/policies-edit-policy-assign-all-users.png" />
</div>
</li>
</ol>
</li>
<li><p>Revoke access to the unrestricted policy from the groups that must use these new policies only. Once compute policies are in use, having access to the “compute creation” permission gives users access to the unrestricted policy. It’s important to revoke this permission for users that should not have it.</p>
<p>To revoke compute creation permissions, see <a class="reference internal" href="../../security/auth-authz/access-control/cluster-acl.html#cluster-create-permission"><span class="std std-ref">Configure compute creation permission</span></a>.</p>
</li>
</ol>
</div>
</div>
<div class="section" id="use-case-specific-policies">
<span id="workload-specific-policies"></span><h3>Use case specific policies<a class="headerlink" href="#use-case-specific-policies" title="Permalink to this headline"> </a></h3>
<div class="section" id="challenge">
<span id="challenge-2"></span><span id="workload-specific-policies-challenge"></span><h4>Challenge<a class="headerlink" href="#challenge" title="Permalink to this headline"> </a></h4>
<p>Some workloads or analyses are incompatible with existing policies, or users do not know the correct compute configuration for certain workload types.</p>
</div>
<div class="section" id="solution">
<span id="solution-2"></span><h4>Solution<a class="headerlink" href="#solution" title="Permalink to this headline"> </a></h4>
<p id="workload-specific-policies-solution">If you find workloads that don’t work well with existing policies, it’s often better to create new policies specifically targeted at those workloads instead of expanding existing policies.</p>
<p>To help users create compute  using these policies, it can help to create policies tuned for specific use cases. Assign descriptive names to these policies to help users identify them. For example, if workloads will be querying a data source that supports predicate pushdown, a best practice is to build a specific policy that enforces autoscaling with a low or zero worker minimum. This policy will ensure that cloud provider and Databricks costs don’t unnecessarily grow while waiting for the data source to compute the pushed down components of the query.</p>
<ol class="arabic">
<li><p>Create a policy that enforces use case-specific best practices. This example defines a policy that has a fixed value of <code class="docutils literal notranslate"><span class="pre">0</span></code> for the minimum number of workers. This policy also enforces that the compute will autoscale, satisfying the predicate pushdown example’s best practice.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="nt">&quot;autoscale.min_workers&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;fixed&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;0&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;hidden&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w"> </span><span class="p">}}</span>
</pre></div>
</div>
</li>
<li><p>Assign the policy to users who need to build compute for these use cases. You can assign policies at a user or a group level through the <a class="reference internal" href="../../administration-guide/clusters/policies.html#manage-policy"><span class="std std-ref">policy UI</span></a> or the <a class="reference external" href="https://docs.databricks.com/api/workspace/permissions">Permissions API</a>. For example, to assign this policy to a data scientist group through the UI:</p>
<ol class="loweralpha">
<li><p>Go to the policy and select <strong>Edit</strong>.</p></li>
<li><p>Select the <strong>Permissions</strong> tab.</p></li>
<li><p>To assign a policy to a specific team, select the team’s name in the <strong>Select User or Group</strong> dropdown.</p>
<div class="figure align-default">
<img alt="Assign policy to a group" src="../../_images/policies-edit-policy-assign-group.png" />
</div>
</li>
</ol>
</li>
</ol>
</div>
</div>
<div class="section" id="excessive-resource-usage">
<span id="excessive-resources"></span><h3>Excessive resource usage<a class="headerlink" href="#excessive-resource-usage" title="Permalink to this headline"> </a></h3>
<div class="section" id="challenge">
<span id="challenge-3"></span><span id="excessive-resources-challenge"></span><h4>Challenge<a class="headerlink" href="#challenge" title="Permalink to this headline"> </a></h4>
<p>Users are creating unnecessarily large compute, consuming excessive and expensive resources. This is often caused by:</p>
<ul class="simple">
<li><p>Failure to activate autoscaling.</p></li>
<li><p>Incorrect usage of auto termination windows.</p></li>
<li><p>High minimum worker node counts.</p></li>
<li><p>Expensive instance types.</p></li>
</ul>
</div>
<div class="section" id="solution">
<span id="solution-3"></span><span id="excessive-resources-solution"></span><h4>Solution<a class="headerlink" href="#solution" title="Permalink to this headline"> </a></h4>
<p>Pairing compute policies with an internal approval process will enable control over resources while also providing access to large compute resources when necessary.</p>
<ol class="arabic">
<li><p>Establish a review process for granting access to larger or more flexible policies. The review process should have an intake form that collects information that supports the need for larger or more flexible compute configurations. The platform ownership team should evaluate this information to decide how to support the workload requirements. The following diagram illustrates an example approval process using T-shirt sizing:</p>
<div class="figure align-default">
<img alt="Policies sizing process" src="../../_images/policies-sizing-process.png" />
</div>
</li>
<li><p>Create more flexible policies with fewer constraints and a focus on controlling governance items like tags. An example of a flexible Policy:</p></li>
</ol>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;autoscale.min_workers&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;range&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;maxValue&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;defaultValue&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;autoscale.max_workers&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;range&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;maxValue&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;defaultValue&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;autotermination_minutes&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;range&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;maxValue&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">120</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;defaultValue&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">60</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;node_type_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;blocklist&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;values&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;z1d.12xlarge&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;z1d.6xlarge&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;r5d.16xlarge&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;r5a.24xlarge&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;i4i.32xlarge&quot;</span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;defaultValue&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;i3.xlarge&quot;</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;driver_node_type_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;blocklist&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;values&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;z1d.12xlarge&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;z1d.6xlarge&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;r5d.16xlarge&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;r5a.24xlarge&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;i4i.32xlarge&quot;</span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;defaultValue&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;i3.xlarge&quot;</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;spark_version&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;fixed&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;auto:latest-ml&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;hidden&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;enable_elastic_disk&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;fixed&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;hidden&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;custom_tags.team&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;fixed&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;product&quot;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<ol class="arabic">
<li><p>Document the upgrade and approval process and share it with users. It is also helpful to publish guidance on identifying the types of workloads that might need more flexibility or larger compute.</p></li>
<li><p>Once a user is approved, assign the policy to them. Policies can be assigned at a user or a group level through the <a class="reference internal" href="../../administration-guide/clusters/policies.html#manage-policy"><span class="std std-ref">policy UI</span></a> or by submitting a request to the <a class="reference external" href="https://docs.databricks.com/api/workspace/permissions">Permissions API</a>:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;access_control_list&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;user_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;users_email@yourdomain.com&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;permission_level&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;CAN_USE&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="section" id="learn-more">
<span id="conclusion"></span><h2>Learn more<a class="headerlink" href="#learn-more" title="Permalink to this headline"> </a></h2>
<p>To learn more about compute policies on Databricks, see <a class="reference internal" href="../../administration-guide/clusters/policies.html"><span class="doc">Create and manage compute policies</span></a> and our blog on compute policies: <a class="reference external" href="https://databricks.com/blog/2020/07/02/allow-simple-cluster-creation-with-full-admin-control-using-cluster-policies.html">Allow Simple Cluster Creation with Full Admin Control Using Cluster Policies</a>.</p>
</div>
</div>


    
          </div>
        </div>
        <div  class="suapp-rating">
  <div id="suPageRateApp">
     <su-app></su-app>
   </div> 
 </div>
<hr> 
<footer>
  <div role="contentinfo">
      <p class="copyright">
          &copy; Databricks 2023. All rights reserved. Apache, Apache Spark, Spark, and the Spark logo are trademarks of the <a href="http://www.apache.org/">Apache Software Foundation</a>.
      </p>
      <p> 
        
          <a id='feedbacklink' href="mailto:doc-feedback@databricks.com?subject=Documentation Feedback">Send us feedback</a>
        
     | <a href="https://databricks.com/privacy-policy">Privacy Policy</a> | <a href="https://databricks.com/terms-of-use">Terms of Use</a></p>

  </div> 

</footer>
      </div>
    </div>
  </section>
</main>

  </page>
  
  <script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
      URL_ROOT: '../../',
      VERSION: '1.0',
      COLLAPSE_INDEX: false,
      FILE_SUFFIX: '.html',
      HAS_SOURCE: 'false'
    };
  </script>
  <script type="text/javascript" src="../../_static/jquery.js"></script>
  <script type="text/javascript" src="../../_static/underscore.js"></script>
  <script type="text/javascript" src="../../_static/doctools.js"></script>
  <script type="text/javascript" src="../../_static/language_data.js"></script>
  

  <script type="text/javascript" src="../../_static/js/clipboard.min.js"></script>
  <script type="text/javascript" src="../../_static/js/jquery.waypoints.min.js"></script>

  <!-- Select2 (https://select2.org/) -->
  <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
  <!-- End Select2 -->

  
  
  <script type="text/javascript" src="../../_static/js/localized.js"></script>
  <script type="text/javascript" src="../../_static/js/custom.js"></script>
  

  
  
  <script type="text/javascript">
    jQuery(function () {
      SphinxRtdTheme.StickyNav.enable();
    });

  </script>
  
 



  <script>
  window.__searchunifyLoaderConfig = JSON.parse('{"clients": {"en": "02c2e804-27e9-11ee-aefb-0242ac120011", "ja": "6a42c3f2-2820-11ee-aefb-0242ac120011", "pt": "6a86badd-2821-11ee-aefb-0242ac120011"}}')
</script>
<script type="text/javascript" src="../../_static/js/search-loader.js"></script>
</body>
<script type='text/javascript'>
  window.onload = function () {
    var description = document.querySelector('meta[name="description"]').getAttribute("content");
    let titleText = document.querySelector('h1').textContent;
    document.querySelector('meta[property="og:title"]').setAttribute("content", titleText);
    document.querySelector('meta[property="og:description"]').setAttribute("content", description);
    document.querySelector('meta[property="twitter:description"]').setAttribute("content", description);
  };
</script>

</html>