

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en-US" > <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en-US"> <!--<![endif]-->

<head>
  <!-- cookie consent -->
  
    <!-- Combined Onetrust and Rudderstack Implementation Scripts -->
    <!-- Onetrust Initialization -->
    <script type="text/javascript" src="https://cdn.cookielaw.org/consent/92466579-1717-44d3-809d-a05fb02843ed-test/OtAutoBlock.js"></script>
    <script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" data-document-language="true" type="text/javascript" charset="UTF-8" data-domain-script="92466579-1717-44d3-809d-a05fb02843ed-test"></script>
    <link rel="stylesheet" id="db-onetrust-style" href="https://www.databricks.com/wp-content/uploads/db_onetrust.css" media="all" />
    <!-- Setting Rudderstack Write Key -->
    <script>window.rudderstackKey = "2SOR9fvSr5Fi6tN2ihPbVHnX1SZ" </script>
    <!-- Rudderstack Initialization + Onetrust Integration + Rudderstack Custom Events -->
    <script type="text/javascript" src="https://www.databricks.com/sites/default/files/rudderstack/v1/db-rudderstack-events.js"></script>

  <!-- cookie consent -->

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="X-UA-Compatible" content="IE=9" />
  <meta content="Archived maintenance updates issued for Databricks runtime releases. The releases listed on this page are no longer supported." name="description" />
<meta content="noindex" name="robots" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
  <meta property="og:image" content="https://www.databricks.com/wp-content/uploads/2020/04/og-databricks.png">
  <meta property="og:image:type" content="image/png">
  <meta property="og:title" content="Maintenance updates for Databricks Runtime (archived)">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://docs.databricks.com">
  <meta property="og:description" content="" id="og-description">
  <meta name="twitter:image" content="https://www.databricks.com/wp-content/uploads/2020/04/og-databricks.png">
  <meta name="twitter:site" content="@databricks">
  <meta name="twitter:creator" content="@databricks">
  <meta property="twitter:description" content="">
  
  <title>Maintenance updates for Databricks Runtime (archived) &#124; Databricks on AWS</title>
  
  
  <link rel="canonical" href="https://docs.databricks.com/en/archive/runtime-release-notes/maintenance-updates-archive.html">
  <!-- Start hreflang tag -->
  <link rel="alternate" hreflang="en" href="https://docs.databricks.com/en/archive/runtime-release-notes/maintenance-updates-archive.html" />
<link rel="alternate" hreflang="x-default" href="https://docs.databricks.com/en/archive/runtime-release-notes/maintenance-updates-archive.html" />
  <!-- End hreflang tag -->
  
  
  <link rel="shortcut icon" href="../../_static/favicon.ico" />
  

  

  

  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;
j.setAttributeNode(d.createAttribute('data-ot-ignore'));
f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-T85FQ33');</script>
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;
j.setAttributeNode(d.createAttribute('data-ot-ignore'));
f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-TWTKQQ');</script>
    
  <!-- End Google Tag Manager -->


  <!-- MaxMind / GEO IP -->
  <script src="//js.maxmind.com/js/apis/geoip2/v2.1/geoip2.js" type="text/javascript"></script>
  <!-- End MaxMind / GEO IP -->

  
  
  <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600&display=swap" rel="stylesheet">
  <link rel="preload" href="../../_static/fonts/DMSans-Bold.ttf" as="font">
  <link rel="preload" href="../../_static/fonts/DMSans-Regular.ttf" as="font">
  <link rel="preload" href="../../_static/fonts/DMMono-Regular.ttf" as="font">
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/cloud-provider-selector.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/translation-selector.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/searchunify/main.css" type="text/css" />

  
  <link rel="index" title="Index" href="../../genindex.html" />
  <link rel="search" title="Search" href="../../search.html" />
  <link rel="top" title="Databricks on AWS" href="../../index.html" /> 
</head>

<body class="wy-body-for-nav" role="document">

  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T85FQ33"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TWTKQQ"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->

  
  <nav class="wy-nav-top header su_header" role="navigation" aria-label="top navigation">
    
<nav class="wy-nav-top header su_header" role="navigation" aria-label="top navigation">
  <div class="container-logo">
    <ul class="mobile-menu-toggle">
        <li class="menu-toggle">
            <i data-toggle="wy-nav-top" class="wy-nav-top-menu-button db-icon db-icon-menu pull-left"></i>
            
            <a href="https://www.databricks.com/" class="wy-nav-top-logo"><img src="../../_static/small-scale-lockup-full-color-rgb.svg" width="137" height="21"
              alt="Databricks" /></a>   
               
              </li>
    </ul>
    <ul class="su_nav-menu">
      <li class="menu-toggle">
        <i data-toggle="wy-nav-top" class="wy-nav-top-menu-button db-icon db-icon-menu pull-left"></i>
        
          
        
        <a href="https://www.databricks.com/" class="wy-nav-top-logo"><img src="../../_static/small-scale-lockup-full-color-rgb.svg" width="137" height="21"
            alt="Databricks" /></a></li>
        <!-- 
<li><a href="https://help.databricks.com/s/">Help Center</a></li>
<li class="active"><a href="https://docs.databricks.com/en/">Documentation</a></li>
<li><a href="https://kb.databricks.com/">Knowledge Base</a></li>
 -->
    </ul>
  </div>
  <div class="su_nav-right">
    <ul class="su_link-mobile">
  <!-- Mobile header code can go here -->
</ul>
<ul class="right-try-list">
   
</ul>
  </div>
</nav>
  </nav>

  <div class="su_sub-header">
    <div class="container">
      <div class="su_sub-header-inner">
        <!-- <div class="su_subnav-menu-right">
  <div id="auto" style="width: 100%;">
    <div ng-controller="SearchautoController">
      <div bind-html-compile="autocompleteHtml">
        <form class="su__search-box-1" disabled="disabled">
          <input class="su__search-input" type="search" name="Search box" id="su__search-b" placeholder="Search Documentation" disabled="disabled"/>
          <button class="su__search-button" type="submit" class="button button-success" disabled="disabled">
            <svg width="24" height="24" viewBox="0 0 24 24">
              <path
                d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"
                fill="#333"></path>
            </svg>
          </button>
        </form>
      </div>
    </div>
  </div>
</div> -->
        <div class="search-lng-gap"></div>
        <div style="margin-left: 16px; margin-right: 16px;">
          <!-- <select name="lng selector" id="lng-selector">
    <option value="../../../en/archive/runtime-release-notes/maintenance-updates-archive.html" class="notranslate">English</option>
    <option value="../../../ja/archive/runtime-release-notes/maintenance-updates-archive.html" class="notranslate">日本語</option>
    <option value="../../../pt/archive/runtime-release-notes/maintenance-updates-archive.html" class="notranslate">Português (Brasil)</option>
</select> -->
        </div>
        <div class="cloud-selector-container">
          <!-- <select name="cloud provider selector" id="cloud-provider-selector">
    <option value="aws" selected class="notranslate">
        Amazon Web Services
    </option>
    <option value="azure"  class="notranslate">
        Microsoft Azure
    </option>
    <option value="gcp"  class="notranslate">
        Google Cloud Platform
    </option>
</select> -->
        </div>
      </div>
    </div>
  </div>
  <page class="js-page-container">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side su_nav-side">
<div class="wy-side-scroll">
  <div class="wy-side-nav-search">
    

    

    

    
  </div>

  <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
    
      <a href="../../index.html" class="main-navigation-home">Databricks on AWS</a>
    

    
      

      
        <p class="caption"><span class="caption-text">Load &amp; manage data</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../rag-temp/index.html">RAG Studio</a></li>
</ul>

      
    
  </div>

  <div role="contentinfo">
    
  <p class="build_info notranslate"data-last-edit="December 23, 2023">
    Updated Jan 11, 2024
  </p>
<script>
  window.addEventListener('DOMContentLoaded',function(){
    var h1=document.querySelector('h1');
    var bi=document.querySelector('[data-last-edit]');
    if(h1 && bi){
      var ver = document.createElement('p');
      ver.className = 'version_info';
      ver.textContent = bi.getAttribute('data-last-edit');
      h1.parentElement.insertBefore(ver, h1.nextElementSibling);
    }
  });
</script>

    <p>
      
        <a id='feedbacklink' href="mailto:doc-feedback@databricks.com?subject=Documentation Feedback">Send us feedback</a>
      
    </p>
  </div>
</div>
</nav>
    
    
<main class="wy-grid-for-nav su_nav-grid">
  <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
    <div class="wy-nav-content su__nav_content">
      <div class="rst-content">
        





<div role="navigation" aria-label="breadcrumbs navigation" class="wy-breadcrumbs-wrapper">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Documentation</a> <span class="db-icon db-icon-chevron-right"></span></li>
    
    
      <li>Maintenance updates for Databricks Runtime (archived)</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>
</div>
        
        <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
          <div itemprop="articleBody">
            
    
  <div class="section" id="maintenance-updates-for-databricks-runtime-archived">
<span id="maintenance-updates-for-dbr-archived"></span><h1>Maintenance updates for Databricks Runtime (archived)<a class="headerlink" href="#maintenance-updates-for-databricks-runtime-archived" title="Permalink to this headline"> </a></h1>
<p>This archived page lists maintenance updates issued for Databricks Runtime releases that are no longer supported. To add a maintenance update to an existing cluster, restart the cluster.</p>
<p>To migrate to a supported Databricks Runtime version, see the <a class="reference external" href="https://dbrmg.databricks.com/?cloud_provider=aws">Databricks Runtime migration guide</a>.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>This documentation has been retired and might not be updated. The products, services, or technologies mentioned in this content are no longer supported. See <a class="reference internal" href="../../release-notes/runtime/index.html"><span class="doc">Databricks Runtime release notes versions and compatibility</span></a>.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This article contains references to the term <em>whitelist</em>, a term that Databricks does not use. When the term is removed from the software, we’ll remove it from this article.</p>
</div>
<div class="section" id="databricks-runtime-releases">
<span id="dbr-releases"></span><h2>Databricks Runtime releases<a class="headerlink" href="#databricks-runtime-releases" title="Permalink to this headline"> </a></h2>
<div class="contents local topic" id="maintenance-updates-by-release">
<p class="topic-title first">Maintenance updates by release:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#databricks-runtime-131" id="id1">Databricks Runtime 13.1</a></p></li>
<li><p><a class="reference internal" href="#databricks-runtime-122-lts" id="id2">Databricks Runtime 12.2 LTS</a></p></li>
<li><p><a class="reference internal" href="#databricks-runtime-113-lts" id="id3">Databricks Runtime 11.3 LTS</a></p></li>
<li><p><a class="reference internal" href="#databricks-runtime-104-lts" id="id4">Databricks Runtime 10.4 LTS</a></p></li>
<li><p><a class="reference internal" href="#databricks-runtime-91-lts" id="id5">Databricks Runtime 9.1 LTS</a></p></li>
<li><p><a class="reference internal" href="#databricks-runtime-130-unsupported" id="id6">Databricks Runtime 13.0 (unsupported)</a></p></li>
<li><p><a class="reference internal" href="#databricks-runtime-121-unsupported" id="id7">Databricks Runtime 12.1 (unsupported)</a></p></li>
<li><p><a class="reference internal" href="#databricks-runtime-120-unsupported" id="id8">Databricks Runtime 12.0 (unsupported)</a></p></li>
<li><p><a class="reference internal" href="#databricks-runtime-112-unsupported" id="id9">Databricks Runtime 11.2 (unsupported)</a></p></li>
<li><p><a class="reference internal" href="#databricks-runtime-111-unsupported" id="id10">Databricks Runtime 11.1 (unsupported)</a></p></li>
<li><p><a class="reference internal" href="#databricks-runtime-110-unsupported" id="id11">Databricks Runtime 11.0 (unsupported)</a></p></li>
<li><p><a class="reference internal" href="#databricks-runtime-105-unsupported" id="id12">Databricks Runtime 10.5 (unsupported)</a></p></li>
<li><p><a class="reference internal" href="#databricks-runtime-103-unsupported" id="id13">Databricks Runtime 10.3 (Unsupported)</a></p></li>
<li><p><a class="reference internal" href="#databricks-runtime-102-unsupported" id="id14">Databricks Runtime 10.2 (unsupported)</a></p></li>
<li><p><a class="reference internal" href="#databricks-runtime-101-unsupported" id="id15">Databricks Runtime 10.1 (unsupported)</a></p></li>
<li><p><a class="reference internal" href="#databricks-runtime-100-unsupported" id="id16">Databricks Runtime 10.0 (unsupported)</a></p></li>
<li><p><a class="reference internal" href="#databricks-runtime-90-unsupported" id="id17">Databricks Runtime 9.0 (unsupported)</a></p></li>
<li><p><a class="reference internal" href="#databricks-runtime-84-unsupported" id="id18">Databricks Runtime 8.4 (unsupported)</a></p></li>
<li><p><a class="reference internal" href="#databricks-runtime-83-unsupported" id="id19">Databricks Runtime 8.3 (unsupported)</a></p></li>
<li><p><a class="reference internal" href="#databricks-runtime-82-unsupported" id="id20">Databricks Runtime 8.2 (unsupported)</a></p></li>
<li><p><a class="reference internal" href="#databricks-runtime-81-unsupported" id="id21">Databricks Runtime 8.1 (unsupported)</a></p></li>
<li><p><a class="reference internal" href="#databricks-runtime-80-unsupported" id="id22">Databricks Runtime 8.0 (unsupported)</a></p></li>
<li><p><a class="reference internal" href="#databricks-runtime-76-unsupported" id="id23">Databricks Runtime 7.6 (unsupported)</a></p></li>
<li><p><a class="reference internal" href="#databricks-runtime-75-unsupported" id="id24">Databricks Runtime 7.5 (unsupported)</a></p></li>
<li><p><a class="reference internal" href="#databricks-runtime-73-lts-unsupported" id="id25">Databricks Runtime 7.3 LTS (unsupported)</a></p></li>
<li><p><a class="reference internal" href="#databricks-runtime-64-extended-support-unsupported" id="id26">Databricks Runtime 6.4 Extended Support (unsupported)</a></p></li>
<li><p><a class="reference internal" href="#databricks-runtime-55-lts-unsupported" id="id27">Databricks Runtime 5.5 LTS (unsupported)</a></p></li>
<li><p><a class="reference internal" href="#databricks-light-24-extended-support" id="id28">Databricks Light 2.4 Extended Support</a></p></li>
<li><p><a class="reference internal" href="#databricks-runtime-74-unsupported" id="id29">Databricks Runtime 7.4 (unsupported)</a></p></li>
<li><p><a class="reference internal" href="#databricks-runtime-72-unsupported" id="id30">Databricks Runtime 7.2 (unsupported)</a></p></li>
<li><p><a class="reference internal" href="#databricks-runtime-71-unsupported" id="id31">Databricks Runtime 7.1 (unsupported)</a></p></li>
<li><p><a class="reference internal" href="#databricks-runtime-70-unsupported" id="id32">Databricks Runtime 7.0 (unsupported)</a></p></li>
<li><p><a class="reference internal" href="#databricks-runtime-66-unsupported" id="id33">Databricks Runtime 6.6 (unsupported)</a></p></li>
<li><p><a class="reference internal" href="#databricks-runtime-65-unsupported" id="id34">Databricks Runtime 6.5 (unsupported)</a></p></li>
<li><p><a class="reference internal" href="#databricks-runtime-63-unsupported" id="id35">Databricks Runtime 6.3 (unsupported)</a></p></li>
<li><p><a class="reference internal" href="#databricks-runtime-62-unsupported" id="id36">Databricks Runtime 6.2 (unsupported)</a></p></li>
<li><p><a class="reference internal" href="#databricks-runtime-61-unsupported" id="id37">Databricks Runtime 6.1 (unsupported)</a></p></li>
<li><p><a class="reference internal" href="#databricks-runtime-60-unsupported" id="id38">Databricks Runtime 6.0 (unsupported)</a></p></li>
<li><p><a class="reference internal" href="#databricks-runtime-54-ml-unsupported" id="id39">Databricks Runtime 5.4 ML (unsupported)</a></p></li>
<li><p><a class="reference internal" href="#databricks-runtime-54-unsupported" id="id40">Databricks Runtime 5.4 (unsupported)</a></p></li>
<li><p><a class="reference internal" href="#databricks-runtime-53-unsupported" id="id41">Databricks Runtime 5.3 (unsupported)</a></p></li>
<li><p><a class="reference internal" href="#databricks-runtime-52-unsupported" id="id42">Databricks Runtime 5.2 (unsupported)</a></p></li>
<li><p><a class="reference internal" href="#databricks-runtime-51-unsupported" id="id43">Databricks Runtime 5.1 (unsupported)</a></p></li>
<li><p><a class="reference internal" href="#databricks-runtime-50-unsupported" id="id44">Databricks Runtime 5.0 (unsupported)</a></p></li>
<li><p><a class="reference internal" href="#databricks-runtime-43-unsupported" id="id45">Databricks Runtime 4.3 (unsupported)</a></p></li>
<li><p><a class="reference internal" href="#databricks-runtime-42-unsupported" id="id46">Databricks Runtime 4.2 (unsupported)</a></p></li>
<li><p><a class="reference internal" href="#databricks-runtime-41-ml-unsupported" id="id47">Databricks Runtime 4.1 ML (unsupported)</a></p></li>
<li><p><a class="reference internal" href="#databricks-runtime-41-unsupported" id="id48">Databricks Runtime 4.1 (unsupported)</a></p></li>
<li><p><a class="reference internal" href="#databricks-runtime-40-unsupported" id="id49">Databricks Runtime 4.0 (unsupported)</a></p></li>
<li><p><a class="reference internal" href="#databricks-runtime-35-lts-unsupported" id="id50">Databricks Runtime 3.5 LTS (unsupported)</a></p></li>
<li><p><a class="reference internal" href="#databricks-runtime-34-unsupported" id="id51">Databricks Runtime 3.4 (unsupported)</a></p></li>
<li><p><a class="reference internal" href="#databricks-runtime-33-unsupported" id="id52">Databricks Runtime 3.3 (unsupported)</a></p></li>
<li><p><a class="reference internal" href="#databricks-runtime-32-unsupported" id="id53">Databricks Runtime 3.2 (unsupported)</a></p></li>
<li><p><a class="reference internal" href="#211-db6-unsupported" id="id54">2.1.1-db6 (unsupported)</a></p></li>
</ul>
</div>
<p>For the maintenance updates on supported Databricks Runtime versions, see <a class="reference internal" href="../../release-notes/runtime/maintenance-updates.html"><span class="doc">Databricks Runtime maintenance updates</span></a>.</p>
<div class="section" id="databricks-runtime-131">
<span id="dbr-131"></span><span id="131"></span><h3><a class="toc-backref" href="#id1">Databricks Runtime 13.1</a><a class="headerlink" href="#databricks-runtime-131" title="Permalink to this headline"> </a></h3>
<p>See <a class="reference internal" href="13.1.html"><span class="doc">Databricks Runtime 13.1 (unsupported)</span></a>.</p>
<ul class="simple">
<li><p>November 29, 2023</p>
<ul>
<li><p>Fixed an issue where escaped underscores in <code class="docutils literal notranslate"><span class="pre">getColumns</span></code> operations originating from JDBC or ODBC clients were wrongly interpreted as wildcards.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44846">[SPARK-44846]</a> Removed complex grouping expressions after <code class="docutils literal notranslate"><span class="pre">RemoveRedundantAggregates</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43802">[SPARK-43802]</a> Fixed an issue where codegen for unhex and unbase64 expressions would fail.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43718">[SPARK-43718]</a> Fixed nullability for keys in <code class="docutils literal notranslate"><span class="pre">USING</span></code> joins.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>November 14, 2023</p>
<ul>
<li><p>Partition filters on Delta Lake streaming queries are pushed down before rate limiting to achieve better utilization.</p></li>
<li><p>Changed data feed queries on Unity Catalog Streaming Tables and Materialized Views to display error messages.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45584">[SPARK-45584]</a> Fixed subquery run failure with <code class="docutils literal notranslate"><span class="pre">TakeOrderedAndProjectExec</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45430">[SPARK-45430]</a> <code class="docutils literal notranslate"><span class="pre">FramelessOffsetWindowFunction</span></code> no longer fails when <code class="docutils literal notranslate"><span class="pre">IGNORE</span> <span class="pre">NULLS</span></code> and <code class="docutils literal notranslate"><span class="pre">offset</span> <span class="pre">&gt;</span> <span class="pre">rowCount</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45543">[SPARK-45543]</a> Fixed an issue where <code class="docutils literal notranslate"><span class="pre">InferWindowGroupLimit</span></code> caused an issue if the other window functions didn’t have the same window frame as the rank-like functions.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>October 24, 2023</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43799">[SPARK-43799]</a> Added descriptor binary option to PySpark <code class="docutils literal notranslate"><span class="pre">Protobuf</span></code> API.</p></li>
<li><p>Revert <a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42946">[SPARK-42946]</a>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45346">[SPARK-45346]</a> Parquet schema inference now respects case-sensitive flag when merging a schema.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>October 13, 2023</p>
<ul>
<li><p>Snowflake-jdbc dependency upgraded from 3.13.29 to 3.13.33.</p></li>
<li><p>No longer ignoring corrupt files when <code class="docutils literal notranslate"><span class="pre">ignoreCorruptFiles</span></code> is enabled during CSV schema inference with Auto Loader.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44658">[SPARK-44658]</a> <code class="docutils literal notranslate"><span class="pre">ShuffleStatus.getMapStatus</span></code> returns <code class="docutils literal notranslate"><span class="pre">None</span></code> instead of <code class="docutils literal notranslate"><span class="pre">Some(null)</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45178">[SPARK-45178]</a> Fallback to running a single batch for <code class="docutils literal notranslate"><span class="pre">Trigger.AvailableNow</span></code> with unsupported sources rather than using the wrapper.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42205">[SPARK-42205]</a> Updated the JSON protocol to remove Accumulables logging in a task or stage start events.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>September 12, 2023</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44718">[SPARK-44718]</a> Match <code class="docutils literal notranslate"><span class="pre">ColumnVector</span></code> memory-mode config default to <code class="docutils literal notranslate"><span class="pre">OffHeapMemoryMode</span></code> config value.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44878">SPARK-44878</a> Turned off strict limit for <code class="docutils literal notranslate"><span class="pre">RocksDB</span></code> write manager to avoid insertion exception on cache complete.</p></li>
<li><p>Miscellaneous fixes.</p></li>
</ul>
</li>
<li><p>August 30, 2023</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44871">[SPARK-44871]</a> Fixed <code class="docutils literal notranslate"><span class="pre">percentile_disc</span> <span class="pre">behaviour</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44714">[SPARK-44714]</a> Ease restriction of LCA resolution regarding queries.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44245">[SPARK-44245]</a> <code class="docutils literal notranslate"><span class="pre">PySpark.sql.dataframe</span> <span class="pre">sample()</span></code> doc tests are now illustrative-only.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44818">[SPARK-44818]</a> Fixed race for pending task interrupt issued before <code class="docutils literal notranslate"><span class="pre">taskThread</span></code> is initialized.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>August 15, 2023</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44485">[SPARK-44485]</a> Optimized <code class="docutils literal notranslate"><span class="pre">TreeNode.generateTreeString</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44643">[SPARK-44643]</a> Fixed <code class="docutils literal notranslate"><span class="pre">Row.__repr__</span></code> when the row is empty.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44504">[SPARK-44504]</a> Maintenance task now cleans up loaded providers on stop error.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44479">[SPARK-44479]</a> Fixed <code class="docutils literal notranslate"><span class="pre">protobuf</span></code> conversion from an empty struct type.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44464">[SPARK-44464]</a> Fixed <code class="docutils literal notranslate"><span class="pre">applyInPandasWithStatePythonRunner</span></code> to output rows that have <code class="docutils literal notranslate"><span class="pre">Null</span></code> as the first column value.</p></li>
<li><p>Miscellaneous fixes.</p></li>
</ul>
</li>
<li><p>July 27, 2023</p>
<ul>
<li><p>Fixed an issue where <code class="docutils literal notranslate"><span class="pre">dbutils.fs.ls()</span></code> returned <code class="docutils literal notranslate"><span class="pre">INVALID_PARAMETER_VALUE.LOCATION_OVERLAP</span></code> when called for a storage location path which clashed with other external or managed storage location.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44199">[SPARK-44199]</a> <code class="docutils literal notranslate"><span class="pre">CacheManager</span></code> no longer refreshes the <code class="docutils literal notranslate"><span class="pre">fileIndex</span></code> unnecessarily.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44448">[SPARK-44448]</a> Fixed wrong results bug from <code class="docutils literal notranslate"><span class="pre">DenseRankLimitIterator</span></code> and <code class="docutils literal notranslate"><span class="pre">InferWindowGroupLimit</span></code>.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>July 24, 2023</p>
<ul>
<li><p>Revert <a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42323">[SPARK-42323]</a>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41848">[SPARK-41848]</a> Fixed task over-schedule issue with <code class="docutils literal notranslate"><span class="pre">TaskResourceProfile</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44136">[SPARK-44136]</a> Fixed an issue where <code class="docutils literal notranslate"><span class="pre">StateManager</span></code> would get materialized in an executor instead of the driver in <code class="docutils literal notranslate"><span class="pre">FlatMapGroupsWithStateExec</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44337">[SPARK-44337]</a> Fixed an issue where any field set to <code class="docutils literal notranslate"><span class="pre">Any.getDefaultInstance</span></code> caused parse errors.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>June 27, 2023</p>
<ul>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>June 15, 2023</p>
<ul>
<li><p>Photonized <code class="docutils literal notranslate"><span class="pre">approx_count_distinct</span></code>.</p></li>
<li><p>JSON parser in <code class="docutils literal notranslate"><span class="pre">failOnUnknownFields</span></code> mode now drops the record in <code class="docutils literal notranslate"><span class="pre">DROPMALFORMED</span></code> mode and fails directly in <code class="docutils literal notranslate"><span class="pre">FAILFAST</span></code> mode.</p></li>
<li><p>Snowflake-jdbc library is upgraded to 3.13.29 to address a security issue.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">PubSubRecord</span></code> attributes field is stored as JSON instead of the string from a Scala map for more straightforward serialization and deserialization.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">EXPLAIN</span> <span class="pre">EXTENDED</span></code> command now returns the result cache eligibility of the query.</p></li>
<li><p>Improve the performance of incremental updates with <code class="docutils literal notranslate"><span class="pre">SHALLOW</span> <span class="pre">CLONE</span></code> Iceberg and Parquet.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43032">[SPARK-43032]</a> Python SQM bug fix.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43404">[SPARK-43404]</a>Skip reusing the sst file for the same version of RocksDB state store to avoid the ID mismatch error.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43340">[SPARK-43340]</a> Handle missing stack-trace field in eventlogs.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43527">[SPARK-43527]</a> Fixed <code class="docutils literal notranslate"><span class="pre">catalog.listCatalogs</span></code> in PySpark.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43541">[SPARK-43541]</a> Propagate all <code class="docutils literal notranslate"><span class="pre">Project</span></code> tags in resolving of expressions and missing columns.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43300">[SPARK-43300]</a> <code class="docutils literal notranslate"><span class="pre">NonFateSharingCache</span></code> wrapper for Guava Cache.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43378">[SPARK-43378]</a> Properly close stream objects in <code class="docutils literal notranslate"><span class="pre">deserializeFromChunkedBuffer</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42852">[SPARK-42852]</a> Revert <code class="docutils literal notranslate"><span class="pre">NamedLambdaVariable</span></code> related changes from <code class="docutils literal notranslate"><span class="pre">EquivalentExpressions</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43779">[SPARK-43779]</a> <code class="docutils literal notranslate"><span class="pre">ParseToDate</span></code> now loads <code class="docutils literal notranslate"><span class="pre">EvalMode</span></code> in the main thread.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43413">[SPARK-43413]</a> Fix <code class="docutils literal notranslate"><span class="pre">IN</span></code> subquery <code class="docutils literal notranslate"><span class="pre">ListQuery</span></code> nullability.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43889">[SPARK-43889]</a> Add check for column name for <code class="docutils literal notranslate"><span class="pre">__dir__()</span></code> to filter out error-prone column names.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43043">[SPARK-43043]</a> Improved the performance of <code class="docutils literal notranslate"><span class="pre">MapOutputTracker</span></code>.updateMapOutput</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43522">[SPARK-43522]</a> Fixed creating struct column name with index of array.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43457">[SPARK-43457]</a> Augument user agent with OS, Python and Spark versions.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43286">[SPARK-43286]</a> Updated <code class="docutils literal notranslate"><span class="pre">aes_encrypt</span></code> CBC mode to generate random IVs.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42851">[SPARK-42851]</a> Guard <code class="docutils literal notranslate"><span class="pre">EquivalentExpressions.addExpr()</span></code> with <code class="docutils literal notranslate"><span class="pre">supportedExpression()</span></code>.</p></li>
<li><p>Revert <a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43183">[SPARK-43183]</a>.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="databricks-runtime-122-lts">
<span id="dbr-122-lts"></span><span id="122"></span><h3><a class="toc-backref" href="#id2">Databricks Runtime 12.2 LTS</a><a class="headerlink" href="#databricks-runtime-122-lts" title="Permalink to this headline"> </a></h3>
<p>See <a class="reference internal" href="../../release-notes/runtime/12.2lts.html"><span class="doc">Databricks Runtime 12.2 LTS</span></a>.</p>
<ul>
<li><p>November 29, 2023</p>
<ul class="simple">
<li><p>Fixed an issue where escaped underscores in <code class="docutils literal notranslate"><span class="pre">getColumns</span></code> operations originating from JDBC or ODBC clients were wrongly interpreted as wildcards.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42205">[SPARK-42205]</a> Removed logging accumulables in <code class="docutils literal notranslate"><span class="pre">Stage</span></code> and <code class="docutils literal notranslate"><span class="pre">Task</span></code> start events.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44846">[SPARK-44846]</a> Removed complex grouping expressions after <code class="docutils literal notranslate"><span class="pre">RemoveRedundantAggregates</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43718">[SPARK-43718]</a> Fixed nullability for keys in <code class="docutils literal notranslate"><span class="pre">USING</span></code> joins.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45544">[SPARK-45544]</a> Integrated SSL support into <code class="docutils literal notranslate"><span class="pre">TransportContext</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43973">[SPARK-43973]</a> Structured Streaming UI now displays failed queries correctly.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45730">[SPARK-45730]</a> Improved time constraints for <code class="docutils literal notranslate"><span class="pre">ReloadingX509TrustManagerSuite</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45859">[SPARK-45859]</a> Made UDF objects in <code class="docutils literal notranslate"><span class="pre">ml.functions</span></code> lazy.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>November 14, 2023</p>
<ul class="simple">
<li><p>Partition filters on Delta Lake streaming queries are pushed down before rate limiting to achieve better utilization.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45545">[SPARK-45545]</a> <code class="docutils literal notranslate"><span class="pre">SparkTransportConf</span></code> inherits <code class="docutils literal notranslate"><span class="pre">SSLOptions</span></code> upon creation.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45427">[SPARK-45427]</a> Added RPC SSL settings to <code class="docutils literal notranslate"><span class="pre">SSLOptions</span></code> and <code class="docutils literal notranslate"><span class="pre">SparkTransportConf</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45584">[SPARK-45584]</a> Fixed subquery run failure with <code class="docutils literal notranslate"><span class="pre">TakeOrderedAndProjectExec</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45541">[SPARK-45541]</a> Added <code class="docutils literal notranslate"><span class="pre">SSLFactory</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45430">[SPARK-45430]</a> <code class="docutils literal notranslate"><span class="pre">FramelessOffsetWindowFunction</span></code> no longer fails when <code class="docutils literal notranslate"><span class="pre">IGNORE</span> <span class="pre">NULLS</span></code> and <code class="docutils literal notranslate"><span class="pre">offset</span> <span class="pre">&gt;</span> <span class="pre">rowCount</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45429">[SPARK-45429]</a> Added helper classes for SSL RPC communication.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>October 24, 2023</p>
<ul class="simple">
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45426">[SPARK-45426]</a> Added support for <code class="docutils literal notranslate"><span class="pre">ReloadingX509TrustManager</span></code>.</p></li>
<li><p>Miscellaneous fixes.</p></li>
</ul>
</li>
<li><p>October 13, 2023</p>
<ul class="simple">
<li><p>Snowflake-jdbc dependency upgraded from 3.13.29 to 3.13.33.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42553">[SPARK-42553]</a> Ensure at least one time unit after interval.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45346">[SPARK-45346]</a> Parquet schema inference respects case sensitive flag when merging schema.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45178">[SPARK-45178]</a> Fallback to running a single batch for <code class="docutils literal notranslate"><span class="pre">Trigger.AvailableNow</span></code> with unsupported sources rather than using the wrapper.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45084">[SPARK-45084]</a> <code class="docutils literal notranslate"><span class="pre">StateOperatorProgress</span></code> to use an accurate, adequate shuffle partition number.</p></li>
</ul>
</li>
<li><p>September 12, 2023</p>
<ul class="simple">
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44873">[SPARK-44873]</a> Added support for <code class="docutils literal notranslate"><span class="pre">alter</span> <span class="pre">view</span></code> with nested columns in the Hive client.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44718">[SPARK-44718]</a> Match <code class="docutils literal notranslate"><span class="pre">ColumnVector</span></code> memory-mode config default to <code class="docutils literal notranslate"><span class="pre">OffHeapMemoryMode</span></code> config value.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43799">[SPARK-43799]</a> Added descriptor binary option to PySpark <code class="docutils literal notranslate"><span class="pre">Protobuf</span></code> API.</p></li>
<li><p>Miscellaneous fixes.</p></li>
</ul>
</li>
<li><p>August 30, 2023</p>
<ul class="simple">
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44485">[SPARK-44485]</a> Optimized <code class="docutils literal notranslate"><span class="pre">TreeNode.generateTreeString</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44818">[SPARK-44818]</a> Fixed race for pending task interrupt issued before <code class="docutils literal notranslate"><span class="pre">taskThread</span></code> is initialized.</p></li>
<li><p>[11.3-13.0][[SPARK-44871]]<a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44871">https://issues.apache.org/jira/browse/SPARK-44871</a>) Fixed <code class="docutils literal notranslate"><span class="pre">percentile_disc</span></code> behavior.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44714">[SPARK-44714]</a> Eased restriction of LCA resolution regarding queries.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>August 15, 2023</p>
<ul class="simple">
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44504">[SPARK-44504]</a> Maintenance task cleans up loaded providers on stop error.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44464">[SPARK-44464]</a> Fixed <code class="docutils literal notranslate"><span class="pre">applyInPandasWithStatePythonRunner</span></code> to output rows that have <code class="docutils literal notranslate"><span class="pre">Null</span></code> as the first column value.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>July 29, 2023</p>
<ul class="simple">
<li><p>Fixed an issue where <code class="docutils literal notranslate"><span class="pre">dbutils.fs.ls()</span></code> returned <code class="docutils literal notranslate"><span class="pre">INVALID_PARAMETER_VALUE.LOCATION_OVERLAP</span></code> when called for a storage location path which clashed with other external or managed storage location.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44199">[SPARK-44199]</a> <code class="docutils literal notranslate"><span class="pre">CacheManager</span></code> no longer refreshes the <code class="docutils literal notranslate"><span class="pre">fileIndex</span></code> unnecessarily.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>July 24, 2023</p>
<ul class="simple">
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44337">[SPARK-44337]</a> Fixed an issue where any field set to <code class="docutils literal notranslate"><span class="pre">Any.getDefaultInstance</span></code> caused parse errors.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44136">[SPARK-44136]</a> Fixed an issue where <code class="docutils literal notranslate"><span class="pre">StateManager</span></code> would get materialized in an executor instead of the driver in <code class="docutils literal notranslate"><span class="pre">FlatMapGroupsWithStateExec</span></code>.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>June 23, 2023</p>
<ul class="simple">
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>June 15, 2023</p>
<ul class="simple">
<li><p>Photonized <code class="docutils literal notranslate"><span class="pre">approx_count_distinct</span></code>.</p></li>
<li><p>Snowflake-jdbc library is upgraded to 3.13.29 to address a security issue.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43779">[SPARK-43779]</a> <code class="docutils literal notranslate"><span class="pre">ParseToDate</span></code> now loads <code class="docutils literal notranslate"><span class="pre">EvalMode</span></code> in the main thread.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43156">[SPARK-43156]</a><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43098">[SPARK-43098]</a> Extended scalar subquery count error test with <code class="docutils literal notranslate"><span class="pre">decorrelateInnerQuery</span></code> turned off.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>June 2, 2023</p>
<ul class="simple">
<li><p>The JSON parser in <code class="docutils literal notranslate"><span class="pre">failOnUnknownFields</span></code> mode drops a record in <code class="docutils literal notranslate"><span class="pre">DROPMALFORMED</span></code> mode and fails directly in <code class="docutils literal notranslate"><span class="pre">FAILFAST</span></code> mode.</p></li>
<li><p>Improve the performance of incremental updates with <code class="docutils literal notranslate"><span class="pre">SHALLOW</span> <span class="pre">CLONE</span></code> Iceberg and Parquet.</p></li>
<li><p>Fixed an issue in Auto Loader where different source file formats were inconsistent when the provided schema did not include inferred partitions. This issue could cause unexpected failures when reading files with missing columns in the inferred partition schema.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43404">[SPARK-43404]</a> Skip reusing the sst file for the same version of RocksDB state store to avoid the ID mismatch error.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43413">[SPARK-43413]</a>[11.3-13.0] Fixed <code class="docutils literal notranslate"><span class="pre">IN</span></code> subquery <code class="docutils literal notranslate"><span class="pre">ListQuery</span></code> nullability.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43522">[SPARK-43522]</a> Fixed creating struct column name with index of array.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43541">[SPARK-43541]</a> Propagate all <code class="docutils literal notranslate"><span class="pre">Project</span></code> tags in resolving of expressions and missing columns.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43527">[SPARK-43527]</a> Fixed <code class="docutils literal notranslate"><span class="pre">catalog.listCatalogs</span></code> in PySpark.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43123">[SPARK-43123]</a> Internal field metadata no longer leaks to catalogs.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43340">[SPARK-43340]</a> Fixed missing stack trace field in eventlogs.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42444">[SPARK-42444]</a> <code class="docutils literal notranslate"><span class="pre">DataFrame.drop</span></code> now handles duplicated columns correctly.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42937">[SPARK-42937]</a> <code class="docutils literal notranslate"><span class="pre">PlanSubqueries</span></code> now sets <code class="docutils literal notranslate"><span class="pre">InSubqueryExec#shouldBroadcast</span></code> to true.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43286">[SPARK-43286]</a> Updated <code class="docutils literal notranslate"><span class="pre">aes_encrypt</span></code> CBC mode to generate random IVs.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43378">[SPARK-43378]</a> Properly close stream objects in <code class="docutils literal notranslate"><span class="pre">deserializeFromChunkedBuffer</span></code>.</p></li>
</ul>
</li>
<li><p>May 17, 2023</p>
<ul class="simple">
<li><p>Parquet scans are now robust against OOMs when scanning exceptionally structured files by dynamically adjusting batch size. File metadata is analyzed to preemptively lower batch size and is lowered again on task retries as a final safety net.</p></li>
<li><p>If an Avro file was read with just the <code class="docutils literal notranslate"><span class="pre">failOnUnknownFields\</span></code> option or with Auto Loader in the <code class="docutils literal notranslate"><span class="pre">failOnNewColumns\</span></code> schema evolution mode, columns that have different data types would be read as <code class="docutils literal notranslate"><span class="pre">null\</span></code> instead of throwing an error stating that the file cannot be read. These reads now fail and recommend users to use the <code class="docutils literal notranslate"><span class="pre">rescuedDataColumn\</span></code> option.</p></li>
<li><p>Auto Loader now does the following.</p></li>
<li><ul>
<li><p>Correctly reads and no longer rescues <code class="docutils literal notranslate"><span class="pre">Integer</span></code>, <code class="docutils literal notranslate"><span class="pre">Short</span></code>, and <code class="docutils literal notranslate"><span class="pre">Byte</span></code> types if one of these data types is provided, but the Avro file suggests one of the other two types.</p></li>
</ul>
</li>
<li><ul>
<li><p>Prevents reading interval types as date or time stamp types to avoid getting corrupt dates.</p></li>
</ul>
</li>
<li><ul>
<li><p>Prevents reading <code class="docutils literal notranslate"><span class="pre">Decimal</span></code> types with lower precision.</p></li>
</ul>
</li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43172">[SPARK-43172]</a> Exposes host and token from Spark connect client.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43293">[SPARK-43293]</a> <code class="docutils literal notranslate"><span class="pre">__qualified_access_only</span></code> is ignored in normal columns.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43098">[SPARK-43098]</a> Fixed correctness <code class="docutils literal notranslate"><span class="pre">COUNT</span></code> bug when scalar subquery is grouped by clause.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43085">[SPARK-43085]</a> Support for column <code class="docutils literal notranslate"><span class="pre">DEFAULT</span></code> assignment for multi-part table names.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43190">[SPARK-43190]</a> <code class="docutils literal notranslate"><span class="pre">ListQuery.childOutput</span></code> is now consistent with secondary output.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43192">[SPARK-43192]</a> Removed user agent charset validation.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>April 25, 2023</p>
<ul class="simple">
<li><p>If a Parquet file was read with just the <code class="docutils literal notranslate"><span class="pre">failOnUnknownFields</span></code> option or with Auto Loader in the <code class="docutils literal notranslate"><span class="pre">failOnNewColumns</span></code> schema evolution mode, columns that had different data types would be read as <code class="docutils literal notranslate"><span class="pre">null</span></code> instead of throwing an error stating that the file cannot be read. These reads now fail and recommend users to use the <code class="docutils literal notranslate"><span class="pre">rescuedDataColumn</span></code> option.</p></li>
<li><p>Auto Loader now correctly reads and no longer rescues <code class="docutils literal notranslate"><span class="pre">Integer</span></code>, <code class="docutils literal notranslate"><span class="pre">Short</span></code>, and <code class="docutils literal notranslate"><span class="pre">Byte</span></code> types if one of these data types is provided. The Parquet file suggests one of the other two types. When the rescued data column was previously enabled, the data type mismatch would cause columns to be saved even though they were readable.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43009">[SPARK-43009]</a> Parameterized <code class="docutils literal notranslate"><span class="pre">sql()</span></code> with <code class="docutils literal notranslate"><span class="pre">Any</span></code> constants</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42406">[SPARK-42406]</a> Terminate Protobuf recursive fields by dropping the field</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43038">[SPARK-43038]</a> Support the CBC mode by <code class="docutils literal notranslate"><span class="pre">aes_encrypt()</span></code>/<code class="docutils literal notranslate"><span class="pre">aes_decrypt()</span></code></p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42971">[SPARK-42971]</a> Change to print <code class="docutils literal notranslate"><span class="pre">workdir</span></code> if <code class="docutils literal notranslate"><span class="pre">appDirs</span></code> is null when worker handle <code class="docutils literal notranslate"><span class="pre">WorkDirCleanup</span></code> event</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43018">[SPARK-43018]</a> Fix bug for INSERT commands with timestamp literals</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>April 11, 2023</p>
<ul class="simple">
<li><p>Support legacy data source formats in the <code class="docutils literal notranslate"><span class="pre">SYNC</span></code> command.</p></li>
<li><p>Fixes an issue in the %autoreload behavior in notebooks outside of a repo.</p></li>
<li><p>Fixed an issue where Auto Loader schema evolution can go into an infinite fail loop when a new column is detected in the schema of a nested JSON object.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42928">[SPARK-42928]</a> Makes <code class="docutils literal notranslate"><span class="pre">resolvePersistentFunction</span></code> synchronized.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42936">[SPARK-42936]</a> Fixes LCan issue when the clause can be resolved directly by its child aggregate.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42967">[SPARK-42967]</a> Fixes <code class="docutils literal notranslate"><span class="pre">SparkListenerTaskStart.stageAttemptId</span></code> when a task starts after the stage is canceled.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>March 29, 2023</p>
<ul>
<li><p>Databricks SQL now supports specifying default values for columns of Delta Lake tables, either at table creation time or afterward. Subsequent <code class="docutils literal notranslate"><span class="pre">INSERT</span></code>, <code class="docutils literal notranslate"><span class="pre">UPDATE</span></code>, <code class="docutils literal notranslate"><span class="pre">DELETE</span></code>, and <code class="docutils literal notranslate"><span class="pre">MERGE</span></code> commands can refer to any column’s default value using the explicit <code class="docutils literal notranslate"><span class="pre">DEFAULT</span></code> keyword. In addition, if any <code class="docutils literal notranslate"><span class="pre">INSERT</span></code> assignment has an explicit list of fewer columns than the target table, corresponding column default values are substituted for the remaining columns (or NULL if no default is specified).</p>
<p>For example:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="p">(</span><span class="k">first</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span><span class="w"> </span><span class="k">second</span><span class="w"> </span><span class="nb">DATE</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">CURRENT_DATE</span><span class="p">())</span><span class="w"> </span><span class="k">USING</span><span class="w"> </span><span class="n">delta</span><span class="p">;</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="k">DEFAULT</span><span class="p">);</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="k">DEFAULT</span><span class="p">);</span>
<span class="k">SELECT</span><span class="w"> </span><span class="k">first</span><span class="p">,</span><span class="w"> </span><span class="k">second</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">t</span><span class="p">;</span>
<span class="err">\</span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2023</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">28</span>
<span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2023</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">28</span><span class="n">z</span>
</pre></div>
</div>
</li>
<li><p>Auto Loader now initiates at least one synchronous RocksDB log cleanup for <code class="docutils literal notranslate"><span class="pre">Trigger.AvailableNow</span></code> streams to check that the checkpoint can get regularly cleaned up for fast-running Auto Loader streams. This can cause some streams to take longer before they shut down, but it will save you storage costs and improve the Auto Loader experience in future runs.</p></li>
<li><p>You can now modify a Delta table to add support to table features using <code class="docutils literal notranslate"><span class="pre">DeltaTable.addFeatureSupport(feature_name)</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42794">[SPARK-42794]</a> Increase the lockAcquireTimeoutMs to 2 minutes for acquiring the RocksDB state store in Structure Streaming</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42521">[SPARK-42521]</a> Add NULLs for INSERTs with user-specified lists of fewer columns than the target table</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42702">[SPARK-42702]</a><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42623">[SPARK-42623]</a> Support parameterized query in subquery and CTE</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42668">[SPARK-42668]</a> Catch exception while trying to close the compressed stream in HDFSStateStoreProvider stop</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42403">[SPARK-42403]</a> JsonProtocol should handle null JSON strings</p></li>
</ul>
</li>
<li><p>March 8, 2023</p>
<ul class="simple">
<li><p>The error message “Failure to initialize configuration” has been improved to provide more context for the customer.</p></li>
<li><p>There is a terminology change for adding features to a Delta table using the table property. The preferred syntax is now <code class="docutils literal notranslate"><span class="pre">'delta.feature.featureName'='supported'</span></code> instead of <code class="docutils literal notranslate"><span class="pre">'delta.feature.featureName'='enabled'</span></code>. For backward compatibility, using <code class="docutils literal notranslate"><span class="pre">'delta.feature.featureName'='enabled'</span></code> still works and will continue to work.</p></li>
<li><p>Starting from this release, it is possible to create/replace a table with an additional table property <code class="docutils literal notranslate"><span class="pre">delta.ignoreProtocolDefaults</span></code> to ignore protocol-related Spark configs, which includes default reader and writer versions and table features supported by default.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42070">[SPARK-42070]</a> Change the default value of the argument of the Mask function from -1 to NULL</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41793">[SPARK-41793]</a> Incorrect result for window frames defined by a range clause on significant decimals</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42484">[SPARK-42484]</a> UnsafeRowUtils better error message</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42516">[SPARK-42516]</a> Always capture the session time zone config while creating views</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42635">[SPARK-42635]</a> Fix the TimestampAdd expression.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42622">[SPARK-42622]</a> Turned off substitution in values</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42534">[SPARK-42534]</a> Fix DB2Dialect Limit clause</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42121">[SPARK-42121]</a> Add built-in table-valued functions posexplode, posexplode_outer, json_tuple and stack</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42045">[SPARK-42045]</a> ANSI SQL mode: Round/Bround should return an error on tiny/small/significant integer overflow</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="databricks-runtime-113-lts">
<span id="dbr-113-lts"></span><span id="113"></span><h3><a class="toc-backref" href="#id3">Databricks Runtime 11.3 LTS</a><a class="headerlink" href="#databricks-runtime-113-lts" title="Permalink to this headline"> </a></h3>
<p>See <a class="reference internal" href="../../release-notes/runtime/11.3lts.html"><span class="doc">Databricks Runtime 11.3 LTS</span></a>.</p>
<ul class="simple">
<li><p>November 29, 2023</p>
<ul>
<li><p>Fixed an issue where escaped underscores in <code class="docutils literal notranslate"><span class="pre">getColumns</span></code> operations originating from JDBC or ODBC clients were wrongly interpreted as wildcards.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43973">[SPARK-43973]</a> Structured Streaming UI now displays failed queries correctly.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45730">[SPARK-45730]</a> Improved time constraints for <code class="docutils literal notranslate"><span class="pre">ReloadingX509TrustManagerSuite</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45544">[SPARK-45544]</a> Integrated SSL support into <code class="docutils literal notranslate"><span class="pre">TransportContext</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45859">[SPARK-45859]</a> Made UDF objects in <code class="docutils literal notranslate"><span class="pre">ml.functions</span></code> lazy.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43718">[SPARK-43718]</a> Fixed nullability for keys in <code class="docutils literal notranslate"><span class="pre">USING</span></code> joins.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44846">[SPARK-44846]</a> Removed complex grouping expressions after <code class="docutils literal notranslate"><span class="pre">RemoveRedundantAggregates</span></code>.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>November 14, 2023</p>
<ul>
<li><p>Partition filters on Delta Lake streaming queries are pushed down before rate limiting to achieve better utilization.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42205">[SPARK-42205]</a> Removed logging accumulables in Stage and Task start events.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45545">[SPARK-45545]</a> <code class="docutils literal notranslate"><span class="pre">SparkTransportConf</span></code> inherits <code class="docutils literal notranslate"><span class="pre">SSLOptions</span></code> upon creation.</p></li>
<li><p>Revert <a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-33861">[SPARK-33861]</a>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45541">[SPARK-45541]</a> Added <code class="docutils literal notranslate"><span class="pre">SSLFactory</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45429">[SPARK-45429]</a> Added helper classes for SSL RPC communication.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45584">[SPARK-45584]</a> Fixed subquery run failure with <code class="docutils literal notranslate"><span class="pre">TakeOrderedAndProjectExec</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45430">[SPARK-45430]</a> <code class="docutils literal notranslate"><span class="pre">FramelessOffsetWindowFunction</span></code> no longer fails when <code class="docutils literal notranslate"><span class="pre">IGNORE</span> <span class="pre">NULLS</span></code> and <code class="docutils literal notranslate"><span class="pre">offset</span> <span class="pre">&gt;</span> <span class="pre">rowCount</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45427">[SPARK-45427]</a> Added RPC SSL settings to <code class="docutils literal notranslate"><span class="pre">SSLOptions</span></code> and <code class="docutils literal notranslate"><span class="pre">SparkTransportConf</span></code>.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>October 24, 2023</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45426">[SPARK-45426]</a> Added support for <code class="docutils literal notranslate"><span class="pre">ReloadingX509TrustManager</span></code>.</p></li>
<li><p>Miscellaneous fixes.</p></li>
</ul>
</li>
<li><p>October 13, 2023</p>
<ul>
<li><p>Snowflake-jdbc dependency upgraded from 3.13.29 to 3.13.33.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45178">[SPARK-45178]</a> Fallback to running a single batch for <code class="docutils literal notranslate"><span class="pre">Trigger.AvailableNow</span></code> with unsupported sources rather than using the wrapper.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45084">[SPARK-45084]</a> <code class="docutils literal notranslate"><span class="pre">StateOperatorProgress</span></code> to use an accurate, adequate shuffle partition number.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45346">[SPARK-45346]</a> Parquet schema inference now respects case-sensitive flag when merging a schema.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>September 10, 2023</p>
<ul>
<li><p>Miscellaneous fixes.</p></li>
</ul>
</li>
<li><p>August 30, 2023</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44818">[SPARK-44818]</a> Fixed race for pending task interrupt issued before <code class="docutils literal notranslate"><span class="pre">taskThread</span></code> is initialized.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44871">[SPARK-44871]</a>[11.3-13.0] Fixed <code class="docutils literal notranslate"><span class="pre">percentile_disc</span></code> behavior.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>August 15, 2023</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44485">[SPARK-44485]</a> Optimized <code class="docutils literal notranslate"><span class="pre">TreeNode.generateTreeString</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44504">[SPARK-44504]</a> Maintenance task cleans up loaded providers on stop error.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44464">[SPARK-44464]</a> Fixed <code class="docutils literal notranslate"><span class="pre">applyInPandasWithStatePythonRunner</span></code> to output rows that have <code class="docutils literal notranslate"><span class="pre">Null</span></code> as the first column value.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>July 27, 2023</p>
<ul>
<li><p>Fixed an issue where <code class="docutils literal notranslate"><span class="pre">dbutils.fs.ls()</span></code> returned <code class="docutils literal notranslate"><span class="pre">INVALID_PARAMETER_VALUE.LOCATION_OVERLAP</span></code> when called for a storage location path which clashed with other external or managed storage location.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44199">[SPARK-44199]</a> <code class="docutils literal notranslate"><span class="pre">CacheManager</span></code> no longer refreshes the <code class="docutils literal notranslate"><span class="pre">fileIndex</span></code> unnecessarily.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>July 24, 2023</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44136">[SPARK-44136]</a> Fixed an issue that StateManager can get materialized in executor instead of driver in FlatMapGroupsWithStateExec.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>June 23, 2023</p>
<ul>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>June 15, 2023</p>
<ul>
<li><p>Photonized <code class="docutils literal notranslate"><span class="pre">approx_count_distinct</span></code>.</p></li>
<li><p>Snowflake-jdbc library is upgraded to 3.13.29 to address a security issue.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43779">[SPARK-43779]</a> <code class="docutils literal notranslate"><span class="pre">ParseToDate</span></code> now loads <code class="docutils literal notranslate"><span class="pre">EvalMode</span></code> in the main thread.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40862">[SPARK-40862]</a> Support non-aggregated subqueries in RewriteCorrelatedScalarSubquery</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43156">[SPARK-43156]</a><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43098">[SPARK-43098]</a> Extended scalar subquery count bug test with <code class="docutils literal notranslate"><span class="pre">decorrelateInnerQuery</span></code> turned off.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43098">[SPARK-43098]</a> Fix correctness COUNT bug when scalar subquery has a group by clause</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>June 2, 2023</p>
<ul>
<li><p>The JSON parser in <code class="docutils literal notranslate"><span class="pre">failOnUnknownFields</span></code> mode drops a record in <code class="docutils literal notranslate"><span class="pre">DROPMALFORMED</span></code> mode and fails directly in <code class="docutils literal notranslate"><span class="pre">FAILFAST</span></code> mode.</p></li>
<li><p>Improve the performance of incremental updates with <code class="docutils literal notranslate"><span class="pre">SHALLOW</span> <span class="pre">CLONE</span></code> Iceberg and Parquet.</p></li>
<li><p>Fixed an issue in Auto Loader where different source file formats were inconsistent when the provided schema did not include inferred partitions. This issue could cause unexpected failures when reading files with missing columns in the inferred partition schema.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43404">[SPARK-43404]</a>Skip reusing the sst file for the same version of RocksDB state store to avoid the ID mismatch error.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43527">[SPARK-43527]</a> Fixed <code class="docutils literal notranslate"><span class="pre">catalog.listCatalogs</span></code> in PySpark.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43413">[SPARK-43413]</a>[11.3-13.0] Fixed <code class="docutils literal notranslate"><span class="pre">IN</span></code> subquery <code class="docutils literal notranslate"><span class="pre">ListQuery</span></code> nullability.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43340">[SPARK-43340]</a> Fixed missing stack trace field in eventlogs.</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="databricks-runtime-104-lts">
<span id="dbr-104-lts"></span><span id="104"></span><h3><a class="toc-backref" href="#id4">Databricks Runtime 10.4 LTS</a><a class="headerlink" href="#databricks-runtime-104-lts" title="Permalink to this headline"> </a></h3>
<p>See <a class="reference internal" href="../../release-notes/runtime/10.4lts.html"><span class="doc">Databricks Runtime 10.4 LTS</span></a>.</p>
<ul class="simple">
<li><p>November 29, 2023</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45544">[SPARK-45544]</a> Integrated SSL support into <code class="docutils literal notranslate"><span class="pre">TransportContext</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45859">[SPARK-45859]</a> Made UDF objects in <code class="docutils literal notranslate"><span class="pre">ml.functions</span></code> lazy.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43718">[SPARK-43718]</a> Fixed nullability for keys in <code class="docutils literal notranslate"><span class="pre">USING</span></code> joins.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45730">[SPARK-45730]</a> Improved time constraints for <code class="docutils literal notranslate"><span class="pre">ReloadingX509TrustManagerSuite</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42205">[SPARK-42205]</a> Removed logging accumulables in Stage and Task start events.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44846">[SPARK-44846]</a> Removed complex grouping expressions after <code class="docutils literal notranslate"><span class="pre">RemoveRedundantAggregates</span></code>.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>November 14, 2023</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45541">[SPARK-45541]</a> Added <code class="docutils literal notranslate"><span class="pre">SSLFactory</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45545">[SPARK-45545]</a> <code class="docutils literal notranslate"><span class="pre">SparkTransportConf</span></code> inherits <code class="docutils literal notranslate"><span class="pre">SSLOptions</span></code> upon creation.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45427">[SPARK-45427]</a> Added RPC SSL settings to <code class="docutils literal notranslate"><span class="pre">SSLOptions</span></code> and <code class="docutils literal notranslate"><span class="pre">SparkTransportConf</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45429">[SPARK-45429]</a> Added helper classes for SSL RPC communication.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45584">[SPARK-45584]</a> Fixed subquery run failure with <code class="docutils literal notranslate"><span class="pre">TakeOrderedAndProjectExec</span></code>.</p></li>
<li><p>Revert <a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-33861">[SPARK-33861]</a>.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>October 24, 2023</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45426">[SPARK-45426]</a> Added support for <code class="docutils literal notranslate"><span class="pre">ReloadingX509TrustManager</span></code>.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>October 13, 2023</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45084">[SPARK-45084]</a> <code class="docutils literal notranslate"><span class="pre">StateOperatorProgress</span></code> to use an accurate, adequate shuffle partition number.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45178">[SPARK-45178]</a> Fallback to running a single batch for <code class="docutils literal notranslate"><span class="pre">Trigger.AvailableNow</span></code> with unsupported sources rather than using the wrapper.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>September 10, 2023</p>
<ul>
<li><p>Miscellaneous fixes.</p></li>
</ul>
</li>
<li><p>August 30, 2023</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44818">[SPARK-44818]</a> Fixed race for pending task interrupt issued before <code class="docutils literal notranslate"><span class="pre">taskThread</span></code> is initialized.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>August 15, 2023</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44504">[SPARK-44504]</a> Maintenance task cleans up loaded providers on stop error.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43973">[SPARK-43973]</a> Structured Streaming UI now appears failed queries correctly.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>June 23, 2023</p>
<ul>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>June 15, 2023</p>
<ul>
<li><p>Snowflake-jdbc library is upgraded to 3.13.29 to address a security issue.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43098">[SPARK-43098]</a> Fix correctness COUNT bug when scalar subquery has a group by clause</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40862">[SPARK-40862]</a> Support non-aggregated subqueries in RewriteCorrelatedScalarSubquery</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43156">[SPARK-43156]</a><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43098">[SPARK-43098]</a> Extended scalar subquery count test with <code class="docutils literal notranslate"><span class="pre">decorrelateInnerQuery</span></code> turned off.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>June 2, 2023</p>
<ul>
<li><p>The JSON parser in <code class="docutils literal notranslate"><span class="pre">failOnUnknownFields</span></code> mode drops a record in <code class="docutils literal notranslate"><span class="pre">DROPMALFORMED</span></code> mode and fails directly in <code class="docutils literal notranslate"><span class="pre">FAILFAST</span></code> mode.</p></li>
<li><p>Fixed an issue in JSON rescued data parsing to prevent <code class="docutils literal notranslate"><span class="pre">UnknownFieldException</span></code>.</p></li>
<li><p>Fixed an issue in Auto Loader where different source file formats were inconsistent when the provided schema did not include inferred partitions. This issue could cause unexpected failures when reading files with missing columns in the inferred partition schema.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43404">[SPARK-43404]</a> Skip reusing the sst file for the same version of RocksDB state store to avoid the ID mismatch error.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43413">[SPARK-43413]</a> Fixed <code class="docutils literal notranslate"><span class="pre">IN</span></code> subquery <code class="docutils literal notranslate"><span class="pre">ListQuery</span></code> nullability.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>May 17, 2023</p>
<ul>
<li><p>Parquet scans are now robust against OOMs when scanning exceptionally structured files by dynamically adjusting batch size. File metadata is analyzed to preemptively lower batch size and is lowered again on task retries as a final safety net.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41520">[SPARK-41520]</a> Split <code class="docutils literal notranslate"><span class="pre">AND_OR</span></code> tree pattern to separate <code class="docutils literal notranslate"><span class="pre">AND</span></code> and <code class="docutils literal notranslate"><span class="pre">OR</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43190">[SPARK-43190]</a> <code class="docutils literal notranslate"><span class="pre">ListQuery.childOutput</span></code> is now consistent with secondary output.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>April 25, 2023</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42928">[SPARK-42928]</a> Make <code class="docutils literal notranslate"><span class="pre">resolvePersistentFunction</span></code> synchronized.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>April 11, 2023</p>
<ul>
<li><p>Fixed an issue where Auto Loader schema evolution can go into an infinite fail loop when a new column is detected in the schema of a nested JSON object.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42937">[SPARK-42937]</a> <code class="docutils literal notranslate"><span class="pre">PlanSubqueries</span></code> now sets <code class="docutils literal notranslate"><span class="pre">InSubqueryExec#shouldBroadcast</span></code> to true.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42967">[SPARK-42967]</a> Fix SparkListenerTaskStart.stageAttemptId when a task is started after the stage is canceled.</p></li>
</ul>
</li>
<li><p>March 29, 2023</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42668">[SPARK-42668]</a> Catch exception while trying to close the compressed stream in HDFSStateStoreProvider stop</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42635">[SPARK-42635]</a> Fix the …</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>March 14, 2023</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41162">[SPARK-41162]</a> Fix anti- and semi-join for self-join with aggregations</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-33206">[SPARK-33206]</a> Fix shuffle index cache weight calculation for small index files</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42484">[SPARK-42484]</a> Improved the <code class="docutils literal notranslate"><span class="pre">UnsafeRowUtils</span></code> error message</p></li>
<li><p>Miscellaneous fixes.</p></li>
</ul>
</li>
<li><p>February 28, 2023</p>
<ul>
<li><p>Support generated column for yyyy-MM-dd date_format. This change supports partition pruning for yyyy-MM-dd as a date_format in generated columns.</p></li>
<li><p>Users can now read and write specific Delta tables requiring Reader version 3 and Writer version 7, using Databricks Runtime 9.1 LTS or later. To succeed, table features listed in the tables’ protocol must be supported by the current version of Databricks Runtime.</p></li>
<li><p>Support generated column for yyyy-MM-dd date_format. This change supports partition pruning for yyyy-MM-dd as a date_format in generated columns.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>February 16, 2023</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-30220">[SPARK-30220]</a> Enable using Exists/In subqueries outside of the Filter node</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>January 31, 2023</p>
<ul>
<li><p>Table types of JDBC tables are now EXTERNAL by default.</p></li>
</ul>
</li>
<li><p>January 18, 2023</p>
<ul>
<li><p>Azure Synapse connector returns a more descriptive error message when a column name contains not valid characters such as whitespaces or semicolons. In such cases, the following message will be returned: <code class="docutils literal notranslate"><span class="pre">Azure</span> <span class="pre">Synapse</span> <span class="pre">Analytics</span> <span class="pre">failed</span> <span class="pre">to</span> <span class="pre">run</span> <span class="pre">the</span> <span class="pre">JDBC</span> <span class="pre">query</span> <span class="pre">produced</span> <span class="pre">by</span> <span class="pre">the</span> <span class="pre">connector.</span> <span class="pre">Check</span> <span class="pre">column</span> <span class="pre">names</span> <span class="pre">do</span> <span class="pre">not</span> <span class="pre">include</span> <span class="pre">not</span> <span class="pre">valid</span> <span class="pre">characters</span> <span class="pre">such</span> <span class="pre">as</span> <span class="pre">';'</span> <span class="pre">or</span> <span class="pre">white</span> <span class="pre">space</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38277">[SPARK-38277]</a> Clear write batch after RocksDB state store’s commit</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41199">[SPARK-41199]</a> Fix metrics issue when DSv1 streaming source and DSv2 streaming source are co-used</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41198">[SPARK-41198]</a> Fix metrics in streaming query having CTE and DSv1 streaming source</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41339">[SPARK-41339]</a> Close and recreate RocksDB write batch instead of just clearing</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41732">[SPARK-41732]</a> Apply tree-pattern based pruning for the rule SessionWindowing</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>November 29, 2022</p>
<ul>
<li><p>Users can configure leading and trailing whitespaces’ behavior when writing data using the Redshift connector. The following options have been added to control white space handling:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">csvignoreleadingwhitespace</span></code>, when set to <code class="docutils literal notranslate"><span class="pre">true</span></code>, removes leading white space from values during writes when <code class="docutils literal notranslate"><span class="pre">tempformat</span></code> is set to <code class="docutils literal notranslate"><span class="pre">CSV</span></code> or <code class="docutils literal notranslate"><span class="pre">CSV</span> <span class="pre">GZIP</span></code>. Whitespaces are retained when the config is set to <code class="docutils literal notranslate"><span class="pre">false</span></code>. By default, the value is <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">csvignoretrailingwhitespace</span></code>, when set to <code class="docutils literal notranslate"><span class="pre">true</span></code>, removes trailing white space from values during writes when <code class="docutils literal notranslate"><span class="pre">tempformat</span></code> is set to <code class="docutils literal notranslate"><span class="pre">CSV</span></code> or <code class="docutils literal notranslate"><span class="pre">CSV</span> <span class="pre">GZIP</span></code>. Whitespaces are retained when the config is set to <code class="docutils literal notranslate"><span class="pre">false</span></code>. By default, the value is <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p></li>
</ul>
</li>
<li><p>Fixed an issue with JSON parsing in Auto Loader when all columns were left as strings (<code class="docutils literal notranslate"><span class="pre">cloudFiles.inferColumnTypes</span></code> was not set or set to <code class="docutils literal notranslate"><span class="pre">false</span></code>) and the JSON contained nested objects.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>November 15, 2022</p>
<ul>
<li><p>Upgraded Apache commons-text to 1.10.0.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40646">[SPARK-40646]</a> JSON parsing for structs, maps, and arrays has been fixed so when a part of a record does not match the schema, the rest of the record can still be parsed correctly instead of returning nulls. To opt-in for the improved behavior, set <code class="docutils literal notranslate"><span class="pre">spark.sql.json.enablePartialResults</span></code> to <code class="docutils literal notranslate"><span class="pre">true</span></code>. The flag is turned off by default to preserve the original behavior.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40292">[SPARK-40292]</a> Fix column names in <code class="docutils literal notranslate"><span class="pre">arrays_zip</span></code> function when arrays are referenced from nested structs</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>November 1, 2022</p>
<ul>
<li><p>Fixed an issue where if a Delta table had a user-defined column named <code class="docutils literal notranslate"><span class="pre">_change_type</span></code>, but <strong>Change data feed</strong> was turned off on that table, data in that column would incorrectly fill with NULL values when running <code class="docutils literal notranslate"><span class="pre">MERGE</span></code>.</p></li>
<li><p>Fixed an issue with Auto Loader where a file can be duplicated in the same micro-batch when <code class="docutils literal notranslate"><span class="pre">allowOverwrites</span></code> is enabled</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40697">[SPARK-40697]</a> Add read-side char padding to cover external data files</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40596">[SPARK-40596]</a> Populate ExecutorDecommission with messages in ExecutorDecommissionInfo</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>October 18, 2022</p>
<ul>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>October 5, 2022</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40468">[SPARK-40468]</a> Fix column pruning in CSV when <code class="docutils literal notranslate"><span class="pre">_corrupt_record</span></code> is selected.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>September 22, 2022</p>
<ul>
<li><p>Users can set spark.conf.set(<code class="docutils literal notranslate"><span class="pre">spark.databricks.io.listKeysWithPrefix.azure.enabled</span></code>, <code class="docutils literal notranslate"><span class="pre">true</span></code>) to re-enable the built-in listing for Auto Loader on ADLS Gen2. Built-in listing was previously turned off due to performance issues but can have led to increased storage costs for customers.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40315">[SPARK-40315]</a> Add hashCode() for Literal of ArrayBasedMapData</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40213">[SPARK-40213]</a> Support ASCII value conversion for Latin-1 characters</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40380">[SPARK-40380]</a> Fix constant-folding of InvokeLike to avoid non-serializable literal embedded in the plan</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38404">[SPARK-38404]</a> Improve CTE resolution when a nested CTE references an outer CTE</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40089">[SPARK-40089]</a> Fix sorting for some Decimal types</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39887">[SPARK-39887]</a> RemoveRedundantAliases should keep aliases that make the output of projection nodes unique</p></li>
</ul>
</li>
<li><p>September 6, 2022</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40235">[SPARK-40235]</a> Use interruptible lock instead of synchronized in Executor.updateDependencies()</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40218">[SPARK-40218]</a> GROUPING SETS should preserve the grouping columns</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39976">[SPARK-39976]</a> ArrayIntersect should handle null in left expression correctly</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40053">[SPARK-40053]</a> Add <code class="docutils literal notranslate"><span class="pre">assume</span></code> to dynamic cancel cases which require Python runtime environment</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-35542">[SPARK-35542]</a> Fix: Bucketizer created for multiple columns with parameters splitsArray,  inputCols and outputCols can not be loaded after saving it</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40079">[SPARK-40079]</a> Add Imputer inputCols validation for empty input case</p></li>
</ul>
</li>
<li><p>August 24, 2022</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39983">[SPARK-39983]</a> Do not cache unserialized broadcast relations on the driver</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39775">[SPARK-39775]</a> Disable validate default values when parsing Avro schemas</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39962">[SPARK-39962]</a> Apply projection when group attributes are empty</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-37643">[SPARK-37643]</a> when charVarcharAsString is true, for char datatype predicate query should skip rpadding rule</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>August 9, 2022</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39847">[SPARK-39847]</a> Fix race condition in RocksDBLoader.loadLibrary() if the caller thread is interrupted</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39731">[SPARK-39731]</a> Fix issue in CSV and JSON data sources when parsing dates in “yyyyMMdd” format with CORRECTED time parser policy</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>July 27, 2022</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39625">[SPARK-39625]</a> Add Dataset.as(StructType)</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39689">[SPARK-39689]</a>Support 2-chars <code class="docutils literal notranslate"><span class="pre">lineSep</span></code> in CSV data source</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39104">[SPARK-39104]</a> InMemoryRelation#isCachedColumnBuffersLoaded should be thread-safe</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39570">[SPARK-39570]</a> Inline table should allow expressions with alias</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39702">[SPARK-39702]</a> Reduce memory overhead of TransportCipher$EncryptedMessage by using a shared byteRawChannel</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39575">[SPARK-39575]</a> add ByteBuffer#rewind after ByteBuffer#get in AvroDeserializer</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39476">[SPARK-39476]</a> Disable Unwrap cast optimize when casting from Long to Float/ Double or from Integer to Float</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38868">[SPARK-38868]</a> Don’t propagate exceptions from filter predicate when optimizing outer joins</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>July 20, 2022</p>
<ul>
<li><p>Make Delta MERGE operation results consistent when the source is non-deterministic.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39355">[SPARK-39355]</a> Single column uses quoted to construct UnresolvedAttribute</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39548">[SPARK-39548]</a> CreateView Command with a window clause query press a wrong window definition not found issue</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39419">[SPARK-39419]</a> Fix ArraySort to throw an exception when the comparator returns null</p></li>
<li><p>Turned off Auto Loader’s use of built-in cloud APIs for directory listing on Azure.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>July 5, 2022</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39376">[SPARK-39376]</a> Hide duplicated columns in star expansion of subquery alias from NATURAL/USING JOIN</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>June 15, 2022</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39283">[SPARK-39283]</a> Fix deadlock between TaskMemoryManager and UnsafeExternalSorter.SpillableIterator</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39285">[SPARK-39285]</a> Spark should not check field names when reading files</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-34096">[SPARK-34096]</a> Improve performance for nth_value ignore nulls over offset window</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-36718">[SPARK-36718]</a> Fix the <code class="docutils literal notranslate"><span class="pre">isExtractOnly</span></code> check in CollapseProject</p></li>
</ul>
</li>
<li><p>June 2, 2022</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39093">[SPARK-39093]</a> Avoid codegen compilation error when dividing year-month intervals or day-time intervals by an integral</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38990">[SPARK-38990]</a> Avoid NullPointerException when evaluating date_trunc/trunc format as a bound reference</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>May 18, 2022</p>
<ul>
<li><p>Fixes a potential built-in memory leak in Auto Loader.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38918">[SPARK-38918]</a> Nested column pruning should filter out attributes that do not belong to the current relation</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-37593">[SPARK-37593]</a> Reduce default page size by LONG_ARRAY_OFFSET if G1GC and ON_HEAP are used</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39084">[SPARK-39084]</a> Fix df.rdd.isEmpty() by using TaskContext to stop iterator on task completion</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-32268">[SPARK-32268]</a> Add ColumnPruning in injectBloomFilter</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38974">[SPARK-38974]</a> Filter registered functions with a given database name in list functions</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38931">[SPARK-38931]</a> Create root dfs directory for RocksDBFileManager with an unknown number of keys on 1st checkpoint</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>April 19, 2022</p>
<ul>
<li><p>Upgraded Java AWS SDK from version 1.11.655 to 1.12.1899.</p></li>
<li><p>Fixed an issue with notebook-scoped libraries not working in batch streaming jobs.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38616">[SPARK-38616]</a> Keep track of SQL query text in Catalyst TreeNode</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>April 6, 2022</p>
<ul>
<li><p>The following Spark SQL functions are now available with this release:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">timestampadd()</span></code> and <code class="docutils literal notranslate"><span class="pre">dateadd()</span></code>: Add a time duration in a specified unit to a time stamp expression.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">timestampdiff()</span></code> and <code class="docutils literal notranslate"><span class="pre">datediff()</span></code>: Calculate the time difference between two-time stamp expressions in a specified unit.</p></li>
</ul>
</li>
<li><p>Parquet-MR has been upgraded to 1.12.2</p></li>
<li><p>Improved support for comprehensive schemas in parquet files</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38631">[SPARK-38631]</a> Uses Java-based implementation for un-tarring at Utils.unpack</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38509">[SPARK-38509]</a><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38481">[SPARK-38481]</a> Cherry-pick three <code class="docutils literal notranslate"><span class="pre">timestmapadd/diff</span></code> changes.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38523">[SPARK-38523]</a> Fix referring to the corrupt record column from CSV</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38237">[SPARK-38237]</a> Allow <code class="docutils literal notranslate"><span class="pre">ClusteredDistribution</span></code> to require full clustering keys</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38437">[SPARK-38437]</a> Lenient serialization of datetime from datasource</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38180">[SPARK-38180]</a> Allow safe up-cast expressions in correlated equality predicates</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38155">[SPARK-38155]</a> Disallow distinct aggregate in lateral subqueries with unsupported predicates</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="databricks-runtime-91-lts">
<span id="dbr-91-lts"></span><span id="91"></span><h3><a class="toc-backref" href="#id5">Databricks Runtime 9.1 LTS</a><a class="headerlink" href="#databricks-runtime-91-lts" title="Permalink to this headline"> </a></h3>
<p>See <a class="reference internal" href="../../release-notes/runtime/9.1lts.html"><span class="doc">Databricks Runtime 9.1 LTS</span></a>.</p>
<ul class="simple">
<li><p>November 29, 2023</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45859">[SPARK-45859]</a> Made UDF objects in <code class="docutils literal notranslate"><span class="pre">ml.functions</span></code> lazy.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45544">[SPARK-45544]</a> Integrated SSL support into <code class="docutils literal notranslate"><span class="pre">TransportContext</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45730">[SPARK-45730]</a> Improved time constraints for <code class="docutils literal notranslate"><span class="pre">ReloadingX509TrustManagerSuite</span></code>.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>November 14, 2023</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45545">[SPARK-45545]</a> <code class="docutils literal notranslate"><span class="pre">SparkTransportConf</span></code> inherits <code class="docutils literal notranslate"><span class="pre">SSLOptions</span></code> upon creation.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45429">[SPARK-45429]</a> Added helper classes for SSL RPC communication.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45427">[SPARK-45427]</a> Added RPC SSL settings to <code class="docutils literal notranslate"><span class="pre">SSLOptions</span></code> and <code class="docutils literal notranslate"><span class="pre">SparkTransportConf</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45584">[SPARK-45584]</a> Fixed subquery run failure with <code class="docutils literal notranslate"><span class="pre">TakeOrderedAndProjectExec</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45541">[SPARK-45541]</a> Added <code class="docutils literal notranslate"><span class="pre">SSLFactory</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42205">[SPARK-42205]</a> Removed logging accumulables in Stage and Task start events.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>October 24, 2023</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45426">[SPARK-45426]</a> Added support for <code class="docutils literal notranslate"><span class="pre">ReloadingX509TrustManager</span></code>.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>October 13, 2023</p>
<ul>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>September 10, 2023</p>
<ul>
<li><p>Miscellaneous fixes.</p></li>
</ul>
</li>
<li><p>August 30, 2023</p>
<ul>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>August 15, 2023</p>
<ul>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>June 23, 2023</p>
<ul>
<li><p>Snowflake-jdbc library is upgraded to 3.13.29 to address a security issue.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>June 15, 2023</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43098">[SPARK-43098]</a> Fix correctness COUNT bug when scalar subquery has a group by clause</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43156">[SPARK-43156]</a><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43098">[SPARK-43098]</a> Extend scalar subquery count bug test with <code class="docutils literal notranslate"><span class="pre">decorrelateInnerQuery</span></code> turned off.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40862">[SPARK-40862]</a> Support non-aggregated subqueries in RewriteCorrelatedScalarSubquery</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>June 2, 2023</p>
<ul>
<li><p>The JSON parser in <code class="docutils literal notranslate"><span class="pre">failOnUnknownFields</span></code> mode drops a record in <code class="docutils literal notranslate"><span class="pre">DROPMALFORMED</span></code> mode and fails directly in <code class="docutils literal notranslate"><span class="pre">FAILFAST</span></code> mode.</p></li>
<li><p>Fixed an issue in JSON rescued data parsing to prevent <code class="docutils literal notranslate"><span class="pre">UnknownFieldException</span></code>.</p></li>
<li><p>Fixed an issue in Auto Loader where different source file formats were inconsistent when the provided schema did not include inferred partitions. This issue could cause unexpected failures when reading files with missing columns in the inferred partition schema.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-37520">[SPARK-37520]</a> Add the <code class="docutils literal notranslate"><span class="pre">startswith()</span></code> and <code class="docutils literal notranslate"><span class="pre">endswith()</span></code> string functions</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43413">[SPARK-43413]</a> Fixed <code class="docutils literal notranslate"><span class="pre">IN</span></code> subquery <code class="docutils literal notranslate"><span class="pre">ListQuery</span></code> nullability.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>May 17, 2023</p>
<ul>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>April 25, 2023</p>
<ul>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>April 11, 2023</p>
<ul>
<li><p>Fixed an issue where Auto Loader schema evolution can go into an infinite fail loop when a new column is detected in the schema of a nested JSON object.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42967">[SPARK-42967]</a> Fix SparkListenerTaskStart.stageAttemptId when a task is started after the stage is canceled.</p></li>
</ul>
</li>
<li><p>March 29, 2023</p>
<ul>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>March 14, 2023</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42484">[SPARK-42484]</a> Improved error message for <code class="docutils literal notranslate"><span class="pre">UnsafeRowUtils</span></code>.</p></li>
<li><p>Miscellaneous fixes.</p></li>
</ul>
</li>
<li><p>February 28, 2023</p>
<ul>
<li><p>Users can now read and write specific Delta tables requiring Reader version 3 and Writer version 7, using Databricks Runtime 9.1 LTS or later. To succeed, table features listed in the tables’ protocol must be supported by the current version of Databricks Runtime.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>February 16, 2023</p>
<ul>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>January 31, 2023</p>
<ul>
<li><p>Table types of JDBC tables are now EXTERNAL by default.</p></li>
</ul>
</li>
<li><p>January 18, 2023</p>
<ul>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>November 29, 2022</p>
<ul>
<li><p>Fixed an issue with JSON parsing in Auto Loader when all columns were left as strings (<code class="docutils literal notranslate"><span class="pre">cloudFiles.inferColumnTypes</span></code> was not set or set to <code class="docutils literal notranslate"><span class="pre">false</span></code>) and the JSON contained nested objects.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>November 15, 2022</p>
<ul>
<li><p>Upgraded Apache commons-text to 1.10.0.</p></li>
<li><p>Operating system security updates.</p></li>
<li><p>Miscellaneous fixes.</p></li>
</ul>
</li>
<li><p>November 1, 2022</p>
<ul>
<li><p>Fixed an issue where if a Delta table had a user-defined column named <code class="docutils literal notranslate"><span class="pre">_change_type</span></code>, but <strong>Change data feed</strong> was turned off on that table, data in that column would incorrectly fill with NULL values when running <code class="docutils literal notranslate"><span class="pre">MERGE</span></code>.</p></li>
<li><p>Fixed an issue with Auto Loader where a file can be duplicated in the same micro-batch when <code class="docutils literal notranslate"><span class="pre">allowOverwrites</span></code> is enabled</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40596">[SPARK-40596]</a> Populate ExecutorDecommission with messages in ExecutorDecommissionInfo</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>October 18, 2022</p>
<ul>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>October 5, 2022</p>
<ul>
<li><p>Miscellaneous fixes.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>September 22, 2022</p>
<ul>
<li><p>Users can set spark.conf.set(“spark.databricks.io.listKeysWithPrefix.azure.enabled”, “true”) to re-enable the built-in listing for Auto Loader on ADLS Gen2. Built-in listing was previously turned off due to performance issues but can have led to increased storage costs for customers.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40315">[SPARK-40315]</a> Add hashCode() for Literal of ArrayBasedMapData</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40089">[SPARK-40089]</a> Fix sorting for some Decimal types</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39887">[SPARK-39887]</a> RemoveRedundantAliases should keep aliases that make the output of projection nodes unique</p></li>
</ul>
</li>
<li><p>September 6, 2022</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40235">[SPARK-40235]</a> Use interruptible lock instead of synchronized in Executor.updateDependencies()</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-35542">[SPARK-35542]</a> Fix: Bucketizer created for multiple columns with parameters splitsArray, inputCols and outputCols can not be loaded after saving it</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40079">[SPARK-40079]</a> Add Imputer inputCols validation for empty input case</p></li>
</ul>
</li>
<li><p>August 24, 2022</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39666">[SPARK-39666]</a> Use UnsafeProjection.create to respect <code class="docutils literal notranslate"><span class="pre">spark.sql.codegen.factoryMode</span></code> in ExpressionEncoder</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39962">[SPARK-39962]</a> Apply projection when group attributes are empty</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>August 9, 2022</p>
<ul>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>July 27, 2022</p>
<ul>
<li><p>Make Delta MERGE operation results consistent when the source is non-deterministic.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39689">[SPARK-39689]</a> Support for 2-chars <code class="docutils literal notranslate"><span class="pre">lineSep</span></code> in CSV data source</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39575">[SPARK-39575]</a> Added <code class="docutils literal notranslate"><span class="pre">ByteBuffer#rewind</span></code> after <code class="docutils literal notranslate"><span class="pre">ByteBuffer#get</span></code> in <code class="docutils literal notranslate"><span class="pre">AvroDeserializer</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-37392">[SPARK-37392]</a> Fixed the performance error for catalyst optimizer.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>July 13, 2022</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39419">[SPARK-39419]</a> <code class="docutils literal notranslate"><span class="pre">ArraySort</span></code> throws an exception when the comparator returns null.</p></li>
<li><p>Turned off Auto Loader’s use of built-in cloud APIs for directory listing on Azure.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>July 5, 2022</p>
<ul>
<li><p>Operating system security updates.</p></li>
<li><p>Miscellaneous fixes.</p></li>
</ul>
</li>
<li><p>June 15, 2022</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39283">[SPARK-39283]</a> Fix deadlock between <code class="docutils literal notranslate"><span class="pre">TaskMemoryManager</span></code> and <code class="docutils literal notranslate"><span class="pre">UnsafeExternalSorter.SpillableIterator</span></code>.</p></li>
</ul>
</li>
<li><p>June 2, 2022</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-34554">[SPARK-34554]</a> Implement the <code class="docutils literal notranslate"><span class="pre">copy()</span></code> method in <code class="docutils literal notranslate"><span class="pre">ColumnarMap</span></code>.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>May 18, 2022</p>
<ul>
<li><p>Fixed a potential built-in memory leak in Auto Loader.</p></li>
<li><p>Upgrade AWS SDK version from 1.11.655 to 1.11.678.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38918">[SPARK-38918]</a> Nested column pruning should filter out attributes that do not belong to the current relation</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39084">[SPARK-39084]</a> Fix <code class="docutils literal notranslate"><span class="pre">df.rdd.isEmpty()</span></code> by using <code class="docutils literal notranslate"><span class="pre">TaskContext</span></code> to stop iterator on task completion</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>April 19, 2022</p>
<ul>
<li><p>Operating system security updates.</p></li>
<li><p>Miscellaneous fixes.</p></li>
</ul>
</li>
<li><p>April 6, 2022</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38631">[SPARK-38631]</a> Uses Java-based implementation for un-tarring at Utils.unpack</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>March 22, 2022</p>
<ul>
<li><p>Changed the current working directory of notebooks on High Concurrency clusters with either table access control or credential passthrough enabled to the user’s home directory. Previously, the active directory was <code class="docutils literal notranslate"><span class="pre">/databricks/driver</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38437">[SPARK-38437]</a> Lenient serialization of datetime from datasource</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38180">[SPARK-38180]</a> Allow safe up-cast expressions in correlated equality predicates</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38155">[SPARK-38155]</a> Disallow distinct aggregate in lateral subqueries with unsupported predicates</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-27442">[SPARK-27442]</a> Removed a check field when reading or writing data in a parquet.</p></li>
</ul>
</li>
<li><p>March 14, 2022</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38236">[SPARK-38236]</a> Absolute file paths specified in the create/alter table are treated as relative</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-34069">[SPARK-34069]</a> Interrupt task thread if local property <code class="docutils literal notranslate"><span class="pre">SPARK_JOB_INTERRUPT_ON_CANCEL</span></code> is set to true.</p></li>
</ul>
</li>
<li><p>February 23, 2022</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-37859">[SPARK-37859]</a> SQL tables created with JDBC with Spark 3.1 are not readable with Spark 3.2.</p></li>
</ul>
</li>
<li><p>February 8, 2022</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-27442">[SPARK-27442]</a> Removed a check field when reading or writing data in a parquet.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>February 1, 2022</p>
<ul>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>January 26, 2022</p>
<ul>
<li><p>Fixed an issue where concurrent transactions on Delta tables could commit in a non-serializable order under certain rare conditions.</p></li>
<li><p>Fixed an issue where the <code class="docutils literal notranslate"><span class="pre">OPTIMIZE</span></code> command could fail when the ANSI SQL dialect was enabled.</p></li>
</ul>
</li>
<li><p>January 19, 2022</p>
<ul>
<li><p>Minor fixes and security enhancements.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>November 4, 2021</p>
<ul>
<li><p>Fixed an issue that could cause Structured Streaming streams to fail with an <code class="docutils literal notranslate"><span class="pre">ArrayIndexOutOfBoundsException</span></code>.</p></li>
<li><p>Fixed a race condition that might cause a query failure with an IOException like <code class="docutils literal notranslate"><span class="pre">java.io.IOException:</span> <span class="pre">No</span> <span class="pre">FileSystem</span> <span class="pre">for</span> <span class="pre">scheme</span></code> or that might cause modifications to <code class="docutils literal notranslate"><span class="pre">sparkContext.hadoopConfiguration</span></code> to not take effect in queries.</p></li>
<li><p>The Apache Spark Connector for Delta Sharing was upgraded to 0.2.0.</p></li>
</ul>
</li>
<li><p>October 20, 2021</p>
<ul>
<li><p>Upgraded BigQuery connector from 0.18.1 to 0.22.2. This adds support for the BigNumeric type.</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="databricks-runtime-130-unsupported">
<span id="dbr-130-unsupported"></span><span id="130"></span><h3><a class="toc-backref" href="#id6">Databricks Runtime 13.0 (unsupported)</a><a class="headerlink" href="#databricks-runtime-130-unsupported" title="Permalink to this headline"> </a></h3>
<p>See <a class="reference internal" href="13.0.html"><span class="doc">Databricks Runtime 13.0 (unsupported)</span></a>.</p>
<ul class="simple">
<li><p>October 13, 2023</p>
<ul>
<li><p>Snowflake-jdbc dependency upgraded from 3.13.29 to 3.13.33.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42553">[SPARK-42553]</a>[SQL] Ensure at least one time unit after interval.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-45178">[SPARK-45178]</a> Fallback to running a single batch for <code class="docutils literal notranslate"><span class="pre">Trigger.AvailableNow</span></code> with unsupported sources rather than using wrapper.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44658">[SPARK-44658]</a>[CORE] <code class="docutils literal notranslate"><span class="pre">ShuffleStatus.getMapStatus</span></code> returns <code class="docutils literal notranslate"><span class="pre">None</span></code> instead of <code class="docutils literal notranslate"><span class="pre">Some(null)</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42205">[SPARK-42205]</a>[CORE] Remove logging of Accumulables in Task/Stage start events in <code class="docutils literal notranslate"><span class="pre">JsonProtocol</span></code>.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>September 12, 2023</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44485">[SPARK-44485]</a>[SQL] Optimize <code class="docutils literal notranslate"><span class="pre">TreeNode.generateTreeString</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44718">[SPARK-44718]</a>[SQL] Match <code class="docutils literal notranslate"><span class="pre">ColumnVector</span></code> memory-mode config default to <code class="docutils literal notranslate"><span class="pre">OffHeapMemoryMode</span></code> config value.</p></li>
<li><p>Miscellaneous bug fixes.</p></li>
</ul>
</li>
<li><p>August 30, 2023</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44818">[SPARK-44818]</a>[Backport] Fixed race for pending task interrupt issued before <code class="docutils literal notranslate"><span class="pre">taskThread</span></code> is initialized.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44714">[SPARK-44714]</a> Ease restriction of LCA resolution regarding queries.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44245">[SPARK-44245]</a>[PYTHON] <code class="docutils literal notranslate"><span class="pre">pyspark.sql.dataframe</span> <span class="pre">sample()</span></code> doctests is now illustrative-only.</p></li>
<li><p>[11.3-13.0][[SPARK-44871]]<a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44871">https://issues.apache.org/jira/browse/SPARK-44871</a>)[SQL] Fixed <code class="docutils literal notranslate"><span class="pre">percentile_disc</span></code> behavior.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>August 15, 2023</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44643">[SPARK-44643]</a>[SQL][PYTHON] Fix <code class="docutils literal notranslate"><span class="pre">Row.__repr__</span></code> when the row is empty.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44504">[SPARK-44504]</a>[Backport] Maintenance task cleans up loaded providers on stop error.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44479">[SPARK-44479]</a>[CONNECT][PYTHON] Fixed <code class="docutils literal notranslate"><span class="pre">protobuf</span></code> conversion from an empty struct type.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44464">[SPARK-44464]</a>[SS] Fixed <code class="docutils literal notranslate"><span class="pre">applyInPandasWithStatePythonRunner</span></code> to output rows that have <code class="docutils literal notranslate"><span class="pre">Null</span></code> as first column value.</p></li>
<li><p>Miscellaneous bug fixes.</p></li>
</ul>
</li>
<li><p>July 29, 2023</p>
<ul>
<li><p>Fixed a bug where <code class="docutils literal notranslate"><span class="pre">dbutils.fs.ls()</span></code> returned <code class="docutils literal notranslate"><span class="pre">INVALID_PARAMETER_VALUE.LOCATION_OVERLAP</span></code> when called for a storage location path which clashed with other external or managed storage location.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44199">[SPARK-44199]</a> <code class="docutils literal notranslate"><span class="pre">CacheManager</span></code> no longer refreshes the <code class="docutils literal notranslate"><span class="pre">fileIndex</span></code> unnecessarily.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>July 24, 2023</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44337">[SPARK-44337]</a>[PROTOBUF] Fixed an issue where any field set to <code class="docutils literal notranslate"><span class="pre">Any.getDefaultInstance</span></code> caused parse errors.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-44136">[SPARK-44136]</a> [SS] Fixed an issue where <code class="docutils literal notranslate"><span class="pre">StateManager</span></code> would get materialized in an executor instead of driver in <code class="docutils literal notranslate"><span class="pre">FlatMapGroupsWithStateExec</span></code>.</p></li>
<li><p>Revert <a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42323">[SPARK-42323]</a>[SQL] Assign name to <code class="docutils literal notranslate"><span class="pre">_LEGACY_ERROR_TEMP_2332</span></code>.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>June 23, 2023</p>
<ul>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>June 15, 2023</p>
<ul>
<li><p>Photonized <code class="docutils literal notranslate"><span class="pre">approx_count_distinct</span></code>.</p></li>
<li><p>Snowflake-jdbc library is upgraded to 3.13.29 to address a security issue.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43156">[SPARK-43156]</a><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43098">[SPARK-43098]</a>[SQL] Extend scalar subquery count bug test with decorrelateInnerQuery disabled</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43779">[SPARK-43779]</a>[SQL] <code class="docutils literal notranslate"><span class="pre">ParseToDate</span></code> now loads <code class="docutils literal notranslate"><span class="pre">EvalMode</span></code> in the main thread.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42937">[SPARK-42937]</a>[SQL] <code class="docutils literal notranslate"><span class="pre">PlanSubqueries</span></code> should set <code class="docutils literal notranslate"><span class="pre">InSubqueryExec#shouldBroadcast</span></code> to true</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>June 2, 2023</p>
<ul>
<li><p>The JSON parser in <code class="docutils literal notranslate"><span class="pre">failOnUnknownFields</span></code> mode drops a record in <code class="docutils literal notranslate"><span class="pre">DROPMALFORMED</span></code> mode and fails directly in <code class="docutils literal notranslate"><span class="pre">FAILFAST</span></code> mode.</p></li>
<li><p>Improve the performance of incremental update with <code class="docutils literal notranslate"><span class="pre">SHALLOW</span> <span class="pre">CLONE</span></code> Iceberg and Parquet.</p></li>
<li><p>Fixed an issue in Auto Loader where different source file formats were inconsistent when the provided schema did not include inferred partitions. This issue could cause unexpected failures when reading files with missing columns in the inferred partition schema.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43404">[SPARK-43404]</a>[Backport] Skip reusing sst file for same version of RocksDB state store to avoid ID mismatch error.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43340">[SPARK-43340]</a>[CORE] Fixed missing stack trace field in eventlogs.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43300">[SPARK-43300]</a>[CORE] <code class="docutils literal notranslate"><span class="pre">NonFateSharingCache</span></code> wrapper for Guava Cache.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43378">[SPARK-43378]</a>[CORE] Properly close stream objects in <code class="docutils literal notranslate"><span class="pre">deserializeFromChunkedBuffer</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-16484">[SPARK-16484]</a>[SQL] Use 8-bit registers for representing DataSketches.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43522">[SPARK-43522]</a>[SQL] Fixed creating struct column name with index of array.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43413">[SPARK-43413]</a>[11.3-13.0][SQL] Fixed <code class="docutils literal notranslate"><span class="pre">IN</span></code> subquery <code class="docutils literal notranslate"><span class="pre">ListQuery</span></code> nullability.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43043">[SPARK-43043]</a>[CORE] Improved <code class="docutils literal notranslate"><span class="pre">MapOutputTracker.updateMapOutput</span></code> performance.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-16484">[SPARK-16484]</a>[SQL] Added support for DataSketches HllSketch.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43123">[SPARK-43123]</a>[SQL] Internal field metadata no longer leaks to catalogs.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42851">[SPARK-42851]</a>[SQL] Guard <code class="docutils literal notranslate"><span class="pre">EquivalentExpressions.addExpr()</span></code> with <code class="docutils literal notranslate"><span class="pre">supportedExpression()</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43336">[SPARK-43336]</a>[SQL] Casting between <code class="docutils literal notranslate"><span class="pre">Timestamp</span></code> and <code class="docutils literal notranslate"><span class="pre">TimestampNTZ</span></code> requires timezone.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43286">[SPARK-43286]</a>[SQL] Updated <code class="docutils literal notranslate"><span class="pre">aes_encrypt</span></code> CBC mode to generate random IVs.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42852">[SPARK-42852]</a>[SQL] Reverted <code class="docutils literal notranslate"><span class="pre">NamedLambdaVariable</span></code> related changes from <code class="docutils literal notranslate"><span class="pre">EquivalentExpressions</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43541">[SPARK-43541]</a>[SQL] Propagate all <code class="docutils literal notranslate"><span class="pre">Project</span></code> tags in resolving of expressions and missing columns..</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43527">[SPARK-43527]</a>[PYTHON] Fixed <code class="docutils literal notranslate"><span class="pre">catalog.listCatalogs</span></code> in PySpark.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>May 31, 2023</p>
<ul>
<li><p>Default optimized write support for Delta tables registered in Unity Catalog has expanded to include <code class="docutils literal notranslate"><span class="pre">CTAS</span></code> statements and <code class="docutils literal notranslate"><span class="pre">INSERT</span></code> operations for partitioned tables. This behavior aligns to defaults on SQL warehouses. See <a class="reference internal" href="../../delta/tune-file-size.html#optimized-writes"><span class="std std-ref">Optimized writes for Delta Lake on Databricks</span></a>.</p></li>
</ul>
</li>
<li><p>May 17, 2023</p>
<ul>
<li><p>Fixed a regression where <code class="docutils literal notranslate"><span class="pre">_metadata.file_path</span></code> and <code class="docutils literal notranslate"><span class="pre">_metadata.file_name</span></code> would return incorrectly formatted strings. For example, now a path with spaces are be represented as <code class="docutils literal notranslate"><span class="pre">s3://test-bucket/some%20directory/some%20data.csv</span></code> instead of <code class="docutils literal notranslate"><span class="pre">s3://test-bucket/some</span> <span class="pre">directory/some</span> <span class="pre">data.csv</span></code>.</p></li>
<li><p>Parquet scans are now robust against OOMs when scanning exceptionally structured files by dynamically adjusting batch size. File metadata is analyzed to preemptively lower batch size and is lowered again on task retries as a final safety net.</p></li>
<li><ul>
<li><p>If an Avro file was read with just the <code class="docutils literal notranslate"><span class="pre">failOnUnknownFields\</span></code> option or with Auto Loader in the <code class="docutils literal notranslate"><span class="pre">failOnNewColumns\</span></code> schema evolution mode, columns that have different data types would be read as <code class="docutils literal notranslate"><span class="pre">null\</span></code> instead of throwing an error stating that the file cannot be read. These reads now fail and recommend users to use the <code class="docutils literal notranslate"><span class="pre">rescuedDataColumn\</span></code> option.</p></li>
</ul>
</li>
<li><p>Auto Loader now does the following.</p></li>
<li><ul>
<li><p>Correctly reads and no longer rescues <code class="docutils literal notranslate"><span class="pre">Integer</span></code>, <code class="docutils literal notranslate"><span class="pre">Short</span></code>, <code class="docutils literal notranslate"><span class="pre">Byte</span></code> types if one of these data types are provided, but the Avro file suggests one of the other two types.</p></li>
</ul>
</li>
<li><ul>
<li><p>Prevents reading interval types as date or timestamp types to avoid getting corrupt dates.</p></li>
</ul>
</li>
<li><ul>
<li><p>Prevents reading <code class="docutils literal notranslate"><span class="pre">Decimal</span></code> types with lower precision.</p></li>
</ul>
</li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43172">[SPARK-43172]</a> [CONNECT] Exposes host and token from Spark connect client.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43293">[SPARK-43293]</a>[SQL] <code class="docutils literal notranslate"><span class="pre">__qualified_access_only</span></code> is ignored in normal columns.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43098">[SPARK-43098]</a>[SQL] Fixed correctness <code class="docutils literal notranslate"><span class="pre">COUNT</span></code> bug when scalar subquery is grouped by clause.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43085">[SPARK-43085]</a>[SQL] Support for column <code class="docutils literal notranslate"><span class="pre">DEFAULT</span></code> assignment for multi-part table names.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43190">[SPARK-43190]</a>[SQL] <code class="docutils literal notranslate"><span class="pre">ListQuery.childOutput</span></code> is now consistent with secondary output.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43192">[SPARK-43192]</a> [CONNECT] Removed user agent charset validation.</p></li>
</ul>
</li>
<li><p>April 25, 2023</p>
<ul>
<li><p>You can modify a Delta table to add support for a Delta table feature using <code class="docutils literal notranslate"><span class="pre">DeltaTable.addFeatureSupport(feature_name)</span></code>.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">SYNC</span></code> command now supports legacy data source formats.</p></li>
<li><p>Fixed a bug where using the Python formatter before running any other commands in a Python notebook could cause the notebook path to be missing from <code class="docutils literal notranslate"><span class="pre">sys.path.</span></code></p></li>
<li><p>Databricks now supports specifying default values for columns of Delta tables. <code class="docutils literal notranslate"><span class="pre">INSERT</span></code>, <code class="docutils literal notranslate"><span class="pre">UPDATE</span></code>, <code class="docutils literal notranslate"><span class="pre">DELETE</span></code>, and <code class="docutils literal notranslate"><span class="pre">MERGE</span></code> commands can refer to a column’s default value using the explicit <code class="docutils literal notranslate"><span class="pre">DEFAULT</span></code> keyword. For <code class="docutils literal notranslate"><span class="pre">INSERT</span></code> commands with an explicit list of fewer columns than the target table, corresponding column default values are substituted for the remaining columns (or <code class="docutils literal notranslate"><span class="pre">NULL</span></code> if no default is specified).</p></li>
</ul>
</li>
</ul>
<p></p>
<ul class="simple">
<li><p>Fixes a bug where the web terminal could not be used to access files in <code class="docutils literal notranslate"><span class="pre">/Workspace</span></code> for some users.</p>
<ul>
<li><p>If a Parquet file was read with just the <code class="docutils literal notranslate"><span class="pre">failOnUnknownFields</span></code> option or with Auto Loader in the <code class="docutils literal notranslate"><span class="pre">failOnNewColumns</span></code> schema evolution mode, columns that had different data types would be read as <code class="docutils literal notranslate"><span class="pre">null</span></code> instead of throwing an error stating that the file cannot be read. These reads now fail and recommend users to use the <code class="docutils literal notranslate"><span class="pre">rescuedDataColumn</span></code> option.</p></li>
<li><p>Auto Loader now correctly reads and no longer rescues <code class="docutils literal notranslate"><span class="pre">Integer</span></code>, <code class="docutils literal notranslate"><span class="pre">Short</span></code>, <code class="docutils literal notranslate"><span class="pre">Byte</span></code> types if one of these data types are provided. The Parquet file suggests one of the other two types. When the rescued data column was previously enabled, the data type mismatch would cause columns to be rescued even though they were readable.</p></li>
<li><p>Fixed a bug where Auto Loader schema evolution can go into an infinite fail loop, when a new column is detected in the schema of a nested JSON object.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42794">[SPARK-42794]</a>[SS] Increase the lockAcquireTimeoutMs to 2 minutes for acquiring the RocksDB state store in Structure Streaming.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39221">[SPARK-39221]</a>[SQL] Make sensitive information be redacted correctly for thrift server job/stage tab.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42971">[SPARK-42971]</a>[CORE] Change to print <code class="docutils literal notranslate"><span class="pre">workdir</span></code> if <code class="docutils literal notranslate"><span class="pre">appDirs</span></code> is null when worker handle <code class="docutils literal notranslate"><span class="pre">WorkDirCleanup</span></code> event.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42936">[SPARK-42936]</a>[SQL] Fix LCA bug when the having clause can be resolved directly by its child aggregate.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43018">[SPARK-43018]</a>[SQL] Fix bug for <code class="docutils literal notranslate"><span class="pre">INSERT</span></code> commands with timestamp literals.</p></li>
<li><p>Revert <a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42754">[SPARK-42754]</a>[SQL][UI] Fix backward compatibility issue in nested SQL run.</p></li>
<li><p>Revert <a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41498">[SPARK-41498]</a> Propagate metadata through Union.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43038">[SPARK-43038]</a>[SQL] Support the CBC mode by <code class="docutils literal notranslate"><span class="pre">aes_encrypt()</span></code>/<code class="docutils literal notranslate"><span class="pre">aes_decrypt()</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42928">[SPARK-42928]</a>[SQL] Make <code class="docutils literal notranslate"><span class="pre">resolvePersistentFunction</span></code> synchronized.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42521">[SPARK-42521]</a>[SQL] Add <code class="docutils literal notranslate"><span class="pre">NULL</span></code> values for <code class="docutils literal notranslate"><span class="pre">INSERT</span></code> with user-specified lists of fewer columns than the target table.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41391">[SPARK-41391]</a>[SQL] The output column name of <code class="docutils literal notranslate"><span class="pre">groupBy.agg(count_distinct)</span></code> was incorrect.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42548">[SPARK-42548]</a>[SQL] Add <code class="docutils literal notranslate"><span class="pre">ReferenceAllColumns</span></code> to skip rewriting attributes.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42423">[SPARK-42423]</a>[SQL] Add metadata column file block start and length.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42796">[SPARK-42796]</a>[SQL] Support accessing <code class="docutils literal notranslate"><span class="pre">TimestampNTZ</span></code> columns in <code class="docutils literal notranslate"><span class="pre">CachedBatch</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42266">[SPARK-42266]</a>[PYTHON] Remove the parent directory in shell.py run when IPython is used.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43011">[SPARK-43011]</a>[SQL] <code class="docutils literal notranslate"><span class="pre">array_insert</span></code> should fail with 0 index.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41874">[SPARK-41874]</a>[CONNECT][PYTHON] Support <code class="docutils literal notranslate"><span class="pre">SameSemantics</span></code> in Spark Connect.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42702">[SPARK-42702]</a><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42623">[SPARK-42623]</a>[SQL] Support parameterized query in subquery and CTE.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42967">[SPARK-42967]</a>[CORE] Fix <code class="docutils literal notranslate"><span class="pre">SparkListenerTaskStart.stageAttemptId</span></code> when a task is started after the stage is cancelled.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="databricks-runtime-121-unsupported">
<span id="dbr-121-unsupported"></span><span id="121"></span><h3><a class="toc-backref" href="#id7">Databricks Runtime 12.1 (unsupported)</a><a class="headerlink" href="#databricks-runtime-121-unsupported" title="Permalink to this headline"> </a></h3>
<p>See <a class="reference internal" href="12.1.html"><span class="doc">Databricks Runtime 12.1 (unsupported)</span></a>.</p>
<ul>
<li><p>June 23, 2023</p>
<ul class="simple">
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>June 15, 2023</p>
<ul class="simple">
<li><p>Photonized <code class="docutils literal notranslate"><span class="pre">approx_count_distinct</span></code>.</p></li>
<li><p>Snowflake-jdbc library is upgraded to 3.13.29 to address a security issue.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43779">[SPARK-43779]</a>[SQL] <code class="docutils literal notranslate"><span class="pre">ParseToDate</span></code> now loads <code class="docutils literal notranslate"><span class="pre">EvalMode</span></code> in the main thread.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43156">[SPARK-43156]</a><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43098">[SPARK-43098]</a>[SQL] Extend scalar subquery count bug test with decorrelateInnerQuery disabled</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>June 2, 2023</p>
<ul class="simple">
<li><p>The JSON parser in <code class="docutils literal notranslate"><span class="pre">failOnUnknownFields</span></code> mode drops a record in <code class="docutils literal notranslate"><span class="pre">DROPMALFORMED</span></code> mode and fails directly in <code class="docutils literal notranslate"><span class="pre">FAILFAST</span></code> mode.</p></li>
<li><p>Improve the performance of incremental update with <code class="docutils literal notranslate"><span class="pre">SHALLOW</span> <span class="pre">CLONE</span></code> Iceberg and Parquet.</p></li>
<li><p>Fixed an issue in Auto Loader where different source file formats were inconsistent when the provided schema did not include inferred partitions. This issue could cause unexpected failures when reading files with missing columns in the inferred partition schema.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43404">[SPARK-43404]</a>[Backport] Skip reusing sst file for same version of RocksDB state store to avoid ID mismatch error.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43413">[SPARK-43413]</a>[11.3-13.0][SQL] Fixed <code class="docutils literal notranslate"><span class="pre">IN</span></code> subquery <code class="docutils literal notranslate"><span class="pre">ListQuery</span></code> nullability.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43522">[SPARK-43522]</a>[SQL] Fixed creating struct column name with index of array.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42444">[SPARK-42444]</a>[PYTHON] <code class="docutils literal notranslate"><span class="pre">DataFrame.drop</span></code> now handles duplicated columns properly.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43541">[SPARK-43541]</a>[SQL] Propagate all <code class="docutils literal notranslate"><span class="pre">Project</span></code> tags in resolving of expressions and missing columns..</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43340">[SPARK-43340]</a>[CORE] Fixed missing stack trace field in eventlogs.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42937">[SPARK-42937]</a>[SQL] <code class="docutils literal notranslate"><span class="pre">PlanSubqueries</span></code> now sets <code class="docutils literal notranslate"><span class="pre">InSubqueryExec#shouldBroadcast</span></code> to true.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43527">[SPARK-43527]</a>[PYTHON] Fixed <code class="docutils literal notranslate"><span class="pre">catalog.listCatalogs</span></code> in PySpark.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43378">[SPARK-43378]</a>[CORE] Properly close stream objects in <code class="docutils literal notranslate"><span class="pre">deserializeFromChunkedBuffer</span></code>.</p></li>
</ul>
</li>
<li><p>May 17, 2023</p>
<ul class="simple">
<li><p>Parquet scans are now robust against OOMs when scanning exceptionally structured files by dynamically adjusting batch size. File metadata is analyzed to preemptively lower batch size and is lowered again on task retries as a final safety net.</p></li>
<li><p>If an Avro file was read with just the <code class="docutils literal notranslate"><span class="pre">failOnUnknownFields\</span></code> option or with Auto Loader in the <code class="docutils literal notranslate"><span class="pre">failOnNewColumns\</span></code> schema evolution mode, columns that have different data types would be read as <code class="docutils literal notranslate"><span class="pre">null\</span></code> instead of throwing an error stating that the file cannot be read. These reads now fail and recommend users to use the <code class="docutils literal notranslate"><span class="pre">rescuedDataColumn\</span></code> option.</p></li>
<li><p>Auto Loader now does the following.</p></li>
<li><ul>
<li><p>Correctly reads and no longer rescues <code class="docutils literal notranslate"><span class="pre">Integer</span></code>, <code class="docutils literal notranslate"><span class="pre">Short</span></code>, <code class="docutils literal notranslate"><span class="pre">Byte</span></code> types if one of these data types are provided, but the Avro file suggests one of the other two types.</p></li>
</ul>
</li>
<li><ul>
<li><p>Prevents reading interval types as date or timestamp types to avoid getting corrupt dates.</p></li>
</ul>
</li>
<li><ul>
<li><p>Prevents reading <code class="docutils literal notranslate"><span class="pre">Decimal</span></code> types with lower precision.</p></li>
</ul>
</li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43098">[SPARK-43098]</a>[SQL] Fixed correctness <code class="docutils literal notranslate"><span class="pre">COUNT</span></code> bug when scalar subquery is grouped by clause.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43190">[SPARK-43190]</a>[SQL] <code class="docutils literal notranslate"><span class="pre">ListQuery.childOutput</span></code> is now consistent with secondary output.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>April 25, 2023</p>
<ul class="simple">
<li><p>If a Parquet file was read with just the <code class="docutils literal notranslate"><span class="pre">failOnUnknownFields</span></code> option or with Auto Loader in the <code class="docutils literal notranslate"><span class="pre">failOnNewColumns</span></code> schema evolution mode, columns that had different data types would be read as <code class="docutils literal notranslate"><span class="pre">null</span></code> instead of throwing an error stating that the file cannot be read. These reads now fail and recommend users to use the <code class="docutils literal notranslate"><span class="pre">rescuedDataColumn</span></code> option.</p></li>
<li><p>Auto Loader now correctly reads and no longer rescues <code class="docutils literal notranslate"><span class="pre">Integer</span></code>, <code class="docutils literal notranslate"><span class="pre">Short</span></code>, <code class="docutils literal notranslate"><span class="pre">Byte</span></code> types if one of these data types are provided. The Parquet file suggests one of the other two types. When the rescued data column was previously enabled, the data type mismatch would cause columns to be rescued even though they were readable.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43009">[SPARK-43009]</a>[SQL] Parameterized <code class="docutils literal notranslate"><span class="pre">sql()</span></code> with <code class="docutils literal notranslate"><span class="pre">Any</span></code> constants.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42971">[SPARK-42971]</a>[CORE] Change to print <code class="docutils literal notranslate"><span class="pre">workdir</span></code> if <code class="docutils literal notranslate"><span class="pre">appDirs</span></code> is null when worker handle <code class="docutils literal notranslate"><span class="pre">WorkDirCleanup</span></code> event.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>April 11, 2023</p>
<ul class="simple">
<li><p>Support legacy data source formats in SYNC command.</p></li>
<li><p>Fixes a bug in the %autoreload behavior in notebooks that are outside of a repo.</p></li>
<li><p>Fixed a bug where Auto Loader schema evolution can go into an infinite fail loop, when a new column is detected in the schema of a nested JSON object.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42928">[SPARK-42928]</a>[SQL] Makes <code class="docutils literal notranslate"><span class="pre">resolvePersistentFunction</span></code> synchronized.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42967">[SPARK-42967]</a>[CORE] Fixes <code class="docutils literal notranslate"><span class="pre">SparkListenerTaskStart.stageAttemptId</span></code> when a task starts after the stage is cancelled.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>March 29, 2023</p>
<ul class="simple">
<li><p>Auto Loader now triggers at least one synchronous RocksDB log clean up for <code class="docutils literal notranslate"><span class="pre">Trigger.AvailableNow</span></code> streams to ensure that the checkpoint can get regularly cleaned up for fast-running Auto Loader streams. This can cause some streams to take longer before they shut down, but will save you  storage costs and improve the Auto Loader experience in future runs.</p></li>
<li><p>You can now modify a Delta table to add support to table features using <code class="docutils literal notranslate"><span class="pre">DeltaTable.addFeatureSupport(feature_name)</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42702">[SPARK-42702]</a><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42623">[SPARK-42623]</a>[SQL] Support parameterized query in subquery and CTE</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41162">[SPARK-41162]</a>[SQL] Fix anti- and semi-join for self-join with aggregations</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42403">[SPARK-42403]</a>[CORE] JsonProtocol should handle null JSON strings</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42668">[SPARK-42668]</a>[SS] Catch exception while trying to close compressed stream in HDFSStateStoreProvider abort</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42794">[SPARK-42794]</a>[SS] Increase the lockAcquireTimeoutMs to 2 minutes for acquiring the RocksDB state store in Structure Streaming</p></li>
</ul>
</li>
<li><p>March 14, 2023</p>
<ul class="simple">
<li><p>There is a terminology change for adding features to a Delta table using the table property. The preferred syntax is now <code class="docutils literal notranslate"><span class="pre">'delta.feature.featureName'='supported'</span></code> instead of <code class="docutils literal notranslate"><span class="pre">'delta.feature.featureName'='enabled'</span></code>. For backwards compatibility, using <code class="docutils literal notranslate"><span class="pre">'delta.feature.featureName'='enabled'</span></code> still works and will continue to work.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42622">[SPARK-42622]</a>[CORE] Disable substitution in values</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42534">[SPARK-42534]</a>[SQL] Fix DB2Dialect Limit clause</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42635">[SPARK-42635]</a>[SQL] Fix the TimestampAdd expression.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42516">[SPARK-42516]</a>[SQL] Always capture the session time zone config while creating views</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42484">[SPARK-42484]</a> [SQL] UnsafeRowUtils better error message</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41793">[SPARK-41793]</a>[SQL] Incorrect result for window frames defined by a range clause on large decimals</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>February 24, 2023</p>
<ul class="simple">
<li><p>You can now use a unified set of options (<code class="docutils literal notranslate"><span class="pre">host</span></code>, <code class="docutils literal notranslate"><span class="pre">port</span></code>, <code class="docutils literal notranslate"><span class="pre">database</span></code>, <code class="docutils literal notranslate"><span class="pre">user</span></code>, <code class="docutils literal notranslate"><span class="pre">password</span></code>) for connecting to the data sources supported in Query Federation (PostgreSQL, MySQL, Synapse, Snowflake, Redshift, SQL Server). Note that <code class="docutils literal notranslate"><span class="pre">port</span></code> is optional and uses the default port number for each data source if not provided.</p></li>
</ul>
<p><strong>Example of PostgreSQL connection configuration</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CREATE</span> <span class="n">TABLE</span> <span class="n">postgresql_table</span>
<span class="n">USING</span> <span class="n">postgresql</span>
<span class="n">OPTIONS</span> <span class="p">(</span>
  <span class="n">dbtable</span> <span class="s1">&#39;&lt;table-name&gt;&#39;</span><span class="p">,</span>
  <span class="n">host</span> <span class="s1">&#39;&lt;host-name&gt;&#39;</span><span class="p">,</span>
  <span class="n">database</span> <span class="s1">&#39;&lt;database-name&gt;&#39;</span><span class="p">,</span>
  <span class="n">user</span> <span class="s1">&#39;&lt;user&gt;&#39;</span><span class="p">,</span>
  <span class="n">password</span> <span class="n">secret</span><span class="p">(</span><span class="s1">&#39;scope&#39;</span><span class="p">,</span> <span class="s1">&#39;key&#39;</span><span class="p">)</span>
<span class="p">);</span>
</pre></div>
</div>
<p><strong>Example of Snowflake connection configuration</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CREATE</span> <span class="n">TABLE</span> <span class="n">snowflake_table</span>
<span class="n">USING</span> <span class="n">snowflake</span>
<span class="n">OPTIONS</span> <span class="p">(</span>
  <span class="n">dbtable</span> <span class="s1">&#39;&lt;table-name&gt;&#39;</span><span class="p">,</span>
  <span class="n">host</span> <span class="s1">&#39;&lt;host-name&gt;&#39;</span><span class="p">,</span>
  <span class="n">port</span> <span class="s1">&#39;&lt;port-number&gt;&#39;</span><span class="p">,</span>
  <span class="n">database</span> <span class="s1">&#39;&lt;database-name&gt;&#39;</span><span class="p">,</span>
  <span class="n">user</span> <span class="n">secret</span><span class="p">(</span><span class="s1">&#39;snowflake_creds&#39;</span><span class="p">,</span> <span class="s1">&#39;my_username&#39;</span><span class="p">),</span>
  <span class="n">password</span> <span class="n">secret</span><span class="p">(</span><span class="s1">&#39;snowflake_creds&#39;</span><span class="p">,</span> <span class="s1">&#39;my_password&#39;</span><span class="p">),</span>
  <span class="n">schema</span> <span class="s1">&#39;&lt;schema-name&gt;&#39;</span><span class="p">,</span>
  <span class="n">sfWarehouse</span> <span class="s1">&#39;&lt;warehouse-name&gt;&#39;</span>
<span class="p">);</span>
</pre></div>
</div>
<ul class="simple">
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41989">[SPARK-41989]</a>[PYTHON] Avoid breaking logging config from pyspark.pandas</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42346">[SPARK-42346]</a>[SQL] Rewrite distinct aggregates after subquery merge</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41990">[SPARK-41990]</a>[SQL] Use <code class="docutils literal notranslate"><span class="pre">FieldReference.column</span></code> instead of <code class="docutils literal notranslate"><span class="pre">apply</span></code> in V1 to V2 filter conversion</p></li>
<li><p>Revert <a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41848">[SPARK-41848]</a>[CORE] Fixing task over-scheduled with TaskResourceProfile</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42162">[SPARK-42162]</a> Introduce MultiCommutativeOp expression as a memory optimization for canonicalizing large trees of commutative expressions</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>February 16, 2023</p>
<ul class="simple">
<li><p>SYNC command supports syncing recreated Hive Metastore tables. If a HMS table has been SYNCed previously to Unity Catalog but then dropped and recreated, a subsequent re-sync will work instead of throwing TABLE_ALREADY_EXISTS status code.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41219">[SPARK-41219]</a>[SQL] IntegralDivide use decimal(1, 0) to represent 0</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-36173">[SPARK-36173]</a>[CORE] Support getting CPU number in TaskContext</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41848">[SPARK-41848]</a>[CORE] Fixing task over-scheduled with TaskResourceProfile</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42286">[SPARK-42286]</a>[SQL] Fallback to previous codegen code path for complex expr with CAST</p></li>
</ul>
</li>
<li><p>January 31, 2023</p>
<ul class="simple">
<li><p>Creating a schema with a defined location now requires the user to have SELECT and MODIFY privileges on ANY FILE.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41581">[SPARK-41581]</a>[SQL] Assign name to <em>LEGACY</em>ERROR_TEMP_1230</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41996">[SPARK-41996]</a>[SQL][SS] Fix kafka test to verify lost partitions to account for slow Kafka operations</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41580">[SPARK-41580]</a>[SQL] Assign name to <em>LEGACY</em>ERROR_TEMP_2137</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41666">[SPARK-41666]</a>[PYTHON] Support parameterized SQL by <code class="docutils literal notranslate"><span class="pre">sql()</span></code></p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41579">[SPARK-41579]</a>[SQL] Assign name to <em>LEGACY</em>ERROR_TEMP_1249</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41573">[SPARK-41573]</a>[SQL] Assign name to <em>LEGACY</em>ERROR_TEMP_2136</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41574">[SPARK-41574]</a>[SQL] Assign name to <em>LEGACY</em>ERROR_TEMP_2009</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41049">[SPARK-41049]</a>[Followup] Fix a code sync regression for ConvertToLocalRelation</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41576">[SPARK-41576]</a>[SQL] Assign name to <em>LEGACY</em>ERROR_TEMP_2051</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41572">[SPARK-41572]</a>[SQL] Assign name to <em>LEGACY</em>ERROR_TEMP_2149</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41575">[SPARK-41575]</a>[SQL] Assign name to <em>LEGACY</em>ERROR_TEMP_2054</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="databricks-runtime-120-unsupported">
<span id="dbr-120-unsupported"></span><span id="120"></span><h3><a class="toc-backref" href="#id8">Databricks Runtime 12.0 (unsupported)</a><a class="headerlink" href="#databricks-runtime-120-unsupported" title="Permalink to this headline"> </a></h3>
<p>See <a class="reference internal" href="12.0.html"><span class="doc">Databricks Runtime 12.0 (unsupported)</span></a>.</p>
<ul>
<li><p>June 15, 2023</p>
<ul class="simple">
<li><p>Photonized <code class="docutils literal notranslate"><span class="pre">approx_count_distinct</span></code>.</p></li>
<li><p>Snowflake-jdbc library is upgraded to 3.13.29 to address a security issue.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43156">[SPARK-43156]</a><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43098">[SPARK-43098]</a>[SQL] Extend scalar subquery count bug test with decorrelateInnerQuery disabled</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43779">[SPARK-43779]</a>[SQL] <code class="docutils literal notranslate"><span class="pre">ParseToDate</span></code> now loads <code class="docutils literal notranslate"><span class="pre">EvalMode</span></code> in the main thread.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>June 2, 2023</p>
<ul class="simple">
<li><p>The JSON parser in <code class="docutils literal notranslate"><span class="pre">failOnUnknownFields</span></code> mode drops a record in <code class="docutils literal notranslate"><span class="pre">DROPMALFORMED</span></code> mode and fails directly in <code class="docutils literal notranslate"><span class="pre">FAILFAST</span></code> mode.</p></li>
<li><p>Improve the performance of incremental update with <code class="docutils literal notranslate"><span class="pre">SHALLOW</span> <span class="pre">CLONE</span></code> Iceberg and Parquet.</p></li>
<li><p>Fixed an issue in Auto Loader where different source file formats were inconsistent when the provided schema did not include inferred partitions. This issue could cause unexpected failures when reading files with missing columns in the inferred partition schema.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42444">[SPARK-42444]</a>[PYTHON] <code class="docutils literal notranslate"><span class="pre">DataFrame.drop</span></code> now handles duplicated columns properly.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43404">[SPARK-43404]</a>[Backport] Skip reusing sst file for same version of RocksDB state store to avoid ID mismatch error.</p></li>
<li><p>[11.3-13.0][[SPARK-43413]]<a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43413">https://issues.apache.org/jira/browse/SPARK-43413</a>)[SQL] Fixed <code class="docutils literal notranslate"><span class="pre">IN</span></code> subquery <code class="docutils literal notranslate"><span class="pre">ListQuery</span></code> nullability.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43527">[SPARK-43527]</a>[PYTHON] Fixed <code class="docutils literal notranslate"><span class="pre">catalog.listCatalogs</span></code> in PySpark.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43522">[SPARK-43522]</a>[SQL] Fixed creating struct column name with index of array.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43541">[SPARK-43541]</a>[SQL] Propagate all <code class="docutils literal notranslate"><span class="pre">Project</span></code> tags in resolving of expressions and missing columns..</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43340">[SPARK-43340]</a>[CORE] Fixed missing stack trace field in eventlogs.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42937">[SPARK-42937]</a>[SQL] <code class="docutils literal notranslate"><span class="pre">PlanSubqueries</span></code> set <code class="docutils literal notranslate"><span class="pre">InSubqueryExec#shouldBroadcast</span></code> to true.</p></li>
</ul>
</li>
<li><p>May 17, 2023</p>
<ul class="simple">
<li><p>Parquet scans are now robust against OOMs when scanning exceptionally structured files by dynamically adjusting batch size. File metadata is analyzed to preemptively lower batch size and is lowered again on task retries as a final safety net.</p></li>
<li><p>If an Avro file was read with just the <code class="docutils literal notranslate"><span class="pre">failOnUnknownFields\</span></code> option or with Auto Loader in the <code class="docutils literal notranslate"><span class="pre">failOnNewColumns\</span></code> schema evolution mode, columns that have different data types would be read as <code class="docutils literal notranslate"><span class="pre">null\</span></code> instead of throwing an error stating that the file cannot be read. These reads now fail and recommend users to use the <code class="docutils literal notranslate"><span class="pre">rescuedDataColumn\</span></code> option.</p></li>
<li><p>Auto Loader now does the following.</p></li>
<li><ul>
<li><p>Correctly reads and no longer rescues <code class="docutils literal notranslate"><span class="pre">Integer</span></code>, <code class="docutils literal notranslate"><span class="pre">Short</span></code>, <code class="docutils literal notranslate"><span class="pre">Byte</span></code> types if one of these data types are provided, but the Avro file suggests one of the other two types.</p></li>
</ul>
</li>
<li><ul>
<li><p>Prevents reading interval types as date or timestamp types to avoid getting corrupt dates.</p></li>
</ul>
</li>
<li><ul>
<li><p>Prevents reading <code class="docutils literal notranslate"><span class="pre">Decimal</span></code> types with lower precision.</p></li>
</ul>
</li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43172">[SPARK-43172]</a> [CONNECT] Exposes host and token from Spark connect client.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41520">[SPARK-41520]</a>[SQL] Split <code class="docutils literal notranslate"><span class="pre">AND_OR</span></code> tree pattern to separate <code class="docutils literal notranslate"><span class="pre">AND</span></code> and <code class="docutils literal notranslate"><span class="pre">OR</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43098">[SPARK-43098]</a>[SQL] Fixed correctness <code class="docutils literal notranslate"><span class="pre">COUNT</span></code> bug when scalar subquery is grouped by clause.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43190">[SPARK-43190]</a>[SQL] <code class="docutils literal notranslate"><span class="pre">ListQuery.childOutput</span></code> is now consistent with secondary output.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>April 25, 2023</p>
<ul class="simple">
<li><p>If a Parquet file was read with just the <code class="docutils literal notranslate"><span class="pre">failOnUnknownFields</span></code> option or with Auto Loader in the <code class="docutils literal notranslate"><span class="pre">failOnNewColumns</span></code> schema evolution mode, columns that had different data types would be read as <code class="docutils literal notranslate"><span class="pre">null</span></code> instead of throwing an error stating that the file cannot be read. These reads now fail and recommend users to use the <code class="docutils literal notranslate"><span class="pre">rescuedDataColumn</span></code> option.</p></li>
<li><p>Auto Loader now correctly reads and no longer rescues <code class="docutils literal notranslate"><span class="pre">Integer</span></code>, <code class="docutils literal notranslate"><span class="pre">Short</span></code>, <code class="docutils literal notranslate"><span class="pre">Byte</span></code> types if one of these data types are provided. The Parquet file suggests one of the other two types. When the rescued data column was previously enabled, the data type mismatch would cause columns to be rescued even though they were readable.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42971">[SPARK-42971]</a>[CORE] Change to print <code class="docutils literal notranslate"><span class="pre">workdir</span></code> if <code class="docutils literal notranslate"><span class="pre">appDirs</span></code> is null when worker handle <code class="docutils literal notranslate"><span class="pre">WorkDirCleanup</span></code> event</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>April 11, 2023</p>
<ul class="simple">
<li><p>Support legacy data source formats in <code class="docutils literal notranslate"><span class="pre">SYNC</span></code> command.</p></li>
<li><p>Fixes a bug in the %autoreload behavior in notebooks which are outside of a repo.</p></li>
<li><p>Fixed a bug where Auto Loader schema evolution can go into an infinite fail loop, when a new column is detected in the schema of a nested JSON object.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42928">[SPARK-42928]</a>[SQL] Makes <code class="docutils literal notranslate"><span class="pre">resolvePersistentFunction</span></code> synchronized.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42967">[SPARK-42967]</a>[CORE] Fixes <code class="docutils literal notranslate"><span class="pre">SparkListenerTaskStart.stageAttemptId</span></code> when a task starts after the stage is cancelled.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>March 29, 2023</p>
<ul class="simple">
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42794">[SPARK-42794]</a>[SS] Increase the lockAcquireTimeoutMs to 2 minutes for acquiring the RocksDB state store in Structure Streaming</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41162">[SPARK-41162]</a>[SQL] Fix anti- and semi-join for self-join with aggregations</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42403">[SPARK-42403]</a>[CORE] JsonProtocol should handle null JSON strings</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42668">[SPARK-42668]</a>[SS] Catch exception while trying to close compressed stream in HDFSStateStoreProvider abort</p></li>
<li><p>Miscellaneous bug fixes.</p></li>
</ul>
</li>
<li><p>March 14, 2023</p>
<ul class="simple">
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42534">[SPARK-42534]</a>[SQL] Fix DB2Dialect Limit clause</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42622">[SPARK-42622]</a>[CORE] Disable substitution in values</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41793">[SPARK-41793]</a>[SQL] Incorrect result for window frames defined by a range clause on large decimals</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42484">[SPARK-42484]</a>  [SQL] UnsafeRowUtils better error message</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42635">[SPARK-42635]</a>[SQL] Fix the TimestampAdd expression.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42516">[SPARK-42516]</a>[SQL] Always capture the session time zone config while creating views</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>February 24, 2023</p>
<ul>
<li><p>Standardized Connection Options for Query Federation</p>
<p>You can now use a unified set of options (<code class="docutils literal notranslate"><span class="pre">host</span></code>, <code class="docutils literal notranslate"><span class="pre">port</span></code>, <code class="docutils literal notranslate"><span class="pre">database</span></code>, <code class="docutils literal notranslate"><span class="pre">user</span></code>, <code class="docutils literal notranslate"><span class="pre">password</span></code>) for connecting to the data sources supported in Query Federation (PostgreSQL, MySQL, Synapse, Snowflake, Redshift, SQL Server). Note that <code class="docutils literal notranslate"><span class="pre">port</span></code> is optional and will use the default port number for each data source if not provided.</p>
<p><strong>Example of PostgreSQL connection configuration</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CREATE</span> <span class="n">TABLE</span> <span class="n">postgresql_table</span>
<span class="n">USING</span> <span class="n">postgresql</span>
<span class="n">OPTIONS</span> <span class="p">(</span>
  <span class="n">dbtable</span> <span class="s1">&#39;&lt;table-name&gt;&#39;</span><span class="p">,</span>
  <span class="n">host</span> <span class="s1">&#39;&lt;host-name&gt;&#39;</span><span class="p">,</span>
  <span class="n">database</span> <span class="s1">&#39;&lt;database-name&gt;&#39;</span><span class="p">,</span>
  <span class="n">user</span> <span class="s1">&#39;&lt;user&gt;&#39;</span><span class="p">,</span>
  <span class="n">password</span> <span class="n">secret</span><span class="p">(</span><span class="s1">&#39;scope&#39;</span><span class="p">,</span> <span class="s1">&#39;key&#39;</span><span class="p">)</span>
<span class="p">);</span>
</pre></div>
</div>
<p><strong>Example of Snowflake connection configuration</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CREATE</span> <span class="n">TABLE</span> <span class="n">snowflake_table</span>
<span class="n">USING</span> <span class="n">snowflake</span>
<span class="n">OPTIONS</span> <span class="p">(</span>
  <span class="n">dbtable</span> <span class="s1">&#39;&lt;table-name&gt;&#39;</span><span class="p">,</span>
  <span class="n">host</span> <span class="s1">&#39;&lt;host-name&gt;&#39;</span><span class="p">,</span>
  <span class="n">port</span> <span class="s1">&#39;&lt;port-number&gt;&#39;</span><span class="p">,</span>
  <span class="n">database</span> <span class="s1">&#39;&lt;database-name&gt;&#39;</span><span class="p">,</span>
  <span class="n">user</span> <span class="n">secret</span><span class="p">(</span><span class="s1">&#39;snowflake_creds&#39;</span><span class="p">,</span> <span class="s1">&#39;my_username&#39;</span><span class="p">),</span>
  <span class="n">password</span> <span class="n">secret</span><span class="p">(</span><span class="s1">&#39;snowflake_creds&#39;</span><span class="p">,</span> <span class="s1">&#39;my_password&#39;</span><span class="p">),</span>
  <span class="n">schema</span> <span class="s1">&#39;&lt;schema-name&gt;&#39;</span><span class="p">,</span>
  <span class="n">sfWarehouse</span> <span class="s1">&#39;&lt;warehouse-name&gt;&#39;</span>
<span class="p">);</span>
</pre></div>
</div>
</li>
<li><p>Revert <a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41848">[SPARK-41848]</a>[CORE] Fixing task over-scheduled with TaskResourceProfile</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42162">[SPARK-42162]</a> Introduce MultiCommutativeOp expression as a memory optimization for canonicalizing large trees of commutative expressions</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41990">[SPARK-41990]</a>[SQL] Use <code class="docutils literal notranslate"><span class="pre">FieldReference.column</span></code> instead of <code class="docutils literal notranslate"><span class="pre">apply</span></code> in V1 to V2 filter conversion</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42346">[SPARK-42346]</a>[SQL] Rewrite distinct aggregates after subquery merge</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>February 16, 2023</p>
<ul class="simple">
<li><p>Users can now read and write certain Delta tables that require Reader version 3 and Writer version 7, by using Databricks Runtime 9.1 or later. To succeed, table features listed in the tables’ protocol must be supported by the current version of Databricks Runtime.</p></li>
<li><p>SYNC command supports syncing recreated Hive Metastore tables. If a HMS table has been SYNCed previously to Unity Catalog but then dropped and recreated, a subsequent re-sync will work instead of throwing TABLE_ALREADY_EXISTS status code.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-36173">[SPARK-36173]</a>[CORE] Support getting CPU number in TaskContext</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42286">[SPARK-42286]</a>[SQL] Fallback to previous codegen code path for complex expr with CAST</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41848">[SPARK-41848]</a>[CORE] Fixing task over-scheduled with TaskResourceProfile</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41219">[SPARK-41219]</a>[SQL] IntegralDivide use decimal(1, 0) to represent 0</p></li>
</ul>
</li>
<li><p>January 25, 2023</p>
<ul class="simple">
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41660">[SPARK-41660]</a>[SQL] Only propagate metadata columns if they are used</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41379">[SPARK-41379]</a>[SS][PYTHON] Provide cloned spark session in DataFrame in user function for foreachBatch sink in PySpark</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41669">[SPARK-41669]</a>[SQL] Early pruning in canCollapseExpressions</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>January 18, 2023</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">REFRESH</span> <span class="pre">FUNCTION</span></code> SQL command now supports SQL functions and SQL Table functions. For example, the command could be used to refresh a persistent SQL function that was updated in another SQL session.</p></li>
<li><p>Java Database Connectivity (JDBC) data source v1 now supports LIMIT clause pushdown to improve performance in queries. This feature is enabled by default and can be disabled with <code class="docutils literal notranslate"><span class="pre">spark.databricks.optimizer.jdbcDSv1LimitPushdown.enabled</span></code> set to <code class="docutils literal notranslate"><span class="pre">false</span></code>.</p></li>
<li><p>In Legacy Table ACLs clusters, creating functions that reference JVM classes now requires the <code class="docutils literal notranslate"><span class="pre">MODIFY_CLASSPATH</span></code> privilege.</p></li>
<li><p>Java Database Connectivity (JDBC) data source v1 now supports LIMIT clause pushdown to improve performance in queries. This feature is enabled by default and can be disabled with spark.databricks.optimizer.jdbcDSv1LimitPushdown.enabled set to false.</p></li>
<li><p>Azure Synapse connector now returns a more descriptive error message when a column name contains invalid characters such as whitespaces or semicolons. In such cases, the following message will be returned: <code class="docutils literal notranslate"><span class="pre">Azure</span> <span class="pre">Synapse</span> <span class="pre">Analytics</span> <span class="pre">failed</span> <span class="pre">to</span> <span class="pre">execute</span> <span class="pre">the</span> <span class="pre">JDBC</span> <span class="pre">query</span> <span class="pre">produced</span> <span class="pre">by</span> <span class="pre">the</span> <span class="pre">connector.</span> <span class="pre">Make</span> <span class="pre">sure</span> <span class="pre">column</span> <span class="pre">names</span> <span class="pre">do</span> <span class="pre">not</span> <span class="pre">include</span> <span class="pre">any</span> <span class="pre">invalid</span> <span class="pre">characters</span> <span class="pre">such</span> <span class="pre">as</span> <span class="pre">';'</span> <span class="pre">or</span> <span class="pre">whitespace</span></code>.</p></li>
<li><p>Spark structured streaming now works with format(“deltasharing”) on a delta sharing table as a source.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38277">[SPARK-38277]</a>[SS] Clear write batch after RocksDB state store’s commit</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41733">[SPARK-41733]</a>[SQL][SS] Apply tree-pattern based pruning for the rule ResolveWindowTime</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39591">[SPARK-39591]</a>[SS] Async Progress Tracking</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41339">[SPARK-41339]</a>[SQL] Close and recreate RocksDB write batch instead of just clearing</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41198">[SPARK-41198]</a>[SS] Fix metrics in streaming query having CTE and DSv1 streaming source</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41539">[SPARK-41539]</a>[SQL] Remap stats and constraints against output in logical plan for LogicalRDD</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41732">[SPARK-41732]</a>[SQL][SS] Apply tree-pattern based pruning for the rule SessionWindowing</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41862">[SPARK-41862]</a>[SQL] Fix correctness bug related to DEFAULT values in Orc reader</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41199">[SPARK-41199]</a>[SS] Fix metrics issue when DSv1 streaming source and DSv2 streaming source are co-used</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41261">[SPARK-41261]</a>[PYTHON][SS] Fix issue for applyInPandasWithState when the columns of grouping keys are not placed in order from earliest</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>May 17, 2023</p>
<ul class="simple">
<li><p>Parquet scans are now robust against OOMs when scanning exceptionally structured files by dynamically adjusting batch size. File metadata is analyzed to preemptively lower batch size and is lowered again on task retries as a final safety net.</p></li>
<li><p>Fixed a regression that caused Databricks jobs to persist after failing to connect to the metastore during cluster initialization.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41520">[SPARK-41520]</a>[SQL] Split <code class="docutils literal notranslate"><span class="pre">AND_OR</span></code> tree pattern to separate <code class="docutils literal notranslate"><span class="pre">AND</span></code> and <code class="docutils literal notranslate"><span class="pre">OR</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43190">[SPARK-43190]</a>[SQL] <code class="docutils literal notranslate"><span class="pre">ListQuery.childOutput</span></code> is now consistent with secondary output.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>April 25, 2023</p>
<ul class="simple">
<li><p>If a Parquet file was read with just the <code class="docutils literal notranslate"><span class="pre">failOnUnknownFields</span></code> option or with Auto Loader in the <code class="docutils literal notranslate"><span class="pre">failOnNewColumns</span></code> schema evolution mode, columns that had different data types would be read as <code class="docutils literal notranslate"><span class="pre">null</span></code> instead of throwing an error stating that the file cannot be read. These reads now fail and recommend users to use the <code class="docutils literal notranslate"><span class="pre">rescuedDataColumn</span></code> option.</p></li>
<li><p>Auto Loader now correctly reads and no longer rescues <code class="docutils literal notranslate"><span class="pre">Integer</span></code>, <code class="docutils literal notranslate"><span class="pre">Short</span></code>, <code class="docutils literal notranslate"><span class="pre">Byte</span></code> types if one of these data types are provided. The Parquet file suggests one of the other two types. When the rescued data column was previously enabled, the data type mismatch would cause columns to be rescued even though they were readable.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42937">[SPARK-42937]</a>[SQL] <code class="docutils literal notranslate"><span class="pre">PlanSubqueries</span></code> now sets <code class="docutils literal notranslate"><span class="pre">InSubqueryExec#shouldBroadcast</span></code> to true.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>April 11, 2023</p>
<ul class="simple">
<li><p>Support legacy data source formats in SYNC command.</p></li>
<li><p>Fixes a bug in the %autoreload behavior in notebooks which are outside of a repo.</p></li>
<li><p>Fixed a bug where Auto Loader schema evolution can go into an infinite fail loop, when a new column is detected in the schema of a nested JSON object.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42928">[SPARK-42928]</a>[SQL] Make resolvePersistentFunction synchronized.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42967">[SPARK-42967]</a>[CORE] Fix SparkListenerTaskStart.stageAttemptId when a task is started after the stage is cancelled.</p></li>
</ul>
</li>
<li><p>March 29, 2023</p>
<ul class="simple">
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42794">[SPARK-42794]</a>[SS] Increase the lockAcquireTimeoutMs to 2 minutes for acquiring the RocksDB state store in Structure Streaming</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42403">[SPARK-42403]</a>[CORE] JsonProtocol should handle null JSON strings</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42668">[SPARK-42668]</a>[SS] Catch exception while trying to close compressed stream in HDFSStateStoreProvider abort</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>March 14, 2023</p>
<ul class="simple">
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42635">[SPARK-42635]</a>[SQL] Fix the TimestampAdd expression.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41793">[SPARK-41793]</a>[SQL] Incorrect result for window frames defined by a range clause on large decimals</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42484">[SPARK-42484]</a>  [SQL] UnsafeRowUtils better error message</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42534">[SPARK-42534]</a>[SQL] Fix DB2Dialect Limit clause</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41162">[SPARK-41162]</a>[SQL] Fix anti- and semi-join for self-join with aggregations</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42516">[SPARK-42516]</a>[SQL] Always capture the session time zone config while creating views</p></li>
<li><p>Miscellaneous bug fixes.</p></li>
</ul>
</li>
<li><p>February 28, 2023</p>
<ul>
<li><p>Standardized Connection Options for Query Federation</p>
<p>You can now use a unified set of options (<code class="docutils literal notranslate"><span class="pre">host</span></code>, <code class="docutils literal notranslate"><span class="pre">port</span></code>, <code class="docutils literal notranslate"><span class="pre">database</span></code>, <code class="docutils literal notranslate"><span class="pre">user</span></code>, <code class="docutils literal notranslate"><span class="pre">password</span></code>) for connecting to the data sources supported in Query Federation (PostgreSQL, MySQL, Synapse, Snowflake, Redshift, SQL Server). Note that <code class="docutils literal notranslate"><span class="pre">port</span></code> is optional and uses the default port number for each data source if not provided.</p>
<p><strong>Example of PostgreSQL connection configuration</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CREATE</span> <span class="n">TABLE</span> <span class="n">postgresql_table</span>
<span class="n">USING</span> <span class="n">postgresql</span>
<span class="n">OPTIONS</span> <span class="p">(</span>
  <span class="n">dbtable</span> <span class="s1">&#39;&lt;table-name&gt;&#39;</span><span class="p">,</span>
  <span class="n">host</span> <span class="s1">&#39;&lt;host-name&gt;&#39;</span><span class="p">,</span>
  <span class="n">database</span> <span class="s1">&#39;&lt;database-name&gt;&#39;</span><span class="p">,</span>
  <span class="n">user</span> <span class="s1">&#39;&lt;user&gt;&#39;</span><span class="p">,</span>
  <span class="n">password</span> <span class="n">secret</span><span class="p">(</span><span class="s1">&#39;scope&#39;</span><span class="p">,</span> <span class="s1">&#39;key&#39;</span><span class="p">)</span>
<span class="p">);</span>
</pre></div>
</div>
<p><strong>Example of Snowflake connection configuration</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CREATE</span> <span class="n">TABLE</span> <span class="n">snowflake_table</span>
<span class="n">USING</span> <span class="n">snowflake</span>
<span class="n">OPTIONS</span> <span class="p">(</span>
  <span class="n">dbtable</span> <span class="s1">&#39;&lt;table-name&gt;&#39;</span><span class="p">,</span>
  <span class="n">host</span> <span class="s1">&#39;&lt;host-name&gt;&#39;</span><span class="p">,</span>
  <span class="n">port</span> <span class="s1">&#39;&lt;port-number&gt;&#39;</span><span class="p">,</span>
  <span class="n">database</span> <span class="s1">&#39;&lt;database-name&gt;&#39;</span><span class="p">,</span>
  <span class="n">user</span> <span class="n">secret</span><span class="p">(</span><span class="s1">&#39;snowflake_creds&#39;</span><span class="p">,</span> <span class="s1">&#39;my_username&#39;</span><span class="p">),</span>
  <span class="n">password</span> <span class="n">secret</span><span class="p">(</span><span class="s1">&#39;snowflake_creds&#39;</span><span class="p">,</span> <span class="s1">&#39;my_password&#39;</span><span class="p">),</span>
  <span class="n">schema</span> <span class="s1">&#39;&lt;schema-name&gt;&#39;</span><span class="p">,</span>
  <span class="n">sfWarehouse</span> <span class="s1">&#39;&lt;warehouse-name&gt;&#39;</span>
<span class="p">);</span>
</pre></div>
</div>
</li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42286">[SPARK-42286]</a>[SQL] Fallback to previous codegen code path for complex expr with CAST</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41989">[SPARK-41989]</a>[PYTHON] Avoid breaking logging config from pyspark.pandas</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42346">[SPARK-42346]</a>[SQL] Rewrite distinct aggregates after subquery merge</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41360">[SPARK-41360]</a>[CORE] Avoid BlockManager re-registration if the executor has been lost</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42162">[SPARK-42162]</a> Introduce MultiCommutativeOp expression as a memory optimization for canonicalizing large trees of commutative expressions</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41990">[SPARK-41990]</a>[SQL] Use <code class="docutils literal notranslate"><span class="pre">FieldReference.column</span></code> instead of <code class="docutils literal notranslate"><span class="pre">apply</span></code> in V1 to V2 filter conversion</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>February 16, 2023</p>
<ul class="simple">
<li><p>Users can now read and write certain Delta tables that require Reader version 3 and Writer version 7, by using Databricks Runtime 9.1 or later. To succeed, table features listed in the tables’ protocol must be supported by the current version of Databricks Runtime.</p></li>
<li><p>SYNC command supports syncing recreated Hive Metastore tables. If a HMS table has been SYNCed previously to Unity Catalog but then dropped and recreated, a subsequent re-sync will work instead of throwing TABLE_ALREADY_EXISTS status code.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41219">[SPARK-41219]</a>[SQL] IntegralDivide use decimal(1, 0) to represent 0</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40382">[SPARK-40382]</a>[SQL] Group distinct aggregate expressions by semantically equivalent children in <code class="docutils literal notranslate"><span class="pre">RewriteDistinctAggregates</span></code></p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>January 25, 2023</p>
<ul class="simple">
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41379">[SPARK-41379]</a>[SS][PYTHON] Provide cloned spark session in DataFrame in user function for foreachBatch sink in PySpark</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41660">[SPARK-41660]</a>[SQL] Only propagate metadata columns if they are used</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41669">[SPARK-41669]</a>[SQL] Early pruning in canCollapseExpressions</p></li>
<li><p>Miscellaneous bug fixes.</p></li>
</ul>
</li>
<li><p>January 18, 2023</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">REFRESH</span> <span class="pre">FUNCTION</span></code> SQL command now supports SQL functions and SQL Table functions. For example, the command could be used to refresh a persistent SQL function that was updated in another SQL session.</p></li>
<li><p>Java Database Connectivity (JDBC) data source v1 now supports LIMIT clause pushdown to improve performance in queries. This feature is enabled by default and can be disabled with <code class="docutils literal notranslate"><span class="pre">spark.databricks.optimizer.jdbcDSv1LimitPushdown.enabled</span></code> set to <code class="docutils literal notranslate"><span class="pre">false</span></code>.</p></li>
<li><p>Java Database Connectivity (JDBC) data source v1 now supports LIMIT clause pushdown to improve performance in queries. This feature is enabled by default and can be disabled with spark.databricks.optimizer.jdbcDSv1LimitPushdown.enabled set to false.</p></li>
<li><p>Azure Synapse connector now returns a more descriptive error message when a column name contains invalid characters such as whitespaces or semicolons. In such cases, the following message will be returned: <code class="docutils literal notranslate"><span class="pre">Azure</span> <span class="pre">Synapse</span> <span class="pre">Analytics</span> <span class="pre">failed</span> <span class="pre">to</span> <span class="pre">execute</span> <span class="pre">the</span> <span class="pre">JDBC</span> <span class="pre">query</span> <span class="pre">produced</span> <span class="pre">by</span> <span class="pre">the</span> <span class="pre">connector.</span> <span class="pre">Make</span> <span class="pre">sure</span> <span class="pre">column</span> <span class="pre">names</span> <span class="pre">do</span> <span class="pre">not</span> <span class="pre">include</span> <span class="pre">any</span> <span class="pre">invalid</span> <span class="pre">characters</span> <span class="pre">such</span> <span class="pre">as</span> <span class="pre">';'</span> <span class="pre">or</span> <span class="pre">whitespace</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41198">[SPARK-41198]</a>[SS] Fix metrics in streaming query having CTE and DSv1 streaming source</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41862">[SPARK-41862]</a>[SQL] Fix correctness bug related to DEFAULT values in Orc reader</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41539">[SPARK-41539]</a>[SQL] Remap stats and constraints against output in logical plan for LogicalRDD</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39591">[SPARK-39591]</a>[SS] Async Progress Tracking</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41199">[SPARK-41199]</a>[SS] Fix metrics issue when DSv1 streaming source and DSv2 streaming source are co-used</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41261">[SPARK-41261]</a>[PYTHON][SS] Fix issue for applyInPandasWithState when the columns of grouping keys are not placed in order from earliest</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41339">[SPARK-41339]</a>[SQL] Close and recreate RocksDB write batch instead of just clearing</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41732">[SPARK-41732]</a>[SQL][SS] Apply tree-pattern based pruning for the rule SessionWindowing</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38277">[SPARK-38277]</a>[SS] Clear write batch after RocksDB state store’s commit</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>November 29, 2022</p>
<ul class="simple">
<li><p>Users can configure leading and trailing whitespaces’ behavior when writing data using the Redshift connector. The following options have been added to control whitespace handling:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">csvignoreleadingwhitespace</span></code>, when set to <code class="docutils literal notranslate"><span class="pre">true</span></code>, removes leading whitespace from values during writes when <code class="docutils literal notranslate"><span class="pre">tempformat</span></code> is set to <code class="docutils literal notranslate"><span class="pre">CSV</span></code> or <code class="docutils literal notranslate"><span class="pre">CSV</span> <span class="pre">GZIP</span></code>. Whitespaces are retained when the config is set to <code class="docutils literal notranslate"><span class="pre">false</span></code>. By default, the value is <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">csvignoretrailingwhitespace</span></code>, when set to <code class="docutils literal notranslate"><span class="pre">true</span></code>, removes trailing whitespace from values during writes when <code class="docutils literal notranslate"><span class="pre">tempformat</span></code> is set to <code class="docutils literal notranslate"><span class="pre">CSV</span></code> or <code class="docutils literal notranslate"><span class="pre">CSV</span> <span class="pre">GZIP</span></code>. Whitespaces are retained when the config is set to <code class="docutils literal notranslate"><span class="pre">false</span></code>. By default, the value is <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p></li>
</ul>
</li>
<li><p>Fixed a bug with JSON parsing in Auto Loader when all columns were left as strings (<code class="docutils literal notranslate"><span class="pre">cloudFiles.inferColumnTypes</span></code> was not set or set to <code class="docutils literal notranslate"><span class="pre">false</span></code>) and the JSON contained nested objects.</p></li>
<li><p>Upgrade <code class="docutils literal notranslate"><span class="pre">snowflake-jdbc</span></code> dependency to version 3.13.22.</p></li>
<li><p>Table types of JDBC tables are now EXTERNAL by default.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40906">[SPARK-40906]</a>[SQL] <code class="docutils literal notranslate"><span class="pre">Mode</span></code> should copy keys before inserting into Map</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>November 15, 2022</p>
<ul class="simple">
<li><p>Table ACLs and UC Shared clusters now allow the Dataset.toJSON method from python.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40646">[SPARK-40646]</a> JSON parsing for structs, maps, and arrays has been fixed so when a part of a record does not match the schema, the rest of the record can still be parsed correctly instead of returning nulls. To opt-in for the improved behaviour, set <code class="docutils literal notranslate"><span class="pre">spark.sql.json.enablePartialResults</span></code> to <code class="docutils literal notranslate"><span class="pre">true</span></code>. The flag is disabled by default to preserve the original behaviour.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40903">[SPARK-40903]</a>[SQL] Avoid reordering decimal Add for canonicalization if data type is changed</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40618">[SPARK-40618]</a>[SQL] Fix bug in MergeScalarSubqueries rule with nested subqueries using reference tracking</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40697">[SPARK-40697]</a>[SQL] Add read-side char padding to cover external data files</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>November 1, 2022</p>
<p></p>
<ul class="simple">
<li><p>Structured Streaming in Unity Catalog now supports refreshing temporary access tokens. Streaming workloads running with Unity Catalog all purpose or jobs clusters no longer fail after the initial token expiry.</p></li>
</ul>
<ul class="simple">
<li><p>Fixed an issue where if a Delta table had a user-defined column named <code class="docutils literal notranslate"><span class="pre">_change_type</span></code>, but <strong>Change data feed</strong> was disabled on that table, data in that column would incorrectly fill with NULL values when running <code class="docutils literal notranslate"><span class="pre">MERGE</span></code>.</p></li>
<li><p>Fixed an issue where running <code class="docutils literal notranslate"><span class="pre">MERGE</span></code> and using exactly 99 columns from the source in the condition could result in <code class="docutils literal notranslate"><span class="pre">java.lang.ClassCastException:</span> <span class="pre">org.apache.spark.sql.vectorized.ColumnarBatch</span> <span class="pre">cannot</span> <span class="pre">be</span> <span class="pre">cast</span> <span class="pre">to</span> <span class="pre">org.apache.spark.sql.catalyst.InternalRow</span></code>.</p></li>
<li><p>Fixed an issue with Auto Loader where a file can be duplicated in the same micro-batch when <code class="docutils literal notranslate"><span class="pre">allowOverwrites</span></code> is enabled.</p></li>
<li><p>Upgraded Apache commons-text to 1.10.0.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38881">[SPARK-38881]</a>[DSTREAMS][KINESIS][PYSPARK] Added Support for CloudWatch MetricsLevel Config</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40596">[SPARK-40596]</a>[CORE] Populate ExecutorDecommission with messages in ExecutorDecommissionInfo</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40670">[SPARK-40670]</a>[SS][PYTHON] Fix NPE in applyInPandasWithState when the input schema has “non-nullable” column(s)</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="databricks-runtime-112-unsupported">
<span id="dbr-112-unsupported"></span><span id="112"></span><h3><a class="toc-backref" href="#id9">Databricks Runtime 11.2 (unsupported)</a><a class="headerlink" href="#databricks-runtime-112-unsupported" title="Permalink to this headline"> </a></h3>
<p>See <a class="reference internal" href="11.2.html"><span class="doc">Databricks Runtime 11.2 (unsupported)</span></a>.</p>
<ul class="simple">
<li><p>February 28, 2023</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42286">[SPARK-42286]</a>[SQL] Fallback to previous codegen code path for complex expr with CAST</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42346">[SPARK-42346]</a>[SQL] Rewrite distinct aggregates after subquery merge</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>February 16, 2023</p>
<ul>
<li><p>Users can now read and write certain Delta tables that require Reader version 3 and Writer version 7, by using Databricks Runtime 9.1 or later. To succeed, table features listed in the tables’ protocol must be supported by the current version of Databricks Runtime.</p></li>
<li><p>SYNC command supports syncing recreated Hive Metastore tables. If a HMS table has been SYNCed previously to Unity Catalog but then dropped and recreated, a subsequent re-sync will work instead of throwing TABLE_ALREADY_EXISTS status code.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41219">[SPARK-41219]</a>[SQL] IntegralDivide use decimal(1, 0) to represent 0</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>January 31, 2023</p>
<ul>
<li><p>Table types of JDBC tables are now EXTERNAL by default.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41379">[SPARK-41379]</a>[SS][PYTHON] Provide cloned spark session in DataFrame in user function for foreachBatch sink in PySpark</p></li>
</ul>
</li>
<li><p>January 18, 2023</p>
<ul>
<li><p>Azure Synapse connector now returns a more descriptive error message when a column name contains invalid characters such as whitespaces or semicolons. In such cases, the following message will be returned: <code class="docutils literal notranslate"><span class="pre">Azure</span> <span class="pre">Synapse</span> <span class="pre">Analytics</span> <span class="pre">failed</span> <span class="pre">to</span> <span class="pre">execute</span> <span class="pre">the</span> <span class="pre">JDBC</span> <span class="pre">query</span> <span class="pre">produced</span> <span class="pre">by</span> <span class="pre">the</span> <span class="pre">connector.</span> <span class="pre">Make</span> <span class="pre">sure</span> <span class="pre">column</span> <span class="pre">names</span> <span class="pre">do</span> <span class="pre">not</span> <span class="pre">include</span> <span class="pre">any</span> <span class="pre">invalid</span> <span class="pre">characters</span> <span class="pre">such</span> <span class="pre">as</span> <span class="pre">';'</span> <span class="pre">or</span> <span class="pre">whitespace</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41198">[SPARK-41198]</a>[SS] Fix metrics in streaming query having CTE and DSv1 streaming source</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41862">[SPARK-41862]</a>[SQL] Fix correctness bug related to DEFAULT values in Orc reader</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41539">[SPARK-41539]</a>[SQL] Remap stats and constraints against output in logical plan for LogicalRDD</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41199">[SPARK-41199]</a>[SS] Fix metrics issue when DSv1 streaming source and DSv2 streaming source are co-used</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41339">[SPARK-41339]</a>[SQL] Close and recreate RocksDB write batch instead of just clearing</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41732">[SPARK-41732]</a>[SQL][SS] Apply tree-pattern based pruning for the rule SessionWindowing</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38277">[SPARK-38277]</a>[SS] Clear write batch after RocksDB state store’s commit</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>November 29, 2022</p>
<ul>
<li><p>Users can configure leading and trailing whitespaces’ behaviour when writing data using the Redshift connector. The following options have been added to control whitespace handling:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">csvignoreleadingwhitespace</span></code>, when set to <code class="docutils literal notranslate"><span class="pre">true</span></code>, removes leading whitespace from values during writes when <code class="docutils literal notranslate"><span class="pre">tempformat</span></code> is set to <code class="docutils literal notranslate"><span class="pre">CSV</span></code> or <code class="docutils literal notranslate"><span class="pre">CSV</span> <span class="pre">GZIP</span></code>. Whitespaces are retained when the config is set to <code class="docutils literal notranslate"><span class="pre">false</span></code>. By default, the value is <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">csvignoretrailingwhitespace</span></code>, when set to <code class="docutils literal notranslate"><span class="pre">true</span></code>, removes trailing whitespace from values during writes when <code class="docutils literal notranslate"><span class="pre">tempformat</span></code> is set to <code class="docutils literal notranslate"><span class="pre">CSV</span></code> or <code class="docutils literal notranslate"><span class="pre">CSV</span> <span class="pre">GZIP</span></code>. Whitespaces are retained when the config is set to <code class="docutils literal notranslate"><span class="pre">false</span></code>. By default, the value is <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p></li>
</ul>
</li>
<li><p>Fixed a bug with JSON parsing in Auto Loader when all columns were left as strings (<code class="docutils literal notranslate"><span class="pre">cloudFiles.inferColumnTypes</span></code> was not set or set to <code class="docutils literal notranslate"><span class="pre">false</span></code>) and the JSON contained nested objects.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40906">[SPARK-40906]</a>[SQL] <code class="docutils literal notranslate"><span class="pre">Mode</span></code> should copy keys before inserting into Map</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>November 15, 2022</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40646">[SPARK-40646]</a> JSON parsing for structs, maps, and arrays has been fixed so when a part of a record does not match the schema, the rest of the record can still be parsed correctly instead of returning nulls. To opt-in for the improved behaviour, set <code class="docutils literal notranslate"><span class="pre">spark.sql.json.enablePartialResults</span></code> to <code class="docutils literal notranslate"><span class="pre">true</span></code>. The flag is disabled by default to preserve the original behaviour.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40618">[SPARK-40618]</a>[SQL] Fix bug in MergeScalarSubqueries rule with nested subqueries using reference tracking</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40697">[SPARK-40697]</a>[SQL] Add read-side char padding to cover external data files</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>November 1, 2022</p>
<ul>
<li><p>Upgraded Apache commons-text to 1.10.0.</p></li>
<li><p>Fixed an issue where if a Delta table had a user-defined column named <code class="docutils literal notranslate"><span class="pre">_change_type</span></code>, but <strong>Change data feed</strong> was disabled on that table, data in that column would incorrectly fill with NULL values when running <code class="docutils literal notranslate"><span class="pre">MERGE</span></code>.</p></li>
<li><p>Fixed an issue where running <code class="docutils literal notranslate"><span class="pre">MERGE</span></code> and using exactly 99 columns from the source in the condition could result in <code class="docutils literal notranslate"><span class="pre">java.lang.ClassCastException:</span> <span class="pre">org.apache.spark.sql.vectorized.ColumnarBatch</span> <span class="pre">cannot</span> <span class="pre">be</span> <span class="pre">cast</span> <span class="pre">to</span> <span class="pre">org.apache.spark.sql.catalyst.InternalRow</span></code>.</p></li>
<li><p>Fixed an issue with Auto Loader where a file can be duplicated in the same micro-batch when <code class="docutils literal notranslate"><span class="pre">allowOverwrites</span></code> is enabled</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40596">[SPARK-40596]</a>[CORE] Populate ExecutorDecommission with messages in ExecutorDecommissionInfo</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>October 19, 2022</p>
<ul>
<li><p>Fixed an issue with COPY INTO usage with temporary credentials on Unity Catalog enabled clusters / warehouses.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40213">[SPARK-40213]</a>[SQL] Support ASCII value conversion for Latin-1 characters</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>October 5, 2022</p>
<ul>
<li><p>Users can set spark.conf.set(“spark.databricks.io.listKeysWithPrefix.azure.enabled”, “true”) to re-enable native listing for Auto Loader on ADLS Gen2. Native listing was previously turned off due to performance issues, but may have led to an increase in storage costs for customers. This change was rolled out to DBR 10.4 and 9.1 in the previous maintenance update.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40315">[SPARK-40315]</a>[SQL]Support url encode/decode as built-in function and tidy up url-related functions</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40156">[SPARK-40156]</a>[SQL]<code class="docutils literal notranslate"><span class="pre">url_decode()</span></code> should the return an error class</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40169">[SPARK-40169]</a> Don’t pushdown Parquet filters with no reference to data schema</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40460">[SPARK-40460]</a>[SS] Fix streaming metrics when selecting <code class="docutils literal notranslate"><span class="pre">_metadata</span></code></p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40468">[SPARK-40468]</a>[SQL] Fix column pruning in CSV when <em>corrupt</em>record is selected</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40055">[SPARK-40055]</a>[SQL] listCatalogs should also return spark_catalog even when spark_catalog implementation is defaultSessionCatalog</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>September 22, 2022</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40315">[SPARK-40315]</a>[SQL] Add hashCode() for Literal of ArrayBasedMapData</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40389">[SPARK-40389]</a>[SQL] Decimals can’t upcast as integral types if the cast can overflow</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40380">[SPARK-40380]</a>[SQL] Fix constant-folding of InvokeLike to avoid non-serializable literal embedded in the plan</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40066">[SPARK-40066]</a>[SQL][FOLLOW-UP] Check if ElementAt is resolved before getting its dataType</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40109">[SPARK-40109]</a>[SQL] New SQL function: get()</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40066">[SPARK-40066]</a>[SQL] ANSI mode: always return null on invalid access to map column</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40089">[SPARK-40089]</a>[SQL] Fix sorting for some Decimal types</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39887">[SPARK-39887]</a>[SQL] RemoveRedundantAliases should keep aliases that make the output of projection nodes unique</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40152">[SPARK-40152]</a>[SQL] Fix split_part codegen compilation issue</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40235">[SPARK-40235]</a>[CORE] Use interruptible lock instead of synchronized in Executor.updateDependencies()</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40212">[SPARK-40212]</a>[SQL] SparkSQL castPartValue does not properly handle byte, short, or float</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40218">[SPARK-40218]</a>[SQL] GROUPING SETS should preserve the grouping columns</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-35542">[SPARK-35542]</a>[ML] Fix: Bucketizer created for multiple columns with parameters</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40079">[SPARK-40079]</a> Add Imputer inputCols validation for empty input case</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39912">[SPARK-39912]</a><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39828">SPARK-39828</a>[SQL] Refine CatalogImpl</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="databricks-runtime-111-unsupported">
<span id="dbr-111-unsupported"></span><span id="111"></span><h3><a class="toc-backref" href="#id10">Databricks Runtime 11.1 (unsupported)</a><a class="headerlink" href="#databricks-runtime-111-unsupported" title="Permalink to this headline"> </a></h3>
<p>See <a class="reference internal" href="11.1.html"><span class="doc">Databricks Runtime 11.1 (unsupported)</span></a>.</p>
<ul>
<li><p>January 31, 2023</p>
<ul class="simple">
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41379">[SPARK-41379]</a>[SS][PYTHON] Provide cloned spark session in DataFrame in user function for foreachBatch sink in PySpark</p></li>
<li><p>Miscellaneous bug fixes.</p></li>
</ul>
</li>
<li><p>January 18, 2023</p>
<ul class="simple">
<li><p>Azure Synapse connector now returns a more descriptive error message when a column name contains invalid characters such as whitespaces or semicolons. In such cases, the following message will be returned: <code class="docutils literal notranslate"><span class="pre">Azure</span> <span class="pre">Synapse</span> <span class="pre">Analytics</span> <span class="pre">failed</span> <span class="pre">to</span> <span class="pre">execute</span> <span class="pre">the</span> <span class="pre">JDBC</span> <span class="pre">query</span> <span class="pre">produced</span> <span class="pre">by</span> <span class="pre">the</span> <span class="pre">connector.</span> <span class="pre">Make</span> <span class="pre">sure</span> <span class="pre">column</span> <span class="pre">names</span> <span class="pre">do</span> <span class="pre">not</span> <span class="pre">include</span> <span class="pre">any</span> <span class="pre">invalid</span> <span class="pre">characters</span> <span class="pre">such</span> <span class="pre">as</span> <span class="pre">';'</span> <span class="pre">or</span> <span class="pre">whitespace</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41198">[SPARK-41198]</a>[SS] Fix metrics in streaming query having CTE and DSv1 streaming source</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41862">[SPARK-41862]</a>[SQL] Fix correctness bug related to DEFAULT values in Orc reader</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41199">[SPARK-41199]</a>[SS] Fix metrics issue when DSv1 streaming source and DSv2 streaming source are co-used</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41339">[SPARK-41339]</a>[SQL] Close and recreate RocksDB write batch instead of just clearing</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-41732">[SPARK-41732]</a>[SQL][SS] Apply tree-pattern based pruning for the rule SessionWindowing</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38277">[SPARK-38277]</a>[SS] Clear write batch after RocksDB state store’s commit</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>November 29, 2022</p>
<ul class="simple">
<li><p>Users can configure leading and trailing whitespaces’ behaviour when writing data using the Redshift connector. The following options have been added to control whitespace handling:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">csvignoreleadingwhitespace</span></code>, when set to <code class="docutils literal notranslate"><span class="pre">true</span></code>, removes leading whitespace from values during writes when <code class="docutils literal notranslate"><span class="pre">tempformat</span></code> is set to <code class="docutils literal notranslate"><span class="pre">CSV</span></code> or <code class="docutils literal notranslate"><span class="pre">CSV</span> <span class="pre">GZIP</span></code>. Whitespaces are retained when the config is set to <code class="docutils literal notranslate"><span class="pre">false</span></code>. By default, the value is <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">csvignoretrailingwhitespace</span></code>, when set to <code class="docutils literal notranslate"><span class="pre">true</span></code>, removes trailing whitespace from values during writes when <code class="docutils literal notranslate"><span class="pre">tempformat</span></code> is set to <code class="docutils literal notranslate"><span class="pre">CSV</span></code> or <code class="docutils literal notranslate"><span class="pre">CSV</span> <span class="pre">GZIP</span></code>. Whitespaces are retained when the config is set to <code class="docutils literal notranslate"><span class="pre">false</span></code>. By default, the value is <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p></li>
</ul>
</li>
<li><p>Fixed a bug with JSON parsing in Auto Loader when all columns were left as strings (<code class="docutils literal notranslate"><span class="pre">cloudFiles.inferColumnTypes</span></code> was not set or set to <code class="docutils literal notranslate"><span class="pre">false</span></code>) and the JSON contained nested objects.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39650">[SPARK-39650]</a>[SS] Fix incorrect value schema in streaming deduplication with backward compatibility</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>November 15, 2022</p>
<ul class="simple">
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40646">[SPARK-40646]</a> JSON parsing for structs, maps, and arrays has been fixed so when a part of a record does not match the schema, the rest of record can still be parsed correctly instead of returning nulls.To opt-in for the improved behaviour, set <code class="docutils literal notranslate"><span class="pre">spark.sql.json.enablePartialResults</span></code> to <code class="docutils literal notranslate"><span class="pre">true</span></code>. The flag is disabled by default to preserve the original behaviour.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>November 1, 2022</p>
<ul class="simple">
<li><p>Upgraded Apache commons-text to 1.10.0.</p></li>
<li><p>Fixed an issue where if a Delta table had a user-defined column named <code class="docutils literal notranslate"><span class="pre">_change_type</span></code>, but <strong>Change data feed</strong> was disabled on that table, data in that column would incorrectly fill with NULL values when running <code class="docutils literal notranslate"><span class="pre">MERGE</span></code>.</p></li>
<li><p>Fixed an issue where running <code class="docutils literal notranslate"><span class="pre">MERGE</span></code> and using exactly 99 columns from the source in the condition could result in <code class="docutils literal notranslate"><span class="pre">java.lang.ClassCastException:</span> <span class="pre">org.apache.spark.sql.vectorized.ColumnarBatch</span> <span class="pre">cannot</span> <span class="pre">be</span> <span class="pre">cast</span> <span class="pre">to</span> <span class="pre">org.apache.spark.sql.catalyst.InternalRow</span></code>.</p></li>
<li><p>Fixed an issue with Auto Loader where a file can be duplicated in the same micro-batch when <code class="docutils literal notranslate"><span class="pre">allowOverwrites</span></code> is enabled</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40697">[SPARK-40697]</a>[SQL] Add read-side char padding to cover external data files</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40596">[SPARK-40596]</a>[CORE] Populate ExecutorDecommission with messages in ExecutorDecommissionInfo</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>October 18, 2022</p>
<ul class="simple">
<li><p>Fixed an issue with COPY INTO usage with temporary credentials on Unity Catalog enabled clusters / warehouses.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40213">[SPARK-40213]</a>[SQL] Support ASCII value conversion for Latin-1 characters</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>October 5, 2022</p>
<ul class="simple">
<li><p>Users can set spark.conf.set(“spark.databricks.io.listKeysWithPrefix.azure.enabled”, “true”) to re-enable native listing for Auto Loader on ADLS Gen2. Native listing was previously turned off due to performance issues, but may have led to an increase in storage costs for customers. This change was rolled out to DBR 10.4 and 9.1 in the previous maintenance update.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40169">[SPARK-40169]</a> Don’t pushdown Parquet filters with no reference to data schema</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40460">[SPARK-40460]</a>[SS] Fix streaming metrics when selecting <code class="docutils literal notranslate"><span class="pre">_metadata</span></code></p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40468">[SPARK-40468]</a>[SQL] Fix column pruning in CSV when <em>corrupt</em>record is selected</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40055">[SPARK-40055]</a>[SQL] listCatalogs should also return spark_catalog even when spark_catalog implementation is defaultSessionCatalog</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>September 22, 2022</p>
<ul class="simple">
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40315">[SPARK-40315]</a>[SQL] Add hashCode() for Literal of ArrayBasedMapData</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40380">[SPARK-40380]</a>[SQL] Fix constant-folding of InvokeLike to avoid non-serializable literal embedded in the plan</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40089">[SPARK-40089]</a>[SQL] Fix sorting for some Decimal types</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39887">[SPARK-39887]</a>[SQL] RemoveRedundantAliases should keep aliases that make the output of projection nodes unique</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40152">[SPARK-40152]</a>[SQL] Fix split_part codegen compilation issue</p></li>
</ul>
</li>
<li><p>September 6, 2022</p>
<ul class="simple">
<li><p>We have updated the permission model in Table Access Controls (Table ACLs) so that only MODIFY permissions are needed to change a table’s schema or table properties with ALTER TABLE. Previously, these operations required a user to own the table. Ownership is still required to grant permissions on a table, change its owner, change its location, or rename it. This change makes the permission model for Table ACLs more consistent with Unity Catalog.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40235">[SPARK-40235]</a>[CORE] Use interruptible lock instead of synchronized in Executor.updateDependencies()</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40212">[SPARK-40212]</a>[SQL] SparkSQL castPartValue does not properly handle byte, short, or float</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40218">[SPARK-40218]</a>[SQL] GROUPING SETS should preserve the grouping columns</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39976">[SPARK-39976]</a>[SQL] ArrayIntersect should handle null in left expression correctly</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40053">[SPARK-40053]</a>[CORE][SQL][TESTS] Add <code class="docutils literal notranslate"><span class="pre">assume</span></code> to dynamic cancel cases which requiring Python runtime environment</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-35542">[SPARK-35542]</a>[CORE][ML] Fix: Bucketizer created for multiple columns with parameters splitsArray,  inputCols and outputCols can not be loaded after saving it</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40079">[SPARK-40079]</a>[CORE] Add Imputer inputCols validation for empty input case</p></li>
</ul>
</li>
<li><p>August 24, 2022</p>
<ul class="simple">
<li><p>Shares, providers, and recipients now support SQL commands to change owners, comment, rename</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39983">[SPARK-39983]</a>[CORE][SQL] Do not cache unserialized broadcast relations on the driver</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39912">[SPARK-39912]</a><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39828">[SPARK-39828]</a>[SQL] Refine CatalogImpl</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39775">[SPARK-39775]</a>[CORE][AVRO] Disable validate default values when parsing Avro schemas</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39806">[SPARK-39806]</a> Fixed the issue on queries accessing METADATA struct crash on partitioned tables</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39867">[SPARK-39867]</a>[SQL] Global limit should not inherit OrderPreservingUnaryNode</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39962">[SPARK-39962]</a>[PYTHON][SQL] Apply projection when group attributes are empty</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39839">[SPARK-39839]</a>[SQL] Handle special case of null variable-length Decimal with non-zero offsetAndSize in UnsafeRow structural integrity check</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39713">[SPARK-39713]</a>[SQL] ANSI mode: add suggestion of using try_element_at for INVALID_ARRAY_INDEX error</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39847">[SPARK-39847]</a>[SS] Fix race condition in RocksDBLoader.loadLibrary() if caller thread is interrupted</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39731">[SPARK-39731]</a>[SQL] Fix issue in CSV and JSON data sources when parsing dates in “yyyyMMdd” format with CORRECTED time parser policy</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>August 10, 2022</p>
<p></p>
<ul class="simple">
<li><p>For Delta tables with table access control, automatic schema evolution through DML statements such as <code class="docutils literal notranslate"><span class="pre">INSERT</span></code> and <code class="docutils literal notranslate"><span class="pre">MERGE</span></code> is now available for all users who have <code class="docutils literal notranslate"><span class="pre">MODIFY</span></code> permissions on such tables. Additionally, permissions required to perform schema evolution with <code class="docutils literal notranslate"><span class="pre">COPY</span> <span class="pre">INTO</span></code> are now lowered from <code class="docutils literal notranslate"><span class="pre">OWNER</span></code> to <code class="docutils literal notranslate"><span class="pre">MODIFY</span></code> for consistency with other commands. These changes make the table ACL security model more consistent with the Unity Catalog security model as well as with other operations such as replacing a table.</p></li>
</ul>
<ul class="simple">
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39889">[SPARK-39889]</a> Enhance the error message of division by 0</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39795">[SPARK-39795]</a> [SQL] New SQL function: try_to_timestamp</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39749">[SPARK-39749]</a> Always use plain string representation on casting decimal as string under ANSI mode</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39625">[SPARK-39625]</a> Rename df.as to df.to</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39787">[SPARK-39787]</a> [SQL] Use error class in the parsing error of function to_timestamp</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39625">[SPARK-39625]</a> [SQL] Add Dataset.as(StructType)</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39689">[SPARK-39689]</a> Support 2-chars <code class="docutils literal notranslate"><span class="pre">lineSep</span></code> in CSV datasource</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39579">[SPARK-39579]</a> [SQL][PYTHON][R] Make ListFunctions/getFunction/functionExists compatible with 3 layer namespace</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39702">[SPARK-39702]</a> [CORE] Reduce memory overhead of TransportCipher$EncryptedMessage by using a shared byteRawChannel</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39575">[SPARK-39575]</a> [AVRO] add ByteBuffer#rewind after ByteBuffer#get in AvroDeserializer</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39265">[SPARK-39265]</a> [SQL] Fix test failure when SPARK_ANSI_SQL_MODE is enabled</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39441">[SPARK-39441]</a> [SQL] Speed up DeduplicateRelations</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39497">[SPARK-39497]</a> [SQL] Improve the analysis exception of missing map key column</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39476">[SPARK-39476]</a> [SQL] Disable Unwrap cast optimize when casting from Long to Float/ Double or from Integer to Float</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39434">[SPARK-39434]</a> [SQL] Provide runtime error query context when array index is out of bounding</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="databricks-runtime-110-unsupported">
<span id="dbr-110-unsupported"></span><span id="110"></span><h3><a class="toc-backref" href="#id11">Databricks Runtime 11.0 (unsupported)</a><a class="headerlink" href="#databricks-runtime-110-unsupported" title="Permalink to this headline"> </a></h3>
<p>See <a class="reference internal" href="11.0.html"><span class="doc">Databricks Runtime 11.0 (unsupported)</span></a>.</p>
<ul class="simple">
<li><p>November 29, 2022</p>
<ul>
<li><p>Users can configure leading and trailing whitespaces’ behaviour when writing data using the Redshift connector. The following options have been added to control whitespace handling:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">csvignoreleadingwhitespace</span></code>, when set to <code class="docutils literal notranslate"><span class="pre">true</span></code>, removes leading whitespace from values during writes when <code class="docutils literal notranslate"><span class="pre">tempformat</span></code> is set to <code class="docutils literal notranslate"><span class="pre">CSV</span></code> or <code class="docutils literal notranslate"><span class="pre">CSV</span> <span class="pre">GZIP</span></code>. Whitespaces are retained when the config is set to <code class="docutils literal notranslate"><span class="pre">false</span></code>. By default, the value is <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">csvignoretrailingwhitespace</span></code>, when set to <code class="docutils literal notranslate"><span class="pre">true</span></code>, removes trailing whitespace from values during writes when <code class="docutils literal notranslate"><span class="pre">tempformat</span></code> is set to <code class="docutils literal notranslate"><span class="pre">CSV</span></code> or <code class="docutils literal notranslate"><span class="pre">CSV</span> <span class="pre">GZIP</span></code>. Whitespaces are retained when the config is set to <code class="docutils literal notranslate"><span class="pre">false</span></code>. By default, the value is <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p></li>
</ul>
</li>
<li><p>Fixed a bug with JSON parsing in Auto Loader when all columns were left as strings (<code class="docutils literal notranslate"><span class="pre">cloudFiles.inferColumnTypes</span></code> was not set or set to <code class="docutils literal notranslate"><span class="pre">false</span></code>) and the JSON contained nested objects.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39650">[SPARK-39650]</a>[SS] Fix incorrect value schema in streaming deduplication with backward compatibility</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>November 15, 2022</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40646">[SPARK-40646]</a> JSON parsing for structs, maps, and arrays has been fixed so when a part of a record does not match the schema, the rest of the record can still be parsed correctly instead of returning nulls. To opt-in for the improved behaviour, set <code class="docutils literal notranslate"><span class="pre">spark.sql.json.enablePartialResults</span></code> to <code class="docutils literal notranslate"><span class="pre">true</span></code>. The flag is disabled by default to preserve the original behaviour.</p></li>
</ul>
</li>
<li><p>November 1, 2022</p>
<ul>
<li><p>Upgraded Apache commons-text to 1.10.0.</p></li>
<li><p>Fixed an issue where if a Delta table had a user-defined column named <code class="docutils literal notranslate"><span class="pre">_change_type</span></code>, but <strong>Change data feed</strong> was disabled on that table, data in that column would incorrectly fill with NULL values when running <code class="docutils literal notranslate"><span class="pre">MERGE</span></code>.</p></li>
<li><p>Fixed an issue with Auto Loader where a file can be duplicated in the same micro-batch when <code class="docutils literal notranslate"><span class="pre">allowOverwrites</span></code> is enabled</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40697">[SPARK-40697]</a>[SQL] Add read-side char padding to cover external data files</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40596">[SPARK-40596]</a>[CORE] Populate ExecutorDecommission with messages in ExecutorDecommissionInfo</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>October 18, 2022</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40213">[SPARK-40213]</a>[SQL] Support ASCII value conversion for Latin-1 characters</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>October 5, 2022</p>
<ul>
<li><p>Users can set spark.conf.set(“spark.databricks.io.listKeysWithPrefix.azure.enabled”, “true”) to re-enable native listing for Auto Loader on ADLS Gen2. Native listing was previously turned off due to performance issues, but may have led to an increase in storage costs for customers. This change was rolled out to DBR 10.4 and 9.1 in the previous maintenance update.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40169">[SPARK-40169]</a> Don’t pushdown Parquet filters with no reference to data schema</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40460">[SPARK-40460]</a>[SS] Fix streaming metrics when selecting <code class="docutils literal notranslate"><span class="pre">_metadata</span></code></p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40468">[SPARK-40468]</a>[SQL] Fix column pruning in CSV when <em>corrupt</em>record is selected</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>September 22, 2022</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40315">[SPARK-40315]</a>[SQL] Add hashCode() for Literal of ArrayBasedMapData</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40380">[SPARK-40380]</a>[SQL] Fix constant-folding of InvokeLike to avoid non-serializable literal embedded in the plan</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40089">[SPARK-40089]</a>[SQL] Fix sorting for some Decimal types</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39887">[SPARK-39887]</a>[SQL] RemoveRedundantAliases should keep aliases that make the output of projection nodes unique</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40152">[SPARK-40152]</a>[SQL] Fix split_part codegen compilation issue</p></li>
</ul>
</li>
<li><p>September 6, 2022</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40235">[SPARK-40235]</a>[CORE] Use interruptible lock instead of synchronized in Executor.updateDependencies()</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40212">[SPARK-40212]</a>[SQL] SparkSQL castPartValue does not properly handle byte, short, or float</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40218">[SPARK-40218]</a>[SQL] GROUPING SETS should preserve the grouping columns</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39976">[SPARK-39976]</a>[SQL] ArrayIntersect should handle null in left expression correctly</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40053">[SPARK-40053]</a>[CORE][SQL][TESTS] Add <code class="docutils literal notranslate"><span class="pre">assume</span></code> to dynamic cancel cases which requiring Python runtime environment</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-35542">[SPARK-35542]</a>[CORE][ML] Fix: Bucketizer created for multiple columns with parameters splitsArray,  inputCols and outputCols can not be loaded after saving it</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40079">[SPARK-40079]</a>[CORE] Add Imputer inputCols validation for empty input case</p></li>
</ul>
</li>
<li><p>August 24, 2022</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39983">[SPARK-39983]</a>[CORE][SQL] Do not cache unserialized broadcast relations on the driver</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39775">[SPARK-39775]</a>[CORE][AVRO] Disable validate default values when parsing Avro schemas</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39806">[SPARK-39806]</a> Fixed the issue on queries accessing METADATA struct crash on partitioned tables</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39867">[SPARK-39867]</a>[SQL] Global limit should not inherit OrderPreservingUnaryNode</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39962">[SPARK-39962]</a>[PYTHON][SQL] Apply projection when group attributes are empty</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>August 9, 2022</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39713">[SPARK-39713]</a>[SQL] ANSI mode: add suggestion of using try_element_at for INVALID_ARRAY_INDEX error</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39847">[SPARK-39847]</a> Fix race condition in RocksDBLoader.loadLibrary() if caller thread is interrupted</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39731">[SPARK-39731]</a>[SQL] Fix issue in CSV and JSON data sources when parsing dates in “yyyyMMdd” format with CORRECTED time parser policy</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39889">[SPARK-39889]</a> Enhance the error message of division by 0</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39795">[SPARK-39795]</a>[SQL] New SQL function: try_to_timestamp</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39749">[SPARK-39749]</a> Always use plain string representation on casting decimal as string under ANSI mode</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39625">[SPARK-39625]</a>[SQL] Add Dataset.to(StructType)</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39787">[SPARK-39787]</a>[SQL] Use error class in the parsing error of function to_timestamp</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>July 27, 2022</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39689">[SPARK-39689]</a>Support 2-chars <code class="docutils literal notranslate"><span class="pre">lineSep</span></code> in CSV datasource</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39104">[SPARK-39104]</a>[SQL] InMemoryRelation#isCachedColumnBuffersLoaded should be thread-safe</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39702">[SPARK-39702]</a>[CORE] Reduce memory overhead of TransportCipher$EncryptedMessage by using a shared byteRawChannel</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39575">[SPARK-39575]</a>[AVRO] add ByteBuffer#rewind after ByteBuffer#get in AvroDeserializer</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39497">[SPARK-39497]</a>[SQL] Improve the analysis exception of missing map key column</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39441">[SPARK-39441]</a>[SQL] Speed up DeduplicateRelations</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39476">[SPARK-39476]</a>[SQL] Disable Unwrap cast optimize when casting from Long to Float/ Double or from Integer to Float</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39434">[SPARK-39434]</a>[SQL] Provide runtime error query context when array index is out of bounding</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39570">[SPARK-39570]</a>[SQL] Inline table should allow expressions with alias</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>July 13, 2022</p>
<ul>
<li><p>Make Delta MERGE operation results consistent when source is non-deterministic.</p></li>
<li><p>Fixed an issue for the cloud_files_state TVF when running on non-DBFS paths.</p></li>
<li><p>Disabled Auto Loader’s use of native cloud APIs for directory listing on Azure.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38796">[SPARK-38796]</a>[SQL] Update to_number and try_to_number functions to allow PR with positive numbers</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39272">[SPARK-39272]</a>[SQL] Increase the start position of query context by 1</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39419">[SPARK-39419]</a>[SQL] Fix ArraySort to throw an exception when the comparator returns null</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>July 5, 2022</p>
<ul>
<li><p>Improvement on error messages for a range of error classes.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39451">[SPARK-39451]</a>[SQL] Support casting intervals to integrals in ANSI mode</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39361">[SPARK-39361]</a> Don’t use Log4J2’s extended throwable conversion pattern in default logging configurations</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39354">[SPARK-39354]</a>[SQL] Ensure show <code class="docutils literal notranslate"><span class="pre">Table</span> <span class="pre">or</span> <span class="pre">view</span> <span class="pre">not</span> <span class="pre">found</span></code> even if there are <code class="docutils literal notranslate"><span class="pre">dataTypeMismatchError</span></code> related to <code class="docutils literal notranslate"><span class="pre">Filter</span></code> at the same time</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38675">[SPARK-38675]</a>[CORE] Fix race during unlock in BlockInfoManager</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39392">[SPARK-39392]</a>[SQL] Refine ANSI error messages for try_* function hints</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39214">[SPARK-39214]</a>[SQL][3.3] Improve errors related to CAST</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-37939">[SPARK-37939]</a>[SQL] Use error classes in the parsing errors of properties</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39085">[SPARK-39085]</a>[SQL] Move the error message of <code class="docutils literal notranslate"><span class="pre">INCONSISTENT_BEHAVIOR_CROSS_VERSION</span></code> to error-classes.json</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39376">[SPARK-39376]</a>[SQL] Hide duplicated columns in star expansion of subquery alias from NATURAL/USING JOIN</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39283">[SPARK-39283]</a>[CORE] Fix deadlock between TaskMemoryManager and UnsafeExternalSorter.SpillableIterator</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39285">[SPARK-39285]</a>[SQL] Spark should not check field names when reading files</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="databricks-runtime-105-unsupported">
<span id="dbr-105-unsupported"></span><span id="105"></span><h3><a class="toc-backref" href="#id12">Databricks Runtime 10.5 (unsupported)</a><a class="headerlink" href="#databricks-runtime-105-unsupported" title="Permalink to this headline"> </a></h3>
<p>See <a class="reference internal" href="10.5.html"><span class="doc">Databricks Runtime 10.5 (unsupported)</span></a>.</p>
<ul class="simple">
<li><p>November 1, 2022</p>
<ul>
<li><p>Fixed an issue where if a Delta table had a user-defined column named <code class="docutils literal notranslate"><span class="pre">_change_type</span></code>, but <strong>Change data feed</strong> was disabled on that table, data in that column would incorrectly fill with NULL values when running <code class="docutils literal notranslate"><span class="pre">MERGE</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40697">[SPARK-40697]</a>[SQL] Add read-side char padding to cover external data files</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40596">[SPARK-40596]</a>[CORE] Populate ExecutorDecommission with messages in ExecutorDecommissionInfo</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>October 18, 2022</p>
<ul>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>October 5, 2022</p>
<ul>
<li><p>Users can set spark.conf.set(“spark.databricks.io.listKeysWithPrefix.azure.enabled”, “true”) to re-enable native listing for Auto Loader on ADLS Gen2. Native listing was previously turned off due to performance issues, but may have led to an increase in storage costs for customers. This change was rolled out to DBR 10.4 and 9.1 in the previous maintenance update.</p></li>
<li><p>reload4j has been upgraded to 1.2.19 to fix vulnerabilities.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40460">[SPARK-40460]</a>[SS] Fix streaming metrics when selecting <code class="docutils literal notranslate"><span class="pre">_metadata</span></code></p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40468">[SPARK-40468]</a>[SQL] Fix column pruning in CSV when <em>corrupt</em>record is selected</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>September 22, 2022</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40315">[SPARK-40315]</a>[SQL] Add hashCode() for Literal of ArrayBasedMapData</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40213">[SPARK-40213]</a>[SQL] Support ASCII value conversion for Latin-1 characters</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40380">[SPARK-40380]</a>[SQL] Fix constant-folding of InvokeLike to avoid non-serializable literal embedded in the plan</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38404">[SPARK-38404]</a>[SQL] Improve CTE resolution when a nested CTE references an outer CTE</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40089">[SPARK-40089]</a>[SQL] Fix sorting for some Decimal types</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39887">[SPARK-39887]</a>[SQL] RemoveRedundantAliases should keep aliases that make the output of projection nodes unique</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>September 6, 2022</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40235">[SPARK-40235]</a>[CORE] Use interruptible lock instead of synchronized in Executor.updateDependencies()</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39976">[SPARK-39976]</a>[SQL] ArrayIntersect should handle null in left expression correctly</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40053">[SPARK-40053]</a>[CORE][SQL][TESTS] Add <code class="docutils literal notranslate"><span class="pre">assume</span></code> to dynamic cancel cases which requiring Python runtime environment</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-35542">[SPARK-35542]</a>[CORE][ML] Fix: Bucketizer created for multiple columns with parameters splitsArray,  inputCols and outputCols can not be loaded after saving it</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40079">[SPARK-40079]</a>[CORE] Add Imputer inputCols validation for empty input case</p></li>
</ul>
</li>
<li><p>August 24, 2022</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39983">[SPARK-39983]</a>[CORE][SQL] Do not cache unserialized broadcast relations on the driver</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39775">[SPARK-39775]</a>[CORE][AVRO] Disable validate default values when parsing Avro schemas</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39806">[SPARK-39806]</a> Fixed the issue on queries accessing METADATA struct crash on partitioned tables</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39962">[SPARK-39962]</a>[PYTHON][SQL] Apply projection when group attributes are empty</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-37643">[SPARK-37643]</a>[SQL] when charVarcharAsString is true, for char datatype predicate query should skip rpadding rule</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>August 9, 2022</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39847">[SPARK-39847]</a> Fix race condition in RocksDBLoader.loadLibrary() if caller thread is interrupted</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39731">[SPARK-39731]</a>[SQL] Fix issue in CSV and JSON data sources when parsing dates in “yyyyMMdd” format with CORRECTED time parser policy</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>July 27, 2022</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39625">[SPARK-39625]</a>[SQL] Add Dataset.as(StructType)</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39689">[SPARK-39689]</a>Support 2-chars <code class="docutils literal notranslate"><span class="pre">lineSep</span></code> in CSV datasource</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39104">[SPARK-39104]</a>[SQL] InMemoryRelation#isCachedColumnBuffersLoaded should be thread-safe</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39570">[SPARK-39570]</a>[SQL] Inline table should allow expressions with alias</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39702">[SPARK-39702]</a>[CORE] Reduce memory overhead of TransportCipher$EncryptedMessage by using a shared byteRawChannel</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39575">[SPARK-39575]</a>[AVRO] add ByteBuffer#rewind after ByteBuffer#get in AvroDeserializer</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39476">[SPARK-39476]</a>[SQL] Disable Unwrap cast optimize when casting from Long to Float/ Double or from Integer to Float</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>July 13, 2022</p>
<ul>
<li><p>Make Delta MERGE operation results consistent when source is non-deterministic.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39355">[SPARK-39355]</a>[SQL] Single column uses quoted to construct UnresolvedAttribute</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39548">[SPARK-39548]</a>[SQL] CreateView Command with a window clause query hit a wrong window definition not found issue</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39419">[SPARK-39419]</a>[SQL] Fix ArraySort to throw an exception when the comparator returns null</p></li>
<li><p>Disabled Auto Loader’s use of native cloud APIs for directory listing on Azure.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>July 5, 2022</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39376">[SPARK-39376]</a>[SQL] Hide duplicated columns in star expansion of subquery alias from NATURAL/USING JOIN</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>June 15, 2022</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39283">[SPARK-39283]</a>[CORE] Fix deadlock between TaskMemoryManager and UnsafeExternalSorter.SpillableIterator</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39285">[SPARK-39285]</a>[SQL] Spark should not check field names when reading files</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-34096">[SPARK-34096]</a>[SQL] Improve performance for nth_value ignore nulls over offset window</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-36718">[SPARK-36718]</a>[SQL][FOLLOWUP] Fix the <code class="docutils literal notranslate"><span class="pre">isExtractOnly</span></code> check in CollapseProject</p></li>
</ul>
</li>
<li><p>June 2, 2022</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39166">[SPARK-39166]</a>[SQL] Provide runtime error query context for binary arithmetic when WSCG is off</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39093">[SPARK-39093]</a>[SQL] Avoid codegen compilation error when dividing year-month intervals or day-time intervals by an integral</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38990">[SPARK-38990]</a>[SQL] Avoid NullPointerException when evaluating date_trunc/trunc format as a bound reference</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>May 18, 2022</p>
<ul>
<li><p>Fixes a potential native memory leak in Auto Loader.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38868">[SPARK-38868]</a>[SQL]Don’t propagate exceptions from filter predicate when optimizing outer joins</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38796">[SPARK-38796]</a>[SQL] Implement the to_number and try_to_number SQL functions according to a new specification</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38918">[SPARK-38918]</a>[SQL] Nested column pruning should filter out attributes that do not belong to the current relation</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38929">[SPARK-38929]</a>[SQL] Improve error messages for cast failures in ANSI</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38926">[SPARK-38926]</a>[SQL] Output types in error messages in SQL style</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39084">[SPARK-39084]</a>[PYSPARK] Fix df.rdd.isEmpty() by using TaskContext to stop iterator on task completion</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-32268">[SPARK-32268]</a>[SQL] Add ColumnPruning in injectBloomFilter</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38908">[SPARK-38908]</a>[SQL] Provide query context in runtime error of Casting from String to Number/Date/Timestamp/Boolean</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39046">[SPARK-39046]</a>[SQL] Return an empty context string if TreeNode.origin is wrongly set</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38974">[SPARK-38974]</a>[SQL] Filter registered functions with a given database name in list functions</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38762">[SPARK-38762]</a>[SQL] Provide query context in Decimal overflow errors</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38931">[SPARK-38931]</a>[SS] Create root dfs directory for RocksDBFileManager with unknown number of keys on 1st checkpoint</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38992">[SPARK-38992]</a>[CORE] Avoid using bash -c in ShellBasedGroupsMappingProvider</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38716">[SPARK-38716]</a>[SQL] Provide query context in map key not exists error</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38889">[SPARK-38889]</a>[SQL] Compile boolean column filters to use the bit type for MSSQL data source</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38698">[SPARK-38698]</a>[SQL] Provide query context in runtime error of Divide/Div/Reminder/Pmod</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38823">[SPARK-38823]</a>[SQL] Make <code class="docutils literal notranslate"><span class="pre">NewInstance</span></code> non-foldable to fix aggregation buffer corruption issue</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38809">[SPARK-38809]</a>[SS] Implement option to skip null values in symmetric hash implementation of stream-stream joins</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38676">[SPARK-38676]</a>[SQL] Provide SQL query context in runtime error message of Add/Subtract/Multiply</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38677">[SPARK-38677]</a>[PYSPARK] Python MonitorThread should detect deadlock due to blocking I/O</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="databricks-runtime-103-unsupported">
<span id="dbr-103-unsupported"></span><span id="103"></span><h3><a class="toc-backref" href="#id13">Databricks Runtime 10.3 (Unsupported)</a><a class="headerlink" href="#databricks-runtime-103-unsupported" title="Permalink to this headline"> </a></h3>
<p>See <a class="reference internal" href="10.3.html"><span class="doc">Databricks Runtime 10.3 (unsupported)</span></a>.</p>
<ul class="simple">
<li><p>July 27, 2022</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39689">[SPARK-39689]</a>Support 2-chars <code class="docutils literal notranslate"><span class="pre">lineSep</span></code> in CSV datasource</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39104">[SPARK-39104]</a>[SQL] InMemoryRelation#isCachedColumnBuffersLoaded should be thread-safe</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39702">[SPARK-39702]</a>[CORE] Reduce memory overhead of TransportCipher$EncryptedMessage by using a shared byteRawChannel</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>July 20, 2022</p>
<ul>
<li><p>Make Delta MERGE operation results consistent when source is non-deterministic.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39476">[SPARK-39476]</a>[SQL] Disable Unwrap cast optimize when casting from Long to Float/ Double or from Integer to Float</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39548">[SPARK-39548]</a>[SQL] CreateView Command with a window clause query hit a wrong window definition not found issue</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39419">[SPARK-39419]</a>[SQL] Fix ArraySort to throw an exception when the comparator returns null</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>July 5, 2022</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39376">[SPARK-39376]</a>[SQL] Hide duplicated columns in star expansion of subquery alias from NATURAL/USING JOIN</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>June 15, 2022</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39283">[SPARK-39283]</a>[CORE] Fix deadlock between TaskMemoryManager and UnsafeExternalSorter.SpillableIterator</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39285">[SPARK-39285]</a>[SQL] Spark should not check field names when reading files</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-34096">[SPARK-34096]</a>[SQL] Improve performance for nth_value ignore nulls over offset window</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-36718">[SPARK-36718]</a>[SQL][FOLLOWUP] Fix the <code class="docutils literal notranslate"><span class="pre">isExtractOnly</span></code> check in CollapseProject</p></li>
</ul>
</li>
<li><p>June 2, 2022</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38990">[SPARK-38990]</a>[SQL] Avoid NullPointerException when evaluating date_trunc/trunc format as a bound reference</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>May 18, 2022</p>
<ul>
<li><p>Fixes a potential native memory leak in Auto Loader.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38918">[SPARK-38918]</a>[SQL] Nested column pruning should filter out attributes that do not belong to the current relation</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-37593">[SPARK-37593]</a>[CORE] Reduce default page size by LONG_ARRAY_OFFSET if G1GC and ON_HEAP are used</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39084">[SPARK-39084]</a>[PYSPARK] Fix df.rdd.isEmpty() by using TaskContext to stop iterator on task completion</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-32268">[SPARK-32268]</a>[SQL] Add ColumnPruning in injectBloomFilter</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38974">[SPARK-38974]</a>[SQL] Filter registered functions with a given database name in list functions</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38889">[SPARK-38889]</a>[SQL] Compile boolean column filters to use the bit type for MSSQL data source</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>May 4, 2022</p>
<ul>
<li><p>Upgraded Java AWS SDK from version 1.11.655 to 1.12.1899.</p></li>
</ul>
</li>
<li><p>April 19, 2022</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38616">[SPARK-38616]</a>[SQL] Keep track of SQL query text in Catalyst TreeNode</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>April 6, 2022</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38631">[SPARK-38631]</a>[CORE] Uses Java-based implementation for un-tarring at Utils.unpack</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>March 22, 2022</p>
<ul>
<li><p>Changed the current working directory of notebooks on High Concurrency clusters with either table access control or credential passthrough enabled to the user’s home directory. Previously, the working directory was <code class="docutils literal notranslate"><span class="pre">/databricks/driver</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38437">[SPARK-38437]</a>[SQL] Lenient serialization of datetime from datasource</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38180">[SPARK-38180]</a>[SQL] Allow safe up-cast expressions in correlated equality predicates</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38155">[SPARK-38155]</a>[SQL] Disallow distinct aggregate in lateral subqueries with unsupported predicates</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38325">[SPARK-38325]</a>[SQL] ANSI mode: avoid potential runtime error in HashJoin.extractKeyExprAt()</p></li>
</ul>
</li>
<li><p>March 14, 2022</p>
<ul>
<li><p>Improved transaction conflict detection for empty transactions in Delta Lake.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38185">[SPARK-38185]</a>[SQL] Fix data incorrect if aggregate function is empty</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38318">[SPARK-38318]</a>[SQL] regression when replacing a dataset view</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38236">[SPARK-38236]</a>[SQL] Absolute file paths specified in create/alter table are treated as relative</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-35937">[SPARK-35937]</a>[SQL] Extracting date field from timestamp should work in ANSI mode</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-34069">[SPARK-34069]</a>[SQL] Kill barrier tasks should respect <code class="docutils literal notranslate"><span class="pre">SPARK_JOB_INTERRUPT_ON_CANCEL</span></code></p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-37707">[SPARK-37707]</a>[SQL] Allow store assignment between TimestampNTZ and Date/Timestamp</p></li>
</ul>
</li>
<li><p>February 23, 2022</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-27442">[SPARK-27442]</a>[SQL] Remove check field name when reading/writing data in parquet</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="databricks-runtime-102-unsupported">
<span id="dbr-102-unsupported"></span><span id="102"></span><h3><a class="toc-backref" href="#id14">Databricks Runtime 10.2 (unsupported)</a><a class="headerlink" href="#databricks-runtime-102-unsupported" title="Permalink to this headline"> </a></h3>
<p>See <a class="reference internal" href="10.2.html"><span class="doc">Databricks Runtime 10.2 (unsupported)</span></a>.</p>
<ul class="simple">
<li><p>June 15, 2022</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39283">[SPARK-39283]</a>[CORE] Fix deadlock between TaskMemoryManager and UnsafeExternalSorter.SpillableIterator</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39285">[SPARK-39285]</a>[SQL] Spark should not check field names when reading files</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-34096">[SPARK-34096]</a>[SQL] Improve performance for nth_value ignore nulls over offset window</p></li>
</ul>
</li>
<li><p>June 2, 2022</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38918">[SPARK-38918]</a>[SQL] Nested column pruning should filter out attributes that do not belong to the current relation</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38990">[SPARK-38990]</a>[SQL] Avoid NullPointerException when evaluating date_trunc/trunc format as a bound reference</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>May 18, 2022</p>
<ul>
<li><p>Fixes a potential native memory leak in Auto Loader.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39084">[SPARK-39084]</a>[PYSPARK] Fix df.rdd.isEmpty() by using TaskContext to stop iterator on task completion</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38889">[SPARK-38889]</a>[SQL] Compile boolean column filters to use the bit type for MSSQL data source</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38931">[SPARK-38931]</a>[SS] Create root dfs directory for RocksDBFileManager with unknown number of keys on 1st checkpoint</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>May 4, 2022</p>
<ul>
<li><p>Upgraded Java AWS SDK from version 1.11.655 to 1.12.1899.</p></li>
</ul>
</li>
<li><p>April 19, 2022</p>
<ul>
<li><p>Operating system security updates.</p></li>
<li><p>Miscellaneous bug fixes.</p></li>
</ul>
</li>
<li><p>April 6, 2022</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38631">[SPARK-38631]</a>[CORE] Uses Java-based implementation for un-tarring at Utils.unpack</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>March 22, 2022</p>
<ul>
<li><p>Changed the current working directory of notebooks on High Concurrency clusters with either table access control or credential passthrough enabled to the user’s home directory. Previously, the working directory was <code class="docutils literal notranslate"><span class="pre">/databricks/driver</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38437">[SPARK-38437]</a>[SQL] Lenient serialization of datetime from datasource</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38180">[SPARK-38180]</a>[SQL] Allow safe up-cast expressions in correlated equality predicates</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38155">[SPARK-38155]</a>[SQL] Disallow distinct aggregate in lateral subqueries with unsupported predicates</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38325">[SPARK-38325]</a>[SQL] ANSI mode: avoid potential runtime error in HashJoin.extractKeyExprAt()</p></li>
</ul>
</li>
<li><p>March 14, 2022</p>
<ul>
<li><p>Improved transaction conflict detection for empty transactions in Delta Lake.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38185">[SPARK-38185]</a>[SQL] Fix data incorrect if aggregate function is empty</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38318">[SPARK-38318]</a>[SQL] regression when replacing a dataset view</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38236">[SPARK-38236]</a>[SQL] Absolute file paths specified in create/alter table are treated as relative</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-35937">[SPARK-35937]</a>[SQL] Extracting date field from timestamp should work in ANSI mode</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-34069">[SPARK-34069]</a>[SQL] Kill barrier tasks should respect <code class="docutils literal notranslate"><span class="pre">SPARK_JOB_INTERRUPT_ON_CANCEL</span></code></p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-37707">[SPARK-37707]</a>[SQL] Allow store assignment between TimestampNTZ and Date/Timestamp</p></li>
</ul>
</li>
<li><p>February 23, 2022</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-37577">[SPARK-37577]</a>[SQL] Fix ClassCastException: ArrayType cannot be cast to StructType for Generate Pruning</p></li>
</ul>
</li>
<li><p>February 8, 2022</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-27442">[SPARK-27442]</a>[SQL] Remove check field name when reading/writing data in parquet.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>February 1, 2022</p>
<ul>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>January 26, 2022</p>
<ul>
<li><p>Fixed a bug where concurrent transactions on Delta tables could commit in a non-serializable order under certain rare conditions.</p></li>
<li><p>Fixed a bug where the OPTIMIZE command could fail when the ANSI SQL dialect was enabled.</p></li>
</ul>
</li>
<li><p>January 19, 2022</p>
<ul>
<li><p>Introduced support for inlining temporary credentials to COPY INTO for loading the source data without requiring SQL ANY_FILE permissions</p></li>
<li><p>Bug fixes and security enhancements.</p></li>
</ul>
</li>
<li><p>December 20, 2021</p>
<ul>
<li><p>Fixed a rare bug with Parquet column index based filtering.</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="databricks-runtime-101-unsupported">
<span id="dbr-101-unsupported"></span><span id="101"></span><h3><a class="toc-backref" href="#id15">Databricks Runtime 10.1 (unsupported)</a><a class="headerlink" href="#databricks-runtime-101-unsupported" title="Permalink to this headline"> </a></h3>
<p>See <a class="reference internal" href="10.1.html"><span class="doc">Databricks Runtime 10.1 (unsupported)</span></a>.</p>
<ul class="simple">
<li><p>June 15, 2022</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39283">[SPARK-39283]</a>[CORE] Fix deadlock between TaskMemoryManager and UnsafeExternalSorter.SpillableIterator</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39285">[SPARK-39285]</a>[SQL] Spark should not check field names when reading files</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-34096">[SPARK-34096]</a>[SQL] Improve performance for nth_value ignore nulls over offset window</p></li>
</ul>
</li>
<li><p>June 2, 2022</p>
<ul>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>May 18, 2022</p>
<ul>
<li><p>Fixes a potential native memory leak in Auto Loader.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39084">[SPARK-39084]</a>[PYSPARK] Fix df.rdd.isEmpty() by using TaskContext to stop iterator on task completion</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38889">[SPARK-38889]</a>[SQL] Compile boolean column filters to use the bit type for MSSQL data source</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>April 19, 2022</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-37270">[SPARK-37270]</a>[SQL] Fix push foldable into CaseWhen branches if elseValue is empty</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>April 6, 2022</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38631">[SPARK-38631]</a>[CORE] Uses Java-based implementation for un-tarring at Utils.unpack</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>March 22, 2022</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38437">[SPARK-38437]</a>[SQL] Lenient serialization of datetime from datasource</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38180">[SPARK-38180]</a>[SQL] Allow safe up-cast expressions in correlated equality predicates</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38155">[SPARK-38155]</a>[SQL] Disallow distinct aggregate in lateral subqueries with unsupported predicates</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38325">[SPARK-38325]</a>[SQL] ANSI mode: avoid potential runtime error in HashJoin.extractKeyExprAt()</p></li>
</ul>
</li>
<li><p>March 14, 2022</p>
<ul>
<li><p>Improved transaction conflict detection for empty transactions in Delta Lake.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38185">[SPARK-38185]</a>[SQL] Fix data incorrect if aggregate function is empty</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38318">[SPARK-38318]</a>[SQL] regression when replacing a dataset view</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38236">[SPARK-38236]</a>[SQL] Absolute file paths specified in create/alter table are treated as relative</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-35937">[SPARK-35937]</a>[SQL] Extracting date field from timestamp should work in ANSI mode</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-34069">[SPARK-34069]</a>[SQL] Kill barrier tasks should respect <code class="docutils literal notranslate"><span class="pre">SPARK_JOB_INTERRUPT_ON_CANCEL</span></code></p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-37707">[SPARK-37707]</a>[SQL] Allow store assignment between TimestampNTZ and Date/Timestamp</p></li>
</ul>
</li>
<li><p>February 23, 2022</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-37577">[SPARK-37577]</a>[SQL] Fix ClassCastException: ArrayType cannot be cast to StructType for Generate Pruning</p></li>
</ul>
</li>
<li><p>February 8, 2022</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-27442">[SPARK-27442]</a>[SQL] Remove check field name when reading/writing data in parquet.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>February 1, 2022</p>
<ul>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>January 26, 2022</p>
<ul>
<li><p>Fixed a bug where concurrent transactions on Delta tables could commit in a non-serializable order under certain rare conditions.</p></li>
<li><p>Fixed a bug where the OPTIMIZE command could fail when the ANSI SQL dialect was enabled.</p></li>
</ul>
</li>
<li><p>January 19, 2022</p>
<ul>
<li><p>Introduced support for inlining temporary credentials to COPY INTO for loading the source data without requiring SQL ANY_FILE permissions</p></li>
<li><p>Fixed an out of memory issue with query result caching under certain conditions.</p></li>
<li><p>Fixed an issue with <code class="docutils literal notranslate"><span class="pre">USE</span> <span class="pre">DATABASE</span></code> when a user switches the current catalog to a non-default catalog.</p></li>
<li><p>Bug fixes and security enhancements.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>December 20, 2021</p>
<ul>
<li><p>Fixed a rare bug with Parquet column index based filtering.</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="databricks-runtime-100-unsupported">
<span id="dbr-100-unsupported"></span><span id="100"></span><h3><a class="toc-backref" href="#id16">Databricks Runtime 10.0 (unsupported)</a><a class="headerlink" href="#databricks-runtime-100-unsupported" title="Permalink to this headline"> </a></h3>
<p>See <a class="reference internal" href="10.0.html"><span class="doc">Databricks Runtime 10.0 (unsupported)</span></a>.</p>
<ul class="simple">
<li><p>April 19, 2022</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-37270">[SPARK-37270]</a>[SQL] Fix push foldable into CaseWhen branches if elseValue is empty</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>April 6, 2022</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38631">[SPARK-38631]</a>[CORE] Uses Java-based implementation for un-tarring at Utils.unpack</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>March 22, 2022</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38437">[SPARK-38437]</a>[SQL] Lenient serialization of datetime from datasource</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38180">[SPARK-38180]</a>[SQL] Allow safe up-cast expressions in correlated equality predicates</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38155">[SPARK-38155]</a>[SQL] Disallow distinct aggregate in lateral subqueries with unsupported predicates</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38325">[SPARK-38325]</a>[SQL] ANSI mode: avoid potential runtime error in HashJoin.extractKeyExprAt()</p></li>
</ul>
</li>
<li><p>March 14, 2022</p>
<ul>
<li><p>Improved transaction conflict detection for empty transactions in Delta Lake.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38185">[SPARK-38185]</a>[SQL] Fix data incorrect if aggregate function is empty</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38318">[SPARK-38318]</a>[SQL] regression when replacing a dataset view</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38236">[SPARK-38236]</a>[SQL] Absolute file paths specified in create/alter table are treated as relative</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-35937">[SPARK-35937]</a>[SQL] Extracting date field from timestamp should work in ANSI mode</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-34069">[SPARK-34069]</a>[SQL] Kill barrier tasks should respect <code class="docutils literal notranslate"><span class="pre">SPARK_JOB_INTERRUPT_ON_CANCEL</span></code></p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-37707">[SPARK-37707]</a>[SQL] Allow store assignment between TimestampNTZ and Date/Timestamp</p></li>
</ul>
</li>
<li><p>February 23, 2022</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-37577">[SPARK-37577]</a>[SQL] Fix ClassCastException: ArrayType cannot be cast to StructType for Generate Pruning</p></li>
</ul>
</li>
<li><p>February 8, 2022</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-27442">[SPARK-27442]</a>[SQL] Remove check field name when reading/writing data in parquet.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-36905">[SPARK-36905]</a>[SQL] Fix reading hive views without explicit column names</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-37859">[SPARK-37859]</a>[SQL] Fix issue that SQL tables created with JDBC with Spark 3.1 are not readable with 3.2</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>February 1, 2022</p>
<ul>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>January 26, 2022</p>
<ul>
<li><p>Fixed a bug where concurrent transactions on Delta tables could commit in a non-serializable order under certain rare conditions.</p></li>
<li><p>Fixed a bug where the OPTIMIZE command could fail when the ANSI SQL dialect was enabled.</p></li>
</ul>
</li>
<li><p>January 19, 2022</p>
<ul>
<li><p>Bug fixes and security enhancements.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>December 20, 2021</p>
<ul>
<li><p>Fixed a rare bug with Parquet column index based filtering.</p></li>
</ul>
</li>
<li><p>November 9, 2021</p>
<ul>
<li><p>Introduced additional configuration flags to enable fine grained control of ANSI behaviors.</p></li>
</ul>
</li>
<li><p>November 4, 2021</p>
<ul>
<li><p>Fixed a bug that could cause Structured Streaming streams to fail with an ArrayIndexOutOfBoundsException</p></li>
<li><p>Fixed a race condition that might cause a query failure with an IOException like <code class="docutils literal notranslate"><span class="pre">java.io.IOException:</span> <span class="pre">No</span> <span class="pre">FileSystem</span> <span class="pre">for</span> <span class="pre">scheme</span></code> or that might cause modifications to <code class="docutils literal notranslate"><span class="pre">sparkContext.hadoopConfiguration</span></code> to not take effect in queries.</p></li>
<li><p>The Apache Spark Connector for Delta Sharing was upgraded to 0.2.0.</p></li>
</ul>
</li>
<li><p>November 30, 2021</p>
<ul>
<li><p>Fixed an issue with timestamp parsing where a timezone string without a colon was considered invalid.</p></li>
<li><p>Fixed an out of memory issue with query result caching under certain conditions.</p></li>
<li><p>Fixed an issue with <code class="docutils literal notranslate"><span class="pre">USE</span> <span class="pre">DATABASE</span></code> when a user switches the current catalog to a non-default catalog.</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="databricks-runtime-90-unsupported">
<span id="dbr-90-unsupported"></span><span id="90"></span><h3><a class="toc-backref" href="#id17">Databricks Runtime 9.0 (unsupported)</a><a class="headerlink" href="#databricks-runtime-90-unsupported" title="Permalink to this headline"> </a></h3>
<p>See <a class="reference internal" href="9.0.html"><span class="doc">Databricks Runtime 9.0 (unsupported)</span></a>.</p>
<ul class="simple">
<li><p>February 8, 2022</p>
<ul>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>February 1, 2022</p>
<ul>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>January 26, 2022</p>
<ul>
<li><p>Fixed a bug where the OPTIMIZE command could fail when the ANSI SQL dialect was enabled.</p></li>
</ul>
</li>
<li><p>January 19, 2022</p>
<ul>
<li><p>Bug fixes and security enhancements.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>November 4, 2021</p>
<ul>
<li><p>Fixed a bug that could cause Structured Streaming streams to fail with an ArrayIndexOutOfBoundsException</p></li>
<li><p>Fixed a race condition that might cause a query failure with an IOException like <code class="docutils literal notranslate"><span class="pre">java.io.IOException:</span> <span class="pre">No</span> <span class="pre">FileSystem</span> <span class="pre">for</span> <span class="pre">scheme</span></code> or that might cause modifications to <code class="docutils literal notranslate"><span class="pre">sparkContext.hadoopConfiguration</span></code> to not take effect in queries.</p></li>
<li><p>The Apache Spark Connector for Delta Sharing was upgraded to 0.2.0.</p></li>
</ul>
</li>
<li><p>September 22, 2021</p>
<ul>
<li><p>Fixed a bug in cast Spark array with null to string</p></li>
</ul>
</li>
<li><p>September 15, 2021</p>
<ul>
<li><p>Fixed a race condition that might cause a query failure with an IOException like <code class="docutils literal notranslate"><span class="pre">java.io.IOException:</span> <span class="pre">org.apache.spark.SparkException:</span> <span class="pre">Failed</span> <span class="pre">to</span> <span class="pre">get</span> <span class="pre">broadcast_x_piecey</span> <span class="pre">of</span> <span class="pre">broadcast_x</span></code>.</p></li>
</ul>
</li>
<li><p>September 8, 2021</p>
<ul>
<li><p>Added support for schema name (<code class="docutils literal notranslate"><span class="pre">databaseName.schemaName.tableName</span></code> format) as the target table name for Azure Synapse Connector.</p></li>
<li><p>Added geometry and geography JDBC types support for Spark SQL.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-33527">[SPARK-33527]</a>[SQL] Extended the function of decode to be consistent with mainstream databases.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-36532">[SPARK-36532]</a>[CORE][3.1] Fixed deadlock in <code class="docutils literal notranslate"><span class="pre">CoarseGrainedExecutorBackend.onDisconnected</span></code> to avoid <code class="docutils literal notranslate"><span class="pre">executorsconnected</span></code> to prevent executor shutdown hang.</p></li>
</ul>
</li>
<li><p>August 25, 2021</p>
<ul>
<li><p>SQL Server driver library was upgraded to 9.2.1.jre8.</p></li>
<li><p>Snowflake connector was upgraded to 2.9.0.</p></li>
<li><p>Fixed broken link to best trial notebook on AutoML experiment page.</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="databricks-runtime-84-unsupported">
<span id="dbr-84-unsupported"></span><span id="84"></span><h3><a class="toc-backref" href="#id18">Databricks Runtime 8.4 (unsupported)</a><a class="headerlink" href="#databricks-runtime-84-unsupported" title="Permalink to this headline"> </a></h3>
<p>See <a class="reference internal" href="8.4.html"><span class="doc">Databricks Runtime 8.4 (unsupported)</span></a>.</p>
<ul class="simple">
<li><p>January 19, 2022</p>
<ul>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>November 4, 2021</p>
<ul>
<li><p>Fixed a bug that could cause Structured Streaming streams to fail with an ArrayIndexOutOfBoundsException</p></li>
<li><p>Fixed a race condition that might cause a query failure with an IOException like <code class="docutils literal notranslate"><span class="pre">java.io.IOException:</span> <span class="pre">No</span> <span class="pre">FileSystem</span> <span class="pre">for</span> <span class="pre">scheme</span></code> or that might cause modifications to <code class="docutils literal notranslate"><span class="pre">sparkContext.hadoopConfiguration</span></code> to not take effect in queries.</p></li>
<li><p>The Apache Spark Connector for Delta Sharing was upgraded to 0.2.0.</p></li>
</ul>
</li>
<li><p>September 22, 2021</p>
<ul>
<li><p>Spark JDBC driver was upgraded to 2.6.19.1030</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-36734">[SPARK-36734]</a>[SQL] Upgrade ORC to 1.5.1</p></li>
</ul>
</li>
<li><p>September 15, 2021</p>
<ul>
<li><p>Fixed a race condition that might cause a query failure with an IOException like <code class="docutils literal notranslate"><span class="pre">java.io.IOException:</span> <span class="pre">org.apache.spark.SparkException:</span> <span class="pre">Failed</span> <span class="pre">to</span> <span class="pre">get</span> <span class="pre">broadcast_x_piecey</span> <span class="pre">of</span> <span class="pre">broadcast_x</span></code>.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>September 8, 2021</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-36532">[SPARK-36532]</a>[CORE][3.1] Fixed deadlock in <code class="docutils literal notranslate"><span class="pre">CoarseGrainedExecutorBackend.onDisconnected</span></code> to avoid <code class="docutils literal notranslate"><span class="pre">executorsconnected</span></code> to prevent executor shutdown hang.</p></li>
</ul>
</li>
<li><p>August 25, 2021</p>
<ul>
<li><p>SQL Server driver library was upgraded to 9.2.1.jre8.</p></li>
<li><p>Snowflake connector was upgraded to 2.9.0.</p></li>
<li><p>Fixes a bug in credential passthrough caused by the new Parquet prefetch optimization, where user’s passthrough credential might not be found during file access.</p></li>
</ul>
</li>
<li><p>August 11, 2021</p>
<ul>
<li><p>Fixes a RocksDB incompatibility problem that prevents older Databricks Runtime 8.4. This fixes forward compatibility for Auto Loader, <code class="docutils literal notranslate"><span class="pre">COPY</span> <span class="pre">INTO</span></code>, and stateful streaming applications.</p></li>
<li><p>Fixes a bug in Auto Loader with S3 paths when using Auto Loader without a <code class="docutils literal notranslate"><span class="pre">path</span></code> option.</p></li>
<li><p>Fixes a bug that misconfigured AWS STS endpoints as Amazon Kinesis endpoints for the Kinesis source.</p></li>
<li><p>Fixes a bug when using Auto Loader to read CSV files with mismatching header files. If column names do not match, the column would be filled in with nulls. Now, if a schema is provided, it assumes the schema is the same and will only save column mismatches if rescued data columns are enabled.</p></li>
<li><p>Adds a new option called <code class="docutils literal notranslate"><span class="pre">externalDataSource</span></code> into the Azure Synapse connector to remove the <code class="docutils literal notranslate"><span class="pre">CONTROL</span></code> permission requirement on the database for PolyBase reading.</p></li>
</ul>
</li>
<li><p>July 29, 2021</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-36034">[SPARK-36034]</a>[BUILD] Rebase datetime in pushed down filters to Parquet</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-36163">[SPARK-36163]</a>[BUILD] Propagate correct JDBC properties in JDBC connector provider and add <code class="docutils literal notranslate"><span class="pre">connectionProvider</span></code> option</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="databricks-runtime-83-unsupported">
<span id="dbr-83-unsupported"></span><span id="83"></span><h3><a class="toc-backref" href="#id19">Databricks Runtime 8.3 (unsupported)</a><a class="headerlink" href="#databricks-runtime-83-unsupported" title="Permalink to this headline"> </a></h3>
<p>See <a class="reference internal" href="8.3.html"><span class="doc">Databricks Runtime 8.3 (unsupported)</span></a>.</p>
<ul class="simple">
<li><p>January 19, 2022</p>
<ul>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>November 4, 2021</p>
<ul>
<li><p>Fixed a bug that could cause Structured Streaming streams to fail with an ArrayIndexOutOfBoundsException</p></li>
<li><p>Fixed a race condition that might cause a query failure with an IOException like <code class="docutils literal notranslate"><span class="pre">java.io.IOException:</span> <span class="pre">No</span> <span class="pre">FileSystem</span> <span class="pre">for</span> <span class="pre">scheme</span></code> or that might cause modifications to <code class="docutils literal notranslate"><span class="pre">sparkContext.hadoopConfiguration</span></code> to not take effect in queries.</p></li>
</ul>
</li>
<li><p>September 22, 2021</p>
<ul>
<li><p>Spark JDBC driver was upgraded to 2.6.19.1030</p></li>
</ul>
</li>
<li><p>September 15, 2021</p>
<ul>
<li><p>Fixed a race condition that might cause a query failure with an IOException like <code class="docutils literal notranslate"><span class="pre">java.io.IOException:</span> <span class="pre">org.apache.spark.SparkException:</span> <span class="pre">Failed</span> <span class="pre">to</span> <span class="pre">get</span> <span class="pre">broadcast_x_piecey</span> <span class="pre">of</span> <span class="pre">broadcast_x</span></code>.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>September 8, 2021</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-35700">[SPARK-35700]</a>[SQL][WARMFIX] Read char/varchar orc table when created and written by external systems.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-36532">[SPARK-36532]</a>[CORE][3.1] Fixed deadlock in <code class="docutils literal notranslate"><span class="pre">CoarseGrainedExecutorBackend.onDisconnected</span></code> to avoid <code class="docutils literal notranslate"><span class="pre">executorsconnected</span></code> to prevent executor shutdown hang.</p></li>
</ul>
</li>
<li><p>August 25, 2021</p>
<ul>
<li><p>SQL Server driver library was upgraded to 9.2.1.jre8.</p></li>
<li><p>Snowflake connector was upgraded to 2.9.0.</p></li>
<li><p>Fixes a bug in credential passthrough caused by the new Parquet prefetch optimization, where user’s passthrough credential might not be found during file access.</p></li>
</ul>
</li>
<li><p>August 11, 2021</p>
<ul>
<li><p>Fixes a bug that misconfigured AWS STS endpoints as Amazon Kinesis endpoints for the Kinesis source.</p></li>
<li><p>Fixes a bug when using Auto Loader to read CSV files with mismatching header files. If column names do not match, the column would be filled in with nulls. Now, if a schema is provided, it assumes the schema is the same and will only save column mismatches if rescued data columns are enabled.</p></li>
</ul>
</li>
<li><p>July 29, 2021</p>
<ul>
<li><p>Upgrade Databricks Snowflake Spark connector to 2.9.0-spark-3.1</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-36034">[SPARK-36034]</a>[BUILD] Rebase datetime in pushed down filters to Parquet</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-36163">[SPARK-36163]</a>[BUILD] Propagate correct JDBC properties in JDBC connector provider and add <code class="docutils literal notranslate"><span class="pre">connectionProvider</span></code> option</p></li>
</ul>
</li>
<li><p>July 14, 2021</p>
<ul>
<li><p>Fixed an issue when using column names with dots in Azure Synapse connector.</p></li>
<li><p>Introduced <code class="docutils literal notranslate"><span class="pre">database.schema.table</span></code> format for Synapse Connector.</p></li>
<li><p>Added support to provide <code class="docutils literal notranslate"><span class="pre">databaseName.schemaName.tableName</span></code> format as the target table instead of only <code class="docutils literal notranslate"><span class="pre">schemaName.tableName</span></code> or <code class="docutils literal notranslate"><span class="pre">tableName</span></code>.</p></li>
</ul>
</li>
<li><p>June 15, 2021</p>
<ul>
<li><p>Fixed a <code class="docutils literal notranslate"><span class="pre">NoSuchElementException</span></code> bug in Delta Lake optimized writes that can happen when writing large amounts of data and encountering executor losses</p></li>
<li><p>Adds SQL <code class="docutils literal notranslate"><span class="pre">CREATE</span> <span class="pre">GROUP</span></code>, <code class="docutils literal notranslate"><span class="pre">DROP</span> <span class="pre">GROUP</span></code>, <code class="docutils literal notranslate"><span class="pre">ALTER</span> <span class="pre">GROUP</span></code>, <code class="docutils literal notranslate"><span class="pre">SHOW</span> <span class="pre">GROUPS</span></code>, and <code class="docutils literal notranslate"><span class="pre">SHOW</span> <span class="pre">USERS</span></code> commands. For details, see <a class="reference internal" href="../../sql/language-manual/index.html#security-statements"><span class="std std-ref">Security statements</span></a> and <a class="reference internal" href="../../sql/language-manual/index.html#show-statements"><span class="std std-ref">Show statements</span></a>.</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="databricks-runtime-82-unsupported">
<span id="dbr-82-unsupported"></span><span id="82"></span><h3><a class="toc-backref" href="#id20">Databricks Runtime 8.2 (unsupported)</a><a class="headerlink" href="#databricks-runtime-82-unsupported" title="Permalink to this headline"> </a></h3>
<p>See <a class="reference internal" href="8.2.html"><span class="doc">Databricks Runtime 8.2 (unsupported)</span></a>.</p>
<ul class="simple">
<li><p>September 22, 2021</p>
<ul>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>September 15, 2021</p>
<ul>
<li><p>Fixed a race condition that might cause a query failure with an IOException like <code class="docutils literal notranslate"><span class="pre">java.io.IOException:</span> <span class="pre">org.apache.spark.SparkException:</span> <span class="pre">Failed</span> <span class="pre">to</span> <span class="pre">get</span> <span class="pre">broadcast_x_piecey</span> <span class="pre">of</span> <span class="pre">broadcast_x</span></code>.</p></li>
</ul>
</li>
<li><p>September 8, 2021</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-35700">[SPARK-35700]</a>[SQL][WARMFIX] Read char/varchar orc table when created and written by external systems.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-36532">[SPARK-36532]</a>[CORE][3.1] Fixed deadlock in <code class="docutils literal notranslate"><span class="pre">CoarseGrainedExecutorBackend.onDisconnected</span></code> to avoid <code class="docutils literal notranslate"><span class="pre">executorsconnected</span></code> to prevent executor shutdown hang.</p></li>
</ul>
</li>
<li><p>August 25, 2021</p>
<ul>
<li><p>Snowflake connector was upgraded to 2.9.0.</p></li>
</ul>
</li>
<li><p>August 11, 2021</p>
<ul>
<li><p>Fixes a bug that misconfigured AWS STS endpoints as Amazon Kinesis endpoints for the Kinesis source.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-36034">[SPARK-36034]</a>[SQL] Rebase datetime in pushed down filters to parquet.</p></li>
</ul>
</li>
<li><p>July 29, 2021</p>
<ul>
<li><p>Upgrade Databricks Snowflake Spark connector to 2.9.0-spark-3.1</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-36163">[SPARK-36163]</a>[BUILD] Propagate correct JDBC properties in JDBC connector provider and add <code class="docutils literal notranslate"><span class="pre">connectionProvider</span></code> option</p></li>
</ul>
</li>
<li><p>July 14, 2021</p>
<ul>
<li><p>Fixed an issue when using column names with dots in Azure Synapse connector.</p></li>
<li><p>Introduced <code class="docutils literal notranslate"><span class="pre">database.schema.table</span></code> format for Synapse Connector.</p></li>
<li><p>Added support to provide <code class="docutils literal notranslate"><span class="pre">databaseName.schemaName.tableName</span></code> format as the target table  instead of only <code class="docutils literal notranslate"><span class="pre">schemaName.tableName</span></code> or <code class="docutils literal notranslate"><span class="pre">tableName</span></code>.</p></li>
<li><p>Fixed a bug that prevents users from time traveling to older available versions with Delta tables.</p></li>
</ul>
</li>
<li><p>June 15, 2021</p>
<ul>
<li><p>Fixes a <code class="docutils literal notranslate"><span class="pre">NoSuchElementException</span></code> bug in Delta Lake optimized writes that can happen when writing large amounts of data and encountering executor losses</p></li>
</ul>
</li>
</ul>
<ul class="simple">
<li><p>June 7, 2021</p>
<ul>
<li><p>Disable a list of pushdown predicates (StartsWith, EndsWith, Contains, Not(EqualTo()), and DataType) for AWS Glue Catalog since they are not supported in Glue yet.</p></li>
</ul>
</li>
</ul>
<ul class="simple">
<li><p>May 26, 2021</p>
<ul>
<li><p>Updated Python with security patch to fix Python security vulnerability (CVE-2021-3177).</p></li>
</ul>
</li>
<li><p>April 30, 2021</p>
<ul>
<li><p>Operating system security updates.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-35227">[SPARK-35227]</a>[BUILD] Update the resolver for spark-packages in SparkSubmit</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-34245">[SPARK-34245]</a>[CORE] Ensure Master removes executors that failed to send finished state</p></li>
<li><p>Fixed an OOM issue when Auto Loader reports Structured Streaming progress metrics.</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="databricks-runtime-81-unsupported">
<span id="dbr-81-unsupported"></span><span id="81"></span><h3><a class="toc-backref" href="#id21">Databricks Runtime 8.1 (unsupported)</a><a class="headerlink" href="#databricks-runtime-81-unsupported" title="Permalink to this headline"> </a></h3>
<p>See <a class="reference internal" href="8.1.html"><span class="doc">Databricks Runtime 8.1 (unsupported)</span></a>.</p>
<ul class="simple">
<li><p>September 22, 2021</p>
<ul>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>September 15, 2021</p>
<ul>
<li><p>Fixed a race condition that might cause a query failure with an IOException like <code class="docutils literal notranslate"><span class="pre">java.io.IOException:</span> <span class="pre">org.apache.spark.SparkException:</span> <span class="pre">Failed</span> <span class="pre">to</span> <span class="pre">get</span> <span class="pre">broadcast_x_piecey</span> <span class="pre">of</span> <span class="pre">broadcast_x</span></code>.</p></li>
</ul>
</li>
<li><p>September 8, 2021</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-35700">[SPARK-35700]</a>[SQL][WARMFIX] Read char/varchar orc table when created and written by external systems.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-36532">[SPARK-36532]</a>[CORE][3.1] Fixed deadlock in <code class="docutils literal notranslate"><span class="pre">CoarseGrainedExecutorBackend.onDisconnected</span></code> to avoid <code class="docutils literal notranslate"><span class="pre">executorsconnected</span></code> to prevent executor shutdown hang.</p></li>
</ul>
</li>
<li><p>August 25, 2021</p>
<ul>
<li><p>Snowflake connector was upgraded to 2.9.0.</p></li>
</ul>
</li>
<li><p>August 11, 2021</p>
<ul>
<li><p>Fixes a bug that misconfigured AWS STS endpoints as Amazon Kinesis endpoints for the Kinesis source.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-36034">[SPARK-36034]</a>[SQL] Rebase datetime in pushed down filters to parquet.</p></li>
</ul>
</li>
<li><p>July 29, 2021</p>
<ul>
<li><p>Upgrade Databricks Snowflake Spark connector to 2.9.0-spark-3.1</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-36163">[SPARK-36163]</a>[BUILD] Propagate correct JDBC properties in JDBC connector provider and add <code class="docutils literal notranslate"><span class="pre">connectionProvider</span></code> option</p></li>
</ul>
</li>
<li><p>July 14, 2021</p>
<ul>
<li><p>Fixed an issue when using column names with dots in Azure Synapse connector.</p></li>
<li><p>Fixed a bug that prevents users from time traveling to older available versions with Delta tables.</p></li>
</ul>
</li>
<li><p>June 15, 2021</p>
<ul>
<li><p>Fixes a <code class="docutils literal notranslate"><span class="pre">NoSuchElementException</span></code> bug in Delta Lake optimized writes that can happen when writing large amounts of data and encountering executor losses</p></li>
</ul>
</li>
</ul>
<ul class="simple">
<li><p>June 7, 2021</p>
<ul>
<li><p>Disable a list of pushdown predicates (StartsWith, EndsWith, Contains, Not(EqualTo()), and DataType) for AWS Glue Catalog since they are not supported in Glue yet.</p></li>
</ul>
</li>
</ul>
<ul class="simple">
<li><p>May 26, 2021</p>
<ul>
<li><p>Updated Python with security patch to fix Python security vulnerability (CVE-2021-3177).</p></li>
</ul>
</li>
<li><p>April 30, 2021</p>
<ul>
<li><p>Operating system security updates.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-35227">[SPARK-35227]</a>[BUILD] Update the resolver for spark-packages in SparkSubmit</p></li>
<li><p>Fixed an OOM issue when Auto Loader reports Structured Streaming progress metrics.</p></li>
</ul>
</li>
<li><p>April 27, 2021</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-34245">[SPARK-34245]</a>[CORE] Ensure Master removes executors that failed to send finished state</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-34856">[SPARK-34856]</a>[SQL] ANSI mode: Allow casting complex types as string type</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-35014">[SPARK-35014]</a> Fix the PhysicalAggregation pattern to not rewrite foldable expressions</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-34769">[SPARK-34769]</a>[SQL] AnsiTypeCoercion: return narrowest convertible type among TypeCollection</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-34614">[SPARK-34614]</a>[SQL] ANSI mode: Casting String to Boolean will throw exception on parse error</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-33794">[SPARK-33794]</a>[SQL] ANSI mode: Fix NextDay expression to throw runtime IllegalArgumentException when receiving invalid input under</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="databricks-runtime-80-unsupported">
<span id="dbr-80-unsupported"></span><span id="80"></span><h3><a class="toc-backref" href="#id22">Databricks Runtime 8.0 (unsupported)</a><a class="headerlink" href="#databricks-runtime-80-unsupported" title="Permalink to this headline"> </a></h3>
<p>See <a class="reference internal" href="8.0.html"><span class="doc">Databricks Runtime 8.0 (unsupported)</span></a>.</p>
<ul class="simple">
<li><p>September 15, 2021</p>
<ul>
<li><p>Fixed a race condition that might cause a query failure with an IOException like <code class="docutils literal notranslate"><span class="pre">java.io.IOException:</span> <span class="pre">org.apache.spark.SparkException:</span> <span class="pre">Failed</span> <span class="pre">to</span> <span class="pre">get</span> <span class="pre">broadcast_x_piecey</span> <span class="pre">of</span> <span class="pre">broadcast_x</span></code>.</p></li>
</ul>
</li>
<li><p>August 25, 2021</p>
<ul>
<li><p>Snowflake connector was upgraded to 2.9.0.</p></li>
</ul>
</li>
<li><p>August 11, 2021</p>
<ul>
<li><p>Fixes a bug that misconfigured AWS STS endpoints as Amazon Kinesis endpoints for the Kinesis source.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-36034">[SPARK-36034]</a>[SQL] Rebase datetime in pushed down filters to parquet.</p></li>
</ul>
</li>
<li><p>July 29, 2021</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-36163">[SPARK-36163]</a>[BUILD] Propagate correct JDBC properties in JDBC connector provider and add <code class="docutils literal notranslate"><span class="pre">connectionProvider</span></code> option</p></li>
</ul>
</li>
<li><p>July 14, 2021</p>
<ul>
<li><p>Fixed an issue when using column names with dots in Azure Synapse connector.</p></li>
<li><p>Fixed a bug that prevents users from time traveling to older available versions with Delta tables.</p></li>
</ul>
</li>
</ul>
<ul class="simple">
<li><p>June 7, 2021</p>
<ul>
<li><p>Disable a list of pushdown predicates (StartsWith, EndsWith, Contains, Not(EqualTo()), and DataType) for AWS Glue Catalog since they are not supported in Glue yet.</p></li>
</ul>
</li>
</ul>
<ul class="simple">
<li><p>May 26, 2021</p>
<ul>
<li><p>Updated Python with security patch to fix Python security vulnerability (CVE-2021-3177).</p></li>
</ul>
</li>
<li><p>April 30, 2021</p>
<ul>
<li><p>Operating system security updates.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-35227">[SPARK-35227]</a>[BUILD] Update the resolver for spark-packages in SparkSubmit</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-34245">[SPARK-34245]</a>[CORE] Ensure Master removes executors that failed to send finished state</p></li>
</ul>
</li>
<li><p>March 24, 2021</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-34681">[SPARK-34681]</a>[SQL] Fix bug for full outer shuffled hash join when building left side with non-equal condition</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-34534">[SPARK-34534]</a> Fix blockIds order when use FetchShuffleBlocks to fetch blocks</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-34613">[SPARK-34613]</a>[SQL] Fix view does not capture disable hint config</p></li>
<li><p>Disk caching is enabled by default on i3en instances.</p></li>
</ul>
</li>
<li><p>March 9, 2021</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-34543">[SPARK-34543]</a>[SQL] Respect the <code class="docutils literal notranslate"><span class="pre">spark.sql.caseSensitive</span></code> config while resolving partition spec in v1 <code class="docutils literal notranslate"><span class="pre">SET</span> <span class="pre">LOCATION</span></code></p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-34392">[SPARK-34392]</a>[SQL] Support ZoneOffset +h:mm in DateTimeUtils. getZoneId</p></li>
<li><p>[UI] Fix the href link of Spark DAG Visualization</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-34436">[SPARK-34436]</a>[SQL] DPP support LIKE ANY/ALL expression</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="databricks-runtime-76-unsupported">
<span id="dbr-76-unsupported"></span><span id="76"></span><h3><a class="toc-backref" href="#id23">Databricks Runtime 7.6 (unsupported)</a><a class="headerlink" href="#databricks-runtime-76-unsupported" title="Permalink to this headline"> </a></h3>
<p>See <a class="reference internal" href="7.6.html"><span class="doc">Databricks Runtime 7.6 (unsupported)</span></a>.</p>
<ul class="simple">
<li><p>August 11, 2021</p>
<ul>
<li><p>Fixes a bug that misconfigured AWS STS endpoints as Amazon Kinesis endpoints for the Kinesis source.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-36034">[SPARK-36034]</a>[SQL] Rebase datetime in pushed down filters to parquet.</p></li>
</ul>
</li>
<li><p>July 29, 2021</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-32998">[SPARK-32998]</a>[BUILD] Add ability to override default remote repos with internal repos only</p></li>
</ul>
</li>
<li><p>July 14, 2021</p>
<ul>
<li><p>Fixed a bug that prevents users from time traveling to older available versions with Delta tables.</p></li>
</ul>
</li>
<li><p>May 26, 2021</p>
<ul>
<li><p>Updated Python with security patch to fix Python security vulnerability (CVE-2021-3177).</p></li>
</ul>
</li>
<li><p>April 30, 2021</p>
<ul>
<li><p>Operating system security updates.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-35227">[SPARK-35227]</a>[BUILD] Update the resolver for spark-packages in SparkSubmit</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-34245">[SPARK-34245]</a>[CORE] Ensure Master removes executors that failed to send finished state</p></li>
</ul>
</li>
<li><p>March 24, 2021</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-34768">[SPARK-34768]</a>[SQL] Respect the default input buffer size in Univocity</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-34534">[SPARK-34534]</a> Fix blockIds order when use FetchShuffleBlocks to fetch blocks</p></li>
<li><p>Disk caching is enabled by default on i3en instances.</p></li>
</ul>
</li>
<li><p>March 9, 2021</p>
<ul>
<li><p>(Azure only) Fixed an Auto Loader bug that can cause NullPointerException when using Databricks Runtime 7.6 to run an old Auto Loader stream created in Databricks Runtime 7.2</p></li>
<li><p>[UI] Fix the href link of Spark DAG Visualization</p></li>
<li><p>Unknown leaf-node SparkPlan is not handled correctly in SizeInBytesOnlyStatsSparkPlanVisitor</p></li>
<li><p>Restore the output schema of <code class="docutils literal notranslate"><span class="pre">SHOW</span> <span class="pre">DATABASES</span></code></p></li>
<li><p>[Delta][8.0, 7.6] Fixed calculation bug in file size auto-tuning logic</p></li>
<li><p>Disable staleness check for Delta table files in disk cache</p></li>
<li><p>[SQL] Use correct dynamic pruning build key when range join hint is present</p></li>
<li><p>Disable char type support in non-SQL code path</p></li>
<li><p>Avoid NPE in DataFrameReader.schema</p></li>
<li><p>Fix NPE when EventGridClient response has no entity</p></li>
<li><p>Fix a read closed stream bug in Azure Auto Loader</p></li>
<li><p>[SQL] Do not generate shuffle partition number advice when AOS is enabled</p></li>
</ul>
</li>
<li><p>February 24, 2021</p>
<ul>
<li><p>Upgraded the Spark BigQuery connector to v0.18, which introduces various bug fixes and support for Arrow and Avro iterators.</p></li>
<li><p>Fixed a correctness issue that caused Spark to return incorrect results when the Parquet file’s decimal precision and scale are different from the Spark schema.</p></li>
<li><p>Fixed reading failure issue on Microsoft SQL Server tables that contain spatial data types, by adding geometry and geography JDBC types support for Spark SQL.</p></li>
<li><p>Introduced a new configuration <code class="docutils literal notranslate"><span class="pre">spark.databricks.hive.metastore.init.reloadFunctions.enabled</span></code>. This configuration controls the built in Hive initialization. When set to true, Databricks reloads all functions from all databases that users have into <code class="docutils literal notranslate"><span class="pre">FunctionRegistry</span></code>. This is the default behavior in Hive Metastore. When set to false, Databricks disables this process for optimization.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-34212">[SPARK-34212]</a> Fixed issues related to reading decimal data from Parquet files.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-34260">[SPARK-34260]</a>[SQL] Fix UnresolvedException when creating temp view twice.</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="databricks-runtime-75-unsupported">
<span id="dbr-75-unsupported"></span><span id="75"></span><h3><a class="toc-backref" href="#id24">Databricks Runtime 7.5 (unsupported)</a><a class="headerlink" href="#databricks-runtime-75-unsupported" title="Permalink to this headline"> </a></h3>
<p>See <a class="reference internal" href="7.5.html"><span class="doc">Databricks Runtime 7.5 (unsupported)</span></a>.</p>
<ul class="simple">
<li><p>May 26, 2021</p>
<ul>
<li><p>Updated Python with security patch to fix Python security vulnerability (CVE-2021-3177).</p></li>
</ul>
</li>
<li><p>April 30, 2021</p>
<ul>
<li><p>Operating system security updates.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-35227">[SPARK-35227]</a>[BUILD] Update the resolver for spark-packages in SparkSubmit</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-34245">[SPARK-34245]</a>[CORE] Ensure Master removes executors that failed to send finished state</p></li>
</ul>
</li>
<li><p>March 24, 2021</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-34768">[SPARK-34768]</a>[SQL] Respect the default input buffer size in Univocity</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-34534">[SPARK-34534]</a> Fix blockIds order when use FetchShuffleBlocks to fetch blocks</p></li>
<li><p>Disk caching is enabled by default on i3en instances.</p></li>
</ul>
</li>
<li><p>March 9, 2021</p>
<ul>
<li><p>(Azure only) Fixed an Auto Loader bug that can cause NullPointerException when using Databricks Runtime 7.5 to run an old Auto Loader stream created in Databricks Runtime 7.2.</p></li>
<li><p>[UI] Fix the href link of Spark DAG Visualization</p></li>
<li><p>Unknown leaf-node SparkPlan is not handled correctly in SizeInBytesOnlyStatsSparkPlanVisitor</p></li>
<li><p>Restore the output schema of <code class="docutils literal notranslate"><span class="pre">SHOW</span> <span class="pre">DATABASES</span></code></p></li>
<li><p>Disable staleness check for Delta table files in disk cache</p></li>
<li><p>[SQL] Use correct dynamic pruning build key when range join hint is present</p></li>
<li><p>Disable char type support in non-SQL code path</p></li>
<li><p>Avoid NPE in DataFrameReader.schema</p></li>
<li><p>Fix NPE when EventGridClient response has no entity</p></li>
<li><p>Fix a read closed stream bug in Azure Auto Loader</p></li>
</ul>
</li>
<li><p>February 24, 2021</p>
<ul>
<li><p>Upgraded the Spark BigQuery connector to v0.18, which introduces various bug fixes and support for Arrow and Avro iterators.</p></li>
<li><p>Fixed a correctness issue that caused Spark to return incorrect results when the Parquet file’s decimal precision and scale are different from the Spark schema.</p></li>
<li><p>Fixed reading failure issue on Microsoft SQL Server tables that contain spatial data types, by adding geometry and geography JDBC types support for Spark SQL.</p></li>
<li><p>Introduced a new configuration <code class="docutils literal notranslate"><span class="pre">spark.databricks.hive.metastore.init.reloadFunctions.enabled</span></code>. This configuration controls the built in Hive initialization. When set to true, Databricks reloads all functions from all databases that users have into <code class="docutils literal notranslate"><span class="pre">FunctionRegistry</span></code>. This is the default behavior in Hive Metastore. When set to false, Databricks disables this process for optimization.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-34212">[SPARK-34212]</a> Fixed issues related to reading decimal data from Parquet files.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-34260">[SPARK-34260]</a>[SQL] Fix UnresolvedException when creating temp view twice.</p></li>
</ul>
</li>
<li><p>February 4, 2021</p>
<ul>
<li><p>Fixed a regression that prevents the incremental execution of a query that sets a global limit such as <code class="docutils literal notranslate"><span class="pre">SELECT</span> <span class="pre">*</span> <span class="pre">FROM</span> <span class="pre">table</span> <span class="pre">LIMIT</span> <span class="pre">nrows</span></code>. The regression was experienced by users running queries via ODBC/JDBC with Arrow serialization enabled.</p></li>
<li><p>Introduced write time checks to the Hive client to prevent the corruption of metadata in the Hive metastore for Delta tables.</p></li>
<li><p>Fixed a regression that caused DBFS FUSE to fail to start when cluster environment variable configurations contain invalid bash syntax.</p></li>
</ul>
</li>
<li><p>January 20, 2021</p>
<ul>
<li><p>Fixed a regression in the January 12, 2021 maintenance release that can cause an incorrect AnalysisException and say the column is ambiguous in a self join. This regression happens when a user joins a DataFrame with its derived DataFrame (a so-called self-join) with the following conditions:</p>
<ul>
<li><p>These two DataFrames have common columns, but the output of the self join does not have common columns. For example, <code class="docutils literal notranslate"><span class="pre">df.join(df.select($&quot;col&quot;</span> <span class="pre">as</span> <span class="pre">&quot;new_col&quot;),</span> <span class="pre">cond)</span></code></p></li>
<li><p>The derived DataFrame excludes some columns via select, groupBy, or window.</p></li>
<li><p>The join condition or the following transformation after the joined Dataframe refers to the non-common columns. For example, <code class="docutils literal notranslate"><span class="pre">df.join(df.drop(&quot;a&quot;),</span> <span class="pre">df(&quot;a&quot;)</span> <span class="pre">===</span> <span class="pre">1)</span></code></p></li>
</ul>
</li>
</ul>
</li>
<li><p>January 12, 2021</p>
<ul>
<li><p>Upgrade Azure Storage SDK from 2.3.8 to 2.3.9.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-33593">[SPARK-33593]</a>[SQL] Vector reader got incorrect data with binary partition value</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-33480">[SPARK-33480]</a>[SQL] updates the error message of char/varchar table insertion length check</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="databricks-runtime-73-lts-unsupported">
<span id="dbr-73-lts-unsupported"></span><span id="73"></span><h3><a class="toc-backref" href="#id25">Databricks Runtime 7.3 LTS (unsupported)</a><a class="headerlink" href="#databricks-runtime-73-lts-unsupported" title="Permalink to this headline"> </a></h3>
<p>See <a class="reference internal" href="7.3lts.html"><span class="doc">Databricks Runtime 7.3 LTS (unsupported)</span></a>.</p>
<ul>
<li><p>September 10, 2023</p>
<ul class="simple">
<li><p>Miscellaneous bug fixes.</p></li>
</ul>
</li>
<li><p>August 30, 2023</p>
<ul class="simple">
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>August 15, 2023</p>
<ul class="simple">
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>June 23, 2023</p>
<ul class="simple">
<li><p>Snowflake-jdbc library is upgraded to 3.13.29 to address a security issue.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>June 15, 2023</p>
<ul class="simple">
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-43413">[SPARK-43413]</a>[SQL] Fix <code class="docutils literal notranslate"><span class="pre">IN</span></code> subquery <code class="docutils literal notranslate"><span class="pre">ListQuery</span></code> nullability.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>June 2, 2023</p>
<ul class="simple">
<li><p>Fixed an issue in Auto Loader where different source file formats were inconsistent when the provided schema did not include inferred partitions. This issue could cause unexpected failures when reading files with missing columns in the inferred partition schema.</p></li>
</ul>
</li>
<li><p>May 17, 2023</p>
<ul class="simple">
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>April 25, 2023</p>
<ul class="simple">
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>April 11, 2023</p>
<ul class="simple">
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-42967">[SPARK-42967]</a>[CORE] Fix SparkListenerTaskStart.stageAttemptId when a task is started after the stage is cancelled.</p></li>
<li><p>Miscellaneous bug fixes.</p></li>
</ul>
</li>
<li><p>March 29, 2023</p>
<ul class="simple">
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>March 14, 2023</p>
<ul class="simple">
<li><p>Miscellaneous bug fixes.</p></li>
</ul>
</li>
<li><p>February 28, 2023</p>
<ul class="simple">
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>February 16, 2023</p>
<ul class="simple">
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>January 31, 2023</p>
<ul class="simple">
<li><p>Table types of JDBC tables are now EXTERNAL by default.</p></li>
</ul>
</li>
<li><p>January 18, 2023</p>
<ul class="simple">
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>November 29, 2022</p>
<ul class="simple">
<li><p>Miscellaneous bug fixes.</p></li>
</ul>
</li>
<li><p>November 15, 2022</p>
<ul class="simple">
<li><p>Upgraded Apache commons-text to 1.10.0.</p></li>
<li><p>Operating system security updates.</p></li>
<li><p>Miscellaneous bug fixes.</p></li>
</ul>
</li>
<li><p>November 1, 2022</p>
<ul class="simple">
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38542">[SPARK-38542]</a>[SQL] UnsafeHashedRelation should serialize numKeys out</p></li>
</ul>
</li>
<li><p>October 18, 2022</p>
<ul class="simple">
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>October 5, 2022</p>
<ul class="simple">
<li><p>Miscellaneous bug fixes.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>September 22, 2022</p>
<ul class="simple">
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40089">[SPARK-40089]</a>[SQL] Fix sorting for some Decimal types</p></li>
</ul>
</li>
<li><p>September 6, 2022</p>
<ul class="simple">
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-35542">[SPARK-35542]</a>[CORE][ML] Fix: Bucketizer created for multiple columns with parameters splitsArray,  inputCols and outputCols can not be loaded after saving it</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-40079">[SPARK-40079]</a>[CORE] Add Imputer inputCols validation for empty input case</p></li>
</ul>
</li>
<li><p>August 24, 2022</p>
<ul class="simple">
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-39962">[SPARK-39962]</a>[PYTHON][SQL] Apply projection when group attributes are empty</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>August 9, 2022</p>
<ul class="simple">
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>July 27, 2022</p>
<ul class="simple">
<li><p>Make Delta MERGE operation results consistent when source is non-deterministic.</p></li>
<li><p>Operating system security updates.</p></li>
<li><p>Miscellaneous bug fixes.</p></li>
</ul>
</li>
<li><p>July 13, 2022</p>
<ul class="simple">
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-32680">[SPARK-32680]</a>[SQL] Don’t Preprocess V2 CTAS with Unresolved Query</p></li>
<li><p>Disabled Auto Loader’s use of native cloud APIs for directory listing on Azure.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>July 5, 2022</p>
<ul class="simple">
<li><p>Operating system security updates.</p></li>
<li><p>Miscellaneous bug fixes.</p></li>
</ul>
</li>
<li><p>June 2, 2022</p>
<ul class="simple">
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-38918">[SPARK-38918]</a>[SQL] Nested column pruning should filter out attributes that do not belong to the current relation</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>May 18, 2022</p>
<ul class="simple">
<li><p>Upgrade AWS SDK version from 1.11.655 to 1.11.678.</p></li>
<li><p>Operating system security updates.</p></li>
<li><p>Miscellaneous bug fixes.</p></li>
</ul>
</li>
<li><p>April 19, 2022</p>
<ul class="simple">
<li><p>Operating system security updates.</p></li>
<li><p>Miscellaneous bug fixes.</p></li>
</ul>
</li>
<li><p>April 6, 2022</p>
<ul class="simple">
<li><p>Operating system security updates.</p></li>
<li><p>Miscellaneous bug fixes.</p></li>
</ul>
</li>
<li><p>March 14, 2022</p>
<ul class="simple">
<li><p>Remove vulnerable classes from log4j 1.2.17 jar</p></li>
<li><p>Miscellaneous bug fixes.</p></li>
</ul>
</li>
<li><p>February 23, 2022</p>
<ul class="simple">
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-37859">[SPARK-37859]</a>[SQL] Do not check for metadata during schema comparison</p></li>
</ul>
</li>
<li><p>February 8, 2022</p>
<ul class="simple">
<li><p>Upgrade Ubuntu JDK to 1.8.0.312.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>February 1, 2022</p>
<ul class="simple">
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>January 26, 2022</p>
<ul class="simple">
<li><p>Fixed a bug where the OPTIMIZE command could fail when the ANSI SQL dialect was enabled.</p></li>
</ul>
</li>
<li><p>January 19, 2022</p>
<ul class="simple">
<li><p>Conda defaults channel is removed from 7.3 ML LTS</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>December 7, 2021</p>
<ul class="simple">
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>November 4, 2021</p>
<ul class="simple">
<li><p>Fixed a bug that could cause Structured Streaming streams to fail with an ArrayIndexOutOfBoundsException</p></li>
<li><p>Fixed a race condition that might cause a query failure with an IOException like <code class="docutils literal notranslate"><span class="pre">java.io.IOException:</span> <span class="pre">No</span> <span class="pre">FileSystem</span> <span class="pre">for</span> <span class="pre">scheme</span></code> or that might cause modifications to <code class="docutils literal notranslate"><span class="pre">sparkContext.hadoopConfiguration</span></code> to not take effect in queries.</p></li>
</ul>
</li>
<li><p>September 15, 2021</p>
<ul class="simple">
<li><p>Fixed a race condition that might cause a query failure with an IOException like <code class="docutils literal notranslate"><span class="pre">java.io.IOException:</span> <span class="pre">org.apache.spark.SparkException:</span> <span class="pre">Failed</span> <span class="pre">to</span> <span class="pre">get</span> <span class="pre">broadcast_x_piecey</span> <span class="pre">of</span> <span class="pre">broadcast_x</span></code>.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>September 8, 2021</p>
<ul class="simple">
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-35700">[SPARK-35700]</a>[SQL][WARMFIX] Read char/varchar orc table when created and written by external systems.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-36532">[SPARK-36532]</a>[CORE][3.1] Fixed deadlock in <code class="docutils literal notranslate"><span class="pre">CoarseGrainedExecutorBackend.onDisconnected</span></code> to avoid <code class="docutils literal notranslate"><span class="pre">executorsconnected</span></code> to prevent executor shutdown hang.</p></li>
</ul>
</li>
<li><p>August 25, 2021</p>
<ul class="simple">
<li><p>Snowflake connector was upgraded to 2.9.0.</p></li>
</ul>
</li>
<li><p>July 29, 2021</p>
<ul class="simple">
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-36034">[SPARK-36034]</a>[BUILD] Rebase datetime in pushed down filters to Parquet</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-34508">[SPARK-34508]</a>[BUILD] Skip <code class="docutils literal notranslate"><span class="pre">HiveExternalCatalogVersionsSuite</span></code> if network is down</p></li>
</ul>
</li>
<li><p>July 14, 2021</p>
<ul class="simple">
<li><p>Introduced <code class="docutils literal notranslate"><span class="pre">database.schema.table</span></code> format for Azure Synapse connector.</p></li>
<li><p>Added support to provide <code class="docutils literal notranslate"><span class="pre">databaseName.schemaName.tableName</span></code> format as the target table instead of only <code class="docutils literal notranslate"><span class="pre">schemaName.tableName</span></code> or <code class="docutils literal notranslate"><span class="pre">tableName</span></code>.</p></li>
<li><p>Fixed a bug that prevents users from time traveling to older available versions with Delta tables.</p></li>
</ul>
</li>
<li><p>June 15, 2021</p>
<ul class="simple">
<li><p>Fixes a <code class="docutils literal notranslate"><span class="pre">NoSuchElementException</span></code> bug in Delta Lake optimized writes that can happen when writing large amounts of data and encountering executor losses</p></li>
</ul>
<ul class="simple">
<li><p>Updated Python with security patch to fix Python security vulnerability (CVE-2021-3177).</p></li>
</ul>
</li>
<li><p>April 30, 2021</p>
<ul class="simple">
<li><p>Operating system security updates.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-35227">[SPARK-35227]</a>[BUILD] Update the resolver for spark-packages in SparkSubmit</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-34245">[SPARK-34245]</a>[CORE] Ensure Master removes executors that failed to send finished state</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-35045">[SPARK-35045]</a>[SQL] Add an internal option to control input buffer in univocity</p></li>
</ul>
</li>
<li><p>March 24, 2021</p>
<ul class="simple">
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-34768">[SPARK-34768]</a>[SQL] Respect the default input buffer size in Univocity</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-34534">[SPARK-34534]</a> Fix blockIds order when use FetchShuffleBlocks to fetch blocks</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-33118">[SPARK-33118]</a>[SQL]CREATE TEMPORARY TABLE fails with location</p></li>
<li><p>Disk caching is enabled by default on i3en instances.</p></li>
</ul>
</li>
<li><p>March 9, 2021</p>
<ul class="simple">
<li><p>The updated Azure Blob File System driver for Azure Data Lake Storage Gen2 is now enabled by default. It brings multiple stability improvements.</p></li>
<li><p>Fix path separator on Windows for <code class="docutils literal notranslate"><span class="pre">databricks-connect</span> <span class="pre">get-jar-dir</span></code></p></li>
<li><p>[UI] Fix the href link of Spark DAG Visualization</p></li>
<li><p>[DBCONNECT] Add support for FlatMapCoGroupsInPandas in Databricks Connect 7.3</p></li>
<li><p>Restore the output schema of <code class="docutils literal notranslate"><span class="pre">SHOW</span> <span class="pre">DATABASES</span></code></p></li>
<li><p>[SQL] Use correct dynamic pruning build key when range join hint is present</p></li>
<li><p>Disable staleness check for Delta table files in disk cache</p></li>
<li><p>[SQL] Do not generate shuffle partition number advice when AOS is enable</p></li>
</ul>
</li>
<li><p>February 24, 2021</p>
<ul class="simple">
<li><p>Upgraded the Spark BigQuery connector to v0.18, which introduces various bug fixes and support for Arrow and Avro iterators.</p></li>
<li><p>Fixed a correctness issue that caused Spark to return incorrect results when the Parquet file’s decimal precision and scale are different from the Spark schema.</p></li>
<li><p>Fixed reading failure issue on Microsoft SQL Server tables that contain spatial data types, by adding geometry and geography JDBC types support for Spark SQL.</p></li>
<li><p>Introduced a new configuration <code class="docutils literal notranslate"><span class="pre">spark.databricks.hive.metastore.init.reloadFunctions.enabled</span></code>. This configuration controls the built in Hive initialization. When set to true, Databricks reloads all functions from all databases that users have into <code class="docutils literal notranslate"><span class="pre">FunctionRegistry</span></code>. This is the default behavior in Hive Metastore. When set to false, Databricks disables this process for optimization.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-34212">[SPARK-34212]</a> Fixed issues related to reading decimal data from Parquet files.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-33579">[SPARK-33579]</a>[UI] Fix executor blank page behind proxy.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-20044">[SPARK-20044]</a>[UI] Support Spark UI behind front-end reverse proxy using a path prefix.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-33277">[SPARK-33277]</a>[PYSPARK][SQL] Use ContextAwareIterator to stop consuming after the task ends.</p></li>
</ul>
</li>
<li><p>February 4, 2021</p>
<ul class="simple">
<li><p>Fixed a regression that prevents the incremental execution of a query that sets a global limit such as <code class="docutils literal notranslate"><span class="pre">SELECT</span> <span class="pre">*</span> <span class="pre">FROM</span> <span class="pre">table</span> <span class="pre">LIMIT</span> <span class="pre">nrows</span></code>. The regression was experienced by users running queries via ODBC/JDBC with Arrow serialization enabled.</p></li>
<li><p>Fixed a regression that caused DBFS FUSE to fail to start when cluster environment variable configurations contain invalid bash syntax.</p></li>
</ul>
</li>
<li><p>January 20, 2021</p>
<ul class="simple">
<li><p>Fixed a regression in the January 12, 2021 maintenance release that can cause an incorrect AnalysisException and say the column is ambiguous in a self join. This regression happens when a user joins a DataFrame with its derived DataFrame (a so-called self-join) with the following conditions:</p>
<ul>
<li><p>These two DataFrames have common columns, but the output of the self join does not have common columns. For example, <code class="docutils literal notranslate"><span class="pre">df.join(df.select($&quot;col&quot;</span> <span class="pre">as</span> <span class="pre">&quot;new_col&quot;),</span> <span class="pre">cond)</span></code></p></li>
<li><p>The derived DataFrame excludes some columns via select, groupBy, or window.</p></li>
<li><p>The join condition or the following transformation after the joined Dataframe refers to the non-common columns. For example, <code class="docutils literal notranslate"><span class="pre">df.join(df.drop(&quot;a&quot;),</span> <span class="pre">df(&quot;a&quot;)</span> <span class="pre">===</span> <span class="pre">1)</span></code></p></li>
</ul>
</li>
</ul>
</li>
<li><p>January 12, 2021</p>
<ul class="simple">
<li><p>Operating system security updates.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-33593">[SPARK-33593]</a>[SQL] Vector reader got incorrect data with binary partition value</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-33677">[SPARK-33677]</a>[SQL] Skip LikeSimplification rule if pattern contains any escapeChar</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-33592">[SPARK-33592]</a>[ML][PYTHON] Pyspark ML Validator params in estimatorParamMaps may be lost after saving and reloading</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-33071">[SPARK-33071]</a>[SPARK-33536][SQL] Avoid changing dataset_id of LogicalPlan in join() to not break DetectAmbiguousSelfJoin</p></li>
</ul>
</li>
<li><p>December 8, 2020</p>
<ul class="simple">
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-33587">[SPARK-33587]</a>[CORE] Kill the executor on nested fatal errors</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-27421">[SPARK-27421]</a>[SQL] Fix filter for int column and value class java.lang.String when pruning partition column</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-33316">[SPARK-33316]</a>[SQL] Support user provided nullable Avro schema for non-nullable catalyst schema in Avro writing</p></li>
<li><p>Spark Jobs launched using Databricks Connect could hang indefinitely with <code class="docutils literal notranslate"><span class="pre">Executor$TaskRunner.$anonfun$copySessionState</span></code> in executor stack trace</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
</ul>
<ul class="simple">
<li><p>November 20, 2020</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-33404">[SPARK-33404]</a>[SQL][3.0] Fix incorrect results in <code class="docutils literal notranslate"><span class="pre">date_trunc</span></code> expression</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-33339">[SPARK-33339]</a>[PYTHON] Pyspark application will hang due to non Exception error</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-33183">[SPARK-33183]</a>[SQL][HOTFIX] Fix Optimizer rule EliminateSorts and add a physical rule to remove redundant sorts</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-33371">[SPARK-33371]</a>[PYTHON][3.0] Update setup.py and tests for Python 3.9</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-33391">[SPARK-33391]</a>[SQL] element_at with CreateArray not respect one based index.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-33306">[SPARK-33306]</a>[SQL]Timezone is needed when cast date to string</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-33260">[SPARK-33260]</a>[SQL] Fix incorrect results from SortExec when sortOrder is Stream</p></li>
</ul>
</li>
</ul>
<ul class="simple">
<li><p>November 5, 2020</p>
<ul>
<li><p>Fix ABFS and WASB locking with regard to <code class="docutils literal notranslate"><span class="pre">UserGroupInformation.getCurrentUser()</span></code>.</p></li>
<li><p>Fix an infinite loop bug when Avro reader reads the MAGIC bytes.</p></li>
<li><p>Add support for the <a class="reference internal" href="../../data-governance/table-acls/object-privileges.html#usage-privilege"><span class="std std-ref">USAGE privilege</span></a>.</p></li>
<li><p>Performance improvements for privilege checking in <a class="reference internal" href="../../data-governance/table-acls/index.html"><span class="doc">table access control</span></a>.</p></li>
</ul>
</li>
<li><p>October 13, 2020</p>
<ul>
<li><p>Operating system security updates.</p></li>
<li><p>You can read and write from DBFS using the FUSE mount at /dbfs/ when on a high concurrency credential passthrough enabled cluster. Regular mounts are supported but mounts that need passthrough credentials are not supported yet.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-32999">[SPARK-32999]</a>[SQL] Use Utils.getSimpleName to avoid hitting Malformed class name in TreeNode</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-32585">[SPARK-32585]</a>[SQL] Support scala enumeration in ScalaReflection</p></li>
<li><p>Fixed listing directories in FUSE mount that contain file names with invalid XML characters</p></li>
<li><p>FUSE mount no longer uses ListMultipartUploads</p></li>
</ul>
</li>
<li><p>September 29, 2020</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-32718">[SPARK-32718]</a>[SQL] Remove unnecessary keywords for interval units</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-32635">[SPARK-32635]</a>[SQL] Fix foldable propagation</p></li>
<li><p>Add a new config <code class="docutils literal notranslate"><span class="pre">spark.shuffle.io.decoder.consolidateThreshold</span></code>. Set the config value to <code class="docutils literal notranslate"><span class="pre">Long.MAX_VALUE</span></code> to skip the consolidation of netty FrameBuffers, which prevents <code class="docutils literal notranslate"><span class="pre">java.lang.IndexOutOfBoundsException</span></code> in corner cases.</p></li>
</ul>
</li>
</ul>
<ul>
<li><p>April 25, 2023</p>
<ul class="simple">
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>April 11, 2023</p>
<ul class="simple">
<li><p>Miscellaneous bug fixes.</p></li>
</ul>
</li>
<li><p>March 29, 2023</p>
<ul class="simple">
<li><p>Miscellaneous bug fixes.</p></li>
</ul>
</li>
<li><p>March 14, 2023</p>
<ul class="simple">
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>February 28, 2023</p>
<ul class="simple">
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>February 16, 2023</p>
<ul class="simple">
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>January 31, 2023</p>
<ul class="simple">
<li><p>Miscellaneous bug fixes.</p></li>
</ul>
</li>
<li><p>January 18, 2023</p>
<ul class="simple">
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>November 29, 2022</p>
<ul class="simple">
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>November 15, 2022</p>
<ul class="simple">
<li><p>Operating system security updates.</p></li>
<li><p>Miscellaneous bug fixes.</p></li>
</ul>
</li>
<li><p>November 1, 2022</p>
<ul class="simple">
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>October 18, 2022</p>
<ul class="simple">
<li><p>Operating system security updates.</p></li>
<li><p>October 5, 2022</p>
<ul>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>August 24, 2022</p>
<ul>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>August 9, 2022</p>
<ul>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>July 27, 2022</p>
<ul>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>July 5, 2022</p>
<ul>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>June 2, 2022</p>
<ul>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>May 18, 2022</p>
<ul>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>April 19, 2022</p>
<ul>
<li><p>Operating system security updates.</p></li>
<li><p>Miscellaneous bug fixes.</p></li>
</ul>
</li>
<li><p>April 6, 2022</p>
<ul>
<li><p>Operating system security updates.</p></li>
<li><p>Miscellaneous bug fixes.</p></li>
</ul>
</li>
<li><p>March 14, 2022</p>
<ul>
<li><p>Miscellaneous bug fixes.</p></li>
</ul>
</li>
<li><p>February 23, 2022</p>
<ul>
<li><p>Miscellaneous bug fixes.</p></li>
</ul>
</li>
<li><p>February 8, 2022</p>
<ul>
<li><p>Upgrade Ubuntu JDK to 1.8.0.312.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>February 1, 2022</p>
<ul>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>January 19, 2022</p>
<ul>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>September 22, 2021</p>
<ul>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>April 30, 2021</p>
<ul>
<li><p>Operating system security updates.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-35227">[SPARK-35227]</a>[BUILD] Update the resolver for spark-packages in SparkSubmit</p></li>
</ul>
</li>
<li><p>January 12, 2021</p>
<ul>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>December 8, 2020</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-27421">[SPARK-27421]</a>[SQL] Fix filter for int column and value class java.lang.String when pruning partition column</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
</ul>
<ul class="simple">
<li><p>November 20, 2020</p></li>
</ul>
<ul class="simple">
<li><p>November 3, 2020</p>
<ul>
<li><p>Upgraded Java version from 1.8.0_252 to 1.8.0_265.</p></li>
<li><p>Fix ABFS and WASB locking with regard to UserGroupInformation.getCurrentUser()</p></li>
</ul>
</li>
<li><p>October 13, 2020</p>
<ul>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="databricks-runtime-64-extended-support-unsupported">
<span id="dbr-64-extended-support-unsupported"></span><span id="64"></span><span id="74"></span><h3><a class="toc-backref" href="#id26">Databricks Runtime 6.4 Extended Support (unsupported)</a><a class="headerlink" href="#databricks-runtime-64-extended-support-unsupported" title="Permalink to this headline"> </a></h3>
<p>See <a class="reference internal" href="6.4.html"><span class="doc">Databricks Runtime 6.4 (unsupported)</span></a> and <a class="reference internal" href="6.4x.html"><span class="doc">Databricks Runtime 6.4 Extended Support (unsupported)</span></a>.</p>
<ul class="simple">
<li><p>July 5, 2022</p>
<ul>
<li><p>Operating system security updates.</p></li>
<li><p>Miscellaneous bug fixes.</p></li>
</ul>
</li>
<li><p>June 2, 2022</p>
<ul>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>May 18, 2022</p>
<ul>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>April 19, 2022</p>
<ul>
<li><p>Operating system security updates.</p></li>
<li><p>Miscellaneous bug fixes.</p></li>
</ul>
</li>
<li><p>April 6, 2022</p>
<ul>
<li><p>Operating system security updates.</p></li>
<li><p>Miscellaneous bug fixes.</p></li>
</ul>
</li>
<li><p>March 14, 2022</p>
<ul>
<li><p>Remove vulnerable classes from log4j 1.2.17 jar</p></li>
<li><p>Miscellaneous bug fixes.</p></li>
</ul>
</li>
<li><p>February 23, 2022</p>
<ul>
<li><p>Miscellaneous bug fixes.</p></li>
</ul>
</li>
<li><p>February 8, 2022</p>
<ul>
<li><p>Upgrade Ubuntu JDK to 1.8.0.312.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>February 1, 2022</p>
<ul>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>January 26, 2022</p>
<ul>
<li><p>Fixed a bug where the OPTIMIZE command could fail when the ANSI SQL dialect was enabled.</p></li>
</ul>
</li>
<li><p>January 19, 2022</p>
<ul>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>December 8, 2021</p>
<ul>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>September 22, 2021</p>
<ul>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>June 15, 2021</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-35576">[SPARK-35576]</a>[SQL] Redact the sensitive info in the result of Set command</p></li>
</ul>
</li>
<li><p>June 7, 2021</p>
<ul>
<li><p>Add a new config called <code class="docutils literal notranslate"><span class="pre">spark.sql.maven.additionalRemoteRepositories</span></code>, a comma-delimited string config of the optional additional remote maven mirror. The value defaults to <code class="docutils literal notranslate"><span class="pre">https://maven-central.storage-download.googleapis.com/maven2/</span></code>.</p></li>
</ul>
</li>
<li><p>April 30, 2021</p>
<ul>
<li><p>Operating system security updates.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-35227">[SPARK-35227]</a>[BUILD] Update the resolver for spark-packages in SparkSubmit</p></li>
</ul>
</li>
</ul>
<ul class="simple">
<li><p>April 6, 2021</p>
<ul>
<li><p>Fixed retries added to the S3 client to resolve connection reset issues.</p></li>
</ul>
</li>
<li><p>March 24, 2021</p>
<ul>
<li><p>Disk caching is enabled by default on i3en instances.</p></li>
</ul>
</li>
</ul>
<ul class="simple">
<li><p>March 9, 2021</p>
<ul>
<li><p>Port HADOOP-17215 to the Azure Blob File System driver (Support for conditional overwrite).</p></li>
<li><p>Fix path separator on Windows for <code class="docutils literal notranslate"><span class="pre">databricks-connect</span> <span class="pre">get-jar-dir</span></code></p></li>
<li><p>Added support for Hive metastore versions 2.3.5, 2.3.6, and 2.3.7</p></li>
<li><p>Arrow “totalResultsCollected” reported incorrectly after spill</p></li>
</ul>
</li>
<li><p>February 24, 2021</p>
<ul>
<li><p>Introduced a new configuration <code class="docutils literal notranslate"><span class="pre">spark.databricks.hive.metastore.init.reloadFunctions.enabled</span></code>. This configuration controls the built in Hive initialization. When set to true, Databricks reloads all functions from all databases that users have into <code class="docutils literal notranslate"><span class="pre">FunctionRegistry</span></code>. This is the default behavior in Hive Metastore. When set to false, Databricks disables this process for optimization.</p></li>
</ul>
</li>
<li><p>February 4, 2021</p>
<ul>
<li><p>Fixed a regression that prevents the incremental execution of a query that sets a global limit such as <code class="docutils literal notranslate"><span class="pre">SELECT</span> <span class="pre">*</span> <span class="pre">FROM</span> <span class="pre">table</span> <span class="pre">LIMIT</span> <span class="pre">nrows</span></code>. The regression was experienced by users running queries via ODBC/JDBC with Arrow serialization enabled.</p></li>
<li><p>Fixed a regression that caused DBFS FUSE to fail to start when cluster environment variable configurations contain invalid bash syntax.</p></li>
</ul>
</li>
<li><p>January 12, 2021</p>
<ul>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>December 8, 2020</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-27421">[SPARK-27421]</a>[SQL] Fix filter for int column and value class java.lang.String when pruning partition column</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-33183">[SPARK-33183]</a>[SQL] Fix Optimizer rule EliminateSorts and add a physical rule to remove redundant sorts</p></li>
<li><p>[Runtime 6.4 ML GPU] We previously installed an incorrect version (2.7.8-1+cuda11.1) of NCCL. This release corrects it to 2.4.8-1+cuda10.0 that is compatible with CUDA 10.0.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
</ul>
<ul class="simple">
<li><p>November 20, 2020</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-33260">[SPARK-33260]</a>[SQL] Fix incorrect results from SortExec when sortOrder is Stream</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-32635">[SPARK-32635]</a>[SQL] Fix foldable propagation</p></li>
</ul>
</li>
</ul>
<ul class="simple">
<li><p>November 3, 2020</p>
<ul>
<li><p>Upgraded Java version from 1.8.0_252 to 1.8.0_265.</p></li>
<li><p>Fix ABFS and WASB locking with regard to UserGroupInformation.getCurrentUser()</p></li>
<li><p>Fix an infinite loop bug of Avro reader when reading the MAGIC bytes.</p></li>
</ul>
</li>
<li><p>October 13, 2020</p>
<ul>
<li><p>Operating system security updates.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-32999">[SPARK-32999]</a>[SQL][2.4] Use Utils.getSimpleName to avoid hitting Malformed class name in TreeNode</p></li>
<li><p>Fixed listing directories in FUSE mount that contain file names with invalid XML characters</p></li>
<li><p>FUSE mount no longer uses ListMultipartUploads</p></li>
</ul>
</li>
<li><p>September 24, 2020</p>
<ul>
<li><p>Fixed a previous limitation where passthrough on standard cluster would still restrict the filesystem implementation user uses. Now users would be able to access local filesystems without restrictions.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>September 8, 2020</p>
<ul>
<li><p>A new parameter was created for Azure Synapse Analytics, <code class="docutils literal notranslate"><span class="pre">maxbinlength</span></code>. This parameter is used to control the column length of BinaryType columns, and is translated as <code class="docutils literal notranslate"><span class="pre">VARBINARY(maxbinlength)</span></code>. It can be set using <code class="docutils literal notranslate"><span class="pre">.option(&quot;maxbinlength&quot;,</span> <span class="pre">n)</span></code>, where 0 &lt; n &lt;= 8000.</p></li>
<li><p>Update Azure Storage SDK to 8.6.4 and enable TCP keep alive on connections made by the WASB driver</p></li>
</ul>
</li>
<li><p>August 25, 2020</p>
<ul>
<li><p>Fixed ambiguous attribute resolution in self-merge</p></li>
</ul>
</li>
<li><p>August 18, 2020</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-32431">[SPARK-32431]</a>[SQL] Check duplicate nested columns in read from in-built datasources</p></li>
<li><p>Fixed a race condition in the SQS connector when using Trigger.Once.</p></li>
</ul>
</li>
<li><p>August 11, 2020</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-28676">[SPARK-28676]</a>[CORE] Avoid Excessive logging from ContextCleaner</p></li>
</ul>
</li>
<li><p>August 3, 2020</p>
<ul>
<li><p>You can now use the LDA transform function on a passthrough-enabled cluster.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>July 7, 2020</p>
<ul>
<li><p>Upgraded Java version from 1.8.0_232 to 1.8.0_252.</p></li>
</ul>
</li>
<li><p>April 21, 2020</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-31312">[SPARK-31312]</a>[SQL] Cache Class instance for the UDF instance in HiveFunctionWrapper</p></li>
</ul>
</li>
<li><p>April 7, 2020</p>
<ul>
<li><p>To resolve an issue with pandas udf not working with PyArrow 0.15.0 and above, we added an environment variable (<code class="docutils literal notranslate"><span class="pre">ARROW_PRE_0_15_IPC_FORMAT=1</span></code>) to enable support for those versions of PyArrow. See the instructions in <a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-29367">[SPARK-29367]</a>.</p></li>
</ul>
</li>
<li><p>March 10, 2020</p>
<ul>
<li><p>Optimized autoscaling is now used by default on interactive clusters on the Security plan.</p></li>
<li><p>The Snowflake connector (<code class="docutils literal notranslate"><span class="pre">spark-snowflake_2.11</span></code>) included in Databricks Runtime is updated to version 2.5.9. <code class="docutils literal notranslate"><span class="pre">snowflake-jdbc</span></code> is updated to version 3.12.0.</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="databricks-runtime-55-lts-unsupported">
<span id="dbr-55-lts-unsupported"></span><span id="55"></span><h3><a class="toc-backref" href="#id27">Databricks Runtime 5.5 LTS (unsupported)</a><a class="headerlink" href="#databricks-runtime-55-lts-unsupported" title="Permalink to this headline"> </a></h3>
<p>See <a class="reference internal" href="5.5.html"><span class="doc">Databricks Runtime 5.5 LTS (unsupported)</span></a> and <a class="reference internal" href="5.5x.html"><span class="doc">Databricks Runtime 5.5 Extended Support (unsupported)</span></a>.</p>
<ul class="simple">
<li><p>December 8, 2021</p>
<ul>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>September 22, 2021</p>
<ul>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>August 25, 2021</p>
<ul>
<li><p>Downgraded some previously upgraded python packages in 5.5 ML Extended Support Release to maintain better parity with 5.5 ML LTS (now deprecated). See [_]/release-notes/runtime/5.5xml.md) for the updated differences between the two versions.</p></li>
</ul>
</li>
<li><p>June 15, 2021</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-35576">[SPARK-35576]</a>[SQL] Redact the sensitive info in the result of Set command</p></li>
</ul>
</li>
<li><p>June 7, 2021</p>
<ul>
<li><p>Add a new config called <code class="docutils literal notranslate"><span class="pre">spark.sql.maven.additionalRemoteRepositories</span></code>, a comma-delimited string config of the optional additional remote maven mirror. The value defaults to <code class="docutils literal notranslate"><span class="pre">https://maven-central.storage-download.googleapis.com/maven2/</span></code>.</p></li>
</ul>
</li>
<li><p>April 30, 2021</p>
<ul>
<li><p>Operating system security updates.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-35227">[SPARK-35227]</a>[BUILD] Update the resolver for spark-packages in SparkSubmit</p></li>
</ul>
</li>
</ul>
<ul class="simple">
<li><p>April 6, 2021</p>
<ul>
<li><p>Fixed retries added to the S3 client to resolve connection reset issues.</p></li>
</ul>
</li>
<li><p>March 24, 2021</p>
<ul>
<li><p>Disk caching is enabled by default on i3en instances.</p></li>
</ul>
</li>
</ul>
<ul class="simple">
<li><p>March 9, 2021</p>
<ul>
<li><p>Port HADOOP-17215 to the Azure Blob File System driver (Support for conditional overwrite).</p></li>
</ul>
</li>
<li><p>February 24, 2021</p>
<ul>
<li><p>Introduced a new configuration <code class="docutils literal notranslate"><span class="pre">spark.databricks.hive.metastore.init.reloadFunctions.enabled</span></code>. This configuration controls the built in Hive initialization. When set to true, Databricks reloads all functions from all databases that users have into <code class="docutils literal notranslate"><span class="pre">FunctionRegistry</span></code>. This is the default behavior in Hive Metastore. When set to false, Databricks disables this process for optimization.</p></li>
</ul>
</li>
<li><p>January 12, 2021</p>
<ul>
<li><p>Operating system security updates.</p></li>
<li><p>Fix for <a class="reference external" href="https://issues.apache.org/jira/browse/HADOOP-17130">[HADOOP-17130]</a>.</p></li>
</ul>
</li>
<li><p>December 8, 2020</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-27421">[SPARK-27421]</a>[SQL] Fix filter for int column and value class java.lang.String when pruning partition column</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
</ul>
<ul class="simple">
<li><p>November 20, 2020</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-33260">[SPARK-33260]</a>[SQL] Fix incorrect results from SortExec when sortOrder is Stream</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-32635">[SPARK-32635]</a>[SQL] Fix foldable propagation</p></li>
</ul>
</li>
</ul>
<ul>
<li><p>October 29, 2020</p>
<ul class="simple">
<li><p>Upgraded Java version from 1.8.0_252 to 1.8.0_265.</p></li>
<li><p>Fix ABFS and WASB locking with regard to UserGroupInformation.getCurrentUser()</p></li>
<li><p>Fix an infinite loop bug of Avro reader when reading the MAGIC bytes.</p></li>
</ul>
</li>
<li><p>October 13, 2020</p>
<ul class="simple">
<li><p>Operating system security updates.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-32999">[SPARK-32999]</a>[SQL][2.4] Use Utils.getSimpleName to avoid hitting Malformed class name in TreeNode</p></li>
</ul>
</li>
<li><p>September 24, 2020</p>
<ul class="simple">
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>September 8, 2020</p>
<ul class="simple">
<li><p>A new parameter was created for Azure Synapse Analytics, <code class="docutils literal notranslate"><span class="pre">maxbinlength</span></code>. This parameter is used to control the column length of BinaryType columns, and is translated as <code class="docutils literal notranslate"><span class="pre">VARBINARY(maxbinlength)</span></code>. It can be set using <code class="docutils literal notranslate"><span class="pre">.option(&quot;maxbinlength&quot;,</span> <span class="pre">n)</span></code>, where 0 &lt; n &lt;= 8000.</p></li>
</ul>
</li>
<li><p>August 18, 2020</p>
<ul class="simple">
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-32431">[SPARK-32431]</a>[SQL] Check duplicate nested columns in read from in-built datasources</p></li>
<li><p>Fixed a race condition in the SQS connector when using Trigger.Once.</p></li>
</ul>
</li>
<li><p>August 11, 2020</p>
<ul class="simple">
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-28676">[SPARK-28676]</a>[CORE] Avoid Excessive logging from ContextCleaner</p></li>
</ul>
</li>
<li><p>August 3, 2020</p>
<ul class="simple">
<li><p>Operating system security updates</p></li>
</ul>
</li>
<li><p>July 7, 2020</p>
<ul class="simple">
<li><p>Upgraded Java version from 1.8.0_232 to 1.8.0_252.</p></li>
</ul>
</li>
<li><p>April 21, 2020</p>
<ul class="simple">
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-31312">[SPARK-31312]</a>[SQL] Cache Class instance for the UDF instance in HiveFunctionWrapper</p></li>
</ul>
</li>
<li><p>April 7, 2020</p>
<ul class="simple">
<li><p>To resolve an issue with pandas udf not working with PyArrow 0.15.0 and above, we added an environment variable (<code class="docutils literal notranslate"><span class="pre">ARROW_PRE_0_15_IPC_FORMAT=1</span></code>) to enable support for those versions of PyArrow. See the instructions in <a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-29367">[SPARK-29367]</a>.</p></li>
</ul>
</li>
<li><p>March 25, 2020</p>
<ul class="simple">
<li><p>The Snowflake connector (<code class="docutils literal notranslate"><span class="pre">spark-snowflake_2.11</span></code>) included in Databricks Runtime is updated to version 2.5.9. <code class="docutils literal notranslate"><span class="pre">snowflake-jdbc</span></code> is updated to version 3.12.0.</p></li>
</ul>
</li>
<li><p>March 10, 2020</p>
<ul class="simple">
<li><p>Job output, such as log output emitted to stdout, is subject to a 20MB size limit. If the total output has a larger size, the run will be canceled and marked as failed. To avoid encountering this limit, you can prevent stdout from being returned from the driver to by setting the <code class="docutils literal notranslate"><span class="pre">spark.databricks.driver.disableScalaOutput</span></code> Spark configuration to <code class="docutils literal notranslate"><span class="pre">true</span></code>. By default the flag value is <code class="docutils literal notranslate"><span class="pre">false</span></code>. The flag controls cell output for Scala JAR jobs and Scala notebooks. If the flag is enabled, Spark does not return job execution results to the client. The flag does not affect the data that is written in the cluster’s log files. Setting this flag is recommended only for automated clusters for JAR jobs, because it will disable notebook results.</p></li>
</ul>
</li>
<li><p>February 18, 2020</p>
<ul class="simple">
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-24783">[SPARK-24783]</a>[SQL] spark.sql.shuffle.partitions=0 should throw exception</p></li>
<li><p>Credential passthrough with ADLS Gen2 has a performance degradation due to incorrect thread local handling when ADLS client prefetching is enabled. This release disables ADLS Gen2 prefetching when credential passthrough is enabled until we have a proper fix.</p></li>
</ul>
</li>
<li><p>January 28, 2020</p>
<ul class="simple">
<li><p>Fixed a bug in S3AFileSystem, whereby <code class="docutils literal notranslate"><span class="pre">fs.isDirectory(path)</span></code> or <code class="docutils literal notranslate"><span class="pre">fs.getFileStatus(path).isDirectory()</span></code> could sometimes incorrectly return <code class="docutils literal notranslate"><span class="pre">false</span></code>. The bug would manifest on paths for which <code class="docutils literal notranslate"><span class="pre">aws</span> <span class="pre">s3</span> <span class="pre">list-objects-v2</span> <span class="pre">--prefix</span> <span class="pre">path/</span> <span class="pre">--max-keys</span> <span class="pre">1</span> <span class="pre">--delimiter</span> <span class="pre">/</span></code> responds with no keys or common prefixes, but <code class="docutils literal notranslate"><span class="pre">isTruncated</span> <span class="pre">=</span> <span class="pre">true</span></code>. This might happen for directories under which many objects were deleted and versioning was enabled.</p></li>
</ul>
<ul class="simple">
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-30447">[SPARK-30447]</a>[SQL] Constant propagation nullability issue.</p></li>
</ul>
</li>
<li><p>January 14, 2020</p>
<ul class="simple">
<li><p>Upgraded Java version from 1.8.0_222 to 1.8.0_232.</p></li>
</ul>
</li>
<li><p>November 19, 2019</p>
<ul class="simple">
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-29743">[SPARK-29743]</a> [SQL] sample should set needCopyResult to true if its child’s needCopyResult is true</p></li>
<li><p>R version was unintendedly upgraded to 3.6.1 from 3.6.0. We downgraded it back to 3.6.0.</p></li>
</ul>
</li>
<li><p>November 5, 2019</p>
<ul class="simple">
<li><p>Upgraded Java version from 1.8.0_212 to 1.8.0_222.</p></li>
</ul>
</li>
<li><p>October 23, 2019</p>
<ul class="simple">
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-29244">[SPARK-29244]</a>[CORE] Prevent freed page in BytesToBytesMap free again</p></li>
</ul>
</li>
<li><p>October 8, 2019</p>
<ul class="simple">
<li><p>Server side changes to allow Simba Apache Spark ODBC driver to reconnect and continue after a connection failure during fetching results (requires <a class="reference external" href="https://databricks.com/spark/odbc-driver-download">Simba Apache Spark ODBC driver version 2.6.10</a>).</p></li>
<li><p>Fixed an issue affecting using <code class="docutils literal notranslate"><span class="pre">Optimize</span></code> command with table ACL enabled clusters.</p></li>
<li><p>Fixed an issue where <code class="docutils literal notranslate"><span class="pre">pyspark.ml</span></code> libraries would fail due to Scala UDF forbidden error on table ACL enabled clusters.</p></li>
<li><p>Fixed NullPointerException when checking error code in the WASB client.</p></li>
</ul>
</li>
<li><p>September 24, 2019</p>
<ul class="simple">
<li><p>Improved stability of Parquet writer.</p></li>
<li><p>Fixed the problem that Thrift query cancelled before it starts executing may stuck in STARTED state.</p></li>
</ul>
</li>
<li><p>September 10, 2019</p>
<ul class="simple">
<li><p>Add thread safe iterator to BytesToBytesMap</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-27992">[SPARK-27992]</a><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-28881">[SPARK-28881]</a>Allow Python to join with connection thread to propagate errors</p></li>
<li><p>Fixed a bug affecting certain global aggregation queries.</p></li>
<li><p>Improved credential redaction.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-27330">[SPARK-27330]</a>[SS] support task abort in foreach writer</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-28642">[SPARK-28642]</a>Hide credentials in SHOW CREATE TABLE</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-28699">[SPARK-28699]</a>[SQL] Disable using radix sort for ShuffleExchangeExec in repartition case</p></li>
</ul>
</li>
<li><p>August 27, 2019</p>
<ul class="simple">
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-20906">[SPARK-20906]</a>[SQL]Allow user-specified schema in the API <em>to</em>avro_ with schema registry</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-27838">[SPARK-27838]</a>[SQL] Support user provided non-nullable avro schema for nullable catalyst schema without any null record</p></li>
<li><p>Improvement on Delta Lake time travel</p></li>
<li><p>Fixed an issue affecting certain <code class="docutils literal notranslate"><span class="pre">transform</span></code> expression</p></li>
<li><p>Supports broadcast variables when Process Isolation is enabled</p></li>
</ul>
</li>
<li><p>August 13, 2019</p>
<ul class="simple">
<li><p>Delta streaming source should check the latest protocol of a table</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-28260">[SPARK-28260]</a>Add CLOSED state to ExecutionState</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-28489">[SPARK-28489]</a>[SS]Fix a bug that KafkaOffsetRangeCalculator.getRanges may drop offsets</p></li>
</ul>
</li>
<li><p>July 30, 2019</p>
<ul class="simple">
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-28015">[SPARK-28015]</a>[SQL] Check stringToDate() consumes entire input for the yyyy and yyyy-[m]m formats</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-28308">[SPARK-28308]</a>[CORE] CalendarInterval sub-second part should be padded before parsing</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-27485">[SPARK-27485]</a>EnsureRequirements.reorder should handle duplicate expressions gracefully</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-28355">[SPARK-28355]</a>[CORE][PYTHON] Use Spark conf for threshold at which UDF is compressed by broadcast</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="databricks-light-24-extended-support">
<span id="light-24"></span><h3><a class="toc-backref" href="#id28">Databricks Light 2.4 Extended Support</a><a class="headerlink" href="#databricks-light-24-extended-support" title="Permalink to this headline"> </a></h3>
<p>See <a class="reference internal" href="2.4light.html"><span class="doc">Databricks Light 2.4 (unsupported)</span></a> and <a class="reference internal" href="2.4lightx.html"><span class="doc">Databricks Light 2.4 Extended Support (unsupported)</span></a>.</p>
</div>
<div class="section" id="databricks-runtime-74-unsupported">
<span id="dbr-74-unsupported"></span><h3><a class="toc-backref" href="#id29">Databricks Runtime 7.4 (unsupported)</a><a class="headerlink" href="#databricks-runtime-74-unsupported" title="Permalink to this headline"> </a></h3>
<p>See <a class="reference internal" href="7.4.html"><span class="doc">Databricks Runtime 7.4 (unsupported)</span></a>.</p>
<ul class="simple">
<li><p>April 30, 2021</p>
<ul>
<li><p>Operating system security updates.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-35227">[SPARK-35227]</a>[BUILD] Update the resolver for spark-packages in SparkSubmit</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-34245">[SPARK-34245]</a>[CORE] Ensure Master removes executors that failed to send finished state</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-35045">[SPARK-35045]</a>[SQL] Add an internal option to control input buffer in univocity and a configuration for CSV input buffer size</p></li>
</ul>
</li>
<li><p>March 24, 2021</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-34768">[SPARK-34768]</a>[SQL] Respect the default input buffer size in Univocity</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-34534">[SPARK-34534]</a> Fix blockIds order when use FetchShuffleBlocks to fetch blocks</p></li>
<li><p>Disk caching is enabled by default on i3en instances.</p></li>
</ul>
</li>
<li><p>March 9, 2021</p>
<ul>
<li><p>The updated Azure Blob File System driver for Azure Data Lake Storage Gen2 is now enabled by default. It brings multiple stability improvements.</p></li>
<li><p>[ES-67926][UI] Fix the href link of Spark DAG Visualization</p></li>
<li><p>[ES-65064] Restore the output schema of <code class="docutils literal notranslate"><span class="pre">SHOW</span> <span class="pre">DATABASES</span></code></p></li>
<li><p>[SC-70522][SQL] Use correct dynamic pruning build key when range join hint is present</p></li>
<li><p>[SC-35081] Disable staleness check for Delta table files in disk cache</p></li>
<li><p>[SC-70640] Fix NPE when EventGridClient response has no entity</p></li>
<li><p>[SC-70220][SQL] Do not generate shuffle partition number advice when AOS is enabled</p></li>
</ul>
</li>
<li><p>February 24, 2021</p>
<ul>
<li><p>Upgraded the Spark BigQuery connector to v0.18, which introduces various bug fixes and support for Arrow and Avro iterators.</p></li>
<li><p>Fixed a correctness issue that caused Spark to return incorrect results when the Parquet file’s decimal precision and scale are different from the Spark schema.</p></li>
<li><p>Fixed reading failure issue on Microsoft SQL Server tables that contain spatial data types, by adding geometry and geography JDBC types support for Spark SQL.</p></li>
<li><p>Introduced a new configuration <code class="docutils literal notranslate"><span class="pre">spark.databricks.hive.metastore.init.reloadFunctions.enabled</span></code>. This configuration controls the built in Hive initialization. When set to true, Databricks reloads all functions from all databases that users have into <code class="docutils literal notranslate"><span class="pre">FunctionRegistry</span></code>. This is the default behavior in Hive Metastore. When set to false, Databricks disables this process for optimization.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-34212">[SPARK-34212]</a> Fixed issues related to reading decimal data from Parquet files.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-33579">[SPARK-33579]</a>[UI] Fix executor blank page behind proxy.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-20044">[SPARK-20044]</a>[UI] Support Spark UI behind front-end reverse proxy using a path prefix.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-33277">[SPARK-33277]</a>[PYSPARK][SQL] Use ContextAwareIterator to stop consuming after the task ends.</p></li>
</ul>
</li>
<li><p>February 4, 2021</p>
<ul>
<li><p>Fixed a regression that prevents the incremental execution of a query that sets a global limit such as <code class="docutils literal notranslate"><span class="pre">SELECT</span> <span class="pre">*</span> <span class="pre">FROM</span> <span class="pre">table</span> <span class="pre">LIMIT</span> <span class="pre">nrows</span></code>. The regression was experienced by users running queries via ODBC/JDBC with Arrow serialization enabled.</p></li>
<li><p>Fixed a regression that caused DBFS FUSE to fail to start when cluster environment variable configurations contain invalid bash syntax.</p></li>
</ul>
</li>
<li><p>January 20, 2021</p>
<ul>
<li><p>Fixed a regression in the January 12, 2021 maintenance release that can cause an incorrect AnalysisException and say the column is ambiguous in a self join. This regression happens when a user joins a DataFrame with its derived DataFrame (a so-called self-join) with the following conditions:</p>
<ul>
<li><p>These two DataFrames have common columns, but the output of the self join does not have common columns. For example, <code class="docutils literal notranslate"><span class="pre">df.join(df.select($&quot;col&quot;</span> <span class="pre">as</span> <span class="pre">&quot;new_col&quot;),</span> <span class="pre">cond)</span></code></p></li>
<li><p>The derived DataFrame excludes some columns via select, groupBy, or window.</p></li>
<li><p>The join condition or the following transformation after the joined Dataframe refers to the non-common columns. For example, <code class="docutils literal notranslate"><span class="pre">df.join(df.drop(&quot;a&quot;),</span> <span class="pre">df(&quot;a&quot;)</span> <span class="pre">===</span> <span class="pre">1)</span></code></p></li>
</ul>
</li>
</ul>
</li>
<li><p>January 12, 2021</p>
<ul>
<li><p>Operating system security updates.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-33593">[SPARK-33593]</a>[SQL] Vector reader got incorrect data with binary partition value</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-33677">[SPARK-33677]</a>[SQL] Skip LikeSimplification rule if pattern contains any escapeChar</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-33071">[SPARK-33071]</a>[SPARK-33536][SQL] Avoid changing dataset_id of LogicalPlan in join() to not break DetectAmbiguousSelfJoin</p></li>
</ul>
</li>
<li><p>December 8, 2020</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-33587">[SPARK-33587]</a>[CORE] Kill the executor on nested fatal errors</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-27421">[SPARK-27421]</a>[SQL] Fix filter for int column and value class java.lang.String when pruning partition column</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-33316">[SPARK-33316]</a>[SQL] Support user provided nullable Avro schema for non-nullable catalyst schema in Avro writing</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
</ul>
<ul class="simple">
<li><p>November 20, 2020</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-33404">[SPARK-33404]</a>[SQL][3.0] Fix incorrect results in <code class="docutils literal notranslate"><span class="pre">date_trunc</span></code> expression</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-33339">[SPARK-33339]</a>[PYTHON] Pyspark application will hang due to non Exception error</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-33183">[SPARK-33183]</a>[SQL][HOTFIX] Fix Optimizer rule EliminateSorts and add a physical rule to remove redundant sorts</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-33371">[SPARK-33371]</a>[PYTHON][3.0] Update setup.py and tests for Python 3.9</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-33391">[SPARK-33391]</a>[SQL] element_at with CreateArray not respect one based index.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-33306">[SPARK-33306]</a>[SQL]Timezone is needed when cast date to string</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-33260">[SPARK-33260]</a>[SQL] Fix incorrect results from SortExec when sortOrder is Stream</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-33272">[SPARK-33272]</a>[SQL] prune the attributes mapping in QueryPlan.transformUpWithNewOutput</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="databricks-runtime-72-unsupported">
<span id="dbr-72-unsupported"></span><span id="72"></span><h3><a class="toc-backref" href="#id30">Databricks Runtime 7.2 (unsupported)</a><a class="headerlink" href="#databricks-runtime-72-unsupported" title="Permalink to this headline"> </a></h3>
<p>See <a class="reference internal" href="7.2.html"><span class="doc">Databricks Runtime 7.2 (unsupported)</span></a>.</p>
<ul class="simple">
<li><p>February 4, 2021</p>
<ul>
<li><p>Fixed a regression that prevents the incremental execution of a query that sets a global limit such as <code class="docutils literal notranslate"><span class="pre">SELECT</span> <span class="pre">*</span> <span class="pre">FROM</span> <span class="pre">table</span> <span class="pre">LIMIT</span> <span class="pre">nrows</span></code>. The regression was experienced by users running queries via ODBC/JDBC with Arrow serialization enabled.</p></li>
<li><p>Fixed a regression that caused DBFS FUSE to fail to start when cluster environment variable configurations contain invalid bash syntax.</p></li>
</ul>
</li>
<li><p>January 20, 2021</p>
<ul>
<li><p>Fixed a regression in the January 12, 2021 maintenance release that can cause an incorrect AnalysisException and say the column is ambiguous in a self join. This regression happens when a user joins a DataFrame with its derived DataFrame (a so-called self-join) with the following conditions:</p>
<ul>
<li><p>These two DataFrames have common columns, but the output of the self join does not have common columns. For example, <code class="docutils literal notranslate"><span class="pre">df.join(df.select($&quot;col&quot;</span> <span class="pre">as</span> <span class="pre">&quot;new_col&quot;),</span> <span class="pre">cond)</span></code></p></li>
<li><p>The derived DataFrame excludes some columns via select, groupBy, or window.</p></li>
<li><p>The join condition or the following transformation after the joined Dataframe refers to the non-common columns. For example, <code class="docutils literal notranslate"><span class="pre">df.join(df.drop(&quot;a&quot;),</span> <span class="pre">df(&quot;a&quot;)</span> <span class="pre">===</span> <span class="pre">1)</span></code></p></li>
</ul>
</li>
</ul>
</li>
<li><p>January 12, 2021</p>
<ul>
<li><p>Operating system security updates.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-33593">[SPARK-33593]</a>[SQL] Vector reader got incorrect data with binary partition value</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-33677">[SPARK-33677]</a>[SQL] Skip LikeSimplification rule if pattern contains any escapeChar</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-33071">[SPARK-33071]</a>[SPARK-33536][SQL] Avoid changing dataset_id of LogicalPlan in join() to not break DetectAmbiguousSelfJoin</p></li>
</ul>
</li>
<li><p>December 8, 2020</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-27421">[SPARK-27421]</a>[SQL] Fix filter for int column and value class java.lang.String when pruning partition column</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-33404">[SPARK-33404]</a>[SQL] Fix incorrect results in <code class="docutils literal notranslate"><span class="pre">date_trunc</span></code> expression</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-33339">[SPARK-33339]</a>[PYTHON] Pyspark application will hang due to non Exception error</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-33183">[SPARK-33183]</a>[SQL] Fix Optimizer rule EliminateSorts and add a physical rule to remove redundant sorts</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-33391">[SPARK-33391]</a>[SQL] element_at with CreateArray not respect one based index.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
</ul>
<ul class="simple">
<li><p>November 20, 2020</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-33306">[SPARK-33306]</a>[SQL]Timezone is needed when cast date to string</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-33260">[SPARK-33260]</a>[SQL] Fix incorrect results from SortExec when sortOrder is Stream</p></li>
</ul>
</li>
</ul>
<ul class="simple">
<li><p>November 3, 2020</p>
<ul>
<li><p>Upgraded Java version from 1.8.0_252 to 1.8.0_265.</p></li>
<li><p>Fix ABFS and WASB locking with regard to UserGroupInformation.getCurrentUser()</p></li>
<li><p>Fix an infinite loop bug of Avro reader when reading the MAGIC bytes.</p></li>
</ul>
</li>
<li><p>October 13, 2020</p>
<ul>
<li><p>Operating system security updates.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-32999">[SPARK-32999]</a>[SQL] Use Utils.getSimpleName to avoid hitting Malformed class name in TreeNode</p></li>
<li><p>Fixed listing directories in FUSE mount that contain file names with invalid XML characters</p></li>
<li><p>FUSE mount no longer uses ListMultipartUploads</p></li>
</ul>
</li>
<li><p>September 29, 2020</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-28863">[SPARK-28863]</a>[SQL][WARMFIX] Introduce AlreadyOptimized to prevent reanalysis of V1FallbackWriters</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-32635">[SPARK-32635]</a>[SQL] Fix foldable propagation</p></li>
<li><p>Add a new config <code class="docutils literal notranslate"><span class="pre">spark.shuffle.io.decoder.consolidateThreshold</span></code>. Set the config value to <code class="docutils literal notranslate"><span class="pre">Long.MAX_VALUE</span></code> to skip the consolidation of netty FrameBuffers, which prevents <code class="docutils literal notranslate"><span class="pre">java.lang.IndexOutOfBoundsException</span></code> in corner cases.</p></li>
</ul>
</li>
<li><p>September 24, 2020</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-32764">[SPARK-32764]</a>[SQL] -0.0 should be equal to 0.0</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-32753">[SPARK-32753]</a>[SQL] Only copy tags to node with no tags when transforming plans</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-32659">[SPARK-32659]</a>[SQL] Fix the data issue of inserted Dynamic Partition Pruning on non-atomic type</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>September 8, 2020</p>
<ul>
<li><p>A new parameter was created for Azure Synapse Analytics, <code class="docutils literal notranslate"><span class="pre">maxbinlength</span></code>. This parameter is used to control the column length of BinaryType columns, and is translated as <code class="docutils literal notranslate"><span class="pre">VARBINARY(maxbinlength)</span></code>. It can be set using <code class="docutils literal notranslate"><span class="pre">.option(&quot;maxbinlength&quot;,</span> <span class="pre">n)</span></code>, where 0 &lt; n &lt;= 8000.</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="databricks-runtime-71-unsupported">
<span id="dbr-71-unsupported"></span><span id="71"></span><h3><a class="toc-backref" href="#id31">Databricks Runtime 7.1 (unsupported)</a><a class="headerlink" href="#databricks-runtime-71-unsupported" title="Permalink to this headline"> </a></h3>
<p>See <a class="reference internal" href="7.1.html"><span class="doc">Databricks Runtime 7.1 (unsupported)</span></a>.</p>
<ul class="simple">
<li><p>February 4, 2021</p>
<ul>
<li><p>Fixed a regression that caused DBFS FUSE to fail to start when cluster environment variable configurations contain invalid bash syntax.</p></li>
</ul>
</li>
<li><p>January 20, 2021</p>
<ul>
<li><p>Fixed a regression in the January 12, 2021 maintenance release that can cause an incorrect AnalysisException and say the column is ambiguous in a self join. This regression happens when a user joins a DataFrame with its derived DataFrame (a so-called self-join) with the following conditions:</p>
<ul>
<li><p>These two DataFrames have common columns, but the output of the self join does not have common columns. For example, <code class="docutils literal notranslate"><span class="pre">df.join(df.select($&quot;col&quot;</span> <span class="pre">as</span> <span class="pre">&quot;new_col&quot;),</span> <span class="pre">cond)</span></code></p></li>
<li><p>The derived DataFrame excludes some columns via select, groupBy, or window.</p></li>
<li><p>The join condition or the following transformation after the joined Dataframe refers to the non-common columns. For example, <code class="docutils literal notranslate"><span class="pre">df.join(df.drop(&quot;a&quot;),</span> <span class="pre">df(&quot;a&quot;)</span> <span class="pre">===</span> <span class="pre">1)</span></code></p></li>
</ul>
</li>
</ul>
</li>
<li><p>January 12, 2021</p>
<ul>
<li><p>Operating system security updates.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-33593">[SPARK-33593]</a>[SQL] Vector reader got incorrect data with binary partition value</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-33677">[SPARK-33677]</a>[SQL] Skip LikeSimplification rule if pattern contains any escapeChar</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-33071">[SPARK-33071]</a>[SPARK-33536][SQL] Avoid changing dataset_id of LogicalPlan in join() to not break DetectAmbiguousSelfJoin</p></li>
</ul>
</li>
<li><p>December 8, 2020</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-27421">[SPARK-27421]</a>[SQL] Fix filter for int column and value class java.lang.String when pruning partition column</p></li>
<li><p>Spark Jobs launched using Databricks Connect could hang indefinitely with <code class="docutils literal notranslate"><span class="pre">Executor$TaskRunner.$anonfun$copySessionState</span></code> in executor stack trace</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
</ul>
<ul class="simple">
<li><p>November 20, 2020</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-33404">[SPARK-33404]</a>[SQL][3.0] Fix incorrect results in <code class="docutils literal notranslate"><span class="pre">date_trunc</span></code> expression</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-33339">[SPARK-33339]</a>[PYTHON] Pyspark application will hang due to non Exception error</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-33183">[SPARK-33183]</a>[SQL][HOTFIX] Fix Optimizer rule EliminateSorts and add a physical rule to remove redundant sorts</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-33371">[SPARK-33371]</a>[PYTHON][3.0] Update setup.py and tests for Python 3.9</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-33391">[SPARK-33391]</a>[SQL] element_at with CreateArray not respect one based index.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-33306">[SPARK-33306]</a>[SQL]Timezone is needed when cast date to string</p></li>
</ul>
</li>
</ul>
<ul class="simple">
<li><p>November 3, 2020</p>
<ul>
<li><p>Upgraded Java version from 1.8.0_252 to 1.8.0_265.</p></li>
<li><p>Fix ABFS and WASB locking with regard to UserGroupInformation.getCurrentUser()</p></li>
<li><p>Fix an infinite loop bug of Avro reader when reading the MAGIC bytes.</p></li>
</ul>
</li>
<li><p>October 13, 2020</p>
<ul>
<li><p>Operating system security updates.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-32999">[SPARK-32999]</a>[SQL] Use Utils.getSimpleName to avoid hitting Malformed class name in TreeNode</p></li>
<li><p>Fixed listing directories in FUSE mount that contain file names with invalid XML characters</p></li>
<li><p>FUSE mount no longer uses ListMultipartUploads</p></li>
</ul>
</li>
<li><p>September 29, 2020</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-28863">[SPARK-28863]</a>[SQL][WARMFIX] Introduce AlreadyOptimized to prevent reanalysis of V1FallbackWriters</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-32635">[SPARK-32635]</a>[SQL] Fix foldable propagation</p></li>
<li><p>Add a new config <code class="docutils literal notranslate"><span class="pre">spark.shuffle.io.decoder.consolidateThreshold</span></code>. Set the config value to <code class="docutils literal notranslate"><span class="pre">Long.MAX_VALUE</span></code> to skip the consolidation of netty FrameBuffers, which prevents <code class="docutils literal notranslate"><span class="pre">java.lang.IndexOutOfBoundsException</span></code> in corner cases.</p></li>
</ul>
</li>
<li><p>September 24, 2020</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-32764">[SPARK-32764]</a>[SQL] -0.0 should be equal to 0.0</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-32753">[SPARK-32753]</a>[SQL] Only copy tags to node with no tags when transforming plans</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-32659">[SPARK-32659]</a>[SQL] Fix the data issue of inserted Dynamic Partition Pruning on non-atomic type</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>September 8, 2020</p>
<ul>
<li><p>A new parameter was created for Azure Synapse Analytics, <code class="docutils literal notranslate"><span class="pre">maxbinlength</span></code>. This parameter is used to control the column length of BinaryType columns, and is translated as <code class="docutils literal notranslate"><span class="pre">VARBINARY(maxbinlength)</span></code>. It can be set using <code class="docutils literal notranslate"><span class="pre">.option(&quot;maxbinlength&quot;,</span> <span class="pre">n)</span></code>, where 0 &lt; n &lt;= 8000.</p></li>
</ul>
</li>
<li><p>August 25, 2020</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-32159">[SPARK-32159]</a>[SQL] Fix integration between <code class="docutils literal notranslate"><span class="pre">Aggregator[Array[_],</span> <span class="pre">_,</span> <span class="pre">_]</span></code> and <code class="docutils literal notranslate"><span class="pre">UnresolvedMapObjects</span></code></p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-32559">[SPARK-32559]</a>[SQL] Fix the trim logic in <code class="docutils literal notranslate"><span class="pre">UTF8String.toInt/toLong</span></code>, which didn’t handle non-ASCII characters correctly</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-32543">[SPARK-32543]</a>[R] Remove <code class="docutils literal notranslate"><span class="pre">arrow::as_tibble</span></code> usage in SparkR</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-32091">[SPARK-32091]</a>[CORE] Ignore timeout error when removing blocks on the lost executor</p></li>
<li><p>Fixed an issue affecting Azure Synapse connector with MSI credentials</p></li>
<li><p>Fixed ambiguous attribute resolution in self-merge</p></li>
</ul>
</li>
<li><p>August 18, 2020</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-32594">[SPARK-32594]</a>[SQL] Fix serialization of dates inserted to Hive tables</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-32237">[SPARK-32237]</a>[SQL] Resolve hint in CTE</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-32431">[SPARK-32431]</a>[SQL] Check duplicate nested columns in read from in-built datasources</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-32467">[SPARK-32467]</a>[UI] Avoid encoding URL twice on https redirect</p></li>
<li><p>Fixed a race condition in the SQS connector when using Trigger.Once.</p></li>
</ul>
</li>
<li><p>August 11, 2020</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-32280">[SPARK-32280]</a><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-32372">[SPARK-32372]</a>[SQL] ResolveReferences.dedupRight should only rewrite attributes for ancestor nodes of the conflict plan</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-32234">[SPARK-32234]</a>[SQL] Spark SQL commands are failing on selecting the ORC tables</p></li>
</ul>
</li>
<li><p>August 3, 2020</p>
<ul>
<li><p>You can now use the LDA transform function on a passthrough-enabled cluster.</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="databricks-runtime-70-unsupported">
<span id="dbr-70-unsupported"></span><span id="70"></span><h3><a class="toc-backref" href="#id32">Databricks Runtime 7.0 (unsupported)</a><a class="headerlink" href="#databricks-runtime-70-unsupported" title="Permalink to this headline"> </a></h3>
<p>See <a class="reference internal" href="7.0.html"><span class="doc">Databricks Runtime 7.0 (unsupported)</span></a>.</p>
<ul class="simple">
<li><p>February 4, 2021</p>
<ul>
<li><p>Fixed a regression that caused DBFS FUSE to fail to start when cluster environment variable configurations contain invalid bash syntax.</p></li>
</ul>
</li>
<li><p>January 20, 2021</p>
<ul>
<li><p>Fixed a regression in the January 12, 2021 maintenance release that can cause an incorrect AnalysisException and say the column is ambiguous in a self join. This regression happens when a user joins a DataFrame with its derived DataFrame (a so-called self-join) with the following conditions:</p>
<ul>
<li><p>These two DataFrames have common columns, but the output of the self join does not have common columns. For example, <code class="docutils literal notranslate"><span class="pre">df.join(df.select($&quot;col&quot;</span> <span class="pre">as</span> <span class="pre">&quot;new_col&quot;),</span> <span class="pre">cond)</span></code></p></li>
<li><p>The derived DataFrame excludes some columns via select, groupBy, or window.</p></li>
<li><p>The join condition or the following transformation after the joined Dataframe refers to the non-common columns. For example, <code class="docutils literal notranslate"><span class="pre">df.join(df.drop(&quot;a&quot;),</span> <span class="pre">df(&quot;a&quot;)</span> <span class="pre">===</span> <span class="pre">1)</span></code></p></li>
</ul>
</li>
</ul>
</li>
<li><p>January 12, 2021</p>
<ul>
<li><p>Operating system security updates.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-33593">[SPARK-33593]</a>[SQL] Vector reader got incorrect data with binary partition value</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-33677">[SPARK-33677]</a>[SQL] Skip LikeSimplification rule if pattern contains any escapeChar</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-33071">[SPARK-33071]</a>[SPARK-33536][SQL] Avoid changing dataset_id of LogicalPlan in join() to not break DetectAmbiguousSelfJoin</p></li>
</ul>
</li>
<li><p>December 8, 2020</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-27421">[SPARK-27421]</a>[SQL] Fix filter for int column and value class java.lang.String when pruning partition column</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-33404">[SPARK-33404]</a>[SQL] Fix incorrect results in <code class="docutils literal notranslate"><span class="pre">date_trunc</span></code> expression</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-33339">[SPARK-33339]</a>[PYTHON] Pyspark application will hang due to non Exception error</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-33183">[SPARK-33183]</a>[SQL] Fix Optimizer rule EliminateSorts and add a physical rule to remove redundant sorts</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-33391">[SPARK-33391]</a>[SQL] element_at with CreateArray not respect one based index.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
</ul>
<ul class="simple">
<li><p>November 20, 2020</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-33306">[SPARK-33306]</a>[SQL]Timezone is needed when cast date to string</p></li>
</ul>
</li>
</ul>
<ul class="simple">
<li><p>November 3, 2020</p>
<ul>
<li><p>Upgraded Java version from 1.8.0_252 to 1.8.0_265.</p></li>
<li><p>Fix ABFS and WASB locking with regard to UserGroupInformation.getCurrentUser()</p></li>
<li><p>Fix an infinite loop bug of Avro reader when reading the MAGIC bytes.</p></li>
</ul>
</li>
<li><p>October 13, 2020</p>
<ul>
<li><p>Operating system security updates.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-32999">[SPARK-32999]</a>[SQL] Use Utils.getSimpleName to avoid hitting Malformed class name in TreeNode</p></li>
<li><p>Fixed listing directories in FUSE mount that contain file names with invalid XML characters</p></li>
<li><p>FUSE mount no longer uses ListMultipartUploads</p></li>
</ul>
</li>
<li><p>September 29, 2020</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-28863">[SPARK-28863]</a>[SQL][WARMFIX] Introduce AlreadyOptimized to prevent reanalysis of V1FallbackWriters</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-32635">[SPARK-32635]</a>[SQL] Fix foldable propagation</p></li>
<li><p>Add a new config <code class="docutils literal notranslate"><span class="pre">spark.shuffle.io.decoder.consolidateThreshold</span></code>. Set the config value to <code class="docutils literal notranslate"><span class="pre">Long.MAX_VALUE</span></code> to skip the consolidation of netty FrameBuffers, which prevents <code class="docutils literal notranslate"><span class="pre">java.lang.IndexOutOfBoundsException</span></code> in corner cases.</p></li>
</ul>
</li>
<li><p>September 24, 2020</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-32764">[SPARK-32764]</a>[SQL] -0.0 should be equal to 0.0</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-32753">[SPARK-32753]</a>[SQL] Only copy tags to node with no tags when transforming plans</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-32659">[SPARK-32659]</a>[SQL] Fix the data issue of inserted Dynamic Partition Pruning on non-atomic type</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>September 8, 2020</p>
<ul>
<li><p>A new parameter was created for Azure Synapse Analytics, <code class="docutils literal notranslate"><span class="pre">maxbinlength</span></code>. This parameter is used to control the column length of BinaryType columns, and is translated as <code class="docutils literal notranslate"><span class="pre">VARBINARY(maxbinlength)</span></code>. It can be set using <code class="docutils literal notranslate"><span class="pre">.option(&quot;maxbinlength&quot;,</span> <span class="pre">n)</span></code>, where 0 &lt; n &lt;= 8000.</p></li>
</ul>
</li>
<li><p>August 25, 2020</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-32159">[SPARK-32159]</a>[SQL] Fix integration between <code class="docutils literal notranslate"><span class="pre">Aggregator[Array[_],</span> <span class="pre">_,</span> <span class="pre">_]</span></code> and <code class="docutils literal notranslate"><span class="pre">UnresolvedMapObjects</span></code></p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-32559">[SPARK-32559]</a>[SQL] Fix the trim logic in <code class="docutils literal notranslate"><span class="pre">UTF8String.toInt/toLong</span></code>, which didn’t handle non-ASCII characters correctly</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-32543">[SPARK-32543]</a>[R] Remove <code class="docutils literal notranslate"><span class="pre">arrow::as_tibble</span></code> usage in SparkR</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-32091">[SPARK-32091]</a>[CORE] Ignore timeout error when removing blocks on the lost executor</p></li>
<li><p>Fixed an issue affecting Azure Synapse connector with MSI credentials</p></li>
<li><p>Fixed ambiguous attribute resolution in self-merge</p></li>
</ul>
</li>
<li><p>August 18, 2020</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-32594">[SPARK-32594]</a>[SQL] Fix serialization of dates inserted to Hive tables</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-32237">[SPARK-32237]</a>[SQL] Resolve hint in CTE</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-32431">[SPARK-32431]</a>[SQL] Check duplicate nested columns in read from in-built datasources</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-32467">[SPARK-32467]</a>[UI] Avoid encoding URL twice on https redirect</p></li>
<li><p>Fixed a race condition in the SQS connector when using Trigger.Once.</p></li>
</ul>
</li>
<li><p>August 11, 2020</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-32280">[SPARK-32280]</a><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-32372">[SPARK-32372]</a>[SQL] ResolveReferences.dedupRight should only rewrite attributes for ancestor nodes of the conflict plan</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-32234">[SPARK-32234]</a>[SQL] Spark SQL commands are failing on selecting the ORC tables</p></li>
<li><p>You can now use the LDA transform function on a passthrough-enabled cluster.</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="databricks-runtime-66-unsupported">
<span id="dbr-66-unsupported"></span><span id="66"></span><h3><a class="toc-backref" href="#id33">Databricks Runtime 6.6 (unsupported)</a><a class="headerlink" href="#databricks-runtime-66-unsupported" title="Permalink to this headline"> </a></h3>
<p>See <a class="reference internal" href="6.6.html"><span class="doc">Databricks Runtime 6.6 (unsupported)</span></a>.</p>
<ul class="simple">
<li><p>November 20, 2020</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-33260">[SPARK-33260]</a>[SQL] Fix incorrect results from SortExec when sortOrder is Stream</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-32635">[SPARK-32635]</a>[SQL] Fix foldable propagation</p></li>
</ul>
</li>
</ul>
<ul class="simple">
<li><p>November 3, 2020</p>
<ul>
<li><p>Upgraded Java version from 1.8.0_252 to 1.8.0_265.</p></li>
<li><p>Fix ABFS and WASB locking with regard to UserGroupInformation.getCurrentUser()</p></li>
<li><p>Fix an infinite loop bug of Avro reader when reading the MAGIC bytes.</p></li>
</ul>
</li>
<li><p>October 13, 2020</p>
<ul>
<li><p>Operating system security updates.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-32999">[SPARK-32999]</a>[SQL][2.4] Use Utils.getSimpleName to avoid hitting Malformed class name in TreeNode</p></li>
<li><p>Fixed listing directories in FUSE mount that contain file names with invalid XML characters</p></li>
<li><p>FUSE mount no longer uses ListMultipartUploads</p></li>
</ul>
</li>
<li><p>September 24, 2020</p>
<ul>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>September 8, 2020</p>
<ul>
<li><p>A new parameter was created for Azure Synapse Analytics, <code class="docutils literal notranslate"><span class="pre">maxbinlength</span></code>. This parameter is used to control the column length of BinaryType columns, and is translated as <code class="docutils literal notranslate"><span class="pre">VARBINARY(maxbinlength)</span></code>. It can be set using <code class="docutils literal notranslate"><span class="pre">.option(&quot;maxbinlength&quot;,</span> <span class="pre">n)</span></code>, where 0 &lt; n &lt;= 8000.</p></li>
<li><p>Update Azure Storage SDK to 8.6.4 and enable TCP keep alive on connections made by the WASB driver</p></li>
</ul>
</li>
<li><p>August 25, 2020</p>
<ul>
<li><p>Fixed ambiguous attribute resolution in self-merge</p></li>
</ul>
</li>
<li><p>August 18, 2020</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-32431">[SPARK-32431]</a>[SQL] Check duplicate nested columns in read from in-built datasources</p></li>
<li><p>Fixed a race condition in the SQS connector when using Trigger.Once.</p></li>
</ul>
</li>
<li><p>August 11, 2020</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-28676">[SPARK-28676]</a>[CORE] Avoid Excessive logging from ContextCleaner</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-31967">[SPARK-31967]</a>[UI] Downgrade to vis.js 4.21.0 to fix Jobs UI loading time regression</p></li>
</ul>
</li>
<li><p>August 3, 2020</p>
<ul>
<li><p>You can now use the LDA transform function on a passthrough-enabled cluster.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="databricks-runtime-65-unsupported">
<span id="dbr-65-unsupported"></span><span id="65"></span><h3><a class="toc-backref" href="#id34">Databricks Runtime 6.5 (unsupported)</a><a class="headerlink" href="#databricks-runtime-65-unsupported" title="Permalink to this headline"> </a></h3>
<p>See <a class="reference internal" href="6.5.html"><span class="doc">Databricks Runtime 6.5 (unsupported)</span></a>.</p>
<ul class="simple">
<li><p>September 24, 2020</p>
<ul>
<li><p>Fixed a previous limitation where passthrough on standard cluster would still restrict the filesystem implementation user uses. Now users would be able to access local filesystems without restrictions.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>September 8, 2020</p>
<ul>
<li><p>A new parameter was created for Azure Synapse Analytics, <code class="docutils literal notranslate"><span class="pre">maxbinlength</span></code>. This parameter is used to control the column length of BinaryType columns, and is translated as <code class="docutils literal notranslate"><span class="pre">VARBINARY(maxbinlength)</span></code>. It can be set using <code class="docutils literal notranslate"><span class="pre">.option(&quot;maxbinlength&quot;,</span> <span class="pre">n)</span></code>, where 0 &lt; n &lt;= 8000.</p></li>
<li><p>Update Azure Storage SDK to 8.6.4 and enable TCP keep alive on connections made by the WASB driver</p></li>
</ul>
</li>
<li><p>August 25, 2020</p>
<ul>
<li><p>Fixed ambiguous attribute resolution in self-merge</p></li>
</ul>
</li>
<li><p>August 18, 2020</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-32431">[SPARK-32431]</a>[SQL] Check duplicate nested columns in read from in-built datasources</p></li>
<li><p>Fixed a race condition in the SQS connector when using Trigger.Once.</p></li>
</ul>
</li>
<li><p>August 11, 2020</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-28676">[SPARK-28676]</a>[CORE] Avoid Excessive logging from ContextCleaner</p></li>
</ul>
</li>
<li><p>August 3, 2020</p>
<ul>
<li><p>You can now use the LDA transform function on a passthrough-enabled cluster.</p></li>
<li><p>Operating system security updates.</p></li>
</ul>
</li>
<li><p>July 7, 2020</p>
<ul>
<li><p>Upgraded Java version from 1.8.0_242 to 1.8.0_252.</p></li>
</ul>
</li>
<li><p>April 21, 2020</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-31312">[SPARK-31312]</a>[SQL] Cache Class instance for the UDF instance in HiveFunctionWrapper</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="databricks-runtime-63-unsupported">
<span id="dbr-63-unsupported"></span><span id="63"></span><h3><a class="toc-backref" href="#id35">Databricks Runtime 6.3 (unsupported)</a><a class="headerlink" href="#databricks-runtime-63-unsupported" title="Permalink to this headline"> </a></h3>
<p>See <a class="reference internal" href="6.3.html"><span class="doc">Databricks Runtime 6.3 (unsupported)</span></a>.</p>
<ul>
<li><p>July 7, 2020</p>
<ul class="simple">
<li><p>Upgraded Java version from 1.8.0_232 to 1.8.0_252.</p></li>
</ul>
</li>
<li><p>April 21, 2020</p>
<ul class="simple">
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-31312">[SPARK-31312]</a>[SQL] Cache Class instance for the UDF instance in HiveFunctionWrapper</p></li>
</ul>
</li>
<li><p>April 7, 2020</p>
<ul class="simple">
<li><p>To resolve an issue with pandas udf not working with PyArrow 0.15.0 and above, we added an environment variable (<code class="docutils literal notranslate"><span class="pre">ARROW_PRE_0_15_IPC_FORMAT=1</span></code>) to enable support for those versions of PyArrow. See the instructions in <a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-29367">[SPARK-29367]</a>.</p></li>
</ul>
</li>
<li><p>March 10, 2020</p>
<ul class="simple">
<li><p>The Snowflake connector (<code class="docutils literal notranslate"><span class="pre">spark-snowflake_2.11</span></code>) included in Databricks Runtime is updated to version 2.5.9. <code class="docutils literal notranslate"><span class="pre">snowflake-jdbc</span></code> is updated to version 3.12.0.</p></li>
</ul>
</li>
<li><p>February 18, 2020</p>
<ul class="simple">
<li><p>Credential passthrough with ADLS Gen2 has a performance degradation due to incorrect thread local handling when ADLS client prefetching is enabled. This release disables ADLS Gen2 prefetching when credential passthrough is enabled until we have a proper fix.</p></li>
</ul>
</li>
<li><p>February 11, 2020</p>
<ul class="simple">
<li><p>Fixed a bug in our S3 client (S3AFileSystem.java), whereby <code class="docutils literal notranslate"><span class="pre">fs.isDirectory(path)</span></code> or <code class="docutils literal notranslate"><span class="pre">fs.getFileStatus(path).isDirectory()</span></code> could sometimes incorrectly return <code class="docutils literal notranslate"><span class="pre">false</span></code>. The bug would manifest on paths for which <code class="docutils literal notranslate"><span class="pre">aws</span> <span class="pre">s3</span> <span class="pre">list-objects-v2</span> <span class="pre">--prefix</span> <span class="pre">path/</span> <span class="pre">--max-keys</span> <span class="pre">1</span> <span class="pre">--delimiter</span> <span class="pre">/</span></code> responds with no keys or common prefixes, but <code class="docutils literal notranslate"><span class="pre">isTruncated</span> <span class="pre">=</span> <span class="pre">true</span></code>. This might happen for directories under which many objects were deleted and versioning was enabled.</p></li>
</ul>
<ul class="simple">
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-24783">[SPARK-24783]</a>[SQL] spark.sql.shuffle.partitions=0 should throw exception</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-30447">[SPARK-30447]</a>[SQL] Constant propagation nullability issue</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-28152">[SPARK-28152]</a>[SQL] Add a legacy conf for old MsSqlServerDialect numeric mapping</p></li>
<li><p>Allowlisted the overwrite function so that the MLModels extends MLWriter could call the function.</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="databricks-runtime-62-unsupported">
<span id="dbr-62-unsupported"></span><span id="62"></span><h3><a class="toc-backref" href="#id36">Databricks Runtime 6.2 (unsupported)</a><a class="headerlink" href="#databricks-runtime-62-unsupported" title="Permalink to this headline"> </a></h3>
<p>See <a class="reference internal" href="6.2.html"><span class="doc">Databricks Runtime 6.2 (unsupported)</span></a>.</p>
<ul>
<li><p>April 21, 2020</p>
<ul class="simple">
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-31312">[SPARK-31312]</a>[SQL] Cache Class instance for the UDF instance in HiveFunctionWrapper</p></li>
</ul>
</li>
<li><p>April 7, 2020</p>
<ul class="simple">
<li><p>To resolve an issue with pandas udf not working with PyArrow 0.15.0 and above, we added an environment variable (<code class="docutils literal notranslate"><span class="pre">ARROW_PRE_0_15_IPC_FORMAT=1</span></code>) to enable support for those versions of PyArrow. See the instructions in <a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-29367">[SPARK-29367]</a>.</p></li>
</ul>
</li>
<li><p>March 25, 2020</p>
<ul class="simple">
<li><p>Job output, such as log output emitted to stdout, is subject to a 20MB size limit. If the total output has a larger size, the run will be canceled and marked as failed. To avoid encountering this limit, you can prevent stdout from being returned from the driver to by setting the <code class="docutils literal notranslate"><span class="pre">spark.databricks.driver.disableScalaOutput</span></code> Spark configuration to <code class="docutils literal notranslate"><span class="pre">true</span></code>. By default the flag value is <code class="docutils literal notranslate"><span class="pre">false</span></code>. The flag controls cell output for Scala JAR jobs and Scala notebooks. If the flag is enabled, Spark does not return job execution results to the client. The flag does not affect the data that is written in the cluster’s log files. Setting this flag is recommended only for automated clusters for JAR jobs, because it will disable notebook results.</p></li>
</ul>
</li>
<li><p>March 10, 2020</p>
<ul class="simple">
<li><p>The Snowflake connector (<code class="docutils literal notranslate"><span class="pre">spark-snowflake_2.11</span></code>) included in Databricks Runtime is updated to version 2.5.9. <code class="docutils literal notranslate"><span class="pre">snowflake-jdbc</span></code> is updated to version 3.12.0.</p></li>
</ul>
</li>
<li><p>February 18, 2020</p>
<ul class="simple">
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-24783">[SPARK-24783]</a>[SQL] spark.sql.shuffle.partitions=0 should throw exception</p></li>
<li><p>Credential passthrough with ADLS Gen2 has a performance degradation due to incorrect thread local handling when ADLS client prefetching is enabled. This release disables ADLS Gen2 prefetching when credential passthrough is enabled until we have a proper fix.</p></li>
</ul>
</li>
<li><p>January 28, 2020</p>
<ul class="simple">
<li><p>Fixed a bug in S3AFileSystem, whereby <code class="docutils literal notranslate"><span class="pre">fs.isDirectory(path)</span></code> or <code class="docutils literal notranslate"><span class="pre">fs.getFileStatus(path).isDirectory()</span></code> could sometimes incorrectly return <code class="docutils literal notranslate"><span class="pre">false</span></code>. The bug would manifest on paths for which <code class="docutils literal notranslate"><span class="pre">aws</span> <span class="pre">s3</span> <span class="pre">list-objects-v2</span> <span class="pre">--prefix</span> <span class="pre">path/</span> <span class="pre">--max-keys</span> <span class="pre">1</span> <span class="pre">--delimiter</span> <span class="pre">/</span></code> responds with no keys or common prefixes, but <code class="docutils literal notranslate"><span class="pre">isTruncated</span> <span class="pre">=</span> <span class="pre">true</span></code>. This might happen for directories under which many objects were deleted and versioning was enabled.</p></li>
</ul>
<ul class="simple">
<li><p>Allowlisted ML Model Writers’ overwrite function for clusters enabled for credential passthrough, so that model save can use overwrite mode on credential passthrough clusters.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-30447">[SPARK-30447]</a>[SQL] Constant propagation nullability issue.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-28152">[SPARK-28152]</a>[SQL] Add a legacy conf for old MsSqlServerDialect numeric mapping.</p></li>
</ul>
</li>
<li><p>January 14, 2020</p>
<ul class="simple">
<li><p>Upgraded Java version from 1.8.0_222 to 1.8.0_232.</p></li>
</ul>
</li>
<li><p>December 10, 2019</p>
<ul class="simple">
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-29904">[SPARK-29904]</a>[SQL] Parse timestamps in microsecond precision by JSON/CSV data sources.</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="databricks-runtime-61-unsupported">
<span id="dbr-61-unsupported"></span><span id="61"></span><h3><a class="toc-backref" href="#id37">Databricks Runtime 6.1 (unsupported)</a><a class="headerlink" href="#databricks-runtime-61-unsupported" title="Permalink to this headline"> </a></h3>
<p>See <a class="reference internal" href="6.1.html"><span class="doc">Databricks Runtime 6.1 (unsupported)</span></a>.</p>
<ul>
<li><p>April 7, 2020</p>
<ul class="simple">
<li><p>To resolve an issue with pandas udf not working with PyArrow 0.15.0 and above, we added an environment variable (<code class="docutils literal notranslate"><span class="pre">ARROW_PRE_0_15_IPC_FORMAT=1</span></code>) to enable support for those versions of PyArrow. See the instructions in <a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-29367">[SPARK-29367]</a>.</p></li>
</ul>
</li>
<li><p>March 25, 2020</p>
<ul class="simple">
<li><p>Job output, such as log output emitted to stdout, is subject to a 20MB size limit. If the total output has a larger size, the run will be canceled and marked as failed. To avoid encountering this limit, you can prevent stdout from being returned from the driver to by setting the <code class="docutils literal notranslate"><span class="pre">spark.databricks.driver.disableScalaOutput</span></code> Spark configuration to <code class="docutils literal notranslate"><span class="pre">true</span></code>. By default the flag value is <code class="docutils literal notranslate"><span class="pre">false</span></code>. The flag controls cell output for Scala JAR jobs and Scala notebooks. If the flag is enabled, Spark does not return job execution results to the client. The flag does not affect the data that is written in the cluster’s log files. Setting this flag is recommended only for automated clusters for JAR jobs, because it will disable notebook results.</p></li>
</ul>
</li>
<li><p>March 10, 2020</p>
<ul class="simple">
<li><p>The Snowflake connector (<code class="docutils literal notranslate"><span class="pre">spark-snowflake_2.11</span></code>) included in Databricks Runtime is updated to version 2.5.9. <code class="docutils literal notranslate"><span class="pre">snowflake-jdbc</span></code> is updated to version 3.12.0.</p></li>
</ul>
</li>
<li><p>February 18, 2020</p>
<ul class="simple">
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-24783">[SPARK-24783]</a>[SQL] spark.sql.shuffle.partitions=0 should throw exception</p></li>
<li><p>Credential passthrough with ADLS Gen2 has a performance degradation due to incorrect thread local handling when ADLS client prefetching is enabled. This release disables ADLS Gen2 prefetching when credential passthrough is enabled until we have a proper fix.</p></li>
</ul>
</li>
<li><p>January 28, 2020</p>
<ul class="simple">
<li><p>Fixed a bug in S3AFileSystem, whereby <code class="docutils literal notranslate"><span class="pre">fs.isDirectory(path)</span></code> or <code class="docutils literal notranslate"><span class="pre">fs.getFileStatus(path).isDirectory()</span></code> could sometimes incorrectly return <code class="docutils literal notranslate"><span class="pre">false</span></code>. The bug would manifest on paths for which <code class="docutils literal notranslate"><span class="pre">aws</span> <span class="pre">s3</span> <span class="pre">list-objects-v2</span> <span class="pre">--prefix</span> <span class="pre">path/</span> <span class="pre">--max-keys</span> <span class="pre">1</span> <span class="pre">--delimiter</span> <span class="pre">/</span></code> responds with no keys or common prefixes, but <code class="docutils literal notranslate"><span class="pre">isTruncated</span> <span class="pre">=</span> <span class="pre">true</span></code>. This might happen for directories under which many objects were deleted and versioning was enabled.</p></li>
</ul>
<ul class="simple">
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-30447">[SPARK-30447]</a>[SQL] Constant propagation nullability issue.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-28152">[SPARK-28152]</a>[SQL] Add a legacy conf for old MsSqlServerDialect numeric mapping.</p></li>
</ul>
</li>
<li><p>January 14, 2020</p>
<ul class="simple">
<li><p>Upgraded Java version from 1.8.0_222 to 1.8.0_232.</p></li>
</ul>
</li>
<li><p>November 7, 2019</p>
<ul class="simple">
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-29743">[SPARK-29743]</a>[SQL] sample should set needCopyResult to true if its child’s needCopyResult is true.</p></li>
<li><p>Secrets referenced from Spark configuration properties and environment variables in Public Preview. See <a class="reference internal" href="../../security/secrets/secrets.html#spark-conf-env-var"><span class="std std-ref">Use a secret in a Spark configuration property or environment variable</span></a>.</p></li>
</ul>
</li>
<li><p>November 5, 2019</p>
<ul class="simple">
<li><p>Fixed a bug in DBFS FUSE to handle mount points having <code class="docutils literal notranslate"><span class="pre">//</span></code> in its path.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-29081">[SPARK-29081]</a> Replace calls to SerializationUtils.clone on properties with a faster implementation</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-29244">[SPARK-29244]</a>[CORE] Prevent freed page in BytesToBytesMap free again</p></li>
<li><p><strong>(6.1 ML)</strong> Library mkl version 2019.4 was installed unintentionally. We downgraded it to mkl version 2019.3 to match Anaconda Distribution 2019.03.</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="databricks-runtime-60-unsupported">
<span id="dbr-60-unsupported"></span><span id="60"></span><h3><a class="toc-backref" href="#id38">Databricks Runtime 6.0 (unsupported)</a><a class="headerlink" href="#databricks-runtime-60-unsupported" title="Permalink to this headline"> </a></h3>
<p>See <a class="reference internal" href="6.0.html"><span class="doc">Databricks Runtime 6.0 (unsupported)</span></a>.</p>
<ul>
<li><p>March 25, 2020</p>
<ul class="simple">
<li><p>Job output, such as log output emitted to stdout, is subject to a 20MB size limit. If the total output has a larger size, the run will be canceled and marked as failed. To avoid encountering this limit, you can prevent stdout from being returned from the driver to by setting the <code class="docutils literal notranslate"><span class="pre">spark.databricks.driver.disableScalaOutput</span></code> Spark configuration to <code class="docutils literal notranslate"><span class="pre">true</span></code>. By default the flag value is <code class="docutils literal notranslate"><span class="pre">false</span></code>. The flag controls cell output for Scala JAR jobs and Scala notebooks. If the flag is enabled, Spark does not return job execution results to the client. The flag does not affect the data that is written in the cluster’s log files. Setting this flag is recommended only for automated clusters for JAR jobs, because it will disable notebook results.</p></li>
</ul>
</li>
<li><p>February 18, 2020</p>
<ul class="simple">
<li><p>Credential passthrough with ADLS Gen2 has a performance degradation due to incorrect thread local handling when ADLS client prefetching is enabled. This release disables ADLS Gen2 prefetching when credential passthrough is enabled until we have a proper fix.</p></li>
</ul>
</li>
<li><p>February 11, 2020</p>
<ul class="simple">
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-24783">[SPARK-24783]</a>[SQL] spark.sql.shuffle.partitions=0 should throw exception</p></li>
</ul>
</li>
<li><p>January 28, 2020</p>
<ul class="simple">
<li><p>Fixed a bug in S3AFileSystem, whereby <code class="docutils literal notranslate"><span class="pre">fs.isDirectory(path)</span></code> or <code class="docutils literal notranslate"><span class="pre">fs.getFileStatus(path).isDirectory()</span></code> could sometimes incorrectly return <code class="docutils literal notranslate"><span class="pre">false</span></code>. The bug would manifest on paths for which <code class="docutils literal notranslate"><span class="pre">aws</span> <span class="pre">s3</span> <span class="pre">list-objects-v2</span> <span class="pre">--prefix</span> <span class="pre">path/</span> <span class="pre">--max-keys</span> <span class="pre">1</span> <span class="pre">--delimiter</span> <span class="pre">/</span></code> responds with no keys or common prefixes, but <code class="docutils literal notranslate"><span class="pre">isTruncated</span> <span class="pre">=</span> <span class="pre">true</span></code>. This might happen for directories under which many objects were deleted and versioning was enabled.</p></li>
</ul>
<ul class="simple">
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-30447">[SPARK-30447]</a>[SQL] Constant propagation nullability issue.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-28152">[SPARK-28152]</a>[SQL] Add a legacy conf for old MsSqlServerDialect numeric mapping.</p></li>
</ul>
</li>
<li><p>January 14, 2020</p>
<ul class="simple">
<li><p>Upgraded Java version from 1.8.0_222 to 1.8.0_232.</p></li>
</ul>
</li>
<li><p>November 19, 2019</p>
<ul class="simple">
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-29743">[SPARK-29743]</a> [SQL] sample should set needCopyResult to true if its child’s needCopyResult is true</p></li>
</ul>
</li>
<li><p>November 5, 2019</p>
<ul class="simple">
<li><p>DBFS FUSE supports S3 mounts with canned ACL.</p></li>
</ul>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">dbutils.tensorboard.start()</span></code> now supports TensorBoard 2.0 (if installed manually).</p></li>
<li><p>Fixed a bug in DBFS FUSE to handle mount points having <code class="docutils literal notranslate"><span class="pre">//</span></code> in its path.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-29081">[SPARK-29081]</a>Replace calls to SerializationUtils.clone on properties with a faster implementation</p></li>
</ul>
</li>
<li><p>October 23, 2019</p>
<ul class="simple">
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-29244">[SPARK-29244]</a>[CORE] Prevent freed page in BytesToBytesMap free again</p></li>
</ul>
</li>
<li><p>October 8, 2019</p>
<ul class="simple">
<li><p>Server side changes to allow Simba Apache Spark ODBC driver to reconnect and continue after a connection failure during fetching results (requires <a class="reference external" href="https://databricks.com/spark/odbc-driver-download">Simba Apache Spark ODBC driver version 2.6.10</a>).</p></li>
<li><p>Fixed an issue affecting using <code class="docutils literal notranslate"><span class="pre">Optimize</span></code> command with table ACL enabled clusters.</p></li>
<li><p>Fixed an issue where <code class="docutils literal notranslate"><span class="pre">pyspark.ml</span></code> libraries would fail due to Scala UDF forbidden error on table ACL enabled clusters.</p></li>
<li><p>Fixed NullPointerException when checking error code in the WASB client.</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="databricks-runtime-54-ml-unsupported">
<span id="dbr-54-ml-unsupported"></span><span id="54ml"></span><h3><a class="toc-backref" href="#id39">Databricks Runtime 5.4 ML (unsupported)</a><a class="headerlink" href="#databricks-runtime-54-ml-unsupported" title="Permalink to this headline"> </a></h3>
<p>See <a class="reference internal" href="5.4ml.html"><span class="doc">Databricks Runtime 5.4 for ML (unsupported)</span></a>.</p>
<ul class="simple">
<li><p>June 18, 2019</p>
<ul>
<li><p>Improved handling of MLflow active runs in Hyperopt integration</p></li>
<li><p>Improved messages in Hyperopt</p></li>
<li><p>Updated package <code class="docutils literal notranslate"><span class="pre">Marchkdown</span></code> from 3.1 to 3.1.1</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="databricks-runtime-54-unsupported">
<span id="dbr-54-unsupported"></span><span id="54"></span><h3><a class="toc-backref" href="#id40">Databricks Runtime 5.4 (unsupported)</a><a class="headerlink" href="#databricks-runtime-54-unsupported" title="Permalink to this headline"> </a></h3>
<p>See <a class="reference internal" href="5.4.html"><span class="doc">Databricks Runtime 5.4 (unsupported)</span></a>.</p>
<ul class="simple">
<li><p>November 19, 2019</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-29743">[SPARK-29743]</a> [SQL] sample should set needCopyResult to true if its child’s needCopyResult is true</p></li>
</ul>
</li>
<li><p>October 8, 2019</p>
<ul>
<li><p>Server side changes to allow Simba Apache Spark ODBC driver to reconnect and continue after a connection failure during fetching results (requires Simba Apache Spark ODBC driver update to version 2.6.10).</p></li>
<li><p>Fixed NullPointerException when checking error code in the WASB client.</p></li>
</ul>
</li>
<li><p>September 10, 2019</p>
<ul>
<li><p>Add thread safe iterator to BytesToBytesMap</p></li>
<li><p>Fixed a bug affecting certain global aggregation queries.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-27330">[SPARK-27330]</a>[SS] support task abort in foreach writer</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-28642">[SPARK-28642]</a>Hide credentials in SHOW CREATE TABLE</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-28699">[SPARK-28699]</a>[SQL] Disable using radix sort for ShuffleExchangeExec in repartition case</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-28699">[SPARK-28699]</a>[CORE] Fix a corner case for aborting indeterminate stage</p></li>
</ul>
</li>
<li><p>August 27, 2019</p>
<ul>
<li><p>Fixed an issue affecting certain <code class="docutils literal notranslate"><span class="pre">transform</span></code> expressions</p></li>
</ul>
</li>
<li><p>August 13, 2019</p>
<ul>
<li><p>Delta streaming source should check the latest protocol of a table</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-28489">[SPARK-28489]</a>[SS]Fix a bug that KafkaOffsetRangeCalculator.getRanges may drop offsets</p></li>
</ul>
</li>
<li><p>July 30, 2019</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-28015">[SPARK-28015]</a>[SQL] Check stringToDate() consumes entire input for the yyyy and yyyy-[m]m formats</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-28308">[SPARK-28308]</a>[CORE] CalendarInterval sub-second part should be padded before parsing</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-27485">[SPARK-27485]</a>EnsureRequirements.reorder should handle duplicate expressions gracefully</p></li>
</ul>
</li>
<li><p>July 2, 2019</p>
<ul>
<li><p>Upgraded snappy-java from 1.1.7.1 to 1.1.7.3.</p></li>
</ul>
</li>
<li><p>June 18, 2019</p>
<ul>
<li><p>Improved handling of MLflow active runs in MLlib integration</p></li>
<li><p>Improved Databricks Advisor message related to using disk caching</p></li>
<li><p>Fixed a bug affecting using higher order functions</p></li>
<li><p>Fixed a bug affecting Delta metadata queries</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="databricks-runtime-53-unsupported">
<span id="dbr-53-unsupported"></span><span id="53"></span><h3><a class="toc-backref" href="#id41">Databricks Runtime 5.3 (unsupported)</a><a class="headerlink" href="#databricks-runtime-53-unsupported" title="Permalink to this headline"> </a></h3>
<p>See <a class="reference internal" href="5.3.html"><span class="doc">Databricks Runtime 5.3 (unsupported)</span></a>.</p>
<ul class="simple">
<li><p>November 7, 2019</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-29743">[SPARK-29743]</a>[SQL] sample should set needCopyResult to true if its child’s needCopyResult is true</p></li>
</ul>
</li>
<li><p>October 8, 2019</p>
<ul>
<li><p>Server side changes to allow Simba Apache Spark ODBC driver to reconnect and continue after a connection failure during fetching results (requires Simba Apache Spark ODBC driver update to version 2.6.10).</p></li>
<li><p>Fixed NullPointerException when checking error code in the WASB client.</p></li>
</ul>
</li>
<li><p>September 10, 2019</p>
<ul>
<li><p>Add thread safe iterator to BytesToBytesMap</p></li>
<li><p>Fixed a bug affecting certain global aggregation queries.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-27330">[SPARK-27330]</a>[SS] support task abort in foreach writer</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-28642">[SPARK-28642]</a>Hide credentials in SHOW CREATE TABLE</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-28699">[SPARK-28699]</a>[SQL] Disable using radix sort for ShuffleExchangeExec in repartition case</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-28699">[SPARK-28699]</a>[CORE] Fix a corner case for aborting indeterminate stage</p></li>
</ul>
</li>
<li><p>August 27, 2019</p>
<ul>
<li><p>Fixed an issue affecting certain <code class="docutils literal notranslate"><span class="pre">transform</span></code> expressions</p></li>
</ul>
</li>
<li><p>August 13, 2019</p>
<ul>
<li><p>Delta streaming source should check the latest protocol of a table</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-28489">[SPARK-28489]</a>[SS]Fix a bug that KafkaOffsetRangeCalculator.getRanges may drop offsets</p></li>
</ul>
</li>
<li><p>July 30, 2019</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-28015">[SPARK-28015]</a>[SQL] Check stringToDate() consumes entire input for the yyyy and yyyy-[m]m formats</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-28308">[SPARK-28308]</a>[CORE] CalendarInterval sub-second part should be padded before parsing</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-27485">[SPARK-27485]</a>EnsureRequirements.reorder should handle duplicate expressions gracefully</p></li>
</ul>
</li>
<li><p>June 18, 2019</p>
<ul>
<li><p>Improved Databricks Advisor message related to using disk caching</p></li>
<li><p>Fixed a bug affecting using higher order functions</p></li>
<li><p>Fixed a bug affecting Delta metadata queries</p></li>
</ul>
</li>
<li><p>May 28, 2019</p>
<ul>
<li><p>Improved the stability of Delta</p></li>
<li><p>Tolerate IOExceptions when reading Delta LAST_CHECKPOINT file</p>
<ul>
<li><p>Added recovery to failed library installation</p></li>
</ul>
</li>
</ul>
</li>
<li><p>May 7, 2019</p>
<ul>
<li><p>Port HADOOP-15778 (ABFS: Fix client side throttling for read) to Azure Data Lake Storage Gen2 connector</p></li>
<li><p>Port HADOOP-16040 (ABFS: Bug fix for tolerateOobAppends configuration) to Azure Data Lake Storage Gen2 connector</p></li>
<li><p>Fixed a bug affecting table ACLs</p></li>
<li><p>Renamed <code class="docutils literal notranslate"><span class="pre">fs.s3a.requesterPays.enabled</span></code> to <code class="docutils literal notranslate"><span class="pre">fs.s3a.requester-pays.enabled</span></code></p></li>
<li><p>Fixed a race condition when loading a Delta log checksum file</p></li>
<li><p>Fixed Delta conflict detection logic to not identify “insert + overwrite” as pure “append” operation</p></li>
<li><p>Fixed a bug affecting Amazon Kinesis connector</p></li>
<li><p>Ensure that disk caching is not disabled when table ACLs are enabled</p></li>
<li><p>[SPARK-27494][SS] Null keys/values don’t work in Kafka source v2</p></li>
<li><p>[SPARK-27446][R] Use existing spark conf if available.</p></li>
<li><p>[SPARK-27454][SPARK-27454][ML][SQL] Spark image datasource fail when encounter some illegal images</p></li>
<li><p>[SPARK-27160][SQL] Fix DecimalType when building orc filters</p></li>
<li><p>[SPARK-27338][CORE] Fix deadlock between UnsafeExternalSorter and TaskMemoryManager</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="databricks-runtime-52-unsupported">
<span id="dbr-52-unsupported"></span><span id="52"></span><h3><a class="toc-backref" href="#id42">Databricks Runtime 5.2 (unsupported)</a><a class="headerlink" href="#databricks-runtime-52-unsupported" title="Permalink to this headline"> </a></h3>
<p>See <a class="reference internal" href="5.2.html"><span class="doc">Databricks Runtime 5.2 (unsupported)</span></a>.</p>
<ul>
<li><p>September 10, 2019</p>
<ul class="simple">
<li><p>Add thread safe iterator to BytesToBytesMap</p></li>
<li><p>Fixed a bug affecting certain global aggregation queries.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-27330">[SPARK-27330]</a>[SS] support task abort in foreach writer</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-28642">[SPARK-28642]</a>Hide credentials in SHOW CREATE TABLE</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-28699">[SPARK-28699]</a>[SQL] Disable using radix sort for ShuffleExchangeExec in repartition case</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-28699">[SPARK-28699]</a>[CORE] Fix a corner case for aborting indeterminate stage</p></li>
</ul>
</li>
<li><p>August 27, 2019</p>
<ul class="simple">
<li><p>Fixed an issue affecting certain <code class="docutils literal notranslate"><span class="pre">transform</span></code> expressions</p></li>
</ul>
</li>
<li><p>August 13, 2019</p>
<ul class="simple">
<li><p>Delta streaming source should check the latest protocol of a table</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-28489">[SPARK-28489]</a>[SS]Fix a bug that KafkaOffsetRangeCalculator.getRanges may drop offsets</p></li>
</ul>
</li>
<li><p>July 30, 2019</p>
<ul class="simple">
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-28015">[SPARK-28015]</a>[SQL] Check stringToDate() consumes entire input for the yyyy and yyyy-[m]m formats</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-28308">[SPARK-28308]</a>[CORE] CalendarInterval sub-second part should be padded before parsing</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-27485">[SPARK-27485]</a>EnsureRequirements.reorder should handle duplicate expressions gracefully</p></li>
</ul>
</li>
<li><p>July 2, 2019</p>
<ul class="simple">
<li><p>Tolerate IOExceptions when reading Delta LAST_CHECKPOINT file</p></li>
</ul>
</li>
<li><p>June 18, 2019</p>
<ul class="simple">
<li><p>Improved Databricks Advisor message related to using disk cache</p></li>
<li><p>Fixed a bug affecting using higher order functions</p></li>
<li><p>Fixed a bug affecting Delta metadata queries</p></li>
</ul>
</li>
<li><p>May 28, 2019</p>
<ul class="simple">
<li><p>Added recovery to failed library installation</p></li>
</ul>
</li>
<li><p>May 7, 2019</p>
<ul class="simple">
<li><p>Port HADOOP-15778 (ABFS: Fix client side throttling for read) to Azure Data Lake Storage Gen2 connector</p></li>
<li><p>Port HADOOP-16040 (ABFS: Bug fix for tolerateOobAppends configuration) to Azure Data Lake Storage Gen2 connector</p></li>
<li><p>Fixed a race condition when loading a Delta log checksum file</p></li>
<li><p>Fixed Delta conflict detection logic to not identify “insert + overwrite” as pure “append” operation</p></li>
<li><p>Fixed a bug affecting Amazon Kinesis connector</p></li>
<li><p>Ensure that disk caching is not disabled when table ACLs are enabled</p></li>
<li><p>[SPARK-27494][SS] Null keys/values don’t work in Kafka source v2</p></li>
<li><p>[SPARK-27454][SPARK-27454][ML][SQL] Spark image datasource fail when encounter some illegal images</p></li>
<li><p>[SPARK-27160][SQL] Fix DecimalType when building orc filters</p></li>
<li><p>[SPARK-27338][CORE] Fix deadlock between UnsafeExternalSorter and TaskMemoryManager</p></li>
</ul>
</li>
<li><p>March 26, 2019</p>
<ul class="simple">
<li><p>Avoid embedding platform-dependent offsets literally in whole-stage generated code</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-26665">[SPARK-26665]</a>[CORE] Fix a bug that BlockTransferService.fetchBlockSync may hang forever.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-27134">[SPARK-27134]</a>[SQL] array_distinct function does not work correctly with columns containing array of array.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-24669">[SPARK-24669]</a>[SQL] Invalidate tables in case of DROP DATABASE CASCADE.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-26572">[SPARK-26572]</a>[SQL] fix aggregate codegen result evaluation.</p></li>
<li><p>Fixed a bug affecting certain PythonUDFs.</p></li>
</ul>
</li>
<li><p>February 26, 2019</p>
<ul class="simple">
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-26864">[SPARK-26864]</a>[SQL] Query may return incorrect result when python udf is used as a left-semi join condition.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-26887">[SPARK-26887]</a>[PYTHON] Create datetime.date directly instead of creating datetime64 as intermediate data.</p></li>
<li><p>Fixed a bug affecting JDBC/ODBC server.</p></li>
<li><p>Fixed a bug affecting PySpark.</p></li>
<li><p>Exclude the hidden files when building HadoopRDD.</p></li>
<li><p>Fixed a bug in Delta that caused serialization issues.</p></li>
</ul>
</li>
<li><p>February 12, 2019</p>
<ul class="simple">
<li><p>Fixed an issue affecting using Delta with Azure ADLS Gen2 mount points.</p></li>
</ul>
<ul class="simple">
<li><p>Fixed an issue that Spark low level network protocol may be broken when sending large RPC error messages with encryption enabled (in <a class="reference internal" href="../../security/privacy/hipaa.html"><span class="doc">HIPAA compliance features</span></a>) or when <code class="docutils literal notranslate"><span class="pre">spark.network.crypto.enabled</span></code> is set to true).</p></li>
</ul>
</li>
<li><p>January 30, 2019</p>
<ul class="simple">
<li><p>Fixed the StackOverflowError when putting skew join hint on cached relation.</p></li>
<li><p>Fixed the inconsistency between a SQL cache’s cached RDD and its physical plan, which causes incorrect result.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-26706">[SPARK-26706]</a>[SQL] Fix <code class="docutils literal notranslate"><span class="pre">illegalNumericPrecedence</span></code> for ByteType.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-26709">[SPARK-26709]</a>[SQL] OptimizeMetadataOnlyQuery does not handle empty records correctly.</p></li>
<li><p>CSV/JSON data sources should avoid globbing paths when inferring schema.</p></li>
<li><p>Fixed constraint inference on Window operator.</p></li>
<li><p>Fixed an issue affecting installing egg libraries with clusters having table ACL enabled.</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="databricks-runtime-51-unsupported">
<span id="dbr-51-unsupported"></span><span id="51"></span><h3><a class="toc-backref" href="#id43">Databricks Runtime 5.1 (unsupported)</a><a class="headerlink" href="#databricks-runtime-51-unsupported" title="Permalink to this headline"> </a></h3>
<p>See <a class="reference internal" href="5.1.html"><span class="doc">Databricks Runtime 5.1 (unsupported)</span></a>.</p>
<ul>
<li><p>August 13, 2019</p>
<ul class="simple">
<li><p>Delta streaming source should check the latest protocol of a table</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-28489">[SPARK-28489]</a>[SS]Fix a bug that KafkaOffsetRangeCalculator.getRanges may drop offsets</p></li>
</ul>
</li>
<li><p>July 30, 2019</p>
<ul class="simple">
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-28015">[SPARK-28015]</a>[SQL] Check stringToDate() consumes entire input for the yyyy and yyyy-[m]m formats</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-28308">[SPARK-28308]</a>[CORE] CalendarInterval sub-second part should be padded before parsing</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-27485">[SPARK-27485]</a>EnsureRequirements.reorder should handle duplicate expressions gracefully</p></li>
</ul>
</li>
<li><p>July 2, 2019</p>
<ul class="simple">
<li><p>Tolerate IOExceptions when reading Delta LAST_CHECKPOINT file</p></li>
</ul>
</li>
<li><p>June 18, 2019</p>
<ul class="simple">
<li><p>Fixed a bug affecting using higher order functions</p></li>
<li><p>Fixed a bug affecting Delta metadata queries</p></li>
</ul>
</li>
<li><p>May 28, 2019</p>
<ul class="simple">
<li><p>Added recovery to failed library installation</p></li>
</ul>
</li>
<li><p>May 7, 2019</p>
<ul class="simple">
<li><p>Port HADOOP-15778 (ABFS: Fix client side throttling for read) to Azure Data Lake Storage Gen2 connector</p></li>
<li><p>Port HADOOP-16040 (ABFS: Bug fix for tolerateOobAppends configuration) to Azure Data Lake Storage Gen2 connector</p></li>
<li><p>Fixed a race condition when loading a Delta log checksum file</p></li>
<li><p>Fixed Delta conflict detection logic to not identify “insert + overwrite” as pure “append” operation</p></li>
<li><p>[SPARK-27494][SS] Null keys/values don’t work in Kafka source v2</p></li>
<li><p>[SPARK-27454][SPARK-27454][ML][SQL] Spark image datasource fail when encounter some illegal images</p></li>
<li><p>[SPARK-27160][SQL] Fix DecimalType when building orc filters</p></li>
<li><p>[SPARK-27338][CORE] Fix deadlock between UnsafeExternalSorter and TaskMemoryManager</p></li>
</ul>
</li>
<li><p>March 26, 2019</p>
<ul class="simple">
<li><p>Avoid embedding platform-dependent offsets literally in whole-stage generated code</p></li>
<li><p>Fixed a bug affecting certain PythonUDFs.</p></li>
</ul>
</li>
<li><p>February 26, 2019</p>
<ul class="simple">
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-26864">[SPARK-26864]</a>[SQL] Query may return incorrect result when python udf is used as a left-semi join condition.</p></li>
<li><p>Fixed a bug affecting JDBC/ODBC server.</p></li>
<li><p>Exclude the hidden files when building HadoopRDD.</p></li>
</ul>
</li>
<li><p>February 12, 2019</p>
<ul class="simple">
<li><p>Fixed an issue affecting installing egg libraries with clusters having table ACL enabled.</p></li>
<li><p>Fixed the inconsistency between a SQL cache’s cached RDD and its physical plan, which causes incorrect result.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-26706">[SPARK-26706]</a>[SQL] Fix <code class="docutils literal notranslate"><span class="pre">illegalNumericPrecedence</span></code> for ByteType.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-26709">[SPARK-26709]</a>[SQL] OptimizeMetadataOnlyQuery does not handle empty records correctly.</p></li>
<li><p>Fixed constraint inference on Window operator.</p></li>
</ul>
<ul class="simple">
<li><p>Fixed an issue that Spark low level network protocol may be broken when sending large RPC error messages with encryption enabled (in <a class="reference internal" href="../../security/privacy/hipaa.html"><span class="doc">HIPAA compliance features</span></a>) or when <code class="docutils literal notranslate"><span class="pre">spark.network.crypto.enabled</span></code> is set to true).</p></li>
</ul>
</li>
<li><p>January 30, 2019</p>
<ul class="simple">
<li><p>Fixed an issue that can cause <code class="docutils literal notranslate"><span class="pre">df.rdd.count()</span></code> with UDT to return incorrect answer for certain cases.</p></li>
<li><p>Fixed an issue affecting installing wheelhouses.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-26267">[SPARK-26267]</a>Retry when detecting incorrect offsets from Kafka.</p></li>
<li><p>Fixed a bug that affects multiple file stream sources in a streaming query.</p></li>
<li><p>Fixed the StackOverflowError when putting skew join hint on cached relation.</p></li>
<li><p>Fixed the inconsistency between a SQL cache’s cached RDD and its physical plan, which causes incorrect result.</p></li>
</ul>
</li>
<li><p>January 8, 2019</p>
<ul class="simple">
<li><p>Fixed issue that causes the error <code class="docutils literal notranslate"><span class="pre">org.apache.spark.sql.expressions.Window.rangeBetween(long,long)</span> <span class="pre">is</span> <span class="pre">not</span> <span class="pre">whitelisted</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-26352">[SPARK-26352]</a>join reordering should not change the order of output attributes.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-26366">[SPARK-26366]</a>ReplaceExceptWithFilter should consider NULL as False.</p></li>
<li><p>Stability improvement for Delta Lake.</p></li>
<li><p>Delta Lake is enabled.</p></li>
</ul>
<ul class="simple">
<li><p>Databricks IO Cache is enabled for the IO Cache Accelerated instance type.</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="databricks-runtime-50-unsupported">
<span id="dbr-50-unsupported"></span><span id="50"></span><h3><a class="toc-backref" href="#id44">Databricks Runtime 5.0 (unsupported)</a><a class="headerlink" href="#databricks-runtime-50-unsupported" title="Permalink to this headline"> </a></h3>
<p>See <a class="reference internal" href="5.0.html"><span class="doc">Databricks Runtime 5.0 (unsupported)</span></a>.</p>
<ul>
<li><p>June 18, 2019</p>
<ul class="simple">
<li><p>Fixed a bug affecting using higher order functions</p></li>
</ul>
</li>
<li><p>May 7, 2019</p>
<ul class="simple">
<li><p>Fixed a race condition when loading a Delta log checksum file</p></li>
<li><p>Fixed Delta conflict detection logic to not identify “insert + overwrite” as pure “append” operation</p></li>
<li><p>[SPARK-27494][SS] Null keys/values don’t work in Kafka source v2</p></li>
<li><p>[SPARK-27454][SPARK-27454][ML][SQL] Spark image datasource fail when encounter some illegal images</p></li>
<li><p>[SPARK-27160][SQL] Fix DecimalType when building orc filters</p>
<ul>
<li><p>[SPARK-27338][CORE] Fix deadlock between UnsafeExternalSorter and TaskMemoryManager</p></li>
</ul>
</li>
</ul>
</li>
<li><p>March 26, 2019</p>
<ul class="simple">
<li><p>Avoid embedding platform-dependent offsets literally in whole-stage generated code</p></li>
<li><p>Fixed a bug affecting certain PythonUDFs.</p></li>
</ul>
</li>
<li><p>March 12, 2019</p>
<ul class="simple">
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-26864">[SPARK-26864]</a>[SQL] Query may return incorrect result when python udf is used as a left-semi join condition.</p></li>
</ul>
</li>
<li><p>February 26, 2019</p>
<ul class="simple">
<li><p>Fixed a bug affecting JDBC/ODBC server.</p></li>
<li><p>Exclude the hidden files when building HadoopRDD.</p></li>
</ul>
</li>
<li><p>February 12, 2019</p>
<ul class="simple">
<li><p>Fixed the inconsistency between a SQL cache’s cached RDD and its physical plan, which causes incorrect result.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-26706">[SPARK-26706]</a>[SQL] Fix <code class="docutils literal notranslate"><span class="pre">illegalNumericPrecedence</span></code> for ByteType.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-26709">[SPARK-26709]</a>[SQL] OptimizeMetadataOnlyQuery does not handle empty records correctly.</p></li>
<li><p>Fixed constraint inference on Window operator.</p></li>
</ul>
<ul class="simple">
<li><p>Fixed an issue that Spark low level network protocol may be broken when sending large RPC error messages with encryption enabled (in <a class="reference internal" href="../../security/privacy/hipaa.html"><span class="doc">HIPAA compliance features</span></a>) or when <code class="docutils literal notranslate"><span class="pre">spark.network.crypto.enabled</span></code> is set to true).</p></li>
</ul>
</li>
<li><p>January 30, 2019</p>
<ul class="simple">
<li><p>Fixed an issue that can cause <code class="docutils literal notranslate"><span class="pre">df.rdd.count()</span></code> with UDT to return incorrect answer for certain cases.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-26267">[SPARK-26267]</a>Retry when detecting incorrect offsets from Kafka.</p></li>
<li><p>Fixed a bug that affects multiple file stream sources in a streaming query.</p></li>
<li><p>Fixed the StackOverflowError when putting skew join hint on cached relation.</p></li>
<li><p>Fixed the inconsistency between a SQL cache’s cached RDD and its physical plan, which causes incorrect result.</p></li>
</ul>
</li>
<li><p>January 8, 2019</p>
<ul class="simple">
<li><p>Fixed issue that caused the error <code class="docutils literal notranslate"><span class="pre">org.apache.spark.sql.expressions.Window.rangeBetween(long,long)</span> <span class="pre">is</span> <span class="pre">not</span> <span class="pre">whitelisted</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-26352">[SPARK-26352]</a>join reordering should not change the order of output attributes.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-26366">[SPARK-26366]</a>ReplaceExceptWithFilter should consider NULL as False.</p></li>
<li><p>Stability improvement for Delta Lake.</p></li>
<li><p>Delta Lake is enabled.</p></li>
</ul>
<ul class="simple">
<li><p>Databricks IO Cache is enabled for the IO Cache Accelerated instance type.</p></li>
</ul>
</li>
<li><p>December 18, 2018</p>
<ul class="simple">
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-26293">[SPARK-26293]</a>Cast exception when having Python UDF in subquery</p></li>
<li><p>Fixed an issue affecting certain queries using Join and Limit.</p></li>
<li><p>Redacted credentials from RDD names in Spark UI</p></li>
</ul>
</li>
<li><p>December 6, 2018</p>
<ul class="simple">
<li><p>Fixed an issue that caused incorrect query result when using orderBy followed immediately by groupBy with group-by key as the leading part of the sort-by key.</p></li>
<li><p>Upgraded Snowflake Connector for Spark from 2.4.9.2-spark_2.4_pre_release to 2.4.10.</p></li>
<li><p>Only ignore corrupt files after one or more retries when <code class="docutils literal notranslate"><span class="pre">spark.sql.files.ignoreCorruptFiles</span></code> or <code class="docutils literal notranslate"><span class="pre">spark.sql.files.ignoreMissingFiles</span></code> flag is enabled.</p></li>
<li><p>Fixed an issue affecting certain self union queries.</p></li>
<li><p>Fixed a bug with the thrift server where sessions are sometimes leaked when cancelled.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-26307">[SPARK-26307]</a>Fixed CTAS when INSERT a partitioned table using Hive SerDe.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-26147">[SPARK-26147]</a>Python UDFs in join condition fail even when using columns from only one side of join</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-26211">[SPARK-26211]</a>Fix InSet for binary, and struct and array with null.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-26181">[SPARK-26181]</a>the <code class="docutils literal notranslate"><span class="pre">hasMinMaxStats</span></code> method of <code class="docutils literal notranslate"><span class="pre">ColumnStatsMap</span></code> is not correct.</p></li>
<li><p>Fixed an issue affecting installing Python Wheels in environments without Internet access.</p></li>
</ul>
</li>
<li><p>November 20, 2018</p>
<ul class="simple">
<li><p>Fixed an issue that caused a notebook not usable after cancelling a streaming query.</p></li>
<li><p>Fixed an issue affecting certain queries using window functions.</p></li>
<li><p>Fixed an issue affecting a stream from Delta with multiple schema changes.</p></li>
<li><p>Fixed an issue affecting certain aggregation queries with Left Semi/Anti joins.</p></li>
</ul>
<ul class="simple">
<li><p>Fixed an issue affecting reading timestamp columns from Redshift.</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="databricks-runtime-43-unsupported">
<span id="dbr-43-unsupported"></span><span id="43"></span><h3><a class="toc-backref" href="#id45">Databricks Runtime 4.3 (unsupported)</a><a class="headerlink" href="#databricks-runtime-43-unsupported" title="Permalink to this headline"> </a></h3>
<p>See <a class="reference internal" href="4.3.html"><span class="doc">Databricks Runtime 4.3 (unsupported)</span></a>.</p>
<ul>
<li><p>April 9, 2019</p>
<ul class="simple">
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-26665">[SPARK-26665]</a>[CORE] Fix a bug that can cause BlockTransferService.fetchBlockSync to hang forever.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-24669">[SPARK-24669]</a>[SQL] Invalidate tables in case of DROP DATABASE CASCADE.</p></li>
</ul>
</li>
<li><p>March 12, 2019</p>
<ul class="simple">
<li><p>Fixed a bug affecting code generation.</p></li>
<li><p>Fixed a bug affecting Delta.</p></li>
</ul>
</li>
<li><p>February 26, 2019</p>
<ul class="simple">
<li><p>Fixed a bug affecting JDBC/ODBC server.</p></li>
</ul>
</li>
<li><p>February 12, 2019</p>
<ul class="simple">
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-26709">[SPARK-26709]</a>[SQL] OptimizeMetadataOnlyQuery does not handle empty records correctly.</p></li>
<li><p>Excluding the hidden files when building HadoopRDD.</p></li>
<li><p>Fixed Parquet Filter Conversion for IN predicate when its value is empty.</p></li>
</ul>
<ul class="simple">
<li><p>Fixed an issue that Spark low level network protocol may be broken when sending large RPC error messages with encryption enabled (in <a class="reference internal" href="../../security/privacy/hipaa.html"><span class="doc">HIPAA compliance features</span></a>) or when <code class="docutils literal notranslate"><span class="pre">spark.network.crypto.enabled</span></code> is set to true).</p></li>
</ul>
</li>
<li><p>January 30, 2019</p>
<ul class="simple">
<li><p>Fixed an issue that can cause <code class="docutils literal notranslate"><span class="pre">df.rdd.count()</span></code> with UDT to return incorrect answer for certain cases.</p></li>
<li><p>Fixed the inconsistency between a SQL cache’s cached RDD and its physical plan, which causes incorrect result.</p></li>
</ul>
</li>
<li><p>January 8, 2019</p>
<ul class="simple">
<li><p>Fixed the issue that causes the error <code class="docutils literal notranslate"><span class="pre">org.apache.spark.sql.expressions.Window.rangeBetween(long,long)</span> <span class="pre">is</span> <span class="pre">not</span> <span class="pre">whitelisted</span></code>.</p></li>
<li><p>Redacted credentials from RDD names in Spark UI</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-26352">[SPARK-26352]</a>join reordering should not change the order of output attributes.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-26366">[SPARK-26366]</a>ReplaceExceptWithFilter should consider NULL as False.</p></li>
<li><p>Delta Lake is enabled.</p></li>
</ul>
<ul class="simple">
<li><p>Databricks IO Cache is enabled for the IO Cache Accelerated instance type.</p></li>
</ul>
</li>
<li><p>December 18, 2018</p>
<ul class="simple">
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-25002">[SPARK-25002]</a>Avro: revise the output record namespace.</p></li>
<li><p>Fixed an issue affecting certain queries using Join and Limit.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-26307">[SPARK-26307]</a>Fixed CTAS when INSERT a partitioned table using Hive SerDe.</p></li>
<li><p>Only ignore corrupt files after one or more retries when <code class="docutils literal notranslate"><span class="pre">spark.sql.files.ignoreCorruptFiles</span></code> or <code class="docutils literal notranslate"><span class="pre">spark.sql.files.ignoreMissingFiles</span></code> flag is enabled.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-26181">[SPARK-26181]</a>the <code class="docutils literal notranslate"><span class="pre">hasMinMaxStats</span></code> method of <code class="docutils literal notranslate"><span class="pre">ColumnStatsMap</span></code> is not correct.</p></li>
<li><p>Fixed an issue affecting installing Python Wheels in environments without Internet access.</p></li>
<li><p>Fixed a performance issue in query analyzer.</p></li>
<li><p>Fixed an issue in PySpark that caused DataFrame actions failed with “connection refused” error.</p></li>
<li><p>Fixed an issue affecting certain self union queries.</p></li>
</ul>
</li>
<li><p>November 20, 2018</p>
<ul class="simple">
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-17916">[SPARK-17916]</a><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-25241">[SPARK-25241]</a>Fix empty string being parsed as null when nullValue is set.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-25387">[SPARK-25387]</a>Fix for NPE caused by bad CSV input.</p></li>
<li><p>Fixed an issue affecting certain aggregation queries with Left Semi/Anti joins.</p></li>
</ul>
<ul class="simple">
<li><p>Fixed an issue affecting reading timestamp columns from Redshift.</p></li>
</ul>
</li>
<li><p>November 6, 2018</p>
<ul class="simple">
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-25741">[SPARK-25741]</a>Long URLs are not rendered properly in web UI.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-25714">[SPARK-25714]</a>Fix Null Handling in the Optimizer rule BooleanSimplification.</p></li>
<li><p>Fixed an issue affecting temporary objects cleanup in Synapse Analytics connector.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-25816">[SPARK-25816]</a>Fix attribute resolution in nested extractors.</p></li>
</ul>
</li>
</ul>
<ul class="simple">
<li><p>October 9, 2018</p>
<ul>
<li><p>Fixed a bug affecting the output of running <code class="docutils literal notranslate"><span class="pre">SHOW</span> <span class="pre">CREATE</span> <span class="pre">TABLE</span></code> on Delta tables.</p></li>
<li><p>Fixed a bug affecting <code class="docutils literal notranslate"><span class="pre">Union</span></code> operation.</p></li>
</ul>
</li>
</ul>
<ul class="simple">
<li><p>September 25, 2018</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-25368">[SPARK-25368]</a>[SQL] Incorrect constraint inference returns wrong result.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-25402">[SPARK-25402]</a>[SQL] Null handling in BooleanSimplification.</p></li>
<li><p>Fixed <code class="docutils literal notranslate"><span class="pre">NotSerializableException</span></code> in Avro data source.</p></li>
</ul>
</li>
<li><p>September 11, 2018</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-25214">[SPARK-25214]</a>[SS] Fix the issue that Kafka v2 source may return duplicated records when <code class="docutils literal notranslate"><span class="pre">failOnDataLoss=false</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-24987">[SPARK-24987]</a>[SS] Fix Kafka consumer leak when no new offsets for articlePartition.</p></li>
<li><p>Filter reduction should handle null value correctly.</p></li>
<li><p>Improved stability of execution engine.</p></li>
</ul>
</li>
<li><p>August 28, 2018</p>
<ul>
<li><p>Fixed a bug in Delta Lake Delete command that would incorrectly delete the rows where the condition evaluates to null.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-25142">[SPARK-25142]</a>Add error messages when Python worker could not open socket in <code class="docutils literal notranslate"><span class="pre">_load_from_socket</span></code>.</p></li>
</ul>
</li>
<li><p>August 23, 2018</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-23935">[SPARK-23935]</a>mapEntry throws <code class="docutils literal notranslate"><span class="pre">org.codehaus.commons.compiler.CompileException</span></code>.</p></li>
<li><p>Fixed nullable map issue in Parquet reader.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-25051">[SPARK-25051]</a>[SQL] FixNullability should not stop on AnalysisBarrier.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-25081">[SPARK-25081]</a>Fixed a bug where ShuffleExternalSorter may access a released memory page when spilling fails to allocate memory.</p></li>
<li><p>Fixed an interaction between Databricks Delta and Pyspark which could cause transient read failures.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-25084">[SPARK-25084]</a>”distribute by” on multiple columns (wrap in brackets) may lead to codegen issue.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-25096">[SPARK-25096]</a>Loosen nullability if the cast is force-nullable.</p></li>
<li><p>Lowered the default number of threads used by the Delta Lake Optimize command, reducing memory overhead and committing data faster.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-25114">[SPARK-25114]</a>Fix RecordBinaryComparator when subtraction between two words is divisible by Integer.MAX_VALUE.</p></li>
<li><p>Fixed secret manager redaction when command partially succeed.</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="databricks-runtime-42-unsupported">
<span id="dbr-42-unsupported"></span><span id="42"></span><h3><a class="toc-backref" href="#id46">Databricks Runtime 4.2 (unsupported)</a><a class="headerlink" href="#databricks-runtime-42-unsupported" title="Permalink to this headline"> </a></h3>
<p>See <a class="reference internal" href="4.2.html"><span class="doc">Databricks Runtime 4.2 (unsupported)</span></a>.</p>
<ul>
<li><p>February 26, 2019</p>
<ul class="simple">
<li><p>Fixed a bug affecting JDBC/ODBC server.</p></li>
</ul>
</li>
<li><p>February 12, 2019</p>
<ul class="simple">
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-26709">[SPARK-26709]</a>[SQL] OptimizeMetadataOnlyQuery does not handle empty records correctly.</p></li>
<li><p>Excluding the hidden files when building HadoopRDD.</p></li>
<li><p>Fixed Parquet Filter Conversion for IN predicate when its value is empty.</p></li>
</ul>
<ul class="simple">
<li><p>Fixed an issue that Spark low level network protocol may be broken when sending large RPC error messages with encryption enabled (in <a class="reference internal" href="../../security/privacy/hipaa.html"><span class="doc">HIPAA compliance features</span></a>) or when <code class="docutils literal notranslate"><span class="pre">spark.network.crypto.enabled</span></code> is set to true).</p></li>
</ul>
</li>
<li><p>January 30, 2019</p>
<ul class="simple">
<li><p>Fixed an issue that can cause <code class="docutils literal notranslate"><span class="pre">df.rdd.count()</span></code> with UDT to return incorrect answer for certain cases.</p></li>
</ul>
</li>
<li><p>January 8, 2019</p>
<ul class="simple">
<li><p>Fixed issue that causes the error <code class="docutils literal notranslate"><span class="pre">org.apache.spark.sql.expressions.Window.rangeBetween(long,long)</span> <span class="pre">is</span> <span class="pre">not</span> <span class="pre">whitelisted</span></code>.</p></li>
<li><p>Redacted credentials from RDD names in Spark UI</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-26352">[SPARK-26352]</a>join reordering should not change the order of output attributes.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-26366">[SPARK-26366]</a>ReplaceExceptWithFilter should consider NULL as False.</p></li>
<li><p>Delta Lake is enabled.</p></li>
</ul>
<ul class="simple">
<li><p>Databricks IO Cache is enabled for the IO Cache Accelerated instance type.</p></li>
</ul>
</li>
<li><p>December 18, 2018</p>
<ul class="simple">
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-25002">[SPARK-25002]</a>Avro: revise the output record namespace.</p></li>
<li><p>Fixed an issue affecting certain queries using Join and Limit.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-26307">[SPARK-26307]</a>Fixed CTAS when INSERT a partitioned table using Hive SerDe.</p></li>
<li><p>Only ignore corrupt files after one or more retries when <code class="docutils literal notranslate"><span class="pre">spark.sql.files.ignoreCorruptFiles</span></code> or <code class="docutils literal notranslate"><span class="pre">spark.sql.files.ignoreMissingFiles</span></code> flag is enabled.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-26181">[SPARK-26181]</a>the <code class="docutils literal notranslate"><span class="pre">hasMinMaxStats</span></code> method of <code class="docutils literal notranslate"><span class="pre">ColumnStatsMap</span></code> is not correct.</p></li>
<li><p>Fixed an issue affecting installing Python Wheels in environments without Internet access.</p></li>
<li><p>Fixed a performance issue in query analyzer.</p></li>
<li><p>Fixed an issue in PySpark that caused DataFrame actions failed with “connection refused” error.</p></li>
<li><p>Fixed an issue affecting certain self union queries.</p></li>
</ul>
</li>
<li><p>November 20, 2018</p>
<ul class="simple">
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-17916">[SPARK-17916]</a><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-25241">[SPARK-25241]</a>Fix empty string being parsed as null when nullValue is set.</p></li>
<li><p>Fixed an issue affecting certain aggregation queries with Left Semi/Anti joins.</p></li>
</ul>
<ul class="simple">
<li><p>Fixed an issue affecting reading timestamp columns from Redshift.</p></li>
</ul>
</li>
<li><p>November 6, 2018</p>
<ul class="simple">
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-25741">[SPARK-25741]</a>Long URLs are not rendered properly in web UI.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-25714">[SPARK-25714]</a>Fix Null Handling in the Optimizer rule BooleanSimplification.</p></li>
</ul>
</li>
</ul>
<ul class="simple">
<li><p>October 9, 2018</p>
<ul>
<li><p>Fixed a bug affecting the output of running <code class="docutils literal notranslate"><span class="pre">SHOW</span> <span class="pre">CREATE</span> <span class="pre">TABLE</span></code> on Delta tables.</p></li>
<li><p>Fixed a bug affecting <code class="docutils literal notranslate"><span class="pre">Union</span></code> operation.</p></li>
</ul>
</li>
</ul>
<ul class="simple">
<li><p>September 25, 2018</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-25368">[SPARK-25368]</a>[SQL] Incorrect constraint inference returns wrong result.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-25402">[SPARK-25402]</a>[SQL] Null handling in BooleanSimplification.</p></li>
<li><p>Fixed <code class="docutils literal notranslate"><span class="pre">NotSerializableException</span></code> in Avro data source.</p></li>
</ul>
</li>
<li><p>September 11, 2018</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-25214">[SPARK-25214]</a>[SS] Fix the issue that Kafka v2 source may return duplicated records when <code class="docutils literal notranslate"><span class="pre">failOnDataLoss=false</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-24987">[SPARK-24987]</a>[SS] Fix Kafka consumer leak when no new offsets for articlePartition.</p></li>
<li><p>Filter reduction should handle null value correctly.</p></li>
</ul>
</li>
<li><p>August 28, 2018</p>
<ul>
<li><p>Fixed a bug in Delta Lake Delete command that would incorrectly delete the rows where the condition evaluates to null.</p></li>
</ul>
</li>
<li><p>August 23, 2018</p>
<ul>
<li><p>Fixed NoClassDefError for Delta Snapshot</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-23935">[SPARK-23935]</a>mapEntry throws <code class="docutils literal notranslate"><span class="pre">org.codehaus.commons.compiler.CompileException</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-24957">[SPARK-24957]</a>[SQL] Average with decimal followed by aggregation returns wrong result. The incorrect results of AVERAGE might be returned. The CAST added in the Average operator will be bypassed if the result of Divide is the same type which it is casted to.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-25081">[SPARK-25081]</a>Fixed a bug where ShuffleExternalSorter may access a released memory page when spilling fails to allocate memory.</p></li>
<li><p>Fixed an interaction between Databricks Delta and Pyspark which could cause transient read failures.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-25114">[SPARK-25114]</a>Fix RecordBinaryComparator when subtraction between two words is divisible by Integer.MAX_VALUE.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-25084">[SPARK-25084]</a>”distribute by” on multiple columns (wrap in brackets) may lead to codegen issue.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-24934">[SPARK-24934]</a>[SQL] Explicitly allowlist supported types in upper/lower bounds for in-memory partition pruning. When complex data types are used in query filters against cached data, Spark always returns an empty result set. The in-memory stats-based pruning generates incorrect results, because null is set for upper/lower bounds for complex types. The fix is to not use in-memory stats-based pruning for complex types.</p></li>
<li><p>Fixed secret manager redaction when command partially succeed.</p></li>
<li><p>Fixed nullable map issue in Parquet reader.</p></li>
</ul>
</li>
<li><p>August 2, 2018</p>
<ul>
<li><p>Added writeStream.table API in Python.</p></li>
<li><p>Fixed an issue affecting Delta checkpointing.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-24867">[SPARK-24867]</a>[SQL] Add AnalysisBarrier to DataFrameWriter. SQL cache is not being used when using DataFrameWriter to write a DataFrame with UDF. This is a regression caused by the changes we made in AnalysisBarrier, since not all the Analyzer rules are idempotent.</p></li>
<li><p>Fixed an issue that could cause <code class="docutils literal notranslate"><span class="pre">mergeInto</span></code> command to produce incorrect results.</p></li>
<li><p>Improved stability on accessing Azure Data Lake Storage Gen1.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-24809">[SPARK-24809]</a>Serializing LongHashedRelation in executor may result in data error.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-24878">[SPARK-24878]</a>[SQL] Fix reverse function for array type of primitive type containing null.</p></li>
</ul>
</li>
<li><p>July 11, 2018</p>
<ul>
<li><p>Fixed a bug in query execution that would cause aggregations on decimal columns with different precisions to return   incorrect results in some cases.</p></li>
<li><p>Fixed a <code class="docutils literal notranslate"><span class="pre">NullPointerException</span></code> bug that was thrown during advanced aggregation operations like grouping sets.</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="databricks-runtime-41-ml-unsupported">
<span id="dbr-41-ml-unsupported"></span><span id="41ml"></span><h3><a class="toc-backref" href="#id47">Databricks Runtime 4.1 ML (unsupported)</a><a class="headerlink" href="#databricks-runtime-41-ml-unsupported" title="Permalink to this headline"> </a></h3>
<p>See <a class="reference internal" href="4.1ml.html"><span class="doc">Databricks Runtime 4.1 ML (unsupported)</span></a>.</p>
<ul class="simple">
<li><p>July 31, 2018</p>
<ul>
<li><p>Added Azure Synapse Analytics to ML Runtime 4.1</p></li>
<li><p>Fixed a bug that could cause incorrect query results when the name of a partition column used in a predicate differs from the case of that column in the schema of the table.</p></li>
<li><p>Fixed a bug affecting Spark SQL execution engine.</p></li>
<li><p>Fixed a bug affecting code generation.</p></li>
<li><p>Fixed a bug (<code class="docutils literal notranslate"><span class="pre">java.lang.NoClassDefFoundError</span></code>) affecting Delta Lake.</p></li>
<li><p>Improved error handling in Delta Lake.</p></li>
<li><p>Fixed a bug that caused incorrect data skipping statistics to be collected for string columns 32 characters or greater.</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="databricks-runtime-41-unsupported">
<span id="dbr-41-unsupported"></span><span id="41"></span><h3><a class="toc-backref" href="#id48">Databricks Runtime 4.1 (unsupported)</a><a class="headerlink" href="#databricks-runtime-41-unsupported" title="Permalink to this headline"> </a></h3>
<p>See <a class="reference internal" href="4.1.html"><span class="doc">Databricks Runtime 4.1 (unsupported)</span></a>.</p>
<ul class="simple">
<li><p>January 8, 2019</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-26366">[SPARK-26366]</a>ReplaceExceptWithFilter should consider NULL as False.</p></li>
<li><p>Delta Lake is enabled.</p></li>
</ul>
</li>
<li><p>December 18, 2018</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-25002">[SPARK-25002]</a>Avro: revise the output record namespace.</p></li>
<li><p>Fixed an issue affecting certain queries using Join and Limit.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-26307">[SPARK-26307]</a>Fixed CTAS when INSERT a partitioned table using Hive SerDe.</p></li>
<li><p>Only ignore corrupt files after one or more retries when <code class="docutils literal notranslate"><span class="pre">spark.sql.files.ignoreCorruptFiles</span></code> or <code class="docutils literal notranslate"><span class="pre">spark.sql.files.ignoreMissingFiles</span></code> flag is enabled.</p></li>
<li><p>Fixed an issue affecting installing Python Wheels in environments without Internet access.</p></li>
<li><p>Fixed an issue in PySpark that caused DataFrame actions failed with “connection refused” error.</p></li>
<li><p>Fixed an issue affecting certain self union queries.</p></li>
</ul>
</li>
<li><p>November 20, 2018</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-17916">[SPARK-17916]</a><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-25241">[SPARK-25241]</a>Fix empty string being parsed as null when nullValue is set.</p></li>
<li><p>Fixed an issue affecting certain aggregation queries with Left Semi/Anti joins.</p></li>
</ul>
</li>
<li><p>November 6, 2018</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-25741">[SPARK-25741]</a>Long URLs are not rendered properly in web UI.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-25714">[SPARK-25714]</a>Fix Null Handling in the Optimizer rule BooleanSimplification.</p></li>
</ul>
</li>
</ul>
<ul class="simple">
<li><p>October 9, 2018</p>
<ul>
<li><p>Fixed a bug affecting the output of running <code class="docutils literal notranslate"><span class="pre">SHOW</span> <span class="pre">CREATE</span> <span class="pre">TABLE</span></code> on Delta tables.</p></li>
<li><p>Fixed a bug affecting <code class="docutils literal notranslate"><span class="pre">Union</span></code> operation.</p></li>
</ul>
</li>
</ul>
<ul class="simple">
<li><p>September 25, 2018</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-25368">[SPARK-25368]</a>[SQL] Incorrect constraint inference returns wrong result.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-25402">[SPARK-25402]</a>[SQL] Null handling in BooleanSimplification.</p></li>
<li><p>Fixed <code class="docutils literal notranslate"><span class="pre">NotSerializableException</span></code> in Avro data source.</p></li>
</ul>
</li>
<li><p>September 11, 2018</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-25214">[SPARK-25214]</a>[SS] Fix the issue that Kafka v2 source may return duplicated records when <code class="docutils literal notranslate"><span class="pre">failOnDataLoss=false</span></code>.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-24987">[SPARK-24987]</a>[SS] Fix Kafka consumer leak when no new offsets for articlePartition.</p></li>
<li><p>Filter reduction should handle null value correctly.</p></li>
</ul>
</li>
<li><p>August 28, 2018</p>
<ul>
<li><p>Fixed a bug in Delta Lake Delete command that would incorrectly delete the rows where the condition evaluates to null.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-25084">[SPARK-25084]</a>”distribute by” on multiple columns (wrap in brackets) may lead to codegen issue.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-25114">[SPARK-25114]</a>Fix RecordBinaryComparator when subtraction between two words is divisible by Integer.MAX_VALUE.</p></li>
</ul>
</li>
<li><p>August 23, 2018</p>
<ul>
<li><p>Fixed NoClassDefError for Delta Snapshot.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-24957">[SPARK-24957]</a>[SQL] Average with decimal followed by aggregation returns wrong result. The incorrect results of AVERAGE might be returned. The CAST added in the Average operator will be bypassed if the result of Divide is the same type which it is casted to.</p></li>
<li><p>Fixed nullable map issue in Parquet reader.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-24934">[SPARK-24934]</a>[SQL] Explicitly allowlist supported types in upper/lower bounds for in-memory partition pruning. When complex data types are used in query filters against cached data, Spark always returns an empty result set. The in-memory stats-based pruning generates incorrect results, because null is set for upper/lower bounds for complex types. The fix is to not use in-memory stats-based pruning for complex types.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-25081">[SPARK-25081]</a>Fixed a bug where ShuffleExternalSorter may access a released memory page when spilling fails to allocate memory.</p></li>
<li><p>Fixed an interaction between Databricks Delta and Pyspark which could cause transient read failures.</p></li>
<li><p>Fixed secret manager redaction when command partially succeed</p></li>
</ul>
</li>
<li><p>August 2, 2018</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-24613">[SPARK-24613]</a>[SQL] Cache with UDF could not be matched with subsequent dependent caches. Wraps the logical plan with a AnalysisBarrier for execution plan compilation in CacheManager, in order to avoid the plan being analyzed again. This is also a regression of Spark 2.3.</p></li>
<li><p>Fixed a Synapse Analytics connector issue affecting timezone conversion for writing DateType data.</p></li>
<li><p>Fixed an issue affecting Delta checkpointing.</p></li>
<li><p>Fixed an issue that could cause <code class="docutils literal notranslate"><span class="pre">mergeInto</span></code> command to produce incorrect results.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-24867">[SPARK-24867]</a>[SQL] Add AnalysisBarrier to DataFrameWriter. SQL cache is not being used when using DataFrameWriter to write a DataFrame with UDF. This is a regression caused by the changes we made in AnalysisBarrier, since not all the Analyzer rules are idempotent.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-24809">[SPARK-24809]</a>Serializing LongHashedRelation in executor may result in data error.</p></li>
</ul>
</li>
<li><p>July 11, 2018</p>
<ul>
<li><p>Fixed a bug in query execution that would cause aggregations on decimal columns with different precisions to return incorrect results in some cases.</p></li>
<li><p>Fixed a <code class="docutils literal notranslate"><span class="pre">NullPointerException</span></code> bug that was thrown during advanced aggregation operations like grouping sets.</p></li>
</ul>
</li>
<li><p>June 28, 2018</p>
<ul>
<li><p>Fixed a bug that could cause incorrect query results when the name of a partition column used in a predicate differs from the case of that column in the schema of the table.</p></li>
</ul>
</li>
</ul>
<ul class="simple">
<li><p>May 29, 2018</p>
<ul>
<li><p>Fixed a bug affecting Spark SQL execution engine.</p></li>
<li><p>Fixed a bug affecting code generation.</p></li>
<li><p>Fixed a bug (<code class="docutils literal notranslate"><span class="pre">java.lang.NoClassDefFoundError</span></code>) affecting Delta Lake.</p></li>
<li><p>Improved error handling in Delta Lake.</p></li>
</ul>
</li>
<li><p>May 15, 2018</p>
<ul>
<li><p>Fixed a bug that caused incorrect data skipping statistics to be collected for string columns 32 characters or greater.</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="databricks-runtime-40-unsupported">
<span id="dbr-40-unsupported"></span><span id="40"></span><h3><a class="toc-backref" href="#id49">Databricks Runtime 4.0 (unsupported)</a><a class="headerlink" href="#databricks-runtime-40-unsupported" title="Permalink to this headline"> </a></h3>
<p>See <a class="reference internal" href="4.0.html"><span class="doc">Databricks Runtime 4.0 (unsupported)</span></a>.</p>
<ul class="simple">
<li><p>November 6, 2018</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-25714">[SPARK-25714]</a>Fix Null Handling in the Optimizer rule BooleanSimplification.</p></li>
</ul>
</li>
</ul>
<ul class="simple">
<li><p>October 9, 2018</p>
<ul>
<li><p>Fixed a bug affecting <code class="docutils literal notranslate"><span class="pre">Union</span></code> operation.</p></li>
</ul>
</li>
</ul>
<ul class="simple">
<li><p>September 25, 2018</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-25368">[SPARK-25368]</a>[SQL] Incorrect constraint inference returns wrong result.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-25402">[SPARK-25402]</a>[SQL] Null handling in BooleanSimplification.</p></li>
<li><p>Fixed <code class="docutils literal notranslate"><span class="pre">NotSerializableException</span></code> in Avro data source.</p></li>
</ul>
</li>
<li><p>September 11, 2018</p>
<ul>
<li><p>Filter reduction should handle null value correctly.</p></li>
</ul>
</li>
<li><p>August 28, 2018</p>
<ul>
<li><p>Fixed a bug in Delta Lake Delete command that would incorrectly delete the rows where the condition evaluates to null.</p></li>
</ul>
</li>
<li><p>August 23, 2018</p>
<ul>
<li><p>Fixed nullable map issue in Parquet reader.</p></li>
<li><p>Fixed secret manager redaction when command partially succeed</p></li>
<li><p>Fixed an interaction between Databricks Delta and Pyspark which could cause transient read failures.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-25081">[SPARK-25081]</a>Fixed a bug where ShuffleExternalSorter may access a released memory page when spilling fails to allocate memory.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-25114">[SPARK-25114]</a>Fix RecordBinaryComparator when subtraction between two words is divisible by Integer.MAX_VALUE.</p></li>
</ul>
</li>
<li><p>August 2, 2018</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-24452">[SPARK-24452]</a>Avoid possible overflow in int add or multiple.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-24588">[SPARK-24588]</a>Streaming join should require HashClusteredPartitioning from children.</p></li>
<li><p>Fixed an issue that could cause <code class="docutils literal notranslate"><span class="pre">mergeInto</span></code> command to produce incorrect results.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-24867">[SPARK-24867]</a>[SQL] Add AnalysisBarrier to DataFrameWriter. SQL cache is not being used when using DataFrameWriter to write a DataFrame with UDF. This is a regression caused by the changes we made in AnalysisBarrier, since not all the Analyzer rules are idempotent.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-24809">[SPARK-24809]</a>Serializing LongHashedRelation in executor may result in data error.</p></li>
</ul>
</li>
<li><p>June 28, 2018</p>
<ul>
<li><p>Fixed a bug that could cause incorrect query results when the name of a partition column used in a predicate differs from the case of that column in the schema of the table.</p></li>
</ul>
</li>
</ul>
<ul class="simple">
<li><p>May 31, 2018</p>
<ul>
<li><p>Fixed a bug affecting Spark SQL execution engine.</p></li>
<li><p>Improved error handling in Delta Lake.</p></li>
</ul>
</li>
</ul>
<ul class="simple">
<li><p>May 17, 2018</p>
<ul>
<li><p>Bug fixes for Databricks secret management.</p></li>
<li><p>Improved stability on reading data stored in Azure Data Lake Store.</p></li>
<li><p>Fixed a bug affecting RDD caching.</p></li>
<li><p>Fixed a bug affecting Null-safe Equal in Spark SQL.</p></li>
</ul>
</li>
<li><p>April 24, 2018</p>
<ul>
<li><p>Upgraded Azure Data Lake Store SDK from 2.0.11 to 2.2.8 to improve the stability of access to Azure Data Lake Store.</p></li>
<li><p>Fixed a bug affecting the insertion of overwrites to partitioned Hive tables when <code class="docutils literal notranslate"><span class="pre">spark.databricks.io.hive.fastwriter.enabled</span></code> is <code class="docutils literal notranslate"><span class="pre">false</span></code>.</p></li>
<li><p>Fixed an issue that failed task serialization.</p></li>
<li><p>Improved Delta Lake stability.</p></li>
</ul>
</li>
<li><p>March 14, 2018</p>
<ul>
<li><p>Prevent unnecessary metadata updates when writing into Delta Lake.</p></li>
<li><p>Fixed an issue caused by a race condition that could, in rare circumstances, lead to loss of some output files.</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="databricks-runtime-35-lts-unsupported">
<span id="dbr-35-lts-unsupported"></span><span id="35"></span><h3><a class="toc-backref" href="#id50">Databricks Runtime 3.5 LTS (unsupported)</a><a class="headerlink" href="#databricks-runtime-35-lts-unsupported" title="Permalink to this headline"> </a></h3>
<p>See <a class="reference internal" href="3.5.html"><span class="doc">Databricks Runtime 3.5 LTS (unsupported)</span></a>.</p>
<ul class="simple">
<li><p>November 7, 2019</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-29743">[SPARK-29743]</a>[SQL] sample should set needCopyResult to true if its child’s needCopyResult is true</p></li>
</ul>
</li>
<li><p>October 8, 2019</p>
<ul>
<li><p>Server side changes to allow Simba Apache Spark ODBC driver to reconnect and continue after a connection failure during fetching results (requires Simba Apache Spark ODBC driver update to version 2.6.10).</p></li>
</ul>
</li>
<li><p>September 10, 2019</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-28699">[SPARK-28699]</a>[SQL] Disable using radix sort for ShuffleExchangeExec in repartition case</p></li>
</ul>
</li>
<li><p>April 9, 2019</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-26665">[SPARK-26665]</a>[CORE] Fix a bug that can cause BlockTransferService.fetchBlockSync to hang forever.</p></li>
</ul>
</li>
<li><p>February 12, 2019</p>
<ul>
<li><p>Fixed an issue that Spark low level network protocol may be broken when sending large RPC error messages with encryption enabled (in <a class="reference internal" href="../../security/privacy/hipaa.html"><span class="doc">HIPAA compliance features</span></a>) or when <code class="docutils literal notranslate"><span class="pre">spark.network.crypto.enabled</span></code> is set to true).</p></li>
</ul>
</li>
<li><p>January 30, 2019</p>
<ul>
<li><p>Fixed an issue that can cause <code class="docutils literal notranslate"><span class="pre">df.rdd.count()</span></code> with UDT to return incorrect answer for certain cases.</p></li>
</ul>
</li>
<li><p>December 18, 2018</p>
<ul>
<li><p>Only ignore corrupt files after one or more retries when <code class="docutils literal notranslate"><span class="pre">spark.sql.files.ignoreCorruptFiles</span></code> or <code class="docutils literal notranslate"><span class="pre">spark.sql.files.ignoreMissingFiles</span></code> flag is enabled.</p></li>
<li><p>Fixed an issue affecting certain self union queries.</p></li>
</ul>
</li>
<li><p>November 20, 2018</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-25816">[SPARK-25816]</a>Fixed attribute resolution in nested extractors.</p></li>
</ul>
</li>
<li><p>November 6, 2018</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-25714">[SPARK-25714]</a>Fix Null Handling in the Optimizer rule BooleanSimplification.</p></li>
</ul>
</li>
</ul>
<ul class="simple">
<li><p>October 9, 2018</p>
<ul>
<li><p>Fixed a bug affecting <code class="docutils literal notranslate"><span class="pre">Union</span></code> operation.</p></li>
</ul>
</li>
</ul>
<ul class="simple">
<li><p>September 25, 2018</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-25402">[SPARK-25402]</a>[SQL] Null handling in BooleanSimplification.</p></li>
<li><p>Fixed <code class="docutils literal notranslate"><span class="pre">NotSerializableException</span></code> in Avro data source.</p></li>
</ul>
</li>
<li><p>September 11, 2018</p>
<ul>
<li><p>Filter reduction should handle null value correctly.</p></li>
</ul>
</li>
<li><p>August 28, 2018</p>
<ul>
<li><p>Fixed a bug in Delta Lake Delete command that would incorrectly delete the rows where the condition evaluates to null.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-25114">[SPARK-25114]</a>Fix RecordBinaryComparator when subtraction between two words is divisible by Integer.MAX_VALUE.</p></li>
</ul>
</li>
<li><p>August 23, 2018</p>
<ul>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-24809">[SPARK-24809]</a>Serializing LongHashedRelation in executor may result in data error.</p></li>
<li><p>Fixed nullable map issue in Parquet reader.</p></li>
<li><p><a class="reference external" href="https://issues.apache.org/jira/browse/SPARK-25081">[SPARK-25081]</a>Fixed a bug where ShuffleExternalSorter may access a released memory page when spilling fails to allocate memory.</p></li>
<li><p>Fixed an interaction between Databricks Delta and Pyspark which could cause transient read failures.</p></li>
</ul>
</li>
<li><p>June 28, 2018</p>
<ul>
<li><p>Fixed a bug that could cause incorrect query results when the name of a partition column used in a predicate differs from the case of that column in the schema of the table.</p></li>
</ul>
</li>
<li><p>June 28, 2018</p>
<ul>
<li><p>Fixed a bug that could cause incorrect query results when the name of a partition column used in a predicate differs from the case of that column in the schema of the table.</p></li>
</ul>
</li>
</ul>
<ul class="simple">
<li><p>May 31, 2018</p>
<ul>
<li><p>Fixed a bug affecting Spark SQL execution engine.</p></li>
<li><p>Improved error handling in Delta Lake.</p></li>
</ul>
</li>
</ul>
<ul class="simple">
<li><p>May 17, 2018</p>
<ul>
<li><p>Improved stability on reading data stored in Azure Data Lake Store.</p></li>
<li><p>Fixed a bug affecting RDD caching.</p></li>
<li><p>Fixed a bug affecting Null-safe Equal in Spark SQL.</p></li>
<li><p>Fixed a bug affecting certain aggregations in streaming queries.</p></li>
</ul>
</li>
<li><p>April 24, 2018</p>
<ul>
<li><p>Upgraded Azure Data Lake Store SDK from 2.0.11 to 2.2.8 to improve the stability of access to Azure Data Lake Store.</p></li>
<li><p>Fixed a bug affecting the insertion of overwrites to partitioned Hive tables when <code class="docutils literal notranslate"><span class="pre">spark.databricks.io.hive.fastwriter.enabled</span></code> is <code class="docutils literal notranslate"><span class="pre">false</span></code>.</p></li>
<li><p>Fixed an issue that failed task serialization.</p></li>
</ul>
</li>
<li><p>March 09, 2018</p>
<ul>
<li><p>Fixed an issue caused by a race condition that could, in rare circumstances, lead to loss of some output files.</p></li>
</ul>
</li>
<li><p>March 01, 2018</p>
<ul>
<li><p>Improved the efficiency of handling streams that can take a long time to stop.</p></li>
<li><p>Fixed an issue affecting Python autocomplete.</p></li>
<li><p>Applied Ubuntu security patches.</p></li>
<li><p>Fixed an issue affecting certain queries using Python UDFs and window functions.</p></li>
<li><p>Fixed an issue affecting the use of UDFs on a cluster with table access control enabled.</p></li>
</ul>
</li>
<li><p>January 29, 2018</p>
<ul>
<li><p>Fixed an issue affecting the manipulation of tables stored in Azure Blob storage.</p></li>
<li><p>Fixed aggregation after dropDuplicates on empty DataFrame.</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="databricks-runtime-34-unsupported">
<span id="dbr-34-unsupported"></span><span id="34"></span><h3><a class="toc-backref" href="#id51">Databricks Runtime 3.4 (unsupported)</a><a class="headerlink" href="#databricks-runtime-34-unsupported" title="Permalink to this headline"> </a></h3>
<p>See <a class="reference internal" href="3.4.html"><span class="doc">Databricks Runtime 3.4 (unsupported)</span></a>.</p>
<ul class="simple">
<li><p>May 31, 2018</p>
<ul>
<li><p>Fixed a bug affecting Spark SQL execution engine.</p></li>
<li><p>Improved error handling in Delta Lake.</p></li>
</ul>
</li>
</ul>
<ul class="simple">
<li><p>May 17, 2018</p>
<ul>
<li><p>Improved stability on reading data stored in Azure Data Lake Store.</p></li>
<li><p>Fixed a bug affecting RDD caching.</p></li>
<li><p>Fixed a bug affecting Null-safe Equal in Spark SQL.</p></li>
</ul>
</li>
<li><p>April 24, 2018</p>
<ul>
<li><p>Fixed a bug affecting the insertion of overwrites to partitioned Hive tables when <code class="docutils literal notranslate"><span class="pre">spark.databricks.io.hive.fastwriter.enabled</span></code> is <code class="docutils literal notranslate"><span class="pre">false</span></code>.</p></li>
</ul>
</li>
<li><p>March 09, 2018</p>
<ul>
<li><p>Fixed an issue caused by a race condition that could, in rare circumstances, lead to loss of some output files.</p></li>
</ul>
</li>
<li><p>December 13, 2017</p>
<ul>
<li><p>Fixed an issue affecting UDFs in Scala.</p></li>
<li><p>Fixed an issue affecting the use of  Data Skipping Index on data source tables stored in non-DBFS paths.</p></li>
</ul>
</li>
<li><p>December 07, 2017</p>
<ul>
<li><p>Improved shuffle stability.</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="databricks-runtime-33-unsupported">
<span id="dbr-33-unsupported"></span><span id="33"></span><h3><a class="toc-backref" href="#id52">Databricks Runtime 3.3 (unsupported)</a><a class="headerlink" href="#databricks-runtime-33-unsupported" title="Permalink to this headline"> </a></h3>
<p>See <a class="reference internal" href="3.3.html"><span class="doc">Databricks Runtime 3.3 (unsupported)</span></a>.</p>
<ul class="simple">
<li><p>May 31, 2018</p>
<ul>
<li><p>Fixed a bug affecting Spark SQL execution engine.</p></li>
</ul>
</li>
<li><p>April 24, 2018</p>
<ul>
<li><p>Fixed a bug affecting the insertion of overwrites to partitioned Hive tables when <code class="docutils literal notranslate"><span class="pre">spark.databricks.io.hive.fastwriter.enabled</span></code> is <code class="docutils literal notranslate"><span class="pre">false</span></code>.</p></li>
</ul>
</li>
<li><p>March 12, 2018</p>
<ul>
<li><p>Fixed an issue caused by a race condition that could, in rare circumstances, lead to loss of some output files.</p></li>
</ul>
</li>
<li><p>January 29, 2018</p>
<ul>
<li><p>Fixed an issue affecting UDFs in Scala.</p></li>
</ul>
</li>
<li><p>October 11, 2017</p>
<ul>
<li><p>Improved shuffle stability.</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="databricks-runtime-32-unsupported">
<span id="dbr-32-unsupported"></span><span id="32"></span><h3><a class="toc-backref" href="#id53">Databricks Runtime 3.2 (unsupported)</a><a class="headerlink" href="#databricks-runtime-32-unsupported" title="Permalink to this headline"> </a></h3>
<p>See <a class="reference internal" href="3.2.html"><span class="doc">Databricks Runtime 3.2 (unsupported)</span></a>.</p>
<ul class="simple">
<li><p>March 30, 2018</p>
<ul>
<li><p>Fixed an issue caused by a race condition that could, in rare circumstances, lead to loss of some output files.</p></li>
</ul>
</li>
<li><p>September 13, 2017</p>
<ul>
<li><p>Fixed an issue affecting the use of <code class="docutils literal notranslate"><span class="pre">spark_submit_task</span></code> with Databricks jobs.</p></li>
</ul>
</li>
<li><p>September 06, 2017</p>
<ul>
<li><p>Fixed an issue affecting the performance of certain window functions.</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="211-db6-unsupported">
<span id="dbr-73-lts-unsupported"></span><span id="211-db6"></span><h3><a class="toc-backref" href="#id54">2.1.1-db6 (unsupported)</a><a class="headerlink" href="#211-db6-unsupported" title="Permalink to this headline"> </a></h3>
<p>See <a class="reference internal" href="cluster-images/2.1.1-db6.html"><span class="doc">2.1.1-db6 cluster image (unsupported)</span></a>.</p>
<ul class="simple">
<li><p>May 31, 2018</p>
<ul>
<li><p>Fixed a bug affecting Spark SQL execution engine.</p></li>
</ul>
</li>
<li><p>March 30, 2018</p>
<ul>
<li><p>Fixed an issue caused by a race condition that could, in rare circumstances, lead to loss of some output files.</p></li>
</ul>
</li>
</ul>
<div class="section" id="211-db4-unsupported">
<span id="211-db4"></span><h4>2.1.1-db4 (unsupported)<a class="headerlink" href="#211-db4-unsupported" title="Permalink to this headline"> </a></h4>
<p>See <a class="reference internal" href="cluster-images/2.1.1-db4.html"><span class="doc">2.1.1-db4 cluster image (unsupported)</span></a>.</p>
<ul class="simple">
<li><p>May 31, 2018</p>
<ul>
<li><p>Fixed a bug affecting Spark SQL execution engine.</p></li>
</ul>
</li>
<li><p>March 30, 2018</p>
<ul>
<li><p>Fixed an issue caused by a race condition that could, in rare circumstances, lead to loss of some output files.</p></li>
</ul>
</li>
</ul>
</div>
</div>
</div>
<div class="section" id="unsupported-databricks-runtime-releases">
<span id="dbr-releases"></span><h2>Unsupported Databricks Runtime releases<a class="headerlink" href="#unsupported-databricks-runtime-releases" title="Permalink to this headline"> </a></h2>
<p>For the original release notes, follow the link below the subheading.</p>
</div>
</div>


    
          </div>
        </div>
        <div  class="suapp-rating">
  <div id="suPageRateApp">
     <su-app></su-app>
   </div> 
 </div>
<hr> 
<footer>
  <div role="contentinfo">
      <p class="copyright">
          &copy; Databricks 2023. All rights reserved. Apache, Apache Spark, Spark, and the Spark logo are trademarks of the <a href="http://www.apache.org/">Apache Software Foundation</a>.
      </p>
      <p> 
        
          <a id='feedbacklink' href="mailto:doc-feedback@databricks.com?subject=Documentation Feedback">Send us feedback</a>
        
     | <a href="https://databricks.com/privacy-policy">Privacy Policy</a> | <a href="https://databricks.com/terms-of-use">Terms of Use</a></p>

  </div> 

</footer>
      </div>
    </div>
  </section>
</main>

  </page>
  
  <script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
      URL_ROOT: '../../',
      VERSION: '1.0',
      COLLAPSE_INDEX: false,
      FILE_SUFFIX: '.html',
      HAS_SOURCE: 'false'
    };
  </script>
  <script type="text/javascript" src="../../_static/jquery.js"></script>
  <script type="text/javascript" src="../../_static/underscore.js"></script>
  <script type="text/javascript" src="../../_static/doctools.js"></script>
  <script type="text/javascript" src="../../_static/language_data.js"></script>
  

  <script type="text/javascript" src="../../_static/js/clipboard.min.js"></script>
  <script type="text/javascript" src="../../_static/js/jquery.waypoints.min.js"></script>

  <!-- Select2 (https://select2.org/) -->
  <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
  <!-- End Select2 -->

  
  
  <script type="text/javascript" src="../../_static/js/localized.js"></script>
  <script type="text/javascript" src="../../_static/js/custom.js"></script>
  

  
  
  <script type="text/javascript">
    jQuery(function () {
      SphinxRtdTheme.StickyNav.enable();
    });

  </script>
  
 



  <script>
  window.__searchunifyLoaderConfig = JSON.parse('{"clients": {"en": "02c2e804-27e9-11ee-aefb-0242ac120011", "ja": "6a42c3f2-2820-11ee-aefb-0242ac120011", "pt": "6a86badd-2821-11ee-aefb-0242ac120011"}}')
</script>
<script type="text/javascript" src="../../_static/js/search-loader.js"></script>
</body>
<script type='text/javascript'>
  window.onload = function () {
    var description = document.querySelector('meta[name="description"]').getAttribute("content");
    let titleText = document.querySelector('h1').textContent;
    document.querySelector('meta[property="og:title"]').setAttribute("content", titleText);
    document.querySelector('meta[property="og:description"]').setAttribute("content", description);
    document.querySelector('meta[property="twitter:description"]').setAttribute("content", description);
  };
</script>

</html>