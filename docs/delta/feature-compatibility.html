

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en-US" > <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en-US"> <!--<![endif]-->

<head>
  <!-- cookie consent -->
  
    <!-- Combined Onetrust and Rudderstack Implementation Scripts -->
    <!-- Onetrust Initialization -->
    <script type="text/javascript" src="https://cdn.cookielaw.org/consent/92466579-1717-44d3-809d-a05fb02843ed-test/OtAutoBlock.js"></script>
    <script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" data-document-language="true" type="text/javascript" charset="UTF-8" data-domain-script="92466579-1717-44d3-809d-a05fb02843ed-test"></script>
    <link rel="stylesheet" id="db-onetrust-style" href="https://www.databricks.com/wp-content/uploads/db_onetrust.css" media="all" />
    <!-- Setting Rudderstack Write Key -->
    <script>window.rudderstackKey = "2SOR9fvSr5Fi6tN2ihPbVHnX1SZ" </script>
    <!-- Rudderstack Initialization + Onetrust Integration + Rudderstack Custom Events -->
    <script type="text/javascript" src="https://www.databricks.com/sites/default/files/rudderstack/v1/db-rudderstack-events.js"></script>

  <!-- cookie consent -->

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="X-UA-Compatible" content="IE=9" />
  <meta content="Compare supported features and upgrade Delta Lake protocol versions on Databricks." name="description" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
  <meta property="og:image" content="https://www.databricks.com/wp-content/uploads/2020/04/og-databricks.png">
  <meta property="og:image:type" content="image/png">
  <meta property="og:title" content="How does Databricks manage Delta Lake feature compatibility?">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://docs.databricks.com">
  <meta property="og:description" content="" id="og-description">
  <meta name="twitter:image" content="https://www.databricks.com/wp-content/uploads/2020/04/og-databricks.png">
  <meta name="twitter:site" content="@databricks">
  <meta name="twitter:creator" content="@databricks">
  <meta property="twitter:description" content="">
  
  <title>How does Databricks manage Delta Lake feature compatibility? &#124; Databricks on AWS</title>
  
  
  <link rel="canonical" href="https://docs.databricks.com/en/delta/feature-compatibility.html">
  <!-- Start hreflang tag -->
  <link rel="alternate" hreflang="en" href="https://docs.databricks.com/en/delta/feature-compatibility.html" />
<link rel="alternate" hreflang="x-default" href="https://docs.databricks.com/en/delta/feature-compatibility.html" />
  <!-- End hreflang tag -->
  
  
  <link rel="shortcut icon" href="../_static/favicon.ico" />
  

  

  

  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;
j.setAttributeNode(d.createAttribute('data-ot-ignore'));
f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-T85FQ33');</script>
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;
j.setAttributeNode(d.createAttribute('data-ot-ignore'));
f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-TWTKQQ');</script>
    
  <!-- End Google Tag Manager -->


  <!-- MaxMind / GEO IP -->
  <script src="//js.maxmind.com/js/apis/geoip2/v2.1/geoip2.js" type="text/javascript"></script>
  <!-- End MaxMind / GEO IP -->

  
  
  <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600&display=swap" rel="stylesheet">
  <link rel="preload" href="../_static/fonts/DMSans-Bold.ttf" as="font">
  <link rel="preload" href="../_static/fonts/DMSans-Regular.ttf" as="font">
  <link rel="preload" href="../_static/fonts/DMMono-Regular.ttf" as="font">
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/cloud-provider-selector.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/translation-selector.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/searchunify/main.css" type="text/css" />

  
  <link rel="index" title="Index" href="../genindex.html" />
  <link rel="search" title="Search" href="../search.html" />
  <link rel="top" title="Databricks on AWS" href="../index.html" /> 
</head>

<body class="wy-body-for-nav" role="document">

  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T85FQ33"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TWTKQQ"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->

  
  <nav class="wy-nav-top header su_header" role="navigation" aria-label="top navigation">
    
<nav class="wy-nav-top header su_header" role="navigation" aria-label="top navigation">
  <div class="container-logo">
    <ul class="mobile-menu-toggle">
        <li class="menu-toggle">
            <i data-toggle="wy-nav-top" class="wy-nav-top-menu-button db-icon db-icon-menu pull-left"></i>
            
            <a href="https://www.databricks.com/" class="wy-nav-top-logo"><img src="../_static/small-scale-lockup-full-color-rgb.svg" width="137" height="21"
              alt="Databricks" /></a>   
               
              </li>
    </ul>
    <ul class="su_nav-menu">
      <li class="menu-toggle">
        <i data-toggle="wy-nav-top" class="wy-nav-top-menu-button db-icon db-icon-menu pull-left"></i>
        
          
        
        <a href="https://www.databricks.com/" class="wy-nav-top-logo"><img src="../_static/small-scale-lockup-full-color-rgb.svg" width="137" height="21"
            alt="Databricks" /></a></li>
        <!-- 
<li><a href="https://help.databricks.com/s/">Help Center</a></li>
<li class="active"><a href="https://docs.databricks.com/en/">Documentation</a></li>
<li><a href="https://kb.databricks.com/">Knowledge Base</a></li>
 -->
    </ul>
  </div>
  <div class="su_nav-right">
    <ul class="su_link-mobile">
  <!-- Mobile header code can go here -->
</ul>
<ul class="right-try-list">
   
</ul>
  </div>
</nav>
  </nav>

  <div class="su_sub-header">
    <div class="container">
      <div class="su_sub-header-inner">
        <!-- <div class="su_subnav-menu-right">
  <div id="auto" style="width: 100%;">
    <div ng-controller="SearchautoController">
      <div bind-html-compile="autocompleteHtml">
        <form class="su__search-box-1" disabled="disabled">
          <input class="su__search-input" type="search" name="Search box" id="su__search-b" placeholder="Search Documentation" disabled="disabled"/>
          <button class="su__search-button" type="submit" class="button button-success" disabled="disabled">
            <svg width="24" height="24" viewBox="0 0 24 24">
              <path
                d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"
                fill="#333"></path>
            </svg>
          </button>
        </form>
      </div>
    </div>
  </div>
</div> -->
        <div class="search-lng-gap"></div>
        <div style="margin-left: 16px; margin-right: 16px;">
          <!-- <select name="lng selector" id="lng-selector">
    <option value="../../en/delta/feature-compatibility.html" class="notranslate">English</option>
    <option value="../../ja/delta/feature-compatibility.html" class="notranslate">日本語</option>
    <option value="../../pt/delta/feature-compatibility.html" class="notranslate">Português (Brasil)</option>
</select> -->
        </div>
        <div class="cloud-selector-container">
          <!-- <select name="cloud provider selector" id="cloud-provider-selector">
    <option value="aws" selected class="notranslate">
        Amazon Web Services
    </option>
    <option value="azure"  class="notranslate">
        Microsoft Azure
    </option>
    <option value="gcp"  class="notranslate">
        Google Cloud Platform
    </option>
</select> -->
        </div>
      </div>
    </div>
  </div>
  <page class="js-page-container">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side su_nav-side">
<div class="wy-side-scroll">
  <div class="wy-side-nav-search">
    

    

    

    
  </div>

  <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
    
      <a href="../index.html" class="main-navigation-home">Databricks on AWS</a>
    

    
      

      
        <p class="caption"><span class="caption-text">Load &amp; manage data</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../rag-temp/index.html">RAG Studio</a></li>
</ul>

      
    
  </div>

  <div role="contentinfo">
    
  <p class="build_info notranslate"data-last-edit="December 23, 2023">
    Updated Jan 11, 2024
  </p>
<script>
  window.addEventListener('DOMContentLoaded',function(){
    var h1=document.querySelector('h1');
    var bi=document.querySelector('[data-last-edit]');
    if(h1 && bi){
      var ver = document.createElement('p');
      ver.className = 'version_info';
      ver.textContent = bi.getAttribute('data-last-edit');
      h1.parentElement.insertBefore(ver, h1.nextElementSibling);
    }
  });
</script>

    <p>
      
        <a id='feedbacklink' href="mailto:doc-feedback@databricks.com?subject=Documentation Feedback">Send us feedback</a>
      
    </p>
  </div>
</div>
</nav>
    
    
<main class="wy-grid-for-nav su_nav-grid">
  <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
    <div class="wy-nav-content su__nav_content">
      <div class="rst-content">
        





<div role="navigation" aria-label="breadcrumbs navigation" class="wy-breadcrumbs-wrapper">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Documentation</a> <span class="db-icon db-icon-chevron-right"></span></li>
    
    
      <li>How does Databricks manage Delta Lake feature compatibility?</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>
</div>
        
        <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
          <div itemprop="articleBody">
            
    
  <div class="section" id="how-does-databricks-manage-delta-lake-feature-compatibility">
<span id="how-does-databricks-manage-delta-feature-compatibility"></span><h1>How does Databricks manage Delta Lake feature compatibility?<a class="headerlink" href="#how-does-databricks-manage-delta-lake-feature-compatibility" title="Permalink to this headline"> </a></h1>
<p>Delta Lake is an independent open-source project under the governance of the Linux Foundation. Databricks introduces support for new Delta Lake features and optimizations that build on top of Delta Lake in Databricks Runtime releases.</p>
<p>Databricks optimizations that leverage Delta Lake features respect the protocols used in OSS Delta Lake for compatability.</p>
<p>Many Databricks optimizations require enabling Delta Lake features on a table. Delta Lake features are always backwards compatible, so tables written by a lower Databricks Runtime version can always be read and written by a higher Databricks Runtime version. Enabling some features breaks forward compatibility with workloads running in a lower Databricks Runtime version. For features that break forward compatibility, you must update all workloads that reference the upgraded tables to use a compliant Databricks Runtime version.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can drop <code class="docutils literal notranslate"><span class="pre">deletionVectors</span></code> and <code class="docutils literal notranslate"><span class="pre">v2Checkpoint</span></code> on Databricks. See <a class="reference internal" href="drop-feature.html"><span class="doc">Drop Delta table features</span></a>.</p>
</div>
<div class="section" id="what-delta-lake-features-require-databricks-runtime-upgrades">
<span id="what-delta-features-require-dbr-upgrades"></span><span id="dbr"></span><h2>What Delta Lake features require Databricks Runtime upgrades?<a class="headerlink" href="#what-delta-lake-features-require-databricks-runtime-upgrades" title="Permalink to this headline"> </a></h2>
<p>The following Delta Lake features break forward compatibility. Features are enabled on a table-by-table basis. This table lists the lowest Databricks Runtime version still supported by Databricks.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Feature</p></th>
<th class="head"><p>Requires Databricks Runtime version or later</p></th>
<th class="head"><p>Documentation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">CHECK</span></code> constraints</p></td>
<td><p><a class="reference internal" href="../release-notes/runtime/9.1lts.html"><span class="doc">Databricks Runtime 9.1 LTS</span></a></p></td>
<td><p><a class="reference internal" href="../tables/constraints.html#check-constraint"><span class="std std-ref">Set a CHECK constraint in Databricks</span></a></p></td>
</tr>
<tr class="row-odd"><td><p>Change data feed</p></td>
<td><p><a class="reference internal" href="../release-notes/runtime/9.1lts.html"><span class="doc">Databricks Runtime 9.1 LTS</span></a></p></td>
<td><p><a class="reference internal" href="delta-change-data-feed.html"><span class="doc">Use Delta Lake change data feed on Databricks</span></a></p></td>
</tr>
<tr class="row-even"><td><p>Generated columns</p></td>
<td><p><a class="reference internal" href="../release-notes/runtime/9.1lts.html"><span class="doc">Databricks Runtime 9.1 LTS</span></a></p></td>
<td><p><a class="reference internal" href="generated-columns.html"><span class="doc">Use Delta Lake generated columns</span></a></p></td>
</tr>
<tr class="row-odd"><td><p>Column mapping</p></td>
<td><p><a class="reference internal" href="../release-notes/runtime/10.4lts.html"><span class="doc">Databricks Runtime 10.4 LTS</span></a></p></td>
<td><p><a class="reference internal" href="delta-column-mapping.html"><span class="doc">Rename and drop columns with Delta Lake column mapping</span></a></p></td>
</tr>
<tr class="row-even"><td><p>Identity columns</p></td>
<td><p><a class="reference internal" href="../release-notes/runtime/10.4lts.html"><span class="doc">Databricks Runtime 10.4 LTS</span></a></p></td>
<td><p><a class="reference internal" href="generated-columns.html#identity"><span class="std std-ref">Use identity columns in Delta Lake</span></a></p></td>
</tr>
<tr class="row-odd"><td><p>Table features</p></td>
<td><p><a class="reference internal" href="../archive/runtime-release-notes/12.1.html"><span class="doc">Databricks Runtime 12.1 (unsupported)</span></a></p></td>
<td><p><a class="reference internal" href="#table-features"><span class="std std-ref">What are table features?</span></a></p></td>
</tr>
<tr class="row-even"><td><p>Deletion vectors</p></td>
<td><p><a class="reference internal" href="../archive/runtime-release-notes/12.1.html"><span class="doc">Databricks Runtime 12.1 (unsupported)</span></a></p></td>
<td><p><a class="reference internal" href="deletion-vectors.html"><span class="doc">What are deletion vectors?</span></a></p></td>
</tr>
<tr class="row-odd"><td><p>TimestampNTZ</p></td>
<td><p><a class="reference internal" href="../archive/runtime-release-notes/13.0.html"><span class="doc">Databricks Runtime 13.0 (unsupported)</span></a></p></td>
<td><p><a class="reference internal" href="../sql/language-manual/data-types/timestamp-ntz-type.html"><span class="doc">TIMESTAMP_NTZ type</span></a></p></td>
</tr>
<tr class="row-even"><td><p>UniForm</p></td>
<td><p><a class="reference internal" href="../release-notes/runtime/13.2.html"><span class="doc">Databricks Runtime 13.2</span></a></p></td>
<td><p><a class="reference internal" href="uniform.html"><span class="doc">Universal Format (UniForm) for Iceberg compatibility with Delta tables</span></a></p></td>
</tr>
<tr class="row-odd"><td><p>Liquid clustering</p></td>
<td><p><a class="reference internal" href="../release-notes/runtime/13.3lts.html"><span class="doc">Databricks Runtime 13.3 LTS</span></a></p></td>
<td><p><a class="reference internal" href="clustering.html"><span class="doc">Use liquid clustering for Delta tables</span></a></p></td>
</tr>
</tbody>
</table>
<p>See <a class="reference internal" href="../release-notes/runtime/index.html"><span class="doc">Databricks Runtime release notes versions and compatibility</span></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Delta Live Tables and Databricks SQL automatically upgrade runtime environments with regular releases to support new features. See <a class="reference internal" href="../release-notes/delta-live-tables/index.html"><span class="doc">Delta Live Tables release notes and the release upgrade process</span></a> and <a class="reference internal" href="../sql/release-notes/index.html"><span class="doc">Databricks SQL release notes</span></a>.</p>
</div>
</div>
<div class="section" id="what-is-a-table-protocol-specification">
<span id="table-protocol"></span><h2>What is a table protocol specification?<a class="headerlink" href="#what-is-a-table-protocol-specification" title="Permalink to this headline"> </a></h2>
<p>Every Delta table has a protocol specification which indicates the set of features that the table supports. The protocol specification is used by applications that read or write the table to determine if they can handle all the features that the table supports. If an application does not know how to handle a feature that is listed as supported in the protocol of a table, then that application is not be able to read or write that table.</p>
<p>The protocol specification is separated into two components: the <em>read protocol</em> and the <em>write protocol</em>.</p>
<div class="section" id="read-protocol">
<h3>Read protocol<a class="headerlink" href="#read-protocol" title="Permalink to this headline"> </a></h3>
<p>The read protocol lists all features that a table supports and that an application must understand in order to read the table correctly. Upgrading the read protocol of a table requires that all reader applications support the added features.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>All applications that write to a Delta table must be able to construct a snapshot of the table. As such, workloads that write to Delta tables must respect both reader and writer protocol requirements.</p>
<p>If you encounter a protocol that is unsupported by a workload on Databricks, you must upgrade to a higher Databricks Runtime that supports that protocol.</p>
</div>
</div>
<div class="section" id="write-protocol">
<h3>Write protocol<a class="headerlink" href="#write-protocol" title="Permalink to this headline"> </a></h3>
<p>The write protocol lists all features that a table supports and that an application must understand in order to write to the table correctly. Upgrading the write protocol of a table requires that all writer applications support the added features. It does not affect read-only applications, unless the read protocol is also upgraded.</p>
</div>
</div>
<div class="section" id="which-protocols-must-be-upgraded">
<h2>Which protocols must be upgraded?<a class="headerlink" href="#which-protocols-must-be-upgraded" title="Permalink to this headline"> </a></h2>
<p>Some features require upgrading both the read protocol and the write protocol. Other features only require upgrading the write protocol.</p>
<p>As an example, support for <code class="docutils literal notranslate"><span class="pre">CHECK</span></code> constraints is a write protocol feature: only writing applications need to know about <code class="docutils literal notranslate"><span class="pre">CHECK</span></code> constraints and enforce them.</p>
<p>In contrast, column mapping requires upgrading both the read and write protocols. Because the data is stored differently in the table, reader applications must understand column mapping so they can read the data correctly.</p>
<p>For more on upgrading, see <a class="reference internal" href="#upgrade"><span class="std std-ref">Upgrading protocol versions</span></a>.</p>
</div>
<div class="section" id="what-are-table-features">
<span id="table-features"></span><h2>What are table features?<a class="headerlink" href="#what-are-table-features" title="Permalink to this headline"> </a></h2>
<p>In Databricks Runtime 12.1 and above, Delta Lake table features introduce granular flags specifying which features are supported by a given table. In Databricks Runtime 12.0 and below, Delta Lake features were enabled in bundles called <em>protocol versions</em>. Table features are the successor to protocol versions and are designed with the goal of improved flexibility for clients that read and write Delta Lake. See <a class="reference internal" href="#protocol-versions"><span class="std std-ref">What is a protocol version?</span></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Table features have protocol version requirements. See <a class="reference internal" href="#protocol-table"><span class="std std-ref">Features by protocol version</span></a>.</p>
</div>
<p>A Delta table feature is a marker that indicates that the table supports a particular feature. Every feature is either a write protocol feature (meaning it only upgrades the write protocol) or a read/write protocol feature (meaning both read and write protocols are upgraded to enable the feature).</p>
<p>To learn more about supported table features in Delta Lake, see the <a class="reference external" href="https://github.com/delta-io/delta/blob/master/PROTOCOL.md#valid-feature-names-in-table-features">Delta Lake protocol</a>.</p>
</div>
<div class="section" id="do-table-features-change-how-delta-lake-features-are-enabled">
<span id="do-table-features-change-how-delta-features-are-enabled"></span><h2>Do table features change how Delta Lake features are enabled?<a class="headerlink" href="#do-table-features-change-how-delta-lake-features-are-enabled" title="Permalink to this headline"> </a></h2>
<p>If you only interact with Delta tables through Databricks, you can continue to track support for Delta Lake features using minimum Databricks Runtime requirements. Databricks supports reading Delta tables that have been upgraded to table features in all Databricks Runtime LTS releases, as long as all features used by the table are supported by that release.</p>
<p>If you read and write from Delta tables using other systems, you might need to consider how table features impact compatibility, because there is a risk that the system could not understand the upgraded protocol versions.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Table features are introduced to the Delta Lake format for writer version 7 and reader version 3. Databricks has backported code to all supported Databricks Runtime LTS versions to add support for table features, but <strong>only for those features already supported in that Databricks Runtime</strong>. This means that while you can opt in to using table features to enable generated columns and still work with these tables in Databricks Runtime 9.1 LTS, tables with identity columns enabled (which requires Databricks Runtime 10.4 LTS) are still not supported in that Databricks Runtime.</p>
</div>
</div>
<div class="section" id="what-is-a-protocol-version">
<span id="protocol-versions"></span><h2>What is a protocol version?<a class="headerlink" href="#what-is-a-protocol-version" title="Permalink to this headline"> </a></h2>
<p>A protocol version is a protocol number that indicates a particular grouping of table features. In Databricks Runtime 12.0 and below, you cannot enable table features individually. Protocol versions bundle a group of features.</p>
<p>Delta tables specify a separate protocol version for read protocol and write protocol. The transaction log for a Delta table contains protocol versioning information that supports Delta Lake evolution. See <a class="reference internal" href="table-details.html"><span class="doc">Review Delta Lake table details with describe detail</span></a>.</p>
<p>The protocol versions bundle all features from previous protocols. See <a class="reference internal" href="#protocol-table"><span class="std std-ref">Features by protocol version</span></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Starting with writer version 7 and reader version 3, Delta Lake has introduced the concept of table features. Using table features, you can now choose to only enable those features that are supported by other clients in your data ecosystem. See <a class="reference internal" href="#table-features"><span class="std std-ref">What are table features?</span></a>.</p>
</div>
</div>
<div class="section" id="features-by-protocol-version">
<span id="protocol-table"></span><h2>Features by protocol version<a class="headerlink" href="#features-by-protocol-version" title="Permalink to this headline"> </a></h2>
<p>The following table shows minimum protocol versions required for Delta Lake features.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you are only concerned with Databricks Runtime compatibility, see <a class="reference internal" href="#dbr"><span class="std std-ref">What Delta Lake features require Databricks Runtime upgrades?</span></a>. Delta Sharing only supports reading tables with features that require <code class="docutils literal notranslate"><span class="pre">minReaderVersion</span></code> = <code class="docutils literal notranslate"><span class="pre">1</span></code>.</p>
</div>
<table class="docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Feature</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">minWriterVersion</span></code></p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">minReaderVersion</span></code></p></th>
<th class="head"><p>Documentation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Basic functionality</p></td>
<td><p>2</p></td>
<td><p>1</p></td>
<td><p><a class="reference internal" href="index.html"><span class="doc">What is Delta Lake?</span></a></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">CHECK</span></code> constraints</p></td>
<td><p>3</p></td>
<td><p>1</p></td>
<td><p><a class="reference internal" href="../tables/constraints.html#check-constraint"><span class="std std-ref">Set a CHECK constraint in Databricks</span></a></p></td>
</tr>
<tr class="row-even"><td><p>Change data feed</p></td>
<td><p>4</p></td>
<td><p>1</p></td>
<td><p><a class="reference internal" href="delta-change-data-feed.html"><span class="doc">Use Delta Lake change data feed on Databricks</span></a></p></td>
</tr>
<tr class="row-odd"><td><p>Generated columns</p></td>
<td><p>4</p></td>
<td><p>1</p></td>
<td><p><a class="reference internal" href="generated-columns.html"><span class="doc">Use Delta Lake generated columns</span></a></p></td>
</tr>
<tr class="row-even"><td><p>Column mapping</p></td>
<td><p>5</p></td>
<td><p>2</p></td>
<td><p><a class="reference internal" href="delta-column-mapping.html"><span class="doc">Rename and drop columns with Delta Lake column mapping</span></a></p></td>
</tr>
<tr class="row-odd"><td><p>Identity columns</p></td>
<td><p>6</p></td>
<td><p>2</p></td>
<td><p><a class="reference internal" href="generated-columns.html#identity"><span class="std std-ref">Use identity columns in Delta Lake</span></a></p></td>
</tr>
<tr class="row-even"><td><p>Table features read</p></td>
<td><p>7</p></td>
<td><p>1</p></td>
<td><p><a class="reference internal" href="#table-features"><span class="std std-ref">What are table features?</span></a></p></td>
</tr>
<tr class="row-odd"><td><p>Table features write</p></td>
<td><p>7</p></td>
<td><p>3</p></td>
<td><p><a class="reference internal" href="#table-features"><span class="std std-ref">What are table features?</span></a></p></td>
</tr>
<tr class="row-even"><td><p>Deletion vectors</p></td>
<td><p>7</p></td>
<td><p>3</p></td>
<td><p><a class="reference internal" href="deletion-vectors.html"><span class="doc">What are deletion vectors?</span></a></p></td>
</tr>
<tr class="row-odd"><td><p>TimestampNTZ</p></td>
<td><p>7</p></td>
<td><p>3</p></td>
<td><p><a class="reference internal" href="../sql/language-manual/data-types/timestamp-ntz-type.html"><span class="doc">TIMESTAMP_NTZ type</span></a></p></td>
</tr>
<tr class="row-even"><td><p>Liquid clustering</p></td>
<td><p>7</p></td>
<td><p>3</p></td>
<td><p><a class="reference internal" href="clustering.html"><span class="doc">Use liquid clustering for Delta tables</span></a></p></td>
</tr>
<tr class="row-odd"><td><p>UniForm</p></td>
<td><p>7</p></td>
<td><p>2</p></td>
<td><p><a class="reference internal" href="uniform.html"><span class="doc">Universal Format (UniForm) for Iceberg compatibility with Delta tables</span></a></p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="upgrading-protocol-versions">
<span id="upgrade"></span><h2>Upgrading protocol versions<a class="headerlink" href="#upgrading-protocol-versions" title="Permalink to this headline"> </a></h2>
<p>You can choose to manually update a table to a newer protocol version. Databricks recommends using the lowest protocol versions that support the Delta Lake features required for your table. Upgrading the writer protocol might cause less disruption than upgrading the reader protocol since systems and workloads using older Databricks Runtime versions can still read from tables, even if they do not support the updated writer protocol.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Protocol version upgrades are irreversible, and upgrading the protocol version might break the existing Delta Lake table readers, writers, or both. Databricks recommends you upgrade specific tables only when needed, such as to opt-in to new features in Delta Lake. You should also check to make sure that all of your current and future production tools support Delta Lake tables with the new protocol version.</p>
</div>
<p>To upgrade a table to a newer protocol version, use the <code class="docutils literal notranslate"><span class="pre">DeltaTable.upgradeTableProtocol</span></code> method:</p>
<div class="js-code-language-tabs js-code-language-tabs--literal compound">
<div class="compound-first highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="c1">-- Upgrades the reader protocol version to 1 and the writer protocol version to 3.</span>
<span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="o">&lt;</span><span class="k">table</span><span class="o">-</span><span class="n">identifier</span><span class="o">&gt;</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">TBLPROPERTIES</span><span class="p">(</span><span class="s1">&#39;delta.minReaderVersion&#39;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;delta.minWriterVersion&#39;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;3&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="compound-middle highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">delta.tables</span> <span class="kn">import</span> <span class="n">DeltaTable</span>
<span class="n">delta</span> <span class="o">=</span> <span class="n">DeltaTable</span><span class="o">.</span><span class="n">forPath</span><span class="p">(</span><span class="n">spark</span><span class="p">,</span> <span class="s2">&quot;path_to_table&quot;</span><span class="p">)</span> <span class="c1"># or DeltaTable.forName</span>
<span class="n">delta</span><span class="o">.</span><span class="n">upgradeTableProtocol</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="c1"># upgrades to readerVersion=1, writerVersion=3</span>
</pre></div>
</div>
<div class="compound-last highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">import</span><span class="w"> </span><span class="nn">io</span><span class="p">.</span><span class="nn">delta</span><span class="p">.</span><span class="nn">tables</span><span class="p">.</span><span class="nc">DeltaTable</span>
<span class="kd">val</span><span class="w"> </span><span class="n">delta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">DeltaTable</span><span class="p">.</span><span class="n">forPath</span><span class="p">(</span><span class="n">spark</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;path_to_table&quot;</span><span class="p">)</span><span class="w"> </span><span class="c1">// or DeltaTable.forName</span>
<span class="n">delta</span><span class="p">.</span><span class="n">upgradeTableProtocol</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="c1">// Upgrades to readerVersion=1, writerVersion=3.</span>
</pre></div>
</div>
</div>
</div>
</div>


    
          </div>
        </div>
        <div  class="suapp-rating">
  <div id="suPageRateApp">
     <su-app></su-app>
   </div> 
 </div>
<hr> 
<footer>
  <div role="contentinfo">
      <p class="copyright">
          &copy; Databricks 2023. All rights reserved. Apache, Apache Spark, Spark, and the Spark logo are trademarks of the <a href="http://www.apache.org/">Apache Software Foundation</a>.
      </p>
      <p> 
        
          <a id='feedbacklink' href="mailto:doc-feedback@databricks.com?subject=Documentation Feedback">Send us feedback</a>
        
     | <a href="https://databricks.com/privacy-policy">Privacy Policy</a> | <a href="https://databricks.com/terms-of-use">Terms of Use</a></p>

  </div> 

</footer>
      </div>
    </div>
  </section>
</main>

  </page>
  
  <script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
      URL_ROOT: '../',
      VERSION: '1.0',
      COLLAPSE_INDEX: false,
      FILE_SUFFIX: '.html',
      HAS_SOURCE: 'false'
    };
  </script>
  <script type="text/javascript" src="../_static/jquery.js"></script>
  <script type="text/javascript" src="../_static/underscore.js"></script>
  <script type="text/javascript" src="../_static/doctools.js"></script>
  <script type="text/javascript" src="../_static/language_data.js"></script>
  

  <script type="text/javascript" src="../_static/js/clipboard.min.js"></script>
  <script type="text/javascript" src="../_static/js/jquery.waypoints.min.js"></script>

  <!-- Select2 (https://select2.org/) -->
  <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
  <!-- End Select2 -->

  
  
  <script type="text/javascript" src="../_static/js/localized.js"></script>
  <script type="text/javascript" src="../_static/js/custom.js"></script>
  

  
  
  <script type="text/javascript">
    jQuery(function () {
      SphinxRtdTheme.StickyNav.enable();
    });

  </script>
  
 



  <script>
  window.__searchunifyLoaderConfig = JSON.parse('{"clients": {"en": "02c2e804-27e9-11ee-aefb-0242ac120011", "ja": "6a42c3f2-2820-11ee-aefb-0242ac120011", "pt": "6a86badd-2821-11ee-aefb-0242ac120011"}}')
</script>
<script type="text/javascript" src="../_static/js/search-loader.js"></script>
</body>
<script type='text/javascript'>
  window.onload = function () {
    var description = document.querySelector('meta[name="description"]').getAttribute("content");
    let titleText = document.querySelector('h1').textContent;
    document.querySelector('meta[property="og:title"]').setAttribute("content", titleText);
    document.querySelector('meta[property="og:description"]').setAttribute("content", description);
    document.querySelector('meta[property="twitter:description"]').setAttribute("content", description);
  };
</script>

</html>