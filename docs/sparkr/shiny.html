

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en-US" > <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en-US"> <!--<![endif]-->

<head>
  <!-- cookie consent -->
  
    <!-- Combined Onetrust and Rudderstack Implementation Scripts -->
    <!-- Onetrust Initialization -->
    <script type="text/javascript" src="https://cdn.cookielaw.org/consent/92466579-1717-44d3-809d-a05fb02843ed-test/OtAutoBlock.js"></script>
    <script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" data-document-language="true" type="text/javascript" charset="UTF-8" data-domain-script="92466579-1717-44d3-809d-a05fb02843ed-test"></script>
    <link rel="stylesheet" id="db-onetrust-style" href="https://www.databricks.com/wp-content/uploads/db_onetrust.css" media="all" />
    <!-- Setting Rudderstack Write Key -->
    <script>window.rudderstackKey = "2SOR9fvSr5Fi6tN2ihPbVHnX1SZ" </script>
    <!-- Rudderstack Initialization + Onetrust Integration + Rudderstack Custom Events -->
    <script type="text/javascript" src="https://www.databricks.com/sites/default/files/rudderstack/v1/db-rudderstack-events.js"></script>

  <!-- cookie consent -->

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="X-UA-Compatible" content="IE=9" />
  <meta content="Learn how to develop interactive applications on Databricks using the Shiny package." name="description" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
  <meta property="og:image" content="https://www.databricks.com/wp-content/uploads/2020/04/og-databricks.png">
  <meta property="og:image:type" content="image/png">
  <meta property="og:title" content="Shiny on Databricks">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://docs.databricks.com">
  <meta property="og:description" content="" id="og-description">
  <meta name="twitter:image" content="https://www.databricks.com/wp-content/uploads/2020/04/og-databricks.png">
  <meta name="twitter:site" content="@databricks">
  <meta name="twitter:creator" content="@databricks">
  <meta property="twitter:description" content="">
  
  <title>Shiny on Databricks &#124; Databricks on AWS</title>
  
  
  <link rel="canonical" href="https://docs.databricks.com/en/sparkr/shiny.html">
  <!-- Start hreflang tag -->
  <link rel="alternate" hreflang="en" href="https://docs.databricks.com/en/sparkr/shiny.html" />
<link rel="alternate" hreflang="x-default" href="https://docs.databricks.com/en/sparkr/shiny.html" />
  <!-- End hreflang tag -->
  
  
  <link rel="shortcut icon" href="../_static/favicon.ico" />
  

  

  

  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;
j.setAttributeNode(d.createAttribute('data-ot-ignore'));
f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-T85FQ33');</script>
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;
j.setAttributeNode(d.createAttribute('data-ot-ignore'));
f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-TWTKQQ');</script>
    
  <!-- End Google Tag Manager -->


  <!-- MaxMind / GEO IP -->
  <script src="//js.maxmind.com/js/apis/geoip2/v2.1/geoip2.js" type="text/javascript"></script>
  <!-- End MaxMind / GEO IP -->

  
  
  <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600&display=swap" rel="stylesheet">
  <link rel="preload" href="../_static/fonts/DMSans-Bold.ttf" as="font">
  <link rel="preload" href="../_static/fonts/DMSans-Regular.ttf" as="font">
  <link rel="preload" href="../_static/fonts/DMMono-Regular.ttf" as="font">
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/cloud-provider-selector.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/translation-selector.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/searchunify/main.css" type="text/css" />

  
  <link rel="index" title="Index" href="../genindex.html" />
  <link rel="search" title="Search" href="../search.html" />
  <link rel="top" title="Databricks on AWS" href="../index.html" /> 
</head>

<body class="wy-body-for-nav" role="document">

  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T85FQ33"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TWTKQQ"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->

  
  <nav class="wy-nav-top header su_header" role="navigation" aria-label="top navigation">
    
<nav class="wy-nav-top header su_header" role="navigation" aria-label="top navigation">
  <div class="container-logo">
    <ul class="mobile-menu-toggle">
        <li class="menu-toggle">
            <i data-toggle="wy-nav-top" class="wy-nav-top-menu-button db-icon db-icon-menu pull-left"></i>
            
            <a href="https://www.databricks.com/" class="wy-nav-top-logo"><img src="../_static/small-scale-lockup-full-color-rgb.svg" width="137" height="21"
              alt="Databricks" /></a>   
               
              </li>
    </ul>
    <ul class="su_nav-menu">
      <li class="menu-toggle">
        <i data-toggle="wy-nav-top" class="wy-nav-top-menu-button db-icon db-icon-menu pull-left"></i>
        
          
        
        <a href="https://www.databricks.com/" class="wy-nav-top-logo"><img src="../_static/small-scale-lockup-full-color-rgb.svg" width="137" height="21"
            alt="Databricks" /></a></li>
        <!-- 
<li><a href="https://help.databricks.com/s/">Help Center</a></li>
<li class="active"><a href="https://docs.databricks.com/en/">Documentation</a></li>
<li><a href="https://kb.databricks.com/">Knowledge Base</a></li>
 -->
    </ul>
  </div>
  <div class="su_nav-right">
    <ul class="su_link-mobile">
  <!-- Mobile header code can go here -->
</ul>
<ul class="right-try-list">
   
</ul>
  </div>
</nav>
  </nav>

  <div class="su_sub-header">
    <div class="container">
      <div class="su_sub-header-inner">
        <!-- <div class="su_subnav-menu-right">
  <div id="auto" style="width: 100%;">
    <div ng-controller="SearchautoController">
      <div bind-html-compile="autocompleteHtml">
        <form class="su__search-box-1" disabled="disabled">
          <input class="su__search-input" type="search" name="Search box" id="su__search-b" placeholder="Search Documentation" disabled="disabled"/>
          <button class="su__search-button" type="submit" class="button button-success" disabled="disabled">
            <svg width="24" height="24" viewBox="0 0 24 24">
              <path
                d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"
                fill="#333"></path>
            </svg>
          </button>
        </form>
      </div>
    </div>
  </div>
</div> -->
        <div class="search-lng-gap"></div>
        <div style="margin-left: 16px; margin-right: 16px;">
          <!-- <select name="lng selector" id="lng-selector">
    <option value="../../en/sparkr/shiny.html" class="notranslate">English</option>
    <option value="../../ja/sparkr/shiny.html" class="notranslate">日本語</option>
    <option value="../../pt/sparkr/shiny.html" class="notranslate">Português (Brasil)</option>
</select> -->
        </div>
        <div class="cloud-selector-container">
          <!-- <select name="cloud provider selector" id="cloud-provider-selector">
    <option value="aws" selected class="notranslate">
        Amazon Web Services
    </option>
    <option value="azure"  class="notranslate">
        Microsoft Azure
    </option>
    <option value="gcp"  class="notranslate">
        Google Cloud Platform
    </option>
</select> -->
        </div>
      </div>
    </div>
  </div>
  <page class="js-page-container">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side su_nav-side">
<div class="wy-side-scroll">
  <div class="wy-side-nav-search">
    

    

    

    
  </div>

  <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
    
      <a href="../index.html" class="main-navigation-home">Databricks on AWS</a>
    

    
      

      
        <p class="caption"><span class="caption-text">Load &amp; manage data</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../rag-temp/index.html">RAG Studio</a></li>
</ul>

      
    
  </div>

  <div role="contentinfo">
    
  <p class="build_info notranslate"data-last-edit="December 23, 2023">
    Updated Jan 11, 2024
  </p>
<script>
  window.addEventListener('DOMContentLoaded',function(){
    var h1=document.querySelector('h1');
    var bi=document.querySelector('[data-last-edit]');
    if(h1 && bi){
      var ver = document.createElement('p');
      ver.className = 'version_info';
      ver.textContent = bi.getAttribute('data-last-edit');
      h1.parentElement.insertBefore(ver, h1.nextElementSibling);
    }
  });
</script>

    <p>
      
        <a id='feedbacklink' href="mailto:doc-feedback@databricks.com?subject=Documentation Feedback">Send us feedback</a>
      
    </p>
  </div>
</div>
</nav>
    
    
<main class="wy-grid-for-nav su_nav-grid">
  <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
    <div class="wy-nav-content su__nav_content">
      <div class="rst-content">
        





<div role="navigation" aria-label="breadcrumbs navigation" class="wy-breadcrumbs-wrapper">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Documentation</a> <span class="db-icon db-icon-chevron-right"></span></li>
    
    
      <li>Shiny on Databricks</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>
</div>
        
        <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
          <div itemprop="articleBody">
            
    
  <div class="section" id="shiny-on-databricks">
<h1>Shiny on Databricks<a class="headerlink" href="#shiny-on-databricks" title="Permalink to this headline"> </a></h1>
<p><a class="reference external" href="https://shiny.rstudio.com/">Shiny</a> is an R package, available on CRAN, used to build interactive R applications and dashboards. You can use Shiny inside <a class="reference internal" href="rstudio.html"><span class="doc">RStudio Server</span></a> hosted on Databricks clusters. You can also develop, host, and share Shiny applications directly from a Databricks notebook.</p>
<p>To get started with Shiny, see the <a class="reference external" href="https://shiny.rstudio.com/tutorial/">Shiny tutorials</a>. You can run these tutorials on Databricks notebooks.</p>
<p>This article describes how to run Shiny applications on Databricks and use Apache Spark inside Shiny applications.</p>
<div class="section" id="shiny-inside-r-notebooks">
<h2>Shiny inside R notebooks<a class="headerlink" href="#shiny-inside-r-notebooks" title="Permalink to this headline"> </a></h2>
<div class="section" id="requirements">
<h3>Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline"> </a></h3>
<ul class="simple">
<li><p>Databricks Runtime 8.3 and above.</p></li>
</ul>
</div>
<div class="section" id="get-started-with-shiny-inside-r-notebooks">
<h3>Get started with Shiny inside R notebooks<a class="headerlink" href="#get-started-with-shiny-inside-r-notebooks" title="Permalink to this headline"> </a></h3>
<p>The Shiny package is included with Databricks Runtime. You can interactively develop and test Shiny applications inside Databricks R notebooks similarly to hosted RStudio.</p>
<p>Follow these steps to get started:</p>
<ol class="arabic">
<li><p>Create an R notebook.</p></li>
<li><p>Import the Shiny package and run the example app <code class="docutils literal notranslate"><span class="pre">01_hello</span></code> as follows:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="nf">library</span><span class="p">(</span><span class="n">shiny</span><span class="p">)</span>
<span class="w">  </span><span class="nf">runExample</span><span class="p">(</span><span class="s">&quot;01_hello&quot;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>When the app is ready, the output includes the Shiny app URL as a clickable link which opens a new tab. To share this app with other users, see <a class="reference internal" href="#share-shiny-app-url"><span class="std std-ref">Share Shiny app URL</span></a>.</p>
<div class="figure align-default">
<img alt="Example Shiny app" src="../_images/shiny-01-notebook.png" />
</div>
</li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Log messages appear in the command result, similar to the default log message (<code class="docutils literal notranslate"><span class="pre">Listening</span> <span class="pre">on</span> <span class="pre">http://0.0.0.0:5150</span></code>) shown in the example.</p></li>
<li><p>To stop the Shiny application, click <strong>Cancel</strong>.</p></li>
<li><p>The Shiny application uses the notebook R process. If you detach the notebook from the cluster, or if you cancel the cell running the application, the Shiny application terminates. You cannot run other cells while the Shiny application is running.</p></li>
</ul>
</div>
</div>
<div class="section" id="run-shiny-apps-from-databricks-repos">
<h3>Run Shiny apps from Databricks Repos<a class="headerlink" href="#run-shiny-apps-from-databricks-repos" title="Permalink to this headline"> </a></h3>
<p>You can run Shiny apps that are checked into <a class="reference internal" href="../repos/index.html"><span class="doc">Databricks Repos</span></a>.</p>
<ol class="arabic">
<li><p><a class="reference internal" href="../repos/git-operations-with-repos.html"><span class="doc">Clone a remote Git repository</span></a>.</p></li>
<li><p>Run the application.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">shiny</span><span class="p">)</span>
<span class="nf">runApp</span><span class="p">(</span><span class="s">&quot;006-tabsets&quot;</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="run-shiny-apps-from-files">
<h3>Run Shiny apps from files<a class="headerlink" href="#run-shiny-apps-from-files" title="Permalink to this headline"> </a></h3>
<p>If your Shiny application code is part of a project managed by version control, you can run it inside the notebook.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You must use the absolute path or set the working directory with <code class="docutils literal notranslate"><span class="pre">setwd()</span></code>.</p>
</div>
<ol class="arabic">
<li><p>Check out the code from a repository using code similar to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="o">%</span><span class="n">sh</span> <span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">rstudio</span><span class="o">/</span><span class="n">shiny</span><span class="o">-</span><span class="n">examples</span><span class="o">.</span><span class="n">git</span>
  <span class="n">cloning</span> <span class="n">into</span> <span class="s1">&#39;shiny-examples&#39;</span><span class="o">...</span>
</pre></div>
</div>
</li>
<li><p>To run the application, enter code similar to the following in another cell:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">shiny</span><span class="p">)</span>
<span class="nf">runApp</span><span class="p">(</span><span class="s">&quot;/databricks/driver/shiny-examples/007-widgets/&quot;</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="share-shiny-app-url">
<h3>Share Shiny app URL<a class="headerlink" href="#share-shiny-app-url" title="Permalink to this headline"> </a></h3>
<p>The Shiny app URL generated when you start an app is shareable with other users. Any Databricks user with <strong>Can Attach To</strong> permission on the cluster can view and interact with the app as long as both the app and the cluster are running.</p>
<p>If the cluster that the app is running on terminates, the app is no longer accessible. You can <a class="reference internal" href="../compute/configure.html"><span class="doc">disable automatic termination</span></a> in the cluster settings.</p>
<p>If you attach and run the notebook hosting the Shiny app on a different cluster, the Shiny URL changes. Also, if you restart the app on the same cluster, Shiny might pick a different random port. To ensure a stable URL, you can set the <code class="docutils literal notranslate"><span class="pre">shiny.port</span></code> option, or, when restarting the app on the same cluster, you can specify the <code class="docutils literal notranslate"><span class="pre">port</span></code> argument.</p>
</div>
</div>
<div class="section" id="shiny-on-hosted-rstudio-server">
<span id="shiny-inside-r-notebooks"></span><h2>Shiny on hosted RStudio Server<a class="headerlink" href="#shiny-on-hosted-rstudio-server" title="Permalink to this headline"> </a></h2>
<div class="section" id="requirements">
<span id="requirements-1"></span><h3>Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline"> </a></h3>
<ul class="simple">
<li><p><a class="reference internal" href="rstudio.html"><span class="doc">RStudio on Databricks</span></a>.</p></li>
</ul>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>With RStudio Server Pro, you must disable proxied authentication.
Make sure <code class="docutils literal notranslate"><span class="pre">auth-proxy=1</span></code> is not present inside <code class="docutils literal notranslate"><span class="pre">/etc/rstudio/rserver.conf</span></code>.</p>
</div>
</div>
<div class="section" id="get-started-with-shiny-on-hosted-rstudio-server">
<h3>Get started with Shiny on hosted RStudio Server<a class="headerlink" href="#get-started-with-shiny-on-hosted-rstudio-server" title="Permalink to this headline"> </a></h3>
<ol class="arabic">
<li><p>Open RStudio on Databricks.</p></li>
<li><p>In RStudio, import the Shiny package and run the example app <code class="docutils literal notranslate"><span class="pre">01_hello</span></code> as follows:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span><span class="w"> </span><span class="nf">library</span><span class="p">(</span><span class="n">shiny</span><span class="p">)</span>
<span class="o">&gt;</span><span class="w"> </span><span class="nf">runExample</span><span class="p">(</span><span class="s">&quot;01_hello&quot;</span><span class="p">)</span>

<span class="n">Listening</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">http</span><span class="o">://</span><span class="m">127.0</span><span class="n">.</span><span class="m">0.1</span><span class="o">:</span><span class="m">3203</span>
</pre></div>
</div>
<p>A new window appears, displaying the Shiny application.</p>
<div class="figure align-default">
<img alt="First Shiny app" src="../_images/shiny-01-hello.png" />
</div>
</li>
</ol>
</div>
<div class="section" id="run-a-shiny-app-from-an-r-script">
<h3>Run a Shiny app from an R script<a class="headerlink" href="#run-a-shiny-app-from-an-r-script" title="Permalink to this headline"> </a></h3>
<p>To run a Shiny app from an R script, open the R script in the RStudio editor and click the <strong>Run App</strong> button on the top right.</p>
<div class="figure align-default">
<img alt="Shiny run App" src="../_images/shiny-run-app.png" />
</div>
</div>
</div>
<div class="section" id="use-apache-spark-inside-shiny-apps">
<span id="use-as-inside-shiny-apps"></span><span id="use-spark-inside-shiny-app"></span><h2>Use Apache Spark inside Shiny apps<a class="headerlink" href="#use-apache-spark-inside-shiny-apps" title="Permalink to this headline"> </a></h2>
<p>You can use Apache Spark inside Shiny applications with either SparkR or sparklyr.</p>
<div class="section" id="use-sparkr-with-shiny-in-a-notebook">
<h3>Use SparkR with Shiny in a notebook<a class="headerlink" href="#use-sparkr-with-shiny-in-a-notebook" title="Permalink to this headline"> </a></h3>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">shiny</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">SparkR</span><span class="p">)</span>
<span class="nf">sparkR.session</span><span class="p">()</span>

<span class="n">ui</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">fluidPage</span><span class="p">(</span>
<span class="w">  </span><span class="nf">mainPanel</span><span class="p">(</span>
<span class="w">    </span><span class="nf">textOutput</span><span class="p">(</span><span class="s">&quot;value&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">)</span>
<span class="p">)</span>

<span class="n">server</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">input</span><span class="p">,</span><span class="w"> </span><span class="n">output</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">output</span><span class="o">$</span><span class="n">value</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">renderText</span><span class="p">({</span><span class="w"> </span><span class="nf">nrow</span><span class="p">(</span><span class="nf">createDataFrame</span><span class="p">(</span><span class="n">iris</span><span class="p">))</span><span class="w"> </span><span class="p">})</span>
<span class="p">}</span>

<span class="nf">shinyApp</span><span class="p">(</span><span class="n">ui</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ui</span><span class="p">,</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">server</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="use-sparklyr-with-shiny-in-a-notebook">
<h3>Use sparklyr with Shiny in a notebook<a class="headerlink" href="#use-sparklyr-with-shiny-in-a-notebook" title="Permalink to this headline"> </a></h3>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">shiny</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">sparklyr</span><span class="p">)</span>

<span class="n">sc</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">spark_connect</span><span class="p">(</span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;databricks&quot;</span><span class="p">)</span>

<span class="n">ui</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">fluidPage</span><span class="p">(</span>
<span class="w">  </span><span class="nf">mainPanel</span><span class="p">(</span>
<span class="w">    </span><span class="nf">textOutput</span><span class="p">(</span><span class="s">&quot;value&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">)</span>
<span class="p">)</span>

<span class="n">server</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">input</span><span class="p">,</span><span class="w"> </span><span class="n">output</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">output</span><span class="o">$</span><span class="n">value</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">renderText</span><span class="p">({</span>
<span class="w">    </span><span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sdf_len</span><span class="p">(</span><span class="n">sc</span><span class="p">,</span><span class="w"> </span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="n">repartition</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">      </span><span class="nf">spark_apply</span><span class="p">(</span><span class="nf">function</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">e</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">      </span><span class="nf">collect</span><span class="p">()</span>
<span class="w">    </span><span class="n">df</span><span class="o">$</span><span class="n">result</span>
<span class="w">  </span><span class="p">})</span>
<span class="p">}</span>

<span class="nf">shinyApp</span><span class="p">(</span><span class="n">ui</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ui</span><span class="p">,</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">server</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">dplyr</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">shiny</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">sparklyr</span><span class="p">)</span>

<span class="n">sc</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">spark_connect</span><span class="p">(</span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;databricks&quot;</span><span class="p">)</span>
<span class="n">diamonds_tbl</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">spark_read_csv</span><span class="p">(</span><span class="n">sc</span><span class="p">,</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;/databricks-datasets/Rdatasets/data-001/csv/ggplot2/diamonds.csv&quot;</span><span class="p">)</span>

<span class="c1"># Define the UI</span>
<span class="n">ui</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">fluidPage</span><span class="p">(</span>
<span class="w">  </span><span class="nf">sliderInput</span><span class="p">(</span><span class="s">&quot;carat&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Select Carat Range:&quot;</span><span class="p">,</span>
<span class="w">              </span><span class="n">min</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">5</span><span class="p">),</span><span class="w"> </span><span class="n">step</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.01</span><span class="p">),</span>
<span class="w">  </span><span class="nf">plotOutput</span><span class="p">(</span><span class="s">&#39;plot&#39;</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Define the server code</span>
<span class="n">server</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">input</span><span class="p">,</span><span class="w"> </span><span class="n">output</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">output</span><span class="o">$</span><span class="n">plot</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">renderPlot</span><span class="p">({</span>
<span class="w">    </span><span class="c1"># Select diamonds in carat range</span>
<span class="w">    </span><span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">diamonds_tbl</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">      </span><span class="n">dplyr</span><span class="o">::</span><span class="nf">select</span><span class="p">(</span><span class="s">&quot;carat&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;price&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">      </span><span class="n">dplyr</span><span class="o">::</span><span class="nf">filter</span><span class="p">(</span><span class="n">carat</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="o">!!</span><span class="n">input</span><span class="o">$</span><span class="n">carat</span><span class="p">[[</span><span class="m">1</span><span class="p">]],</span><span class="w"> </span><span class="n">carat</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="o">!!</span><span class="n">input</span><span class="o">$</span><span class="n">carat</span><span class="p">[[</span><span class="m">2</span><span class="p">]])</span>

<span class="w">    </span><span class="c1"># Scatter plot with smoothed means</span>
<span class="w">    </span><span class="nf">ggplot</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">carat</span><span class="p">,</span><span class="w"> </span><span class="n">price</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="nf">geom_point</span><span class="p">(</span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="o">/</span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="nf">geom_smooth</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="nf">scale_size_area</span><span class="p">(</span><span class="n">max_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Price vs. Carat&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">})</span>
<span class="p">}</span>

<span class="c1"># Return a Shiny app object</span>
<span class="nf">shinyApp</span><span class="p">(</span><span class="n">ui</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ui</span><span class="p">,</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">server</span><span class="p">)</span>
</pre></div>
</div>
<div class="figure align-default">
<img alt="Spark Shiny app" src="../_images/shiny-spark.png" />
</div>
</div>
</div>
<div class="section" id="frequently-asked-questions-faq">
<h2>Frequently asked questions (FAQ)<a class="headerlink" href="#frequently-asked-questions-faq" title="Permalink to this headline"> </a></h2>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#why-is-my-shiny-app-grayed-out-after-some-time" id="id2">Why is my Shiny app grayed out after some time?</a></p></li>
<li><p><a class="reference internal" href="#why-does-my-shiny-viewer-window-disappear-after-a-while" id="id3">Why does my Shiny viewer window disappear after a while?</a></p></li>
<li><p><a class="reference internal" href="#why-do-long-spark-jobs-never-return" id="id4">Why do long Spark jobs never return?</a></p></li>
<li><p><a class="reference internal" href="#how-can-i-avoid-the-timeout" id="id5">How can I avoid the timeout?</a></p></li>
<li><p><a class="reference internal" href="#my-app-crashes-immediately-after-launching-but-the-code-appears-to-be-correct-whats-going-on" id="id6">My app crashes immediately after launching, but the code appears to be correct. What’s going on?</a></p></li>
<li><p><a class="reference internal" href="#how-many-connections-can-be-accepted-for-one-shiny-app-link-during-development" id="id7">How many connections can be accepted for one Shiny app link during development?</a></p></li>
<li><p><a class="reference internal" href="#can-i-use-a-different-version-of-the-shiny-package-than-the-one-installed-in-databricks-runtime" id="id8">Can I use a different version of the Shiny package than the one installed in Databricks Runtime?</a></p></li>
<li><p><a class="reference internal" href="#how-can-i-develop-a-shiny-application-that-can-be-published-to-a-shiny-server-and-access-data-on-databricks" id="id9">How can I develop a Shiny application that can be published to a Shiny server and access data on Databricks?</a></p></li>
<li><p><a class="reference internal" href="#can-i-develop-a-shiny-application-inside-a-databricks-notebook" id="id10">Can I develop a Shiny application inside a Databricks notebook?</a></p></li>
<li><p><a class="reference internal" href="#how-can-i-save-the-shiny-applications-that-i-developed-on-hosted-rstudio-server" id="id11">How can I save the Shiny applications that I developed on hosted RStudio Server?</a></p></li>
</ul>
</div>
<div class="section" id="why-is-my-shiny-app-grayed-out-after-some-time">
<h3><a class="toc-backref" href="#id2">Why is my Shiny app grayed out after some time?</a><a class="headerlink" href="#why-is-my-shiny-app-grayed-out-after-some-time" title="Permalink to this headline"> </a></h3>
<p>If there is no interaction with the Shiny app, the connection to the app closes after about 10 minutes.</p>
<p>To reconnect, refresh the Shiny app page. The dashboard state resets.</p>
</div>
<div class="section" id="why-does-my-shiny-viewer-window-disappear-after-a-while">
<h3><a class="toc-backref" href="#id3">Why does my Shiny viewer window disappear after a while?</a><a class="headerlink" href="#why-does-my-shiny-viewer-window-disappear-after-a-while" title="Permalink to this headline"> </a></h3>
<p>If the Shiny viewer window disappears after idling for several minutes, it is due to the same timeout as the “gray out” scenario.</p>
</div>
<div class="section" id="why-do-long-spark-jobs-never-return">
<h3><a class="toc-backref" href="#id4">Why do long Spark jobs never return?</a><a class="headerlink" href="#why-do-long-spark-jobs-never-return" title="Permalink to this headline"> </a></h3>
<p>This is also because of the idle timeout. Any Spark job running for longer than the previously mentioned timeouts is not able to render its result because the connection closes before the job returns.</p>
</div>
<div class="section" id="how-can-i-avoid-the-timeout">
<h3><a class="toc-backref" href="#id5">How can I avoid the timeout?</a><a class="headerlink" href="#how-can-i-avoid-the-timeout" title="Permalink to this headline"> </a></h3>
<ul>
<li><p>There is a workaround suggested in <a class="reference external" href="https://github.com/rstudio/shiny/issues/2110#issuecomment-419971302">Feature request: Have client send keep alive message to prevent TCP timeout on some load balancers</a> on Github. The workaround sends heartbeats to keep the WebSocket connection alive when the app is idle. However, if the app is blocked by a long running computation, this workaround does not work.</p></li>
<li><p>Shiny does not support long running tasks. A Shiny blog post recommends using <a class="reference external" href="https://blog.rstudio.com/2018/06/26/shiny-1-1-0/">promises and futures</a> to run long tasks asynchronously and keep the app unblocked. Here is an example that uses heartbeats to keep the Shiny app alive, and runs a long running Spark job in a <code class="docutils literal notranslate"><span class="pre">future</span></code> construct.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write an app that uses spark to access data on Databricks</span>
<span class="c1"># First, install the following packages:</span>
<span class="nf">install.packages</span><span class="p">(</span>‘<span class="n">future</span>’<span class="p">)</span>
<span class="nf">install.packages</span><span class="p">(</span>‘<span class="n">promises</span>’<span class="p">)</span>

<span class="nf">library</span><span class="p">(</span><span class="n">shiny</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">promises</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">future</span><span class="p">)</span>
<span class="nf">plan</span><span class="p">(</span><span class="n">multisession</span><span class="p">)</span>

<span class="n">HEARTBEAT_INTERVAL_MILLIS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1000</span><span class="w">  </span><span class="c1"># 1 second</span>

<span class="c1"># Define the long Spark job here</span>
<span class="n">run_spark</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1"># Environment setting</span>
<span class="w">  </span><span class="nf">library</span><span class="p">(</span><span class="s">&quot;SparkR&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">lib.loc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;/databricks/spark/R/lib&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="nf">sparkR.session</span><span class="p">()</span>

<span class="w">  </span><span class="n">irisDF</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">createDataFrame</span><span class="p">(</span><span class="n">iris</span><span class="p">)</span>
<span class="w">  </span><span class="nf">collect</span><span class="p">(</span><span class="n">irisDF</span><span class="p">)</span>
<span class="w">  </span><span class="nf">Sys.sleep</span><span class="p">(</span><span class="m">3</span><span class="p">)</span>
<span class="w">  </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">1</span>
<span class="p">}</span>

<span class="n">run_spark_sparklyr</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1"># Environment setting</span>
<span class="w">  </span><span class="nf">library</span><span class="p">(</span><span class="n">sparklyr</span><span class="p">)</span>
<span class="w">  </span><span class="nf">library</span><span class="p">(</span><span class="n">dplyr</span><span class="p">)</span>
<span class="w">  </span><span class="nf">library</span><span class="p">(</span><span class="s">&quot;SparkR&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">lib.loc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;/databricks/spark/R/lib&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="nf">sparkR.session</span><span class="p">()</span>
<span class="w">  </span><span class="n">sc</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">spark_connect</span><span class="p">(</span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;databricks&quot;</span><span class="p">)</span>

<span class="w">  </span><span class="n">iris_tbl</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">copy_to</span><span class="p">(</span><span class="n">sc</span><span class="p">,</span><span class="w"> </span><span class="n">iris</span><span class="p">,</span><span class="w"> </span><span class="n">overwrite</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span>
<span class="w">  </span><span class="nf">collect</span><span class="p">(</span><span class="n">iris_tbl</span><span class="p">)</span>
<span class="w">  </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">1</span>
<span class="p">}</span>

<span class="n">ui</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">fluidPage</span><span class="p">(</span>
<span class="w">  </span><span class="nf">sidebarLayout</span><span class="p">(</span>
<span class="w">    </span><span class="c1"># Display heartbeat</span>
<span class="w">    </span><span class="nf">sidebarPanel</span><span class="p">(</span><span class="nf">textOutput</span><span class="p">(</span><span class="s">&quot;keep_alive&quot;</span><span class="p">)),</span>

<span class="w">    </span><span class="c1"># Display the Input and Output of the Spark job</span>
<span class="w">    </span><span class="nf">mainPanel</span><span class="p">(</span>
<span class="w">      </span><span class="nf">numericInput</span><span class="p">(</span><span class="s">&#39;num&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#39;Input&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">),</span>
<span class="w">      </span><span class="nf">actionButton</span><span class="p">(</span><span class="s">&#39;submit&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;Submit&#39;</span><span class="p">),</span>
<span class="w">      </span><span class="nf">textOutput</span><span class="p">(</span><span class="s">&#39;value&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="p">)</span>
<span class="w">  </span><span class="p">)</span>
<span class="p">)</span>
<span class="n">server</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">input</span><span class="p">,</span><span class="w"> </span><span class="n">output</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">#### Heartbeat ####</span>
<span class="w">  </span><span class="c1"># Define reactive variable</span>
<span class="w">  </span><span class="n">cnt</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">reactiveVal</span><span class="p">(</span><span class="m">0</span><span class="p">)</span>
<span class="w">  </span><span class="c1"># Define time dependent trigger</span>
<span class="w">  </span><span class="n">autoInvalidate</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">reactiveTimer</span><span class="p">(</span><span class="n">HEARTBEAT_INTERVAL_MILLIS</span><span class="p">)</span>
<span class="w">  </span><span class="c1"># Time dependent change of variable</span>
<span class="w">  </span><span class="nf">observeEvent</span><span class="p">(</span><span class="nf">autoInvalidate</span><span class="p">(),</span><span class="w"> </span><span class="p">{</span><span class="w">  </span><span class="nf">cnt</span><span class="p">(</span><span class="nf">cnt</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w">  </span><span class="p">})</span>
<span class="w">  </span><span class="c1"># Render print</span>
<span class="w">  </span><span class="n">output</span><span class="o">$</span><span class="n">keep_alive</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">renderPrint</span><span class="p">(</span><span class="nf">cnt</span><span class="p">())</span>

<span class="w">  </span><span class="c1">#### Spark job ####</span>
<span class="w">  </span><span class="n">result</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">reactiveVal</span><span class="p">()</span><span class="w"> </span><span class="c1"># the result of the spark job</span>
<span class="w">  </span><span class="n">busy</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">reactiveVal</span><span class="p">(</span><span class="m">0</span><span class="p">)</span><span class="w">  </span><span class="c1"># whether the spark job is running</span>
<span class="w">  </span><span class="c1"># Launch a spark job in a future when actionButton is clicked</span>
<span class="w">  </span><span class="nf">observeEvent</span><span class="p">(</span><span class="n">input</span><span class="o">$</span><span class="n">submit</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nf">if </span><span class="p">(</span><span class="nf">busy</span><span class="p">()</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nf">showNotification</span><span class="p">(</span><span class="s">&quot;Already running Spark job...&quot;</span><span class="p">)</span>
<span class="w">      </span><span class="nf">return</span><span class="p">(</span><span class="kc">NULL</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="nf">showNotification</span><span class="p">(</span><span class="s">&quot;Launching a new Spark job...&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="c1"># input$num must be read outside the future</span>
<span class="w">    </span><span class="n">input_x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">input</span><span class="o">$</span><span class="n">num</span>
<span class="w">    </span><span class="n">fut</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">future</span><span class="p">({</span><span class="w"> </span><span class="nf">run_spark</span><span class="p">(</span><span class="n">input_x</span><span class="p">)</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="o">%...&gt;%</span><span class="w"> </span><span class="nf">result</span><span class="p">()</span>
<span class="w">    </span><span class="c1"># Or: fut &lt;- future({ run_spark_sparklyr(input_x) }) %...&gt;% result()</span>
<span class="w">    </span><span class="nf">busy</span><span class="p">(</span><span class="m">1</span><span class="p">)</span>
<span class="w">    </span><span class="c1"># Catch exceptions and notify the user</span>
<span class="w">    </span><span class="n">fut</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">catch</span><span class="p">(</span><span class="n">fut</span><span class="p">,</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nf">result</span><span class="p">(</span><span class="kc">NULL</span><span class="p">)</span>
<span class="w">      </span><span class="nf">cat</span><span class="p">(</span><span class="n">e</span><span class="o">$</span><span class="n">message</span><span class="p">)</span>
<span class="w">      </span><span class="nf">showNotification</span><span class="p">(</span><span class="n">e</span><span class="o">$</span><span class="n">message</span><span class="p">)</span>
<span class="w">    </span><span class="p">})</span>
<span class="w">    </span><span class="n">fut</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">finally</span><span class="p">(</span><span class="n">fut</span><span class="p">,</span><span class="w"> </span><span class="nf">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nf">busy</span><span class="p">(</span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="p">})</span>
<span class="w">    </span><span class="c1"># Return something other than the promise so shiny remains responsive</span>
<span class="w">    </span><span class="kc">NULL</span>
<span class="w">  </span><span class="p">})</span>
<span class="w">  </span><span class="c1"># When the spark job returns, render the value</span>
<span class="w">  </span><span class="n">output</span><span class="o">$</span><span class="n">value</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">renderPrint</span><span class="p">(</span><span class="nf">result</span><span class="p">())</span>
<span class="p">}</span>
<span class="nf">shinyApp</span><span class="p">(</span><span class="n">ui</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ui</span><span class="p">,</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">server</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>There is a hard limit of 12 hours since the initial page load after which any connection, even if active, will be terminated. You must refresh the Shiny app to reconnect in these cases. However, the underlying WebSocket connection can close at any time by a variety of factors including network instability or computer sleep mode. Databricks recommends rewriting Shiny apps such that they do not require a long-lived connection and do not over-rely on session state.</p></li>
</ul>
</div>
<div class="section" id="my-app-crashes-immediately-after-launching-but-the-code-appears-to-be-correct-whats-going-on">
<h3><a class="toc-backref" href="#id6">My app crashes immediately after launching, but the code appears to be correct. What’s going on?</a><a class="headerlink" href="#my-app-crashes-immediately-after-launching-but-the-code-appears-to-be-correct-whats-going-on" title="Permalink to this headline"> </a></h3>
<p>There is a 50 MB limit on the total amount of data that can be displayed in a Shiny app on Databricks. If the application’s total data size exceeds this limit, it will crash immediately after launching. To avoid this, Databricks recommends reducing the data size, for example by downsampling the displayed data or reducing the resolution of images.</p>
</div>
<div class="section" id="how-many-connections-can-be-accepted-for-one-shiny-app-link-during-development">
<h3><a class="toc-backref" href="#id7">How many connections can be accepted for one Shiny app link during development?</a><a class="headerlink" href="#how-many-connections-can-be-accepted-for-one-shiny-app-link-during-development" title="Permalink to this headline"> </a></h3>
<p>Databricks recommends up to 20.</p>
</div>
<div class="section" id="can-i-use-a-different-version-of-the-shiny-package-than-the-one-installed-in-databricks-runtime">
<span id="can-i-use-a-different-version-of-the-shiny-package-than-the-one-installed-in-dbr"></span><h3><a class="toc-backref" href="#id8">Can I use a different version of the Shiny package than the one installed in Databricks Runtime?</a><a class="headerlink" href="#can-i-use-a-different-version-of-the-shiny-package-than-the-one-installed-in-databricks-runtime" title="Permalink to this headline"> </a></h3>
<p>Yes. See <a class="reference external" href="https://kb.databricks.com/r/pin-r-packages.html">Fix the Version of R Packages</a>.</p>
</div>
<div class="section" id="how-can-i-develop-a-shiny-application-that-can-be-published-to-a-shiny-server-and-access-data-on-databricks">
<h3><a class="toc-backref" href="#id9">How can I develop a Shiny application that can be published to a Shiny server and access data on Databricks?</a><a class="headerlink" href="#how-can-i-develop-a-shiny-application-that-can-be-published-to-a-shiny-server-and-access-data-on-databricks" title="Permalink to this headline"> </a></h3>
<p>While you can access data naturally using SparkR or sparklyr during development and testing on Databricks, after a Shiny application is published to a stand-alone hosting service, it cannot directly access the data and tables on Databricks.</p>
<p>To enable your application to function outside Databricks, you must rewrite how you access data. There are a few options:</p>
<ul class="simple">
<li><p>Use <a class="reference internal" href="../integrations/jdbc-odbc-bi.html"><span class="doc">JDBC/ODBC</span></a> to submit queries to a Databricks cluster.</p></li>
<li><p>Use <a class="reference internal" href="../dev-tools/databricks-connect/index.html"><span class="doc">Databricks Connect</span></a>.</p></li>
<li><p>Directly access data on object storage.</p></li>
</ul>
<p>Databricks recommends that you work with your Databricks solutions team to find the best approach for your existing data and analytics architecture.</p>
</div>
<div class="section" id="can-i-develop-a-shiny-application-inside-a-databricks-notebook">
<h3><a class="toc-backref" href="#id10">Can I develop a Shiny application inside a Databricks notebook?</a><a class="headerlink" href="#can-i-develop-a-shiny-application-inside-a-databricks-notebook" title="Permalink to this headline"> </a></h3>
<p>Yes, you can develop a Shiny application inside a Databricks notebook.</p>
</div>
<div class="section" id="how-can-i-save-the-shiny-applications-that-i-developed-on-hosted-rstudio-server">
<span id="can-i-develop-a-shiny-application-inside-a-databricks-notebook"></span><h3><a class="toc-backref" href="#id11">How can I save the Shiny applications that I developed on hosted RStudio Server?</a><a class="headerlink" href="#how-can-i-save-the-shiny-applications-that-i-developed-on-hosted-rstudio-server" title="Permalink to this headline"> </a></h3>
<p>You can either save your application code <a class="reference internal" href="../dbfs/index.html"><span class="doc">on DBFS</span></a> or check your code into version control.</p>
</div>
</div>
</div>


    
          </div>
        </div>
        <div  class="suapp-rating">
  <div id="suPageRateApp">
     <su-app></su-app>
   </div> 
 </div>
<hr> 
<footer>
  <div role="contentinfo">
      <p class="copyright">
          &copy; Databricks 2023. All rights reserved. Apache, Apache Spark, Spark, and the Spark logo are trademarks of the <a href="http://www.apache.org/">Apache Software Foundation</a>.
      </p>
      <p> 
        
          <a id='feedbacklink' href="mailto:doc-feedback@databricks.com?subject=Documentation Feedback">Send us feedback</a>
        
     | <a href="https://databricks.com/privacy-policy">Privacy Policy</a> | <a href="https://databricks.com/terms-of-use">Terms of Use</a></p>

  </div> 

</footer>
      </div>
    </div>
  </section>
</main>

  </page>
  
  <script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
      URL_ROOT: '../',
      VERSION: '1.0',
      COLLAPSE_INDEX: false,
      FILE_SUFFIX: '.html',
      HAS_SOURCE: 'false'
    };
  </script>
  <script type="text/javascript" src="../_static/jquery.js"></script>
  <script type="text/javascript" src="../_static/underscore.js"></script>
  <script type="text/javascript" src="../_static/doctools.js"></script>
  <script type="text/javascript" src="../_static/language_data.js"></script>
  

  <script type="text/javascript" src="../_static/js/clipboard.min.js"></script>
  <script type="text/javascript" src="../_static/js/jquery.waypoints.min.js"></script>

  <!-- Select2 (https://select2.org/) -->
  <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
  <!-- End Select2 -->

  
  
  <script type="text/javascript" src="../_static/js/localized.js"></script>
  <script type="text/javascript" src="../_static/js/custom.js"></script>
  

  
  
  <script type="text/javascript">
    jQuery(function () {
      SphinxRtdTheme.StickyNav.enable();
    });

  </script>
  
 



  <script>
  window.__searchunifyLoaderConfig = JSON.parse('{"clients": {"en": "02c2e804-27e9-11ee-aefb-0242ac120011", "ja": "6a42c3f2-2820-11ee-aefb-0242ac120011", "pt": "6a86badd-2821-11ee-aefb-0242ac120011"}}')
</script>
<script type="text/javascript" src="../_static/js/search-loader.js"></script>
</body>
<script type='text/javascript'>
  window.onload = function () {
    var description = document.querySelector('meta[name="description"]').getAttribute("content");
    let titleText = document.querySelector('h1').textContent;
    document.querySelector('meta[property="og:title"]').setAttribute("content", titleText);
    document.querySelector('meta[property="og:description"]').setAttribute("content", description);
    document.querySelector('meta[property="twitter:description"]').setAttribute("content", description);
  };
</script>

</html>