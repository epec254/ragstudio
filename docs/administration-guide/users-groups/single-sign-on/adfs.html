

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en-US" > <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en-US"> <!--<![endif]-->

<head>
  <!-- cookie consent -->
  
    <!-- Combined Onetrust and Rudderstack Implementation Scripts -->
    <!-- Onetrust Initialization -->
    <script type="text/javascript" src="https://cdn.cookielaw.org/consent/92466579-1717-44d3-809d-a05fb02843ed-test/OtAutoBlock.js"></script>
    <script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" data-document-language="true" type="text/javascript" charset="UTF-8" data-domain-script="92466579-1717-44d3-809d-a05fb02843ed-test"></script>
    <link rel="stylesheet" id="db-onetrust-style" href="https://www.databricks.com/wp-content/uploads/db_onetrust.css" media="all" />
    <!-- Setting Rudderstack Write Key -->
    <script>window.rudderstackKey = "2SOR9fvSr5Fi6tN2ihPbVHnX1SZ" </script>
    <!-- Rudderstack Initialization + Onetrust Integration + Rudderstack Custom Events -->
    <script type="text/javascript" src="https://www.databricks.com/sites/default/files/rudderstack/v1/db-rudderstack-events.js"></script>

  <!-- cookie consent -->

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="X-UA-Compatible" content="IE=9" />
  <meta content="Learn how to set up self-hosted Microsoft Windows Active Directory for SSO with Databricks." name="description" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
  <meta property="og:image" content="https://www.databricks.com/wp-content/uploads/2020/04/og-databricks.png">
  <meta property="og:image:type" content="image/png">
  <meta property="og:title" content="SSO with Microsoft Windows Active Directory for your workspace">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://docs.databricks.com">
  <meta property="og:description" content="" id="og-description">
  <meta name="twitter:image" content="https://www.databricks.com/wp-content/uploads/2020/04/og-databricks.png">
  <meta name="twitter:site" content="@databricks">
  <meta name="twitter:creator" content="@databricks">
  <meta property="twitter:description" content="">
  
  <title>SSO with Microsoft Windows Active Directory for your workspace &#124; Databricks on AWS</title>
  
  
  <link rel="canonical" href="https://docs.databricks.com/en/administration-guide/users-groups/single-sign-on/adfs.html">
  <!-- Start hreflang tag -->
  <link rel="alternate" hreflang="en" href="https://docs.databricks.com/en/administration-guide/users-groups/single-sign-on/adfs.html" />
<link rel="alternate" hreflang="x-default" href="https://docs.databricks.com/en/administration-guide/users-groups/single-sign-on/adfs.html" />
  <!-- End hreflang tag -->
  
  
  <link rel="shortcut icon" href="../../../_static/favicon.ico" />
  

  

  

  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;
j.setAttributeNode(d.createAttribute('data-ot-ignore'));
f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-T85FQ33');</script>
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;
j.setAttributeNode(d.createAttribute('data-ot-ignore'));
f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-TWTKQQ');</script>
    
  <!-- End Google Tag Manager -->


  <!-- MaxMind / GEO IP -->
  <script src="//js.maxmind.com/js/apis/geoip2/v2.1/geoip2.js" type="text/javascript"></script>
  <!-- End MaxMind / GEO IP -->

  
  
  <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600&display=swap" rel="stylesheet">
  <link rel="preload" href="../../../_static/fonts/DMSans-Bold.ttf" as="font">
  <link rel="preload" href="../../../_static/fonts/DMSans-Regular.ttf" as="font">
  <link rel="preload" href="../../../_static/fonts/DMMono-Regular.ttf" as="font">
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/css/custom.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/css/cloud-provider-selector.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/css/translation-selector.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/css/searchunify/main.css" type="text/css" />

  
  <link rel="index" title="Index" href="../../../genindex.html" />
  <link rel="search" title="Search" href="../../../search.html" />
  <link rel="top" title="Databricks on AWS" href="../../../index.html" /> 
</head>

<body class="wy-body-for-nav" role="document">

  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T85FQ33"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TWTKQQ"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->

  
  <nav class="wy-nav-top header su_header" role="navigation" aria-label="top navigation">
    
<nav class="wy-nav-top header su_header" role="navigation" aria-label="top navigation">
  <div class="container-logo">
    <ul class="mobile-menu-toggle">
        <li class="menu-toggle">
            <i data-toggle="wy-nav-top" class="wy-nav-top-menu-button db-icon db-icon-menu pull-left"></i>
            
            <a href="https://www.databricks.com/" class="wy-nav-top-logo"><img src="../../../_static/small-scale-lockup-full-color-rgb.svg" width="137" height="21"
              alt="Databricks" /></a>   
               
              </li>
    </ul>
    <ul class="su_nav-menu">
      <li class="menu-toggle">
        <i data-toggle="wy-nav-top" class="wy-nav-top-menu-button db-icon db-icon-menu pull-left"></i>
        
          
        
        <a href="https://www.databricks.com/" class="wy-nav-top-logo"><img src="../../../_static/small-scale-lockup-full-color-rgb.svg" width="137" height="21"
            alt="Databricks" /></a></li>
        <!-- 
<li><a href="https://help.databricks.com/s/">Help Center</a></li>
<li class="active"><a href="https://docs.databricks.com/en/">Documentation</a></li>
<li><a href="https://kb.databricks.com/">Knowledge Base</a></li>
 -->
    </ul>
  </div>
  <div class="su_nav-right">
    <ul class="su_link-mobile">
  <!-- Mobile header code can go here -->
</ul>
<ul class="right-try-list">
   
</ul>
  </div>
</nav>
  </nav>

  <div class="su_sub-header">
    <div class="container">
      <div class="su_sub-header-inner">
        <!-- <div class="su_subnav-menu-right">
  <div id="auto" style="width: 100%;">
    <div ng-controller="SearchautoController">
      <div bind-html-compile="autocompleteHtml">
        <form class="su__search-box-1" disabled="disabled">
          <input class="su__search-input" type="search" name="Search box" id="su__search-b" placeholder="Search Documentation" disabled="disabled"/>
          <button class="su__search-button" type="submit" class="button button-success" disabled="disabled">
            <svg width="24" height="24" viewBox="0 0 24 24">
              <path
                d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"
                fill="#333"></path>
            </svg>
          </button>
        </form>
      </div>
    </div>
  </div>
</div> -->
        <div class="search-lng-gap"></div>
        <div style="margin-left: 16px; margin-right: 16px;">
          <!-- <select name="lng selector" id="lng-selector">
    <option value="../../../../en/administration-guide/users-groups/single-sign-on/adfs.html" class="notranslate">English</option>
    <option value="../../../../ja/administration-guide/users-groups/single-sign-on/adfs.html" class="notranslate">日本語</option>
    <option value="../../../../pt/administration-guide/users-groups/single-sign-on/adfs.html" class="notranslate">Português (Brasil)</option>
</select> -->
        </div>
        <div class="cloud-selector-container">
          <!-- <select name="cloud provider selector" id="cloud-provider-selector">
    <option value="aws" selected class="notranslate">
        Amazon Web Services
    </option>
    <option value="azure"  class="notranslate">
        Microsoft Azure
    </option>
    <option value="gcp"  class="notranslate">
        Google Cloud Platform
    </option>
</select> -->
        </div>
      </div>
    </div>
  </div>
  <page class="js-page-container">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side su_nav-side">
<div class="wy-side-scroll">
  <div class="wy-side-nav-search">
    

    

    

    
  </div>

  <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
    
      <a href="../../../index.html" class="main-navigation-home">Databricks on AWS</a>
    

    
      

      
        <p class="caption"><span class="caption-text">Load &amp; manage data</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../rag-temp/index.html">RAG Studio</a></li>
</ul>

      
    
  </div>

  <div role="contentinfo">
    
  <p class="build_info notranslate"data-last-edit="December 23, 2023">
    Updated Jan 11, 2024
  </p>
<script>
  window.addEventListener('DOMContentLoaded',function(){
    var h1=document.querySelector('h1');
    var bi=document.querySelector('[data-last-edit]');
    if(h1 && bi){
      var ver = document.createElement('p');
      ver.className = 'version_info';
      ver.textContent = bi.getAttribute('data-last-edit');
      h1.parentElement.insertBefore(ver, h1.nextElementSibling);
    }
  });
</script>

    <p>
      
        <a id='feedbacklink' href="mailto:doc-feedback@databricks.com?subject=Documentation Feedback">Send us feedback</a>
      
    </p>
  </div>
</div>
</nav>
    
    
<main class="wy-grid-for-nav su_nav-grid">
  <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
    <div class="wy-nav-content su__nav_content">
      <div class="rst-content">
        





<div role="navigation" aria-label="breadcrumbs navigation" class="wy-breadcrumbs-wrapper">
  <ul class="wy-breadcrumbs">
    <li><a href="../../../index.html">Documentation</a> <span class="db-icon db-icon-chevron-right"></span></li>
    
    
      <li>SSO with Microsoft Windows Active Directory for your workspace</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>
</div>
        
        <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
          <div itemprop="articleBody">
            
    
  <div class="section" id="sso-with-microsoft-windows-active-directory-for-your-workspace">
<h1>SSO with Microsoft Windows Active Directory for your workspace<a class="headerlink" href="#sso-with-microsoft-windows-active-directory-for-your-workspace" title="Permalink to this headline"> </a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Workspace-level SSO can only be configured when unified login is disabled.  When unified login, your workspace uses the same SSO configuration as your account. Databricks recommends enabling unified login on all workspaces. See <a class="reference internal" href="index.html#unified-login"><span class="std std-ref">Unified login</span></a>.</p>
</div>
<p>Microsoft Windows Active Directory (AD) provides identity based access controls for a wide range of Microsoft products. You host Windows AD, either in your Azure tenant or on your premises. With Windows AD, you can authenticate third party extranet applications such as Databricks using Windows Active Directory Federation Services (AD FS). AD FS uses SAML 2.0.</p>
<p>This article shows how to configure AD FS as the identity provider for a Databricks workspace. To use Microsoft Entra ID (formerly Azure Active Directory) hosted in your Azure tenant for SSO with Databricks, see <a class="reference internal" href="azure-ad.html"><span class="doc">SSO with Microsoft Entra ID (formerly Azure Active Directory) for your workspace</span></a>.</p>
<p>To configure SSO in your Databricks account, see <a class="reference internal" href="../../account-settings-e2/single-sign-on/index.html"><span class="doc">Set up SSO in your Databricks account console</span></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>The following guide is for configuring AD FS integration using Windows Server 2012 R2 Active Directory Federation Services version 6.3.0.0. Existing customers who need support for other versions of AD FS or Azure Directory Services can contact <a class="reference external" href="mailto:help&#37;&#52;&#48;databricks&#46;com">help<span>&#64;</span>databricks<span>&#46;</span>com</a>. If you are a new customer, contact <a class="reference external" href="mailto:sales&#37;&#52;&#48;databricks&#46;com">sales<span>&#64;</span>databricks<span>&#46;</span>com</a>.</p></li>
<li><p>Windows AD typically uses a short employee ID or employee username as the authentication principal, rather than an email address. When a user logs in to Databricks, the user’s workspace directory is automatically appended to the username to create an email address. For example, the username <code class="docutils literal notranslate"><span class="pre">john.doe</span></code> might become <code class="docutils literal notranslate"><span class="pre">john.doe&#64;example.com</span></code>.</p></li>
<li><p>Time synchronization issues can lead to a situation where all AD FS logins are invalidated. Make sure the clock on your AD FS server is updated.</p></li>
<li><p>If you are having trouble enabling AD FS SSO and your organization uses multiple certificates, contact Databricks at <a class="reference external" href="mailto:help&#37;&#52;&#48;databricks&#46;com">help<span>&#64;</span>databricks<span>&#46;</span>com</a> (for existing customers) or <a class="reference external" href="mailto:sales&#37;&#52;&#48;databricks&#46;com">sales<span>&#64;</span>databricks<span>&#46;</span>com</a> (for new customers).</p></li>
</ul>
</div>
<div class="section" id="requirements">
<h2>Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline"> </a></h2>
<ul>
<li><p>Install and configure the following Windows services:</p>
<ul class="simple">
<li><p>Windows Domain Server</p></li>
<li><p>Windows DNS Service</p></li>
<li><p>Microsoft IIS</p></li>
<li><p>Windows AD</p></li>
<li><p>Windows AD FS</p></li>
</ul>
<p>For details on configuring these services, see <a class="reference external" href="https://technet.microsoft.com/library/c66c7f4b-6b8f-4e44-8331-63fa85f858c2">Microsoft KB c66c7f4b-6b8f-4e44-8331-63fa85f858c2</a>.</p>
</li>
<li><p>Install a signed SSL certificate for your AD FS login page and the fingerprint for that certificate.</p></li>
<li><p>Verify that all user objects in AD have an email address attribute. This is required to map AD users to Databricks users.</p></li>
<li><p>In Databricks, make a note of the SAML URL.</p>
<ol class="arabic simple">
<li><p>As a workspace admin, log in to the Databricks workspace.</p></li>
<li><p>Click your username in the top bar of the Databricks workspace and select <strong>Admin Settings</strong>.</p></li>
<li><p>Click on the <strong>Identity and access</strong> tab.</p></li>
<li><p>Next to <strong>SSO settings</strong>, click <strong>Manage</strong>.</p></li>
<li><p>Go to <strong>Single Sign On</strong>.</p></li>
<li><p>Copy the <strong>Databricks SAML URL</strong>.</p></li>
</ol>
</li>
</ul>
</div>
<div class="section" id="configure-ad-fs">
<h2>Configure AD FS<a class="headerlink" href="#configure-ad-fs" title="Permalink to this headline"> </a></h2>
<div class="contents local topic" id="in-this-section">
<p class="topic-title first">In this section:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#configure-the-ad-fs-federation-service" id="id1">Configure the AD FS Federation service</a></p></li>
<li><p><a class="reference internal" href="#configure-the-trust-relationship" id="id2">Configure the trust relationship</a></p></li>
<li><p><a class="reference internal" href="#add-transform-claim-rules" id="id3">Add transform claim rules</a></p></li>
<li><p><a class="reference internal" href="#change-signature-to-sha-256" id="id4">Change Signature to SHA-256</a></p></li>
<li><p><a class="reference internal" href="#copy-the-ad-fs-service-certificate" id="id5">Copy the AD FS service certificate</a></p></li>
<li><p><a class="reference internal" href="#required-configure-signing-of-the-saml-response" id="id6">(Required) Configure signing of the SAML response</a></p></li>
</ul>
</div>
<div class="section" id="configure-the-ad-fs-federation-service">
<h3><a class="toc-backref" href="#id1">Configure the AD FS Federation service</a><a class="headerlink" href="#configure-the-ad-fs-federation-service" title="Permalink to this headline"> </a></h3>
<ol class="arabic">
<li><p>Go to the AD FS management console.</p>
<div class="figure align-default">
<img alt="ActiveDirectory Federation Services Management console" src="../../../_images/windows-ad-4.png" />
</div>
</li>
<li><p>Click <strong>Edit Federation Service Properties</strong> on the right side action bar.</p></li>
<li><p>Verify that the federation service name and identifier both match the DNS entry for the environment. The following example doesn’t use a custom DNS entry:</p>
<div class="figure align-default">
<img alt="Edit Federation Service Properties" src="../../../_images/windows-ad-2.png" />
</div>
</li>
<li><p>Databricks uses SAML 2.0 as the standard authentication mechanism. To verify that your AD FS service supports SAML 2.0, go to <strong>AD FS &gt; Service &gt; Endpoints</strong> and confirm that the URL Path <code class="docutils literal notranslate"><span class="pre">/adfs/ls</span></code> exists.</p>
<div class="figure align-default">
<img alt="Confirm /adls/fs URL path" src="../../../_images/windows-ad-22.png" />
</div>
</li>
<li><p>The first time you configure AD FS to authenticate a client outside of your corporate intranet, you must enable Intranet Forms Authentication.</p>
<ol class="loweralpha simple">
<li><p>Go to <strong>AD FS Management application &gt; AD FS &gt; Authentication Policies &gt; Edit Global Authentication Policy</strong>.</p></li>
<li><p>Select Intranet Forms authentication.</p></li>
</ol>
<div class="figure align-default">
<img alt="Intranet Forms authentication" src="../../../_images/windows-ad-1.png" />
</div>
</li>
<li><p>To view the SSO page for your organization, go to <code class="docutils literal notranslate"><span class="pre">https://&lt;your-sso-domain&gt;.com/adfs/ls/idpinitiatedsignon</span></code>.</p></li>
</ol>
</div>
<div class="section" id="configure-the-trust-relationship">
<h3><a class="toc-backref" href="#id2">Configure the trust relationship</a><a class="headerlink" href="#configure-the-trust-relationship" title="Permalink to this headline"> </a></h3>
<p>To add Databricks as a relying party trust:</p>
<ol class="arabic">
<li><p>Go to <strong>AD FS &gt; Trust Relationships &gt; Relying Party Trusts</strong>.</p></li>
<li><p>Follow the instructions to <a class="reference external" href="https://learn.microsoft.com/powerapps/maker/portals/configure/configure-saml2-settings#create-an-ad-fs-relying-party-trust">create an AD FS relying party trust</a>.</p></li>
<li><p>Set <strong>Display name</strong> to <strong>Databricks</strong>.</p></li>
<li><p>If desired, enter information in <strong>Notes</strong>.</p></li>
<li><p>Click <strong>Next</strong>.</p></li>
<li><p>Click <strong>AD FS profile</strong>.</p>
<div class="figure align-default">
<img alt="Select AD FS profile" src="../../../_images/windows-ad-19.png" />
</div>
</li>
<li><p>Configure a certificate for encryption between AD FS and Databricks.</p>
<div class="figure align-default">
<img alt="Configure certificate" src="../../../_images/windows-ad-16.png" />
</div>
<ol class="loweralpha">
<li><p>Under <strong>Configure URL</strong>, click <strong>Enable support for the SAML 2.0 WebSSO protocol</strong>.</p></li>
<li><p>Enter the Databricks SAML URL you copied in <a class="reference internal" href="#requirements"><span class="std std-ref">Requirements</span></a>.</p>
<div class="figure align-default">
<img alt="Configure URL" src="../../../_images/windows-ad-24.png" />
</div>
</li>
<li><p>In <strong>Configure Identifiers</strong>, enter the Databricks SAML URL again.</p>
<div class="figure align-default">
<img alt="Configure Identifiers" src="../../../_images/windows-ad-25.png" />
</div>
</li>
<li><p>Click <strong>Add</strong> to add another identifier. Enter the Databricks workspace URL, such as <code class="docutils literal notranslate"><span class="pre">https://&lt;databricks-instance&gt;.cloud.databricks.com</span></code>.</p></li>
</ol>
</li>
<li><p>Next to <strong>Configure Multi-factor Authentication …</strong>, select <strong>I do not want to configure ….</strong></p>
<div class="figure align-default">
<img alt="Configure Multi-factor Authentication" src="../../../_images/windows-ad-10.png" />
</div>
</li>
<li><p>Under <strong>Choose Issuance Authorization Rules</strong>, select <strong>Permit all users to access this relying party</strong>. After the testing period, you can update this setting to selectively allow Active Directory groups or members to access Databricks.</p>
<div class="figure align-default">
<img alt="Choose Issuance Authorization Rules" src="../../../_images/windows-ad-13.png" />
</div>
<p>Click <strong>Next</strong>.</p>
</li>
<li><p>Review the configuration.</p>
<div class="figure align-default">
<img alt="Review configuration" src="../../../_images/windows-ad-11.png" />
</div>
</li>
<li><p>Leave <strong>Open the Edit Claim Rules …</strong> selected, then click <strong>Close</strong> to finish adding the relaying party trust.</p>
<div class="figure align-default">
<img alt="Complete add Relying party trust" src="../../../_images/windows-ad-9.png" />
</div>
<p>Keep this dialog open and continue to <a class="reference internal" href="#add-transform-claim-rules"><span class="std std-ref">Add transform claim rules</span></a>.</p>
</li>
</ol>
</div>
<div class="section" id="add-transform-claim-rules">
<h3><a class="toc-backref" href="#id3">Add transform claim rules</a><a class="headerlink" href="#add-transform-claim-rules" title="Permalink to this headline"> </a></h3>
<p>Claim rules in AD FS map user objects in Windows AD to users in Databricks. To create a claim rule to map users based on their email addresses:</p>
<ol class="arabic">
<li><p>If necessary, click <strong>Relaying Party Trusts</strong> and click <strong>Databricks</strong>.</p></li>
<li><p>In the right actions bar, click <strong>Edit Claim Rules</strong>, then click <strong>Add Rule</strong>.</p></li>
<li><p>Click  <strong>Send LDAP Attributes as Claims</strong>.</p>
<div class="figure align-default">
<img alt="Send LDAP Attributes as Claims" src="../../../_images/windows-ad-6.png" />
</div>
<ol class="loweralpha simple">
<li><p>Set the Claim Rule Name to <strong>Outgoing Databricks LDAP Email</strong>.</p></li>
<li><p>Set the Attribute Store to <strong>Active Directory</strong>.</p></li>
<li><p>Select the LDAP attribute used by your company for email addresses. The default is <strong>E-Mail Addresses</strong>. Map it to <strong>Name ID</strong> and <strong>E-Mail Address</strong>:</p></li>
</ol>
<div class="figure align-default">
<img alt="Configure claim rule name" src="../../../_images/windows-ad-23.png" />
</div>
</li>
<li><p>Click <strong>Finish</strong>.</p></li>
<li><p>Click <strong>Add Rule</strong> to add another rule.</p></li>
<li><p>Set <strong>Claim Rule Template</strong> to  <strong>Transform an Incoming Claim</strong>.</p>
<div class="figure align-default">
<img alt="Add rule" src="../../../_images/windows-ad-5.png" />
</div>
<ol class="loweralpha simple">
<li><p>Set <strong>Claim Rule Name</strong> to <strong>Incoming Databricks LDAP Email</strong>.</p></li>
<li><p>Set <strong>Incoming claim type</strong> to <strong>E-Mail Address</strong>.</p></li>
<li><p>Set <strong>Incoming name ID format</strong> to <strong>Unspecified</strong>.</p></li>
<li><p>Set <strong>Outgoing claim type</strong> to <strong>Name ID</strong>.</p></li>
<li><p>Set <strong>Outgoing name ID format</strong> to <strong>Email</strong>.</p></li>
</ol>
</li>
<li><p>Click <strong>Pass through all claim values</strong>.</p>
<div class="figure align-default">
<img alt="Pass through all claim values" src="../../../_images/windows-ad-7.png" />
</div>
</li>
<li><p>Click <strong>Finish</strong>.</p></li>
<li><p>Click <strong>Apply then Ok</strong> to return to the main screen.</p></li>
</ol>
</div>
<div class="section" id="change-signature-to-sha-256">
<h3><a class="toc-backref" href="#id4">Change Signature to SHA-256</a><a class="headerlink" href="#change-signature-to-sha-256" title="Permalink to this headline"> </a></h3>
<ol class="arabic">
<li><p>On the AD FS Relying Party Trusts screen, select <strong>Databricks</strong>.</p></li>
<li><p>Click <strong>Properties</strong> on the Action bar.</p>
<div class="figure align-default">
<img alt="Configure Databricks properties" src="../../../_images/windows-ad-20.png" />
</div>
</li>
<li><p>Go to the <strong>Advanced</strong> tab.</p></li>
<li><p>Set <strong>Secure hash algorithm</strong> to <strong>SHA-256</strong>.</p>
<div class="figure align-default">
<img alt="Set secure hash algorithm" src="../../../_images/windows-ad-3.png" />
</div>
</li>
</ol>
</div>
<div class="section" id="copy-the-ad-fs-service-certificate">
<span id="configure-databricks-for-single-sign-on"></span><h3><a class="toc-backref" href="#id5">Copy the AD FS service certificate</a><a class="headerlink" href="#copy-the-ad-fs-service-certificate" title="Permalink to this headline"> </a></h3>
<ol class="arabic simple">
<li><p>From the AD FS Management Console go to <strong>AD FS &gt; Service &gt; Certificates</strong>.</p></li>
<li><p>Find the Token-signing certificate. Click <strong>View Certificate</strong> in the action sidebar.
<img alt="View certificate" src="../../../_images/windows-ad-21.png" /></p>
<ol class="loweralpha simple">
<li><p>Click the <strong>Details</strong> tab.</p></li>
<li><p>Click <strong>Copy to File</strong>.</p></li>
<li><p>Choose <strong>Base-64 encoded X.509 (.CER)</strong> when prompted.</p></li>
<li><p>Open the file with Notepad or another text editor.</p></li>
<li><p>Copy the text between <code class="docutils literal notranslate"><span class="pre">-----BEGIN</span> <span class="pre">CERTIFICATE-----</span></code> and <code class="docutils literal notranslate"><span class="pre">-----END</span> <span class="pre">CERTIFICATE-----</span></code>.</p></li>
</ol>
</li>
</ol>
</div>
<div class="section" id="required-configure-signing-of-the-saml-response">
<h3><a class="toc-backref" href="#id6">(Required) Configure signing of the SAML response</a><a class="headerlink" href="#required-configure-signing-of-the-saml-response" title="Permalink to this headline"> </a></h3>
<p>To configure signing of the SAML response and the SAML assertion within it, use the following PowerShell command. If your relying party trust is not named <strong>Databricks</strong>, set <code class="docutils literal notranslate"><span class="pre">-TargetName</span></code> accordingly.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Set-ADFSRelyingPartyTrust -TargetName Databricks -SamlResponseSignature “MessageAndAssertion”
</pre></div>
</div>
<p>For more information about this requirement, see <a class="reference internal" href="index.html#signed-saml-response"><span class="std std-ref">Verify that the SAML response is signed</span></a>.</p>
</div>
</div>
<div class="section" id="configure-databricks">
<h2>Configure Databricks<a class="headerlink" href="#configure-databricks" title="Permalink to this headline"> </a></h2>
<p>As a Databricks administrator:</p>
<ol class="arabic">
<li><p>Go to the <a class="reference internal" href="../../index.html#admin-settings"><span class="std std-ref">admin settings page</span></a>, click the <strong>Identity and access</strong> tab.</p></li>
<li><p>Click <strong>Manage</strong> next to <strong>SSO settings</strong>.</p>
<div class="figure align-default">
<img alt="SSO tab" src="../../../_images/windows-ad-14.png" />
</div>
</li>
<li><p>Set <strong>Single Sign-On URL</strong> to <code class="docutils literal notranslate"><span class="pre">https://&lt;your-sso-domain&gt;.com/adfs/ls/</span></code>.</p></li>
<li><p>Set <strong>Identity Provider Entity ID</strong> to  <code class="docutils literal notranslate"><span class="pre">https://&lt;your-sso-domain&gt;.com/adfs/services/trust</span></code>.</p></li>
<li><p>Paste the  certificate from <a class="reference internal" href="#copy-the-ad-fs-service-certificate"><span class="std std-ref">Copy the AD FS service certificate</span></a> into the <strong>X.509 Certificate</strong> field.</p></li>
<li><p>Click <strong>Enable SSO</strong>.</p></li>
<li><p>Optionally, click <strong>Allow auto user creation</strong>.</p></li>
</ol>
</div>
<div class="section" id="test-the-configuration">
<h2>Test the configuration<a class="headerlink" href="#test-the-configuration" title="Permalink to this headline"> </a></h2>
<ol class="arabic simple">
<li><p>In an incognito browser window, go to your Databricks workspace.</p></li>
<li><p>Click <strong>Single Sign On</strong>. You are redirected to AD FS.</p></li>
<li><p>Enter your AD FS credentials. If SSO is configured correctly, you are redirected to Databricks.</p></li>
</ol>
<p>If the test fails, review <a class="reference internal" href="index.html#troubleshooting"><span class="std std-ref">Troubleshooting</span></a>.</p>
</div>
</div>


    
          </div>
        </div>
        <div  class="suapp-rating">
  <div id="suPageRateApp">
     <su-app></su-app>
   </div> 
 </div>
<hr> 
<footer>
  <div role="contentinfo">
      <p class="copyright">
          &copy; Databricks 2023. All rights reserved. Apache, Apache Spark, Spark, and the Spark logo are trademarks of the <a href="http://www.apache.org/">Apache Software Foundation</a>.
      </p>
      <p> 
        
          <a id='feedbacklink' href="mailto:doc-feedback@databricks.com?subject=Documentation Feedback">Send us feedback</a>
        
     | <a href="https://databricks.com/privacy-policy">Privacy Policy</a> | <a href="https://databricks.com/terms-of-use">Terms of Use</a></p>

  </div> 

</footer>
      </div>
    </div>
  </section>
</main>

  </page>
  
  <script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
      URL_ROOT: '../../../',
      VERSION: '1.0',
      COLLAPSE_INDEX: false,
      FILE_SUFFIX: '.html',
      HAS_SOURCE: 'false'
    };
  </script>
  <script type="text/javascript" src="../../../_static/jquery.js"></script>
  <script type="text/javascript" src="../../../_static/underscore.js"></script>
  <script type="text/javascript" src="../../../_static/doctools.js"></script>
  <script type="text/javascript" src="../../../_static/language_data.js"></script>
  

  <script type="text/javascript" src="../../../_static/js/clipboard.min.js"></script>
  <script type="text/javascript" src="../../../_static/js/jquery.waypoints.min.js"></script>

  <!-- Select2 (https://select2.org/) -->
  <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
  <!-- End Select2 -->

  
  
  <script type="text/javascript" src="../../../_static/js/localized.js"></script>
  <script type="text/javascript" src="../../../_static/js/custom.js"></script>
  

  
  
  <script type="text/javascript">
    jQuery(function () {
      SphinxRtdTheme.StickyNav.enable();
    });

  </script>
  
 



  <script>
  window.__searchunifyLoaderConfig = JSON.parse('{"clients": {"en": "02c2e804-27e9-11ee-aefb-0242ac120011", "ja": "6a42c3f2-2820-11ee-aefb-0242ac120011", "pt": "6a86badd-2821-11ee-aefb-0242ac120011"}}')
</script>
<script type="text/javascript" src="../../../_static/js/search-loader.js"></script>
</body>
<script type='text/javascript'>
  window.onload = function () {
    var description = document.querySelector('meta[name="description"]').getAttribute("content");
    let titleText = document.querySelector('h1').textContent;
    document.querySelector('meta[property="og:title"]').setAttribute("content", titleText);
    document.querySelector('meta[property="og:description"]').setAttribute("content", description);
    document.querySelector('meta[property="twitter:description"]').setAttribute("content", description);
  };
</script>

</html>