

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en-US" > <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en-US"> <!--<![endif]-->

<head>
  <!-- cookie consent -->
  
    <!-- Combined Onetrust and Rudderstack Implementation Scripts -->
    <!-- Onetrust Initialization -->
    <script type="text/javascript" src="https://cdn.cookielaw.org/consent/92466579-1717-44d3-809d-a05fb02843ed-test/OtAutoBlock.js"></script>
    <script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" data-document-language="true" type="text/javascript" charset="UTF-8" data-domain-script="92466579-1717-44d3-809d-a05fb02843ed-test"></script>
    <link rel="stylesheet" id="db-onetrust-style" href="https://www.databricks.com/wp-content/uploads/db_onetrust.css" media="all" />
    <!-- Setting Rudderstack Write Key -->
    <script>window.rudderstackKey = "2SOR9fvSr5Fi6tN2ihPbVHnX1SZ" </script>
    <!-- Rudderstack Initialization + Onetrust Integration + Rudderstack Custom Events -->
    <script type="text/javascript" src="https://www.databricks.com/sites/default/files/rudderstack/v1/db-rudderstack-events.js"></script>

  <!-- cookie consent -->

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="X-UA-Compatible" content="IE=9" />
  <meta content="Learn how to use service principals with CI/CD for Databricks projects." name="description" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
  <meta property="og:image" content="https://www.databricks.com/wp-content/uploads/2020/04/og-databricks.png">
  <meta property="og:image:type" content="image/png">
  <meta property="og:title" content="Service principals for CI/CD">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://docs.databricks.com">
  <meta property="og:description" content="" id="og-description">
  <meta name="twitter:image" content="https://www.databricks.com/wp-content/uploads/2020/04/og-databricks.png">
  <meta name="twitter:site" content="@databricks">
  <meta name="twitter:creator" content="@databricks">
  <meta property="twitter:description" content="">
  
  <title>Service principals for CI/CD &#124; Databricks on AWS</title>
  
  
  <link rel="canonical" href="https://docs.databricks.com/en/dev-tools/ci-cd/ci-cd-sp.html">
  <!-- Start hreflang tag -->
  <link rel="alternate" hreflang="en" href="https://docs.databricks.com/en/dev-tools/ci-cd/ci-cd-sp.html" />
<link rel="alternate" hreflang="x-default" href="https://docs.databricks.com/en/dev-tools/ci-cd/ci-cd-sp.html" />
  <!-- End hreflang tag -->
  
  
  <link rel="shortcut icon" href="../../_static/favicon.ico" />
  

  

  

  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;
j.setAttributeNode(d.createAttribute('data-ot-ignore'));
f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-T85FQ33');</script>
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;
j.setAttributeNode(d.createAttribute('data-ot-ignore'));
f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-TWTKQQ');</script>
    
  <!-- End Google Tag Manager -->


  <!-- MaxMind / GEO IP -->
  <script src="//js.maxmind.com/js/apis/geoip2/v2.1/geoip2.js" type="text/javascript"></script>
  <!-- End MaxMind / GEO IP -->

  
  
  <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600&display=swap" rel="stylesheet">
  <link rel="preload" href="../../_static/fonts/DMSans-Bold.ttf" as="font">
  <link rel="preload" href="../../_static/fonts/DMSans-Regular.ttf" as="font">
  <link rel="preload" href="../../_static/fonts/DMMono-Regular.ttf" as="font">
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/cloud-provider-selector.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/translation-selector.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/searchunify/main.css" type="text/css" />

  
  <link rel="index" title="Index" href="../../genindex.html" />
  <link rel="search" title="Search" href="../../search.html" />
  <link rel="top" title="Databricks on AWS" href="../../index.html" /> 
</head>

<body class="wy-body-for-nav" role="document">

  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T85FQ33"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TWTKQQ"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->

  
  <nav class="wy-nav-top header su_header" role="navigation" aria-label="top navigation">
    
<nav class="wy-nav-top header su_header" role="navigation" aria-label="top navigation">
  <div class="container-logo">
    <ul class="mobile-menu-toggle">
        <li class="menu-toggle">
            <i data-toggle="wy-nav-top" class="wy-nav-top-menu-button db-icon db-icon-menu pull-left"></i>
            
            <a href="https://www.databricks.com/" class="wy-nav-top-logo"><img src="../../_static/small-scale-lockup-full-color-rgb.svg" width="137" height="21"
              alt="Databricks" /></a>   
               
              </li>
    </ul>
    <ul class="su_nav-menu">
      <li class="menu-toggle">
        <i data-toggle="wy-nav-top" class="wy-nav-top-menu-button db-icon db-icon-menu pull-left"></i>
        
          
        
        <a href="https://www.databricks.com/" class="wy-nav-top-logo"><img src="../../_static/small-scale-lockup-full-color-rgb.svg" width="137" height="21"
            alt="Databricks" /></a></li>
        <!-- 
<li><a href="https://help.databricks.com/s/">Help Center</a></li>
<li class="active"><a href="https://docs.databricks.com/en/">Documentation</a></li>
<li><a href="https://kb.databricks.com/">Knowledge Base</a></li>
 -->
    </ul>
  </div>
  <div class="su_nav-right">
    <ul class="su_link-mobile">
  <!-- Mobile header code can go here -->
</ul>
<ul class="right-try-list">
   
</ul>
  </div>
</nav>
  </nav>

  <div class="su_sub-header">
    <div class="container">
      <div class="su_sub-header-inner">
        <!-- <div class="su_subnav-menu-right">
  <div id="auto" style="width: 100%;">
    <div ng-controller="SearchautoController">
      <div bind-html-compile="autocompleteHtml">
        <form class="su__search-box-1" disabled="disabled">
          <input class="su__search-input" type="search" name="Search box" id="su__search-b" placeholder="Search Documentation" disabled="disabled"/>
          <button class="su__search-button" type="submit" class="button button-success" disabled="disabled">
            <svg width="24" height="24" viewBox="0 0 24 24">
              <path
                d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"
                fill="#333"></path>
            </svg>
          </button>
        </form>
      </div>
    </div>
  </div>
</div> -->
        <div class="search-lng-gap"></div>
        <div style="margin-left: 16px; margin-right: 16px;">
          <!-- <select name="lng selector" id="lng-selector">
    <option value="../../../en/dev-tools/ci-cd/ci-cd-sp.html" class="notranslate">English</option>
    <option value="../../../ja/dev-tools/ci-cd/ci-cd-sp.html" class="notranslate">日本語</option>
    <option value="../../../pt/dev-tools/ci-cd/ci-cd-sp.html" class="notranslate">Português (Brasil)</option>
</select> -->
        </div>
        <div class="cloud-selector-container">
          <!-- <select name="cloud provider selector" id="cloud-provider-selector">
    <option value="aws" selected class="notranslate">
        Amazon Web Services
    </option>
    <option value="azure"  class="notranslate">
        Microsoft Azure
    </option>
    <option value="gcp"  class="notranslate">
        Google Cloud Platform
    </option>
</select> -->
        </div>
      </div>
    </div>
  </div>
  <page class="js-page-container">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side su_nav-side">
<div class="wy-side-scroll">
  <div class="wy-side-nav-search">
    

    

    

    
  </div>

  <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
    
      <a href="../../index.html" class="main-navigation-home">Databricks on AWS</a>
    

    
      

      
        <p class="caption"><span class="caption-text">Load &amp; manage data</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../rag-temp/index.html">RAG Studio</a></li>
</ul>

      
    
  </div>

  <div role="contentinfo">
    
  <p class="build_info notranslate"data-last-edit="December 23, 2023">
    Updated Jan 11, 2024
  </p>
<script>
  window.addEventListener('DOMContentLoaded',function(){
    var h1=document.querySelector('h1');
    var bi=document.querySelector('[data-last-edit]');
    if(h1 && bi){
      var ver = document.createElement('p');
      ver.className = 'version_info';
      ver.textContent = bi.getAttribute('data-last-edit');
      h1.parentElement.insertBefore(ver, h1.nextElementSibling);
    }
  });
</script>

    <p>
      
        <a id='feedbacklink' href="mailto:doc-feedback@databricks.com?subject=Documentation Feedback">Send us feedback</a>
      
    </p>
  </div>
</div>
</nav>
    
    
<main class="wy-grid-for-nav su_nav-grid">
  <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
    <div class="wy-nav-content su__nav_content">
      <div class="rst-content">
        





<div role="navigation" aria-label="breadcrumbs navigation" class="wy-breadcrumbs-wrapper">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Documentation</a> <span class="db-icon db-icon-chevron-right"></span></li>
    
    
      <li>Service principals for CI/CD</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>
</div>
        
        <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
          <div itemprop="articleBody">
            
    
  <div class="section" id="service-principals-for-cicd">
<h1>Service principals for CI/CD<a class="headerlink" href="#service-principals-for-cicd" title="Permalink to this headline"> </a></h1>
<p>This article describes how to use service principals for CI/CD with Databricks. A <a class="reference internal" href="../../administration-guide/users-groups/service-principals.html"><span class="doc">service principal</span></a> is an identity created for use with automated tools and applications, including:</p>
<ul class="simple">
<li><p>CI/CD platforms such as <a class="reference external" href="https://github.com/features/actions">GitHub Actions</a>, <a class="reference external" href="https://azure.microsoft.com/services/devops/pipelines/">Azure Pipelines</a>, and <a class="reference external" href="https://docs.gitlab.com/ee/ci/">GitLab CI/CD</a></p></li>
<li><p><a class="reference internal" href="../../workflows/jobs/how-to/use-airflow-with-jobs.html"><span class="doc">Airflow</span></a> in data pipelines</p></li>
<li><p><a class="reference internal" href="ci-cd-jenkins.html"><span class="doc">Jenkins</span></a></p></li>
</ul>
<p>As a security best practice, Databricks recommends using a Databricks service principal and its token instead of your Databricks user or your Databricks personal access token for your workspace user to give CI/CD platforms access to Databricks resources. Some benefits to this approach include the following:</p>
<ul class="simple">
<li><p>You can grant and restrict access to Databricks resources for a Databricks service principal independently of a user. For instance, this allows you to prohibit a Databricks service principal from acting as an admin in your Databricks workspace while still allowing other specific users in your workspace to continue to act as admins.</p></li>
<li><p>Users can safeguard their access tokens from being accessed by CI/CD platforms.</p></li>
<li><p>You can temporarily disable or permanently delete a Databricks service principal without impacting other users. For instance, this allows you to pause or remove access from a Databricks service principal that you suspect is being used in a malicious way.</p></li>
<li><p>If a user leaves your organization, you can remove that user without impacting any Databricks service principal.</p></li>
</ul>
<p>To give a CI/CD platform access to your Databricks workspace, do the following:</p>
<ol class="arabic simple">
<li><p>Create a Databricks service principal in your workspace.</p></li>
<li><p>Generate a Databricks access token for a Databricks service principal.</p></li>
<li><p>Give this Databricks access token to the CI/CD platform.</p></li>
</ol>
<p>To complete Steps 1 and 2, see <a class="reference internal" href="../../administration-guide/users-groups/service-principals.html"><span class="doc">Manage service principals</span></a>.</p>
<p>To complete Step 3, complete the instructions in this article.</p>
<p>Optionally, if you also want to use your Databricks workspace with Databricks <a class="reference internal" href="../../repos/index.html"><span class="doc">Repos</span></a> in a CI/CD platform scenario, see <a class="reference internal" href="#add-creds-to-ws"><span class="std std-ref">Add Git provider credentials to a Databricks workspace</span></a>. For example, you may want your Git provider to access your workspace, and you also want to use Databricks Repos in your workspace with your Git provider. However, you don’t need to use Databricks Repos in order to use your workspace with CI/CD platforms.</p>
<div class="section" id="requirements">
<h2>Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline"> </a></h2>
<ul class="simple">
<li><p>The Databricks access token for a Databricks service principal. To create a Databricks service principal and its Databricks access token, see <a class="reference internal" href="../../administration-guide/users-groups/service-principals.html"><span class="doc">Manage service principals</span></a>.</p></li>
<li><p>An account with your Git provider.</p></li>
</ul>
</div>
<div class="section" id="set-up-github-actions">
<h2>Set up GitHub Actions<a class="headerlink" href="#set-up-github-actions" title="Permalink to this headline"> </a></h2>
<p><a class="reference external" href="https://docs.github.com/en/actions">GitHub Actions</a> must be able to access your Databricks workspace. If you want to use Databricks <a class="reference internal" href="../../repos/index.html"><span class="doc">Repos</span></a>, your workspace must also be able to access GitHub.</p>
<p>To enable GitHub Actions to access your Databricks workspace, you must register the Databricks access token for your Databricks service principal with GitHub Actions.</p>
<p>If you also want to enable your Databricks workspace to access GitHub when you use Databricks <a class="reference internal" href="../../repos/index.html"><span class="doc">Repos</span></a>, you must add the GitHub personal access token for a GitHub machine user to your workspace.</p>
<div class="section" id="register-the-databricks-access-token-for-your-databricks-service-principal-with-github-actions">
<span id="register-the-access-token-sp-for-your-service-principal-with-github-actions"></span><h3>Register the Databricks access token for your Databricks service principal with GitHub Actions<a class="headerlink" href="#register-the-databricks-access-token-for-your-databricks-service-principal-with-github-actions" title="Permalink to this headline"> </a></h3>
<p>This section describes how to enable GitHub Actions to access your Databricks workspace.</p>
<p>As a security best practice, Databricks recommends that you do not enter a Databricks access token directly into the body of a GitHub Actions file. You should register the Databricks access token with GitHub Actions by using GitHub <a class="reference external" href="https://docs.github.com/en/actions/security-guides/encrypted-secrets">encrypted secrets</a> instead.</p>
<p>GitHub Actions, such as the ones that Databricks lists in <a class="reference internal" href="ci-cd-github.html"><span class="doc">Continuous integration and delivery using GitHub Actions</span></a>, as well as the <code class="docutils literal notranslate"><span class="pre">onpush.yml</span></code> and <code class="docutils literal notranslate"><span class="pre">onrelease.yml</span></code> files as part of the <a class="reference external" href="https://dbx.readthedocs.io/en/latest/guides/general/custom_templates/#default-templates">Basic Python Template</a> in <code class="docutils literal notranslate"><span class="pre">dbx</span></code> for GitHub Actions, rely on GitHub encrypted secrets such as:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">DATABRICKS_HOST</span></code>, which is the value <code class="docutils literal notranslate"><span class="pre">https://</span></code> followed by your <a class="reference internal" href="../../workspace/workspace-details.html#workspace-url"><span class="std std-ref">workspace instance name</span></a>, for example <code class="docutils literal notranslate"><span class="pre">dbc-a1b2345c-d6e7.cloud.databricks.com</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">DATABRICKS_TOKEN</span></code>, which is the value of the <code class="docutils literal notranslate"><span class="pre">token_value</span></code> value that you copied after you created the Databricks access token for the Databricks service principal.</p></li>
</ul>
</div>
<p>For more information about which GitHub encrypted secrets are required for a GitHub Action, see <a class="reference internal" href="../../administration-guide/users-groups/service-principals.html"><span class="doc">Manage service principals</span></a> and the documentation for that GitHub Action.</p>
<p>To add these GitHub encrypted secrets to your GitHub repository, see <a class="reference external" href="https://docs.github.com/en/actions/security-guides/encrypted-secrets#creating-encrypted-secrets-for-a-repository">Creating encrypted secrets for a repository</a> in the GitHub documentation. For other approaches to add these GitHub repository secrets, see <a class="reference external" href="https://docs.github.com/en/actions/security-guides/encrypted-secrets">Encrypted secrets</a> in the GitHub documentation.</p>
<div class="section" id="add-the-github-personal-access-token-for-a-github-machine-user-to-your-databricks-workspace">
<h3>Add the GitHub personal access token for a GitHub machine user to your Databricks workspace<a class="headerlink" href="#add-the-github-personal-access-token-for-a-github-machine-user-to-your-databricks-workspace" title="Permalink to this headline"> </a></h3>
<p>This section describes how to enable your Databricks workspace to access GitHub with Databricks <a class="reference internal" href="../../repos/index.html"><span class="doc">Repos</span></a>. This is an optional task in CI/CD scenarios.</p>
<p>As a security best practice, Databricks recommends that you use GitHub machine users instead of GitHub personal accounts, for many of the same reasons that you should use a Databricks service principal instead of a Databricks user. To add the GitHub personal access token for a GitHub machine user to your Databricks workspace, do the following:</p>
<ol class="arabic">
<li><p>Create a GitHub machine user, if you do not already have one available. A GitHub <em>machine user</em> is a GitHub personal account, separate from your own GitHub personal account, that you can use to automate activity on GitHub. <a class="reference external" href="https://docs.github.com/en/get-started/signing-up-for-github/signing-up-for-a-new-github-account">Create a new separate GitHub account</a> to use as a GitHub machine user, if you do not already have one available.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When you create a new separate GitHub account as a GitHub machine user, you cannot associate it with the email address for your own GitHub personal account. Instead, see your organization’s email administrator about getting a separate email address that you can associate with this new separate GitHub account as a GitHub machine user.</p>
<p>See your organization’s account administrator about managing the separate email address and its associated GitHub machine user and its GitHub personal access tokens within your organization.</p>
</div>
</li>
<li><p>Give the GitHub machine user access to your GitHub repository. See <a class="reference external" href="https://docs.github.com/en/repositories/managing-your-repositorys-settings-and-features/managing-repository-settings/managing-teams-and-people-with-access-to-your-repository#inviting-a-team-or-person">Inviting a team or person</a> in the GitHub documentation. To accept the invitation, you may first need to sign out of your GitHub personal account, and then sign back in as the GitHub machine user.</p></li>
<li><p>Sign in to GitHub as the machine user, and then create a GitHub personal access token for that machine user. See <a class="reference external" href="https://docs.github.com/en/enterprise-server&#64;3.4/authentication/keeping-your-account-and-data-secure/creating-a-personal-access-token">Create a personal access token</a> in the GitHub documentation. Be sure to give the GitHub personal access token <strong>repo</strong> access.</p></li>
<li><p>Gather the Databricks access token for your Databricks service principal, your GitHub machine username, and then <a class="reference internal" href="#add-creds-to-ws"><span class="std std-ref">Add Git provider credentials to a Databricks workspace</span></a>.</p></li>
</ol>
</div>
</div>
<div class="section" id="set-up-azure-pipelines">
<h2>Set up Azure Pipelines<a class="headerlink" href="#set-up-azure-pipelines" title="Permalink to this headline"> </a></h2>
<p><a class="reference external" href="https://azure.microsoft.com/services/devops/pipelines/">Azure Pipelines</a> must be able to access your Databricks workspace. If you also want to use Databricks <a class="reference internal" href="../../repos/index.html"><span class="doc">Repos</span></a>, your workspace must be able to access Azure Pipelines.</p>
<p>Azure Pipelines YAML pipeline files rely on environment variables to access your Databricks workspace.  These environment variables include ones such as:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">DATABRICKS_HOST</span></code>, which is the value <code class="docutils literal notranslate"><span class="pre">https://</span></code> followed by your <a class="reference internal" href="../../workspace/workspace-details.html#workspace-url"><span class="std std-ref">workspace instance name</span></a>, for example <code class="docutils literal notranslate"><span class="pre">dbc-a1b2345c-d6e7.cloud.databricks.com</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">DATABRICKS_TOKEN</span></code>, which is the value of the <code class="docutils literal notranslate"><span class="pre">token_value</span></code> value that you copied after you created the Databricks access token for the Databricks service principal.</p></li>
</ul>
<p>To add these environment variables to your Azure pipeline, see <a class="reference external" href="https://learn.microsoft.com/azure/devops/pipelines/release/azure-key-vault">Use Azure Key Value secrets in Azure Pipelines</a> and <a class="reference external" href="https://learn.microsoft.com/azure/devops/pipelines/process/variables#secret-variables">Set secret variables</a> in the Azure documentation.</p>
<p>See also the following Databricks blog:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://databricks.com/blog/2021/09/20/part-1-implementing-ci-cd-on-databricks-using-databricks-notebooks-and-azure-devops.html">Implementing CI/CD on Databricks Using Databricks Notebooks and Azure DevOps</a></p></li>
</ul>
<p>Optional for CI/CD scenarios: If your workspace uses Databricks <a class="reference internal" href="../../repos/index.html"><span class="doc">Repos</span></a>, and you want to enable your workspace to access Azure Pipelines, gather:</p>
<ul class="simple">
<li><p>The Databricks access token for your Databricks service principal</p></li>
<li><p>Your Azure Pipelines username</p></li>
</ul>
<p>Then, <a class="reference internal" href="#add-creds-to-ws"><span class="std std-ref">Add Git provider credentials to a Databricks workspace</span></a>.</p>
</div>
<div class="section" id="set-up-gitlab-cicd">
<h2>Set up GitLab CI/CD<a class="headerlink" href="#set-up-gitlab-cicd" title="Permalink to this headline"> </a></h2>
<p><a class="reference external" href="https://docs.gitlab.com/ee/ci/">GitLab CI/CD</a> must be able to access your Databricks workspace. If you also want to use Databricks <a class="reference internal" href="../../repos/index.html"><span class="doc">Repos</span></a>, your workspace must be able to access GitLab CI/CD.</p>
<p>To access your Databricks workspace, GitLab CI/CD <code class="docutils literal notranslate"><span class="pre">.gitlab-ci.yml</span></code> files, such as the one as part of the <a class="reference external" href="https://dbx.readthedocs.io/en/latest/guides/general/custom_templates/#default-templates">Basic Python Template</a> in <code class="docutils literal notranslate"><span class="pre">dbx</span></code>, rely on custom CI/CD variables such as:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">DATABRICKS_HOST</span></code>, which is the value <code class="docutils literal notranslate"><span class="pre">https://</span></code> followed by your <a class="reference internal" href="../../workspace/workspace-details.html#workspace-url"><span class="std std-ref">workspace instance name</span></a>, for example <code class="docutils literal notranslate"><span class="pre">dbc-a1b2345c-d6e7.cloud.databricks.com</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">DATABRICKS_TOKEN</span></code>, which is the value of the <code class="docutils literal notranslate"><span class="pre">token_value</span></code> value that you copied after you created the Databricks access token for the Databricks service principal.</p></li>
</ul>
<p>To add these custom variables to your GitLab CI/CD project, see <a class="reference external" href="https://docs.gitlab.com/ee/ci/variables/#add-a-cicd-variable-to-a-project">Add a CI/CD variable to a project</a> in the GitLab CI/CD documentation.</p>
<p>If your workspace uses Databricks <a class="reference internal" href="../../repos/index.html"><span class="doc">Repos</span></a>, and you want to enable your workspace to access GitLab CI/CD, gather:</p>
<ul class="simple">
<li><p>The Databricks access token for your Databricks service principal</p></li>
<li><p>Your GitLab CI/CD username</p></li>
</ul>
<p>Then <a class="reference internal" href="#add-creds-to-ws"><span class="std std-ref">Add Git provider credentials to a Databricks workspace</span></a>.</p>
</div>
<div class="section" id="add-git-provider-credentials-to-a-databricks-workspace">
<span id="add-creds-to-ws"></span><h2>Add Git provider credentials to a Databricks workspace<a class="headerlink" href="#add-git-provider-credentials-to-a-databricks-workspace" title="Permalink to this headline"> </a></h2>
<p>This section describes how to enable your Databricks workspace to access a Git provider for Databricks <a class="reference internal" href="../../repos/index.html"><span class="doc">Repos</span></a>. This is optional in CI/CD scenarios. For example, you may only want your Git provider to access your Databricks workspace, but you do not also want to use Databricks Repos in your workspace with your Git provider. If so, then skip this section.</p>
<p>Before you begin, gather the following information and tools:</p>
<ul class="simple">
<li><p>The Databricks access token for your Databricks service principal.</p></li>
<li><p>The username associated with your Git provider.</p></li>
<li><p>The access token associated with the user for your Git provider.</p></li>
</ul>
<ul class="simple">
<li><p>Databricks CLI version 0.205 or above. See <a class="reference internal" href="../cli/index.html"><span class="doc">What is the Databricks CLI?</span></a>. You cannot use the Databricks user interface.</p></li>
<li><p>A Databricks configuration profile in your <code class="docutils literal notranslate"><span class="pre">.databrickscfg</span></code> file, with the profile’s fields set correctly for the related <code class="docutils literal notranslate"><span class="pre">host</span></code> representing your Databricks <a class="reference internal" href="../../workspace/workspace-details.html#workspace-url"><span class="std std-ref">workspace instance URL</span></a>, for example <code class="docutils literal notranslate"><span class="pre">https://dbc-a1b2345c-d6e7.cloud.databricks.com</span></code>, and <code class="docutils literal notranslate"><span class="pre">token</span></code> representing the Databricks access token for your Databricks service principal. (Do <em>not</em> use the Databricks personal access token for your workspace user.) See <a class="reference internal" href="../cli/authentication.html#token-auth"><span class="std std-ref">Databricks personal access token authentication</span></a>.</p></li>
</ul>
<p>Use the Databricks CLI to run the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>databricks<span class="w"> </span>git-credentials<span class="w"> </span>create<span class="w"> </span>&lt;git-provider-short-name&gt;<span class="w"> </span>--git-username<span class="w"> </span>&lt;git-provider-user-name&gt;<span class="w"> </span>--personal-access-token<span class="w"> </span>&lt;git-provider-access-token&gt;<span class="w"> </span>-p<span class="w"> </span>&lt;profile-name&gt;
</pre></div>
</div>
<ul class="simple">
<li><p>Use one of the following for <code class="docutils literal notranslate"><span class="pre">&lt;git-provider-short-name&gt;</span></code>:</p>
<ul>
<li><p>For GitHub, use <code class="docutils literal notranslate"><span class="pre">GitHub</span></code>.</p></li>
<li><p>For Azure Pipelines, use <code class="docutils literal notranslate"><span class="pre">AzureDevOpsServices</span></code>.</p></li>
<li><p>For GitLab CI/CD, use <code class="docutils literal notranslate"><span class="pre">GitLab</span></code>.</p></li>
</ul>
</li>
<li><p>Replace <code class="docutils literal notranslate"><span class="pre">&lt;git-provider-user-name&gt;</span></code> with the username associated with your Git provider.</p></li>
<li><p>Replace <code class="docutils literal notranslate"><span class="pre">&lt;git-provider-access-token&gt;</span></code> with the access token associated with the user for your Git provider.</p></li>
<li><p>Replace <code class="docutils literal notranslate"><span class="pre">&lt;profile-name&gt;</span></code> with the name of the Databricks configuration profile in your <code class="docutils literal notranslate"><span class="pre">.databrickscfg</span></code> file.</p></li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>To confirm that the call was successful, you can run one of the following Databricks CLI commands, and review the output:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>databricks<span class="w"> </span>git-credentials<span class="w"> </span>list<span class="w"> </span>-p<span class="w"> </span>&lt;profile-name&gt;
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>databricks<span class="w"> </span>git-credentials<span class="w"> </span>get<span class="w"> </span>&lt;credential-id&gt;<span class="w"> </span>-p<span class="w"> </span>&lt;profile-name&gt;
</pre></div>
</div>
</div>
</div>
</div>


    
          </div>
        </div>
        <div  class="suapp-rating">
  <div id="suPageRateApp">
     <su-app></su-app>
   </div> 
 </div>
<hr> 
<footer>
  <div role="contentinfo">
      <p class="copyright">
          &copy; Databricks 2023. All rights reserved. Apache, Apache Spark, Spark, and the Spark logo are trademarks of the <a href="http://www.apache.org/">Apache Software Foundation</a>.
      </p>
      <p> 
        
          <a id='feedbacklink' href="mailto:doc-feedback@databricks.com?subject=Documentation Feedback">Send us feedback</a>
        
     | <a href="https://databricks.com/privacy-policy">Privacy Policy</a> | <a href="https://databricks.com/terms-of-use">Terms of Use</a></p>

  </div> 

</footer>
      </div>
    </div>
  </section>
</main>

  </page>
  
  <script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
      URL_ROOT: '../../',
      VERSION: '1.0',
      COLLAPSE_INDEX: false,
      FILE_SUFFIX: '.html',
      HAS_SOURCE: 'false'
    };
  </script>
  <script type="text/javascript" src="../../_static/jquery.js"></script>
  <script type="text/javascript" src="../../_static/underscore.js"></script>
  <script type="text/javascript" src="../../_static/doctools.js"></script>
  <script type="text/javascript" src="../../_static/language_data.js"></script>
  

  <script type="text/javascript" src="../../_static/js/clipboard.min.js"></script>
  <script type="text/javascript" src="../../_static/js/jquery.waypoints.min.js"></script>

  <!-- Select2 (https://select2.org/) -->
  <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
  <!-- End Select2 -->

  
  
  <script type="text/javascript" src="../../_static/js/localized.js"></script>
  <script type="text/javascript" src="../../_static/js/custom.js"></script>
  

  
  
  <script type="text/javascript">
    jQuery(function () {
      SphinxRtdTheme.StickyNav.enable();
    });

  </script>
  
 



  <script>
  window.__searchunifyLoaderConfig = JSON.parse('{"clients": {"en": "02c2e804-27e9-11ee-aefb-0242ac120011", "ja": "6a42c3f2-2820-11ee-aefb-0242ac120011", "pt": "6a86badd-2821-11ee-aefb-0242ac120011"}}')
</script>
<script type="text/javascript" src="../../_static/js/search-loader.js"></script>
</body>
<script type='text/javascript'>
  window.onload = function () {
    var description = document.querySelector('meta[name="description"]').getAttribute("content");
    let titleText = document.querySelector('h1').textContent;
    document.querySelector('meta[property="og:title"]').setAttribute("content", titleText);
    document.querySelector('meta[property="og:description"]').setAttribute("content", description);
    document.querySelector('meta[property="twitter:description"]').setAttribute("content", description);
  };
</script>

</html>