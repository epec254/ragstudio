

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en-US" > <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en-US"> <!--<![endif]-->

<head>
  <!-- cookie consent -->
  
    <!-- Combined Onetrust and Rudderstack Implementation Scripts -->
    <!-- Onetrust Initialization -->
    <script type="text/javascript" src="https://cdn.cookielaw.org/consent/92466579-1717-44d3-809d-a05fb02843ed-test/OtAutoBlock.js"></script>
    <script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" data-document-language="true" type="text/javascript" charset="UTF-8" data-domain-script="92466579-1717-44d3-809d-a05fb02843ed-test"></script>
    <link rel="stylesheet" id="db-onetrust-style" href="https://www.databricks.com/wp-content/uploads/db_onetrust.css" media="all" />
    <!-- Setting Rudderstack Write Key -->
    <script>window.rudderstackKey = "2SOR9fvSr5Fi6tN2ihPbVHnX1SZ" </script>
    <!-- Rudderstack Initialization + Onetrust Integration + Rudderstack Custom Events -->
    <script type="text/javascript" src="https://www.databricks.com/sites/default/files/rudderstack/v1/db-rudderstack-events.js"></script>

  <!-- cookie consent -->

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="X-UA-Compatible" content="IE=9" />
  <meta content="Learn how to install Databricks Connect for Python. Databricks Connect allows you to connect popular IDEs and other custom applications to Databricks clusters." name="description" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
  <meta property="og:image" content="https://www.databricks.com/wp-content/uploads/2020/04/og-databricks.png">
  <meta property="og:image:type" content="image/png">
  <meta property="og:title" content="Install Databricks Connect for Python">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://docs.databricks.com">
  <meta property="og:description" content="" id="og-description">
  <meta name="twitter:image" content="https://www.databricks.com/wp-content/uploads/2020/04/og-databricks.png">
  <meta name="twitter:site" content="@databricks">
  <meta name="twitter:creator" content="@databricks">
  <meta property="twitter:description" content="">
  
  <title>Install Databricks Connect for Python &#124; Databricks on AWS</title>
  
  
  <link rel="canonical" href="https://docs.databricks.com/en/dev-tools/databricks-connect/python/install.html">
  <!-- Start hreflang tag -->
  <link rel="alternate" hreflang="en" href="https://docs.databricks.com/en/dev-tools/databricks-connect/python/install.html" />
<link rel="alternate" hreflang="x-default" href="https://docs.databricks.com/en/dev-tools/databricks-connect/python/install.html" />
  <!-- End hreflang tag -->
  
  
  <link rel="shortcut icon" href="../../../_static/favicon.ico" />
  

  

  

  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;
j.setAttributeNode(d.createAttribute('data-ot-ignore'));
f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-T85FQ33');</script>
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;
j.setAttributeNode(d.createAttribute('data-ot-ignore'));
f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-TWTKQQ');</script>
    
  <!-- End Google Tag Manager -->


  <!-- MaxMind / GEO IP -->
  <script src="//js.maxmind.com/js/apis/geoip2/v2.1/geoip2.js" type="text/javascript"></script>
  <!-- End MaxMind / GEO IP -->

  
  
  <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600&display=swap" rel="stylesheet">
  <link rel="preload" href="../../../_static/fonts/DMSans-Bold.ttf" as="font">
  <link rel="preload" href="../../../_static/fonts/DMSans-Regular.ttf" as="font">
  <link rel="preload" href="../../../_static/fonts/DMMono-Regular.ttf" as="font">
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/css/custom.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/css/cloud-provider-selector.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/css/translation-selector.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/css/searchunify/main.css" type="text/css" />

  
  <link rel="index" title="Index" href="../../../genindex.html" />
  <link rel="search" title="Search" href="../../../search.html" />
  <link rel="top" title="Databricks on AWS" href="../../../index.html" /> 
</head>

<body class="wy-body-for-nav" role="document">

  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T85FQ33"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TWTKQQ"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->

  
  <nav class="wy-nav-top header su_header" role="navigation" aria-label="top navigation">
    
<nav class="wy-nav-top header su_header" role="navigation" aria-label="top navigation">
  <div class="container-logo">
    <ul class="mobile-menu-toggle">
        <li class="menu-toggle">
            <i data-toggle="wy-nav-top" class="wy-nav-top-menu-button db-icon db-icon-menu pull-left"></i>
            
            <a href="https://www.databricks.com/" class="wy-nav-top-logo"><img src="../../../_static/small-scale-lockup-full-color-rgb.svg" width="137" height="21"
              alt="Databricks" /></a>   
               
              </li>
    </ul>
    <ul class="su_nav-menu">
      <li class="menu-toggle">
        <i data-toggle="wy-nav-top" class="wy-nav-top-menu-button db-icon db-icon-menu pull-left"></i>
        
          
        
        <a href="https://www.databricks.com/" class="wy-nav-top-logo"><img src="../../../_static/small-scale-lockup-full-color-rgb.svg" width="137" height="21"
            alt="Databricks" /></a></li>
        <!-- 
<li><a href="https://help.databricks.com/s/">Help Center</a></li>
<li class="active"><a href="https://docs.databricks.com/en/">Documentation</a></li>
<li><a href="https://kb.databricks.com/">Knowledge Base</a></li>
 -->
    </ul>
  </div>
  <div class="su_nav-right">
    <ul class="su_link-mobile">
  <!-- Mobile header code can go here -->
</ul>
<ul class="right-try-list">
   
</ul>
  </div>
</nav>
  </nav>

  <div class="su_sub-header">
    <div class="container">
      <div class="su_sub-header-inner">
        <!-- <div class="su_subnav-menu-right">
  <div id="auto" style="width: 100%;">
    <div ng-controller="SearchautoController">
      <div bind-html-compile="autocompleteHtml">
        <form class="su__search-box-1" disabled="disabled">
          <input class="su__search-input" type="search" name="Search box" id="su__search-b" placeholder="Search Documentation" disabled="disabled"/>
          <button class="su__search-button" type="submit" class="button button-success" disabled="disabled">
            <svg width="24" height="24" viewBox="0 0 24 24">
              <path
                d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"
                fill="#333"></path>
            </svg>
          </button>
        </form>
      </div>
    </div>
  </div>
</div> -->
        <div class="search-lng-gap"></div>
        <div style="margin-left: 16px; margin-right: 16px;">
          <!-- <select name="lng selector" id="lng-selector">
    <option value="../../../../en/dev-tools/databricks-connect/python/install.html" class="notranslate">English</option>
    <option value="../../../../ja/dev-tools/databricks-connect/python/install.html" class="notranslate">日本語</option>
    <option value="../../../../pt/dev-tools/databricks-connect/python/install.html" class="notranslate">Português (Brasil)</option>
</select> -->
        </div>
        <div class="cloud-selector-container">
          <!-- <select name="cloud provider selector" id="cloud-provider-selector">
    <option value="aws" selected class="notranslate">
        Amazon Web Services
    </option>
    <option value="azure"  class="notranslate">
        Microsoft Azure
    </option>
    <option value="gcp"  class="notranslate">
        Google Cloud Platform
    </option>
</select> -->
        </div>
      </div>
    </div>
  </div>
  <page class="js-page-container">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side su_nav-side">
<div class="wy-side-scroll">
  <div class="wy-side-nav-search">
    

    

    

    
  </div>

  <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
    
      <a href="../../../index.html" class="main-navigation-home">Databricks on AWS</a>
    

    
      

      
        <p class="caption"><span class="caption-text">Load &amp; manage data</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../rag-temp/index.html">RAG Studio</a></li>
</ul>

      
    
  </div>

  <div role="contentinfo">
    
  <p class="build_info notranslate"data-last-edit="December 23, 2023">
    Updated Jan 11, 2024
  </p>
<script>
  window.addEventListener('DOMContentLoaded',function(){
    var h1=document.querySelector('h1');
    var bi=document.querySelector('[data-last-edit]');
    if(h1 && bi){
      var ver = document.createElement('p');
      ver.className = 'version_info';
      ver.textContent = bi.getAttribute('data-last-edit');
      h1.parentElement.insertBefore(ver, h1.nextElementSibling);
    }
  });
</script>

    <p>
      
        <a id='feedbacklink' href="mailto:doc-feedback@databricks.com?subject=Documentation Feedback">Send us feedback</a>
      
    </p>
  </div>
</div>
</nav>
    
    
<main class="wy-grid-for-nav su_nav-grid">
  <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
    <div class="wy-nav-content su__nav_content">
      <div class="rst-content">
        





<div role="navigation" aria-label="breadcrumbs navigation" class="wy-breadcrumbs-wrapper">
  <ul class="wy-breadcrumbs">
    <li><a href="../../../index.html">Documentation</a> <span class="db-icon db-icon-chevron-right"></span></li>
    
    
      <li>Install Databricks Connect for Python</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>
</div>
        
        <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
          <div itemprop="articleBody">
            
    
  <div class="section" id="install-databricks-connect-for-python">
<h1>Install Databricks Connect for Python<a class="headerlink" href="#install-databricks-connect-for-python" title="Permalink to this headline"> </a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This article covers Databricks Connect for Databricks Runtime 13.0 and above.</p>
</div>
<p>This article describes how to install Databricks Connect for Python. See <a class="reference internal" href="../index.html"><span class="doc">What is Databricks Connect?</span></a>. For the Scala version of this article, see <a class="reference internal" href="../scala/install.html"><span class="doc">Install Databricks Connect for Scala</span></a>.</p>
<div class="section" id="requirements">
<h2>Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline"> </a></h2>
<ul>
<li><p>Your target Databricks workspace and cluster must meet the requirements for <a class="reference internal" href="../cluster-config.html"><span class="doc">Cluster configuration for Databricks Connect</span></a>.</p></li>
<li><p>You must install Python 3 on your development machine, and the minor version of your client Python installation must be the same as the minor Python version of your Databricks cluster. To find the minor Python version of your cluster, refer to the “System environment” section of the Databricks Runtime release notes for your cluster. See <a class="reference internal" href="../../../release-notes/runtime/index.html"><span class="doc">Databricks Runtime release notes versions and compatibility</span></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you want to use PySpark UDFs, it’s important that your development machine’s installed minor version of Python match the minor version of Python that is included with Databricks Runtime installed on the cluster.</p>
</div>
</li>
<li><p>The Databricks Connect major and minor package version should match your Databricks Runtime version. Databricks recommends that you always use the most recent package of Databricks Connect that matches your Databricks Runtime version. For example, when you use a Databricks Runtime 14.0 cluster, you should also use the <code class="docutils literal notranslate"><span class="pre">14.0</span></code> version of the <code class="docutils literal notranslate"><span class="pre">databricks-connect</span></code> package.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>See the <a class="reference internal" href="../../../release-notes/dbconnect/index.html"><span class="doc">Databricks Connect release notes</span></a> for a list of available Databricks Connect releases and maintenance updates.</p>
</div>
<p>Using the most recent package of Databricks Connect that matches your Databricks Runtime version is not a requirement. For Databricks Runtime 13.0 and above, you can use the Databricks Connect package against all versions of Databricks Runtime at or above the version of the Databricks Connect package. However, if you want to use features that are available in later versions of the Databricks Runtime, you must upgrade the Databricks Connect package accordingly.</p>
</li>
<li><p>Databricks strongly recommends that you have a Python <em>virtual environment</em> activated for each Python version that you use with Databricks Connect. Python virtual environments help to make sure that you are using the correct versions of Python and Databricks Connect together. This can help to reduce or shorten resolving related technical issues. See how to activate a Python virtual environment for <code class="docutils literal notranslate"><span class="pre">venv</span></code> or Poetry in the following sections. For more information about these tools, see <a class="reference external" href="https://docs.python.org/3/library/venv.html">venv</a> or <a class="reference external" href="https://python-poetry.org/">Poetry</a>.</p></li>
</ul>
</div>
<div class="section" id="activate-a-python-virtual-environment-with-venv">
<h2>Activate a Python virtual environment with venv<a class="headerlink" href="#activate-a-python-virtual-environment-with-venv" title="Permalink to this headline"> </a></h2>
<p>If you’re using <code class="docutils literal notranslate"><span class="pre">venv</span></code> on your development machine and your cluster is running Python 3.10, you must create a <code class="docutils literal notranslate"><span class="pre">venv</span></code> environment with that version. The following example command generates the scripts to activate a <code class="docutils literal notranslate"><span class="pre">venv</span></code> environment with Python 3.10, and this command then places those scripts within a hidden folder named <code class="docutils literal notranslate"><span class="pre">.venv</span></code> within the current working directory:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Linux and macOS</span>
python3.10<span class="w"> </span>-m<span class="w"> </span>venv<span class="w"> </span>./.venv

<span class="c1"># Windows</span>
python3.10<span class="w"> </span>-m<span class="w"> </span>venv<span class="w"> </span>.<span class="se">\.</span>venv
</pre></div>
</div>
<p>To use these scripts to activate this <code class="docutils literal notranslate"><span class="pre">venv</span></code> environment, see <a class="reference external" href="https://docs.python.org/3/library/venv.html#how-venvs-work">How venvs work</a>.</p>
<p>Skip ahead to <a class="reference internal" href="#set-up-the-client"><span class="std std-ref">Set up the client</span></a>.</p>
</div>
<div class="section" id="activate-a-python-virtual-environment-with-poetry">
<h2>Activate a Python virtual environment with Poetry<a class="headerlink" href="#activate-a-python-virtual-environment-with-poetry" title="Permalink to this headline"> </a></h2>
<ol class="arabic">
<li><p><a class="reference external" href="https://python-poetry.org/docs/#installation">Install Poetry</a>, if you have not done so already.</p></li>
<li><p>If you’re using Poetry on your development machine and your cluster is running Python 3.10, you must create a Poetry virtual environment with that version. From the root directory of your existing Python code project, instruct <code class="docutils literal notranslate"><span class="pre">poetry</span></code> to initialize your Python code project for Poetry, by running the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>poetry<span class="w"> </span>init
</pre></div>
</div>
</li>
<li><p>Poetry displays several prompts for you to complete. None of these prompts are specific to Databricks Connect. For information about these prompts, see <a class="reference external" href="https://python-poetry.org/docs/cli/#init">init</a>.</p></li>
<li><p>After you complete the prompts, Poetry adds a <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code> file to your Python project. For information about the <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code> file, see <a class="reference external" href="https://python-poetry.org/docs/pyproject/">The pyproject.toml file</a>.</p></li>
<li><p>From the root directory of your Python code project, instruct <code class="docutils literal notranslate"><span class="pre">poetry</span></code> to read the <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code> file, resolve the dependencies and install them, create a <code class="docutils literal notranslate"><span class="pre">poetry.lock</span></code> file to lock the dependencies, and finally to create a virtual environment. To do this, run the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>poetry<span class="w"> </span>install
</pre></div>
</div>
</li>
<li><p>From the root directory of your Python code project, instruct <code class="docutils literal notranslate"><span class="pre">poetry</span></code> to activate the virtual environment and enter the shell. To do this, run the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>poetry<span class="w"> </span>shell
</pre></div>
</div>
</li>
</ol>
<p>You will know that your virtual environment is activated and the shell is entered when the virtual environment’s name displays in parentheses just before your terminal prompt, for example <code class="docutils literal notranslate"><span class="pre">(my-project-py3.10)</span></code>.</p>
<p>To deactivate the virtual environment and exit the shell at any time, run the command <code class="docutils literal notranslate"><span class="pre">exit</span></code>.</p>
<p>You will know that you have exited the shell when the virtual environment’s name no longer displays in parentheses just before your terminal prompt.</p>
<p>For more information about creating and managing Poetry virtual environments, see <a class="reference external" href="https://python-poetry.org/docs/managing-environments/">Managing environments</a>.</p>
</div>
<div class="section" id="set-up-the-client">
<h2>Set up the client<a class="headerlink" href="#set-up-the-client" title="Permalink to this headline"> </a></h2>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you already have the Databricks extension for Visual Studio Code installed, you do not need to follow these setup instructions.</p>
</div>
<p>The Databricks extension for Visual Studio Code already has built-in support for Databricks Connect for Databricks Runtime 13.0 and above. Skip ahead to <a class="reference internal" href="../../vscode-ext/dev-tasks/databricks-connect.html"><span class="doc">Debug code by using Databricks Connect for the Databricks extension for Visual Studio Code</span></a>.</p>
<p>After you meet the requirements for Databricks Connect, complete the following steps to set up the Databricks Connect client.</p>
<div class="section" id="step-1-install-the-databricks-connect-client">
<h3>Step 1: Install the Databricks Connect client<a class="headerlink" href="#step-1-install-the-databricks-connect-client" title="Permalink to this headline"> </a></h3>
<p>This sections describes how to install the Databricks Connect client with <a class="reference external" href="https://docs.python.org/3/library/venv.html">venv</a> or <a class="reference external" href="https://python-poetry.org/">Poetry</a>.</p>
<div class="section" id="install-the-databricks-connect-client-with-venv">
<h4>Install the Databricks Connect client with venv<a class="headerlink" href="#install-the-databricks-connect-client-with-venv" title="Permalink to this headline"> </a></h4>
<ol class="arabic">
<li><p>With your virtual environment activated, uninstall PySpark, if it is already installed, by running the <code class="docutils literal notranslate"><span class="pre">uninstall</span></code> command. This is required because the <code class="docutils literal notranslate"><span class="pre">databricks-connect</span></code> package conflicts with PySpark. For details, see <a class="reference internal" href="troubleshooting.html#conflicting-pyspark-installations"><span class="std std-ref">Conflicting PySpark installations</span></a>. To check whether PySpark is already installed, run the <code class="docutils literal notranslate"><span class="pre">show</span></code> command.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Is PySpark already installed?</span>
pip3<span class="w"> </span>show<span class="w"> </span>pyspark

<span class="c1"># Uninstall PySpark</span>
pip3<span class="w"> </span>uninstall<span class="w"> </span>pyspark
</pre></div>
</div>
</li>
<li><p>With your virtual environment still activated, install the Databricks Connect client by running the <code class="docutils literal notranslate"><span class="pre">install</span></code> command. Use the <code class="docutils literal notranslate"><span class="pre">--upgrade</span></code> option to upgrade any existing client installation to the specified version.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip3<span class="w"> </span>install<span class="w"> </span>--upgrade<span class="w"> </span><span class="s2">&quot;databricks-connect==14.0.*&quot;</span><span class="w">  </span><span class="c1"># Or X.Y.* to match your cluster version.</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Databricks recommends that you append the “dot-asterisk” notation to specify <code class="docutils literal notranslate"><span class="pre">databricks-connect==X.Y.*</span></code> instead of <code class="docutils literal notranslate"><span class="pre">databricks-connect=X.Y</span></code>, to make sure that the most recent package is installed. While this is not a requirement, it helps make sure that you can use the latest supported features for that cluster.</p>
</div>
</li>
</ol>
<p>Skip ahead to <a class="reference internal" href="#configure-connection-python"><span class="std std-ref">Step 2: Configure connection properties</span></a>.</p>
</div>
<div class="section" id="install-the-databricks-connect-client-with-poetry">
<h4>Install the Databricks Connect client with Poetry<a class="headerlink" href="#install-the-databricks-connect-client-with-poetry" title="Permalink to this headline"> </a></h4>
<ol class="arabic">
<li><p>With your virtual environment activated, uninstall PySpark, if it is already installed, by running the <code class="docutils literal notranslate"><span class="pre">remove</span></code> command. This is required because the <code class="docutils literal notranslate"><span class="pre">databricks-connect</span></code> package conflicts with PySpark. For details, see <a class="reference internal" href="troubleshooting.html#conflicting-pyspark-installations"><span class="std std-ref">Conflicting PySpark installations</span></a>. To check whether PySpark is already installed, run the <code class="docutils literal notranslate"><span class="pre">show</span></code> command.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Is PySpark already installed?</span>
poetry<span class="w"> </span>show<span class="w"> </span>pyspark

<span class="c1"># Uninstall PySpark</span>
poetry<span class="w"> </span>remove<span class="w"> </span>pyspark
</pre></div>
</div>
</li>
<li><p>With your virtual environment still activated, install the Databricks Connect client by running the <code class="docutils literal notranslate"><span class="pre">add</span></code> command.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>poetry<span class="w"> </span>add<span class="w"> </span>databricks-connect@~14.0<span class="w">  </span><span class="c1"># Or X.Y to match your cluster version.</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Databricks recommends that you use the “at-tilde” notation to specify <code class="docutils literal notranslate"><span class="pre">databricks-connect&#64;~14.0</span></code> instead of <code class="docutils literal notranslate"><span class="pre">databricks-connect==14.0</span></code>, to make sure that the most recent package is installed. While this is not a requirement, it helps make sure that you can use the latest supported features for that cluster.</p>
</div>
</li>
</ol>
</div>
</div>
<div class="section" id="step-2-configure-connection-properties">
<span id="configure-connection-python"></span><h3>Step 2: Configure connection properties<a class="headerlink" href="#step-2-configure-connection-properties" title="Permalink to this headline"> </a></h3>
<p>In this section, you configure properties to establish a connection between Databricks Connect and your remote Databricks cluster. These properties include settings to authenticate Databricks Connect with your cluster.</p>
<p>For Databricks Connect for Databricks Runtime 13.1 and above, Databricks Connect includes the <a class="reference internal" href="../../sdk-python.html"><span class="doc">Databricks SDK for Python</span></a>. This SDK implements the <a class="reference internal" href="../../auth/index.html#unified-auth"><span class="std std-ref">Databricks client unified authentication</span></a> standard, a consolidated and consistent architectural and programmatic approach to authentication. This approach makes setting up and automating authentication with Databricks more centralized and predictable. It enables you to configure Databricks authentication once and then use that configuration across multiple Databricks tools and SDKs without further authentication configuration changes.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Databricks Connect for Databricks Runtime 13.0 supports only <a class="reference internal" href="../../auth/pat.html"><span class="doc">Databricks personal access token authentication</span></a> for authentication.</p>
</div>
<ol class="arabic">
<li><p>Collect the following configuration properties.</p>
<ul class="simple">
<li><p>The Databricks <a class="reference internal" href="../../../workspace/workspace-details.html#workspace-url"><span class="std std-ref">workspace instance name</span></a>. This is the same as the <strong>Server Hostname</strong> value for your cluster; see <a class="reference internal" href="../../../integrations/jdbc-odbc-bi.html#connection-details-cluster"><span class="std std-ref">Get connection details for a cluster</span></a>.</p></li>
<li><p>The ID of your cluster. You can obtain the cluster ID from the URL. See <a class="reference internal" href="../../../workspace/workspace-details.html#cluster-url-and-id"><span class="std std-ref">Cluster URL and ID</span></a>.</p></li>
<li><p>Any other properties that are necessary for the supported <a class="reference internal" href="../../auth/index.html#auth-types"><span class="std std-ref">Databricks authentication type</span></a> that you want to use. These properties are described throughout this section.</p></li>
</ul>
</li>
<li><p>Configure the connection within your code. Databricks Connect searches for configuration properties in the following order until it finds them. Once it finds them, it stops searching through the remaining options. The details for each option appear after the following table:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Configuration properties option</p></th>
<th class="head"><p>Applies to</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><ol class="arabic simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">DatabricksSession</span></code> class’s <code class="docutils literal notranslate"><span class="pre">remote()</span></code> method</p></li>
</ol>
</td>
<td><p>Databricks personal access token authentication only</p></td>
</tr>
<tr class="row-odd"><td><ol class="arabic simple" start="2">
<li><p>A Databricks configuration profile</p></li>
</ol>
</td>
<td><p>All Databricks authentication types</p></td>
</tr>
<tr class="row-even"><td><ol class="arabic simple" start="3">
<li><p>The <code class="docutils literal notranslate"><span class="pre">SPARK_REMOTE</span></code> environment variable</p></li>
</ol>
</td>
<td><p>Databricks personal access token authentication only</p></td>
</tr>
<tr class="row-odd"><td><ol class="arabic simple" start="4">
<li><p>The <code class="docutils literal notranslate"><span class="pre">DATABRICKS_CONFIG_PROFILE</span></code> environment variable</p></li>
</ol>
</td>
<td><p>All Databricks authentication types</p></td>
</tr>
<tr class="row-even"><td><ol class="arabic simple" start="5">
<li><p>An environment variable for each configuration property</p></li>
</ol>
</td>
<td><p>All Databricks authentication types</p></td>
</tr>
<tr class="row-odd"><td><ol class="arabic simple" start="6">
<li><p>A Databricks configuration profile named <code class="docutils literal notranslate"><span class="pre">DEFAULT</span></code></p></li>
</ol>
</td>
<td><p>All Databricks authentication types</p></td>
</tr>
</tbody>
</table>
<ol class="arabic">
<li><p><strong>The <code class="docutils literal notranslate"><span class="pre">DatabricksSession</span></code> class’s <code class="docutils literal notranslate"><span class="pre">remote()</span></code> method</strong></p>
<p>For this option, which applies to <a class="reference internal" href="../../auth/pat.html"><span class="doc">Databricks personal access token authentication</span></a> only, specify the workspace instance name, the Databricks personal access token, and the ID of the cluster.</p>
<p>You can initialize the <code class="docutils literal notranslate"><span class="pre">DatabricksSession</span></code> class in several ways, as follows:</p>
<ul class="simple">
<li><p>Set the <code class="docutils literal notranslate"><span class="pre">host</span></code>, <code class="docutils literal notranslate"><span class="pre">token</span></code>, and <code class="docutils literal notranslate"><span class="pre">cluster_id</span></code> fields in <code class="docutils literal notranslate"><span class="pre">DatabricksSession.builder.remote()</span></code>.</p></li>
<li><p>Use the Databricks SDK’s <code class="docutils literal notranslate"><span class="pre">Config</span></code> class.</p></li>
<li><p>Specify a Databricks configuration profile along with the <code class="docutils literal notranslate"><span class="pre">cluster_id</span></code> field.</p></li>
<li><p>Set the Spark Connect connection string in <code class="docutils literal notranslate"><span class="pre">DatabricksSession.builder.remote()</span></code>.</p></li>
</ul>
<p>Databricks does not recommend that you directly specify these connection properties in your code. Instead, Databricks recommends configuring properties through environment variables or configuration files, as described throughout this section. The following code examples assume that you provide some implementation of the proposed <code class="docutils literal notranslate"><span class="pre">retrieve_*</span></code> functions yourself to get the necessary properties from the user or from some other configuration store, such as <a class="reference external" href="https://docs.aws.amazon.com/systems-manager/latest/userguide/systems-manager-parameter-store.html">AWS Systems Manager Parameter Store</a>.</p>
<p>The code for each of these approaches is as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set the host, token, and cluster_id fields in DatabricksSession.builder.remote.</span>
<span class="c1"># If you have already set the DATABRICKS_CLUSTER_ID environment variable with the</span>
<span class="c1"># cluster&#39;s ID, you do not also need to set the cluster_id field here.</span>
<span class="kn">from</span> <span class="nn">databricks.connect</span> <span class="kn">import</span> <span class="n">DatabricksSession</span>

<span class="n">spark</span> <span class="o">=</span> <span class="n">DatabricksSession</span><span class="o">.</span><span class="n">builder</span><span class="o">.</span><span class="n">remote</span><span class="p">(</span>
  <span class="n">host</span>       <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://</span><span class="si">{</span><span class="n">retrieve_workspace_instance_name</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
  <span class="n">token</span>      <span class="o">=</span> <span class="n">retrieve_token</span><span class="p">(),</span>
  <span class="n">cluster_id</span> <span class="o">=</span> <span class="n">retrieve_cluster_id</span><span class="p">()</span>
<span class="p">)</span><span class="o">.</span><span class="n">getOrCreate</span><span class="p">()</span>

<span class="c1"># Use the Databricks SDK&#39;s Config class.</span>
<span class="c1"># If you have already set the DATABRICKS_CLUSTER_ID environment variable with the</span>
<span class="c1"># cluster&#39;s ID, you do not also need to set the cluster_id field here.</span>
<span class="kn">from</span> <span class="nn">databricks.connect</span> <span class="kn">import</span> <span class="n">DatabricksSession</span>
<span class="kn">from</span> <span class="nn">databricks.sdk.core</span> <span class="kn">import</span> <span class="n">Config</span>

<span class="n">config</span> <span class="o">=</span> <span class="n">Config</span><span class="p">(</span>
  <span class="n">host</span>       <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://</span><span class="si">{</span><span class="n">retrieve_workspace_instance_name</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
  <span class="n">token</span>      <span class="o">=</span> <span class="n">retrieve_token</span><span class="p">(),</span>
  <span class="n">cluster_id</span> <span class="o">=</span> <span class="n">retrieve_cluster_id</span><span class="p">()</span>
<span class="p">)</span>

<span class="n">spark</span> <span class="o">=</span> <span class="n">DatabricksSession</span><span class="o">.</span><span class="n">builder</span><span class="o">.</span><span class="n">sdkConfig</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="o">.</span><span class="n">getOrCreate</span><span class="p">()</span>

<span class="c1"># Specify a Databricks configuration profile along with the `cluster_id` field.</span>
<span class="c1"># If you have already set the DATABRICKS_CLUSTER_ID environment variable with the</span>
<span class="c1"># cluster&#39;s ID, you do not also need to set the cluster_id field here.</span>
<span class="kn">from</span> <span class="nn">databricks.connect</span> <span class="kn">import</span> <span class="n">DatabricksSession</span>
<span class="kn">from</span> <span class="nn">databricks.sdk.core</span> <span class="kn">import</span> <span class="n">Config</span>

<span class="n">config</span> <span class="o">=</span> <span class="n">Config</span><span class="p">(</span>
  <span class="n">profile</span>    <span class="o">=</span> <span class="s2">&quot;&lt;profile-name&gt;&quot;</span><span class="p">,</span>
  <span class="n">cluster_id</span> <span class="o">=</span> <span class="n">retrieve_cluster_id</span><span class="p">()</span>
<span class="p">)</span>

<span class="n">spark</span> <span class="o">=</span> <span class="n">DatabricksSession</span><span class="o">.</span><span class="n">builder</span><span class="o">.</span><span class="n">sdkConfig</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="o">.</span><span class="n">getOrCreate</span><span class="p">()</span>

<span class="c1"># Set the Spark Connect connection string in DatabricksSession.builder.remote.</span>
<span class="kn">from</span> <span class="nn">databricks.connect</span> <span class="kn">import</span> <span class="n">DatabricksSession</span>

<span class="n">workspace_instance_name</span> <span class="o">=</span> <span class="n">retrieve_workspace_instance_name</span><span class="p">()</span>
<span class="n">token</span>                   <span class="o">=</span> <span class="n">retrieve_token</span><span class="p">()</span>
<span class="n">cluster_id</span>              <span class="o">=</span> <span class="n">retrieve_cluster_id</span><span class="p">()</span>

<span class="n">spark</span> <span class="o">=</span> <span class="n">DatabricksSession</span><span class="o">.</span><span class="n">builder</span><span class="o">.</span><span class="n">remote</span><span class="p">(</span>
  <span class="sa">f</span><span class="s2">&quot;sc://</span><span class="si">{</span><span class="n">workspace_instance_name</span><span class="si">}</span><span class="s2">:443/;token=</span><span class="si">{</span><span class="n">token</span><span class="si">}</span><span class="s2">;x-databricks-cluster-id=</span><span class="si">{</span><span class="n">cluster_id</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="p">)</span><span class="o">.</span><span class="n">getOrCreate</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p><strong>A Databricks configuration profile</strong></p>
<p>For this option, create or identify a Databricks <a class="reference internal" href="../../auth/index.html#config-profiles"><span class="std std-ref">configuration profile</span></a> containing the field <code class="docutils literal notranslate"><span class="pre">cluster_id</span></code> and any other fields that are necessary for the <a class="reference internal" href="../../auth/index.html#auth-types"><span class="std std-ref">Databricks authentication type</span></a> that you want to use.</p>
<p>The required configuration profile fields for each authentication type are as follows:</p>
<ul class="simple">
<li><p>For Databricks <a class="reference internal" href="../../auth/pat.html"><span class="doc">personal access token authentication</span></a>: <code class="docutils literal notranslate"><span class="pre">host</span></code> and <code class="docutils literal notranslate"><span class="pre">token</span></code>.</p></li>
<li><p>For <a class="reference internal" href="../../auth/basic.html"><span class="doc">basic authentication (legacy)</span></a>: <code class="docutils literal notranslate"><span class="pre">host</span></code>, <code class="docutils literal notranslate"><span class="pre">username</span></code>, and <code class="docutils literal notranslate"><span class="pre">password</span></code>.</p></li>
<li><p>For <a class="reference internal" href="../../auth/oauth-m2m.html"><span class="doc">OAuth machine-to-machine (M2M) authentication</span></a>: <code class="docutils literal notranslate"><span class="pre">host</span></code>, <code class="docutils literal notranslate"><span class="pre">client_id</span></code>, and <code class="docutils literal notranslate"><span class="pre">client_secret</span></code>.</p></li>
<li><p>For <a class="reference internal" href="../../auth/oauth-u2m.html"><span class="doc">OAuth user-to-machine (U2M) authentication</span></a>: <code class="docutils literal notranslate"><span class="pre">host</span></code>.</p></li>
</ul>
<p>Then set the name of this configuration profile through the <code class="docutils literal notranslate"><span class="pre">Config</span></code> class.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can use the <code class="docutils literal notranslate"><span class="pre">auth</span> <span class="pre">login</span></code> command’s <code class="docutils literal notranslate"><span class="pre">--configure-cluster</span></code> option to automtically add the <code class="docutils literal notranslate"><span class="pre">cluster_id</span></code> field to a new or existing configuration profile. For more information, run the command <code class="docutils literal notranslate"><span class="pre">databricks</span> <span class="pre">auth</span> <span class="pre">login</span> <span class="pre">-h</span></code>.</p>
</div>
<p>You can specify <code class="docutils literal notranslate"><span class="pre">cluster_id</span></code> in a few ways, as follows:</p>
<ul class="simple">
<li><p>Include the <code class="docutils literal notranslate"><span class="pre">cluster_id</span></code> field in your configuration profile, and then just specify the configuration profile’s name.</p></li>
<li><p>Specify the configuration profile name along with the <code class="docutils literal notranslate"><span class="pre">cluster_id</span></code> field.</p></li>
</ul>
<p>If you have already set the <code class="docutils literal notranslate"><span class="pre">DATABRICKS_CLUSTER_ID</span></code> environment variable with the
cluster’s ID, you do not also need to specify <code class="docutils literal notranslate"><span class="pre">cluster_id</span></code>.</p>
<p>The code for each of these approaches is as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Include the cluster_id field in your configuration profile, and then</span>
<span class="c1"># just specify the configuration profile&#39;s name:</span>
<span class="kn">from</span> <span class="nn">databricks.connect</span> <span class="kn">import</span> <span class="n">DatabricksSession</span>

<span class="n">spark</span> <span class="o">=</span> <span class="n">DatabricksSession</span><span class="o">.</span><span class="n">builder</span><span class="o">.</span><span class="n">profile</span><span class="p">(</span><span class="s2">&quot;&lt;profile-name&gt;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">getOrCreate</span><span class="p">()</span>

<span class="c1"># Specify the configuration profile name along with the cluster_id field.</span>
<span class="c1"># In this example, retrieve_cluster_id() assumes some custom implementation that</span>
<span class="c1"># you provide to get the cluster ID from the user or from some other</span>
<span class="c1"># configuration store:</span>
<span class="kn">from</span> <span class="nn">databricks.connect</span> <span class="kn">import</span> <span class="n">DatabricksSession</span>
<span class="kn">from</span> <span class="nn">databricks.sdk.core</span> <span class="kn">import</span> <span class="n">Config</span>

<span class="n">config</span> <span class="o">=</span> <span class="n">Config</span><span class="p">(</span>
  <span class="n">profile</span>    <span class="o">=</span> <span class="s2">&quot;&lt;profile-name&gt;&quot;</span><span class="p">,</span>
  <span class="n">cluster_id</span> <span class="o">=</span> <span class="n">retrieve_cluster_id</span><span class="p">()</span>
<span class="p">)</span>

<span class="n">spark</span> <span class="o">=</span> <span class="n">DatabricksSession</span><span class="o">.</span><span class="n">builder</span><span class="o">.</span><span class="n">sdkConfig</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="o">.</span><span class="n">getOrCreate</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p><strong>The <code class="docutils literal notranslate"><span class="pre">SPARK_REMOTE</span></code> environment variable</strong></p>
<p>For this option, which applies to <a class="reference internal" href="../../auth/pat.html"><span class="doc">Databricks personal access token authentication</span></a> only, set the <code class="docutils literal notranslate"><span class="pre">SPARK_REMOTE</span></code> environment variable to the following string, replacing the placeholders with the appropriate values.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sc</span><span class="p">:</span><span class="o">//&lt;</span><span class="n">workspace</span><span class="o">-</span><span class="n">instance</span><span class="o">-</span><span class="n">name</span><span class="o">&gt;</span><span class="p">:</span><span class="mi">443</span><span class="o">/</span><span class="p">;</span><span class="n">token</span><span class="o">=&lt;</span><span class="n">access</span><span class="o">-</span><span class="n">token</span><span class="o">-</span><span class="n">value</span><span class="o">&gt;</span><span class="p">;</span><span class="n">x</span><span class="o">-</span><span class="n">databricks</span><span class="o">-</span><span class="n">cluster</span><span class="o">-</span><span class="nb">id</span><span class="o">=&lt;</span><span class="n">cluster</span><span class="o">-</span><span class="nb">id</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Then initialize the <code class="docutils literal notranslate"><span class="pre">DatabricksSession</span></code> class as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">databricks.connect</span> <span class="kn">import</span> <span class="n">DatabricksSession</span>

<span class="n">spark</span> <span class="o">=</span> <span class="n">DatabricksSession</span><span class="o">.</span><span class="n">builder</span><span class="o">.</span><span class="n">getOrCreate</span><span class="p">()</span>
</pre></div>
</div>
<p>To set environment variables, see your operating system’s documentation.</p>
</li>
<li><p><strong>The <code class="docutils literal notranslate"><span class="pre">DATABRICKS_CONFIG_PROFILE</span></code> environment variable</strong></p>
<p>For this option, create or identify a Databricks <a class="reference internal" href="../../auth/index.html#config-profiles"><span class="std std-ref">configuration profile</span></a> containing the field <code class="docutils literal notranslate"><span class="pre">cluster_id</span></code> and any other fields that are necessary for the <a class="reference internal" href="../../auth/index.html#auth-types"><span class="std std-ref">Databricks authentication type</span></a> that you want to use.</p>
<p>If you have already set the <code class="docutils literal notranslate"><span class="pre">DATABRICKS_CLUSTER_ID</span></code> environment variable with the
cluster’s ID, you do not also need to specify <code class="docutils literal notranslate"><span class="pre">cluster_id</span></code>.</p>
<p>The required configuration profile fields for each authentication type are as follows:</p>
<ul class="simple">
<li><p>For Databricks <a class="reference internal" href="../../auth/pat.html"><span class="doc">personal access token authentication</span></a>: <code class="docutils literal notranslate"><span class="pre">host</span></code> and <code class="docutils literal notranslate"><span class="pre">token</span></code>.</p></li>
<li><p>For <a class="reference internal" href="../../auth/basic.html"><span class="doc">basic authentication (legacy)</span></a>: <code class="docutils literal notranslate"><span class="pre">host</span></code>, <code class="docutils literal notranslate"><span class="pre">username</span></code>, and <code class="docutils literal notranslate"><span class="pre">password</span></code>.</p></li>
<li><p>For <a class="reference internal" href="../../auth/oauth-m2m.html"><span class="doc">OAuth machine-to-machine (M2M) authentication</span></a>: <code class="docutils literal notranslate"><span class="pre">host</span></code>, <code class="docutils literal notranslate"><span class="pre">client_id</span></code>, and <code class="docutils literal notranslate"><span class="pre">client_secret</span></code>.</p></li>
<li><p>For <a class="reference internal" href="../../auth/oauth-u2m.html"><span class="doc">OAuth user-to-machine (U2M) authentication</span></a>: <code class="docutils literal notranslate"><span class="pre">host</span></code>.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can use the <code class="docutils literal notranslate"><span class="pre">auth</span> <span class="pre">login</span></code> command’s <code class="docutils literal notranslate"><span class="pre">--configure-cluster</span></code> to automtically add the <code class="docutils literal notranslate"><span class="pre">cluster_id</span></code> field to a new or existing configuration profile. For more information, run the command <code class="docutils literal notranslate"><span class="pre">databricks</span> <span class="pre">auth</span> <span class="pre">login</span> <span class="pre">-h</span></code>.</p>
</div>
<p>Set the <code class="docutils literal notranslate"><span class="pre">DATABRICKS_CONFIG_PROFILE</span></code> environment variable to the name of this configuration profile. Then initialize the <code class="docutils literal notranslate"><span class="pre">DatabricksSession</span></code> class as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">databricks.connect</span> <span class="kn">import</span> <span class="n">DatabricksSession</span>

<span class="n">spark</span> <span class="o">=</span> <span class="n">DatabricksSession</span><span class="o">.</span><span class="n">builder</span><span class="o">.</span><span class="n">getOrCreate</span><span class="p">()</span>
</pre></div>
</div>
<p>To set environment variables, see your operating system’s documentation.</p>
</li>
<li><p><strong>An environment variable for each configuration property</strong></p>
<p>For this option, set the <code class="docutils literal notranslate"><span class="pre">DATABRICKS_CLUSTER_ID</span></code> environment variable and any other environment variables that are necessary for the <a class="reference internal" href="../../auth/index.html#auth-types"><span class="std std-ref">Databricks authentication type</span></a> that you want to use.</p>
<p>The required environment variables for each authentication type are as follows:</p>
<ul class="simple">
<li><p>For Databricks <a class="reference internal" href="../../auth/pat.html"><span class="doc">personal access token authentication</span></a>: <code class="docutils literal notranslate"><span class="pre">DATABRICKS_HOST</span></code> and <code class="docutils literal notranslate"><span class="pre">DATABRICKS_TOKEN</span></code>.</p></li>
<li><p>For <a class="reference internal" href="../../auth/basic.html"><span class="doc">basic authentication (legacy)</span></a>: <code class="docutils literal notranslate"><span class="pre">DATABRICKS_HOST</span></code>, <code class="docutils literal notranslate"><span class="pre">DATABRICKS_USERNAME</span></code>, and <code class="docutils literal notranslate"><span class="pre">DATABRICKS_PASSWORD</span></code>.</p></li>
<li><p>For <a class="reference internal" href="../../auth/oauth-m2m.html"><span class="doc">OAuth machine-to-machine (M2M) authentication</span></a>: <code class="docutils literal notranslate"><span class="pre">DATABRICKS_HOST</span></code>, <code class="docutils literal notranslate"><span class="pre">DATABRICKS_CLIENT_ID</span></code>, and <code class="docutils literal notranslate"><span class="pre">DATABRICKS_CLIENT_SECRET</span></code>.</p></li>
<li><p>For <a class="reference internal" href="../../auth/oauth-u2m.html"><span class="doc">OAuth user-to-machine (U2M) authentication</span></a>: <code class="docutils literal notranslate"><span class="pre">DATABRICKS_HOST</span></code>.</p></li>
</ul>
<p>Then initialize the <code class="docutils literal notranslate"><span class="pre">DatabricksSession</span></code> class as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">databricks.connect</span> <span class="kn">import</span> <span class="n">DatabricksSession</span>

<span class="n">spark</span> <span class="o">=</span> <span class="n">DatabricksSession</span><span class="o">.</span><span class="n">builder</span><span class="o">.</span><span class="n">getOrCreate</span><span class="p">()</span>
</pre></div>
</div>
<p>To set environment variables, see your operating system’s documentation.</p>
</li>
<li><p><strong>A Databricks configuration profile named <code class="docutils literal notranslate"><span class="pre">DEFAULT</span></code></strong></p>
<p>For this option, create or identify a Databricks <a class="reference internal" href="../../auth/index.html#config-profiles"><span class="std std-ref">configuration profile</span></a> containing the field <code class="docutils literal notranslate"><span class="pre">cluster_id</span></code> and any other fields that are necessary for the <a class="reference internal" href="../../auth/index.html#auth-types"><span class="std std-ref">Databricks authentication type</span></a> that you want to use.</p>
<p>If you have already set the <code class="docutils literal notranslate"><span class="pre">DATABRICKS_CLUSTER_ID</span></code> environment variable with the
cluster’s ID, you do not also need to specify <code class="docutils literal notranslate"><span class="pre">cluster_id</span></code>.</p>
<p>The required configuration profile fields for each authentication type are as follows:</p>
<ul class="simple">
<li><p>For Databricks <a class="reference internal" href="../../auth/pat.html"><span class="doc">personal access token authentication</span></a>: <code class="docutils literal notranslate"><span class="pre">host</span></code> and <code class="docutils literal notranslate"><span class="pre">token</span></code>.</p></li>
<li><p>For <a class="reference internal" href="../../auth/basic.html"><span class="doc">basic authentication (legacy)</span></a>: <code class="docutils literal notranslate"><span class="pre">host</span></code>, <code class="docutils literal notranslate"><span class="pre">username</span></code>, and <code class="docutils literal notranslate"><span class="pre">password</span></code>.</p></li>
<li><p>For <a class="reference internal" href="../../auth/oauth-m2m.html"><span class="doc">OAuth machine-to-machine (M2M) authentication</span></a>: <code class="docutils literal notranslate"><span class="pre">host</span></code>, <code class="docutils literal notranslate"><span class="pre">client_id</span></code>, and <code class="docutils literal notranslate"><span class="pre">client_secret</span></code>.</p></li>
<li><p>For <a class="reference internal" href="../../auth/oauth-u2m.html"><span class="doc">OAuth user-to-machine (U2M) authentication</span></a>: <code class="docutils literal notranslate"><span class="pre">host</span></code>.</p></li>
</ul>
<p>Name this configuration profile <code class="docutils literal notranslate"><span class="pre">DEFAULT</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can use the <code class="docutils literal notranslate"><span class="pre">auth</span> <span class="pre">login</span></code> command’s <code class="docutils literal notranslate"><span class="pre">--configure-cluster</span></code> option to automtically add the <code class="docutils literal notranslate"><span class="pre">cluster_id</span></code> field to the <code class="docutils literal notranslate"><span class="pre">DEFAULT</span></code> configuration profile. For more information, run the command <code class="docutils literal notranslate"><span class="pre">databricks</span> <span class="pre">auth</span> <span class="pre">login</span> <span class="pre">-h</span></code>.</p>
</div>
<p>Then initialize the <code class="docutils literal notranslate"><span class="pre">DatabricksSession</span></code> class as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">databricks.connect</span> <span class="kn">import</span> <span class="n">DatabricksSession</span>

<span class="n">spark</span> <span class="o">=</span> <span class="n">DatabricksSession</span><span class="o">.</span><span class="n">builder</span><span class="o">.</span><span class="n">getOrCreate</span><span class="p">()</span>
</pre></div>
</div>
</li>
</ol>
</li>
<li><p>If you choose to use <a class="reference internal" href="../../auth/pat.html"><span class="doc">Databricks personal access token authentication</span></a> authentication, you can use the included <code class="docutils literal notranslate"><span class="pre">pyspark</span></code> utility to test connectivity to your Databricks cluster as follows.</p>
<ul>
<li><p>With your virtual environment still activated, run the following command:</p>
<p>If you set the <code class="docutils literal notranslate"><span class="pre">SPARK_REMOTE</span></code> environment variable earlier, run the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pyspark
</pre></div>
</div>
<p>If you did not set the <code class="docutils literal notranslate"><span class="pre">SPARK_REMOTE</span></code> environment variable earlier, run the following command instead:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pyspark<span class="w"> </span>--remote<span class="w"> </span><span class="s2">&quot;sc://&lt;workspace-instance-name&gt;:443/;token=&lt;access-token-value&gt;;x-databricks-cluster-id=&lt;cluster-id&gt;&quot;</span>
</pre></div>
</div>
</li>
<li><p>The Spark shell appears, for example:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Python 3.10 ...
[Clang ...] on darwin
Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.
Welcome to
      ____              __
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  &#39;_/
   /__ / .__/\_,_/_/ /_/\_\   version 13.0
      /_/

Using Python version 3.10 ...
Client connected to the Spark Connect server at sc://...:.../;token=...;x-databricks-cluster-id=...
SparkSession available as &#39;spark&#39;.
&gt;&gt;&gt;
</pre></div>
</div>
</li>
<li><p>At the <code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;</span></code> prompt, run a simple PySpark command, such as <code class="docutils literal notranslate"><span class="pre">spark.range(1,10).show()</span></code>. If there are no errors, you have successfully connected.</p></li>
<li><p>If you have successfully connected, to stop the Spark shell, press <code class="docutils literal notranslate"><span class="pre">Ctrl</span> <span class="pre">+</span> <span class="pre">d</span></code> or <code class="docutils literal notranslate"><span class="pre">Ctrl</span> <span class="pre">+</span> <span class="pre">z</span></code>, or run the command <code class="docutils literal notranslate"><span class="pre">quit()</span></code> or <code class="docutils literal notranslate"><span class="pre">exit()</span></code>.</p></li>
</ul>
</li>
</ol>
</div>
</div>
</div>


    
          </div>
        </div>
        <div  class="suapp-rating">
  <div id="suPageRateApp">
     <su-app></su-app>
   </div> 
 </div>
<hr> 
<footer>
  <div role="contentinfo">
      <p class="copyright">
          &copy; Databricks 2023. All rights reserved. Apache, Apache Spark, Spark, and the Spark logo are trademarks of the <a href="http://www.apache.org/">Apache Software Foundation</a>.
      </p>
      <p> 
        
          <a id='feedbacklink' href="mailto:doc-feedback@databricks.com?subject=Documentation Feedback">Send us feedback</a>
        
     | <a href="https://databricks.com/privacy-policy">Privacy Policy</a> | <a href="https://databricks.com/terms-of-use">Terms of Use</a></p>

  </div> 

</footer>
      </div>
    </div>
  </section>
</main>

  </page>
  
  <script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
      URL_ROOT: '../../../',
      VERSION: '1.0',
      COLLAPSE_INDEX: false,
      FILE_SUFFIX: '.html',
      HAS_SOURCE: 'false'
    };
  </script>
  <script type="text/javascript" src="../../../_static/jquery.js"></script>
  <script type="text/javascript" src="../../../_static/underscore.js"></script>
  <script type="text/javascript" src="../../../_static/doctools.js"></script>
  <script type="text/javascript" src="../../../_static/language_data.js"></script>
  

  <script type="text/javascript" src="../../../_static/js/clipboard.min.js"></script>
  <script type="text/javascript" src="../../../_static/js/jquery.waypoints.min.js"></script>

  <!-- Select2 (https://select2.org/) -->
  <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
  <!-- End Select2 -->

  
  
  <script type="text/javascript" src="../../../_static/js/localized.js"></script>
  <script type="text/javascript" src="../../../_static/js/custom.js"></script>
  

  
  
  <script type="text/javascript">
    jQuery(function () {
      SphinxRtdTheme.StickyNav.enable();
    });

  </script>
  
 



  <script>
  window.__searchunifyLoaderConfig = JSON.parse('{"clients": {"en": "02c2e804-27e9-11ee-aefb-0242ac120011", "ja": "6a42c3f2-2820-11ee-aefb-0242ac120011", "pt": "6a86badd-2821-11ee-aefb-0242ac120011"}}')
</script>
<script type="text/javascript" src="../../../_static/js/search-loader.js"></script>
</body>
<script type='text/javascript'>
  window.onload = function () {
    var description = document.querySelector('meta[name="description"]').getAttribute("content");
    let titleText = document.querySelector('h1').textContent;
    document.querySelector('meta[property="og:title"]').setAttribute("content", titleText);
    document.querySelector('meta[property="og:description"]').setAttribute("content", description);
    document.querySelector('meta[property="twitter:description"]').setAttribute("content", description);
  };
</script>

</html>