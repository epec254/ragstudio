

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en-US" > <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en-US"> <!--<![endif]-->

<head>
  <!-- cookie consent -->
  
    <!-- Combined Onetrust and Rudderstack Implementation Scripts -->
    <!-- Onetrust Initialization -->
    <script type="text/javascript" src="https://cdn.cookielaw.org/consent/92466579-1717-44d3-809d-a05fb02843ed-test/OtAutoBlock.js"></script>
    <script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" data-document-language="true" type="text/javascript" charset="UTF-8" data-domain-script="92466579-1717-44d3-809d-a05fb02843ed-test"></script>
    <link rel="stylesheet" id="db-onetrust-style" href="https://www.databricks.com/wp-content/uploads/db_onetrust.css" media="all" />
    <!-- Setting Rudderstack Write Key -->
    <script>window.rudderstackKey = "2SOR9fvSr5Fi6tN2ihPbVHnX1SZ" </script>
    <!-- Rudderstack Initialization + Onetrust Integration + Rudderstack Custom Events -->
    <script type="text/javascript" src="https://www.databricks.com/sites/default/files/rudderstack/v1/db-rudderstack-events.js"></script>

  <!-- cookie consent -->

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="X-UA-Compatible" content="IE=9" />
  <meta content="Learn how to use Databricks Connect for R. Databricks Connect allows you to connect popular IDEs and other custom applications to Databricks clusters." name="description" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
  <meta property="og:image" content="https://www.databricks.com/wp-content/uploads/2020/04/og-databricks.png">
  <meta property="og:image:type" content="image/png">
  <meta property="og:title" content="Databricks Connect for R">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://docs.databricks.com">
  <meta property="og:description" content="" id="og-description">
  <meta name="twitter:image" content="https://www.databricks.com/wp-content/uploads/2020/04/og-databricks.png">
  <meta name="twitter:site" content="@databricks">
  <meta name="twitter:creator" content="@databricks">
  <meta property="twitter:description" content="">
  
  <title>Databricks Connect for R &#124; Databricks on AWS</title>
  
  
  <link rel="canonical" href="https://docs.databricks.com/en/dev-tools/databricks-connect/r/index.html">
  <!-- Start hreflang tag -->
  <link rel="alternate" hreflang="en" href="https://docs.databricks.com/en/dev-tools/databricks-connect/r/index.html" />
<link rel="alternate" hreflang="x-default" href="https://docs.databricks.com/en/dev-tools/databricks-connect/r/index.html" />
  <!-- End hreflang tag -->
  
  
  <link rel="shortcut icon" href="../../../_static/favicon.ico" />
  

  

  

  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;
j.setAttributeNode(d.createAttribute('data-ot-ignore'));
f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-T85FQ33');</script>
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;
j.setAttributeNode(d.createAttribute('data-ot-ignore'));
f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-TWTKQQ');</script>
    
  <!-- End Google Tag Manager -->


  <!-- MaxMind / GEO IP -->
  <script src="//js.maxmind.com/js/apis/geoip2/v2.1/geoip2.js" type="text/javascript"></script>
  <!-- End MaxMind / GEO IP -->

  
  
  <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600&display=swap" rel="stylesheet">
  <link rel="preload" href="../../../_static/fonts/DMSans-Bold.ttf" as="font">
  <link rel="preload" href="../../../_static/fonts/DMSans-Regular.ttf" as="font">
  <link rel="preload" href="../../../_static/fonts/DMMono-Regular.ttf" as="font">
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/css/custom.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/css/cloud-provider-selector.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/css/translation-selector.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/css/searchunify/main.css" type="text/css" />

  
  <link rel="index" title="Index" href="../../../genindex.html" />
  <link rel="search" title="Search" href="../../../search.html" />
  <link rel="top" title="Databricks on AWS" href="../../../index.html" /> 
</head>

<body class="wy-body-for-nav" role="document">

  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T85FQ33"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TWTKQQ"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->

  
  <nav class="wy-nav-top header su_header" role="navigation" aria-label="top navigation">
    
<nav class="wy-nav-top header su_header" role="navigation" aria-label="top navigation">
  <div class="container-logo">
    <ul class="mobile-menu-toggle">
        <li class="menu-toggle">
            <i data-toggle="wy-nav-top" class="wy-nav-top-menu-button db-icon db-icon-menu pull-left"></i>
            
            <a href="https://www.databricks.com/" class="wy-nav-top-logo"><img src="../../../_static/small-scale-lockup-full-color-rgb.svg" width="137" height="21"
              alt="Databricks" /></a>   
               
              </li>
    </ul>
    <ul class="su_nav-menu">
      <li class="menu-toggle">
        <i data-toggle="wy-nav-top" class="wy-nav-top-menu-button db-icon db-icon-menu pull-left"></i>
        
          
        
        <a href="https://www.databricks.com/" class="wy-nav-top-logo"><img src="../../../_static/small-scale-lockup-full-color-rgb.svg" width="137" height="21"
            alt="Databricks" /></a></li>
        <!-- 
<li><a href="https://help.databricks.com/s/">Help Center</a></li>
<li class="active"><a href="https://docs.databricks.com/en/">Documentation</a></li>
<li><a href="https://kb.databricks.com/">Knowledge Base</a></li>
 -->
    </ul>
  </div>
  <div class="su_nav-right">
    <ul class="su_link-mobile">
  <!-- Mobile header code can go here -->
</ul>
<ul class="right-try-list">
   
</ul>
  </div>
</nav>
  </nav>

  <div class="su_sub-header">
    <div class="container">
      <div class="su_sub-header-inner">
        <!-- <div class="su_subnav-menu-right">
  <div id="auto" style="width: 100%;">
    <div ng-controller="SearchautoController">
      <div bind-html-compile="autocompleteHtml">
        <form class="su__search-box-1" disabled="disabled">
          <input class="su__search-input" type="search" name="Search box" id="su__search-b" placeholder="Search Documentation" disabled="disabled"/>
          <button class="su__search-button" type="submit" class="button button-success" disabled="disabled">
            <svg width="24" height="24" viewBox="0 0 24 24">
              <path
                d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"
                fill="#333"></path>
            </svg>
          </button>
        </form>
      </div>
    </div>
  </div>
</div> -->
        <div class="search-lng-gap"></div>
        <div style="margin-left: 16px; margin-right: 16px;">
          <!-- <select name="lng selector" id="lng-selector">
    <option value="../../../../en/dev-tools/databricks-connect/r/index.html" class="notranslate">English</option>
    <option value="../../../../ja/dev-tools/databricks-connect/r/index.html" class="notranslate">日本語</option>
    <option value="../../../../pt/dev-tools/databricks-connect/r/index.html" class="notranslate">Português (Brasil)</option>
</select> -->
        </div>
        <div class="cloud-selector-container">
          <!-- <select name="cloud provider selector" id="cloud-provider-selector">
    <option value="aws" selected class="notranslate">
        Amazon Web Services
    </option>
    <option value="azure"  class="notranslate">
        Microsoft Azure
    </option>
    <option value="gcp"  class="notranslate">
        Google Cloud Platform
    </option>
</select> -->
        </div>
      </div>
    </div>
  </div>
  <page class="js-page-container">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side su_nav-side">
<div class="wy-side-scroll">
  <div class="wy-side-nav-search">
    

    

    

    
  </div>

  <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
    
      <a href="../../../index.html" class="main-navigation-home">Databricks on AWS</a>
    

    
      

      
        <p class="caption"><span class="caption-text">Load &amp; manage data</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../rag-temp/index.html">RAG Studio</a></li>
</ul>

      
    
  </div>

  <div role="contentinfo">
    
  <p class="build_info notranslate"data-last-edit="December 23, 2023">
    Updated Jan 11, 2024
  </p>
<script>
  window.addEventListener('DOMContentLoaded',function(){
    var h1=document.querySelector('h1');
    var bi=document.querySelector('[data-last-edit]');
    if(h1 && bi){
      var ver = document.createElement('p');
      ver.className = 'version_info';
      ver.textContent = bi.getAttribute('data-last-edit');
      h1.parentElement.insertBefore(ver, h1.nextElementSibling);
    }
  });
</script>

    <p>
      
        <a id='feedbacklink' href="mailto:doc-feedback@databricks.com?subject=Documentation Feedback">Send us feedback</a>
      
    </p>
  </div>
</div>
</nav>
    
    
<main class="wy-grid-for-nav su_nav-grid">
  <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
    <div class="wy-nav-content su__nav_content">
      <div class="rst-content">
        





<div role="navigation" aria-label="breadcrumbs navigation" class="wy-breadcrumbs-wrapper">
  <ul class="wy-breadcrumbs">
    <li><a href="../../../index.html">Documentation</a> <span class="db-icon db-icon-chevron-right"></span></li>
    
    
      <li>Databricks Connect for R</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>
</div>
        
        <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
          <div itemprop="articleBody">
            
    
  <div class="section" id="databricks-connect-for-r">
<h1>Databricks Connect for R<a class="headerlink" href="#databricks-connect-for-r" title="Permalink to this headline"> </a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This article covers <code class="docutils literal notranslate"><span class="pre">sparklyr</span></code> integration with Databricks Connect for Databricks Runtime 13.0 and above. This integration is neither provided by Databricks nor directly supported by Databricks.</p>
<p>For questions, go to the <a class="reference external" href="https://community.rstudio.com/">Posit Community</a>.</p>
<p>To report issues, go to the <a class="reference external" href="https://github.com/sparklyr/sparklyr/issues">Issues</a> section of the <code class="docutils literal notranslate"><span class="pre">sparklyr</span></code> repository in GitHub.</p>
<p>For more information, see <a class="reference external" href="https://spark.rstudio.com/deployment/databricks-connect.html">Databricks Connect v2</a> in the <code class="docutils literal notranslate"><span class="pre">sparklyr</span></code> documentation.</p>
</div>
<p>This article demonstrates how to quickly get started with Databricks Connect by using R, <code class="docutils literal notranslate"><span class="pre">sparklyr</span></code>, and <a class="reference external" href="https://posit.co/download/rstudio-desktop/">RStudio Desktop</a>.</p>
<ul class="simple">
<li><p>For the Python version of this article, see <a class="reference internal" href="../python/index.html"><span class="doc">Databricks Connect for Python</span></a>.</p></li>
<li><p>For the Scala version of this article, see <a class="reference internal" href="../scala/index.html"><span class="doc">Databricks Connect for Scala</span></a>.</p></li>
</ul>
<p>Databricks Connect enables you to connect popular IDEs such as RStudio Desktop, notebook servers, and other custom applications to Databricks clusters. See <a class="reference internal" href="../index.html"><span class="doc">What is Databricks Connect?</span></a>.</p>
<div class="section" id="tutorial">
<h2>Tutorial<a class="headerlink" href="#tutorial" title="Permalink to this headline"> </a></h2>
<p>This tutorial uses RStudio Desktop and Python 3.10. If you don’t have them already installed, <a class="reference external" href="https://posit.co/download/rstudio-desktop/">install R and RStudio Desktop</a> and Python 3.10.</p>
<p>For supplemental information about this tutorial, see the “Databricks Connect” section of <a class="reference external" href="https://spark.rstudio.com/deployment/databricks-spark-connect">Spark Connect, and Databricks Connect v2</a> on the <code class="docutils literal notranslate"><span class="pre">sparklyr</span></code> website.</p>
</div>
<div class="section" id="requirements">
<h2>Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline"> </a></h2>
<p>To complete this tutorial, you must meet the following requirements:</p>
<ul class="simple">
<li><p>Your target Databricks workspace and cluster must meet the requirements for <a class="reference internal" href="../cluster-config.html"><span class="doc">Cluster configuration for Databricks Connect</span></a>.</p></li>
<li><p>You must have your cluster ID available. To get your cluster ID, in your workspace, click <strong>Compute</strong> on the sidebar, and then click your cluster’s name. In your web browser’s address bar, copy the string of characters between <code class="docutils literal notranslate"><span class="pre">clusters</span></code> and <code class="docutils literal notranslate"><span class="pre">configuration</span></code> in the URL.</p></li>
</ul>
</div>
<div class="section" id="step-1-create-a-personal-access-token">
<span id="create-pat"></span><h2>Step 1: Create a personal access token<a class="headerlink" href="#step-1-create-a-personal-access-token" title="Permalink to this headline"> </a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Databricks Connect for R authentication currently only supports Databricks personal access tokens.</p>
</div>
<p>This tutorial uses Databricks <a class="reference internal" href="../../auth/pat.html"><span class="doc">personal access token authentication</span></a> for authenticating with your Databricks workspace.</p>
<p>If you already have a Databricks personal access token, skip to Step 2. If you are not sure whether you already have a Databricks personal access token, you can follow this step without affecting any other Databricks personal access tokens in your user account.</p>
<p>
</p>
<p>To create a personal access token:</p>
<ol class="arabic simple">
<li><p>In your Databricks workspace, click your Databricks username in the top bar, and then select <strong>User Settings</strong> from the drop down.</p></li>
<li><p>Click <strong>Developer</strong>.</p></li>
<li><p>Next to <strong>Access tokens</strong>, click <strong>Manage</strong>.</p></li>
<li><p>Click <strong>Generate new token</strong>.</p></li>
<li><p>(Optional) Enter a comment that helps you to identify this token in the future, and change the token’s default lifetime of 90 days. To create a token with no lifetime (not recommended), leave the <strong>Lifetime (days)</strong> box empty (blank).</p></li>
<li><p>Click <strong>Generate</strong>.</p></li>
<li><p>Copy the displayed token to a secure location, and then click <strong>Done</strong>.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Be sure to save the copied token in a secure location. Do not share your copied token with others. If you lose the copied token, you cannot regenerate that exact same token. Instead, you must repeat this procedure to create a new token. If you lose the copied token, or you believe that the token has been compromised, Databricks strongly recommends that you immediately delete that token from your workspace by clicking the trash can (<strong>Revoke</strong>) icon next to the token on the <strong>Access tokens</strong> page.</p>
<p>If you are not able to create or use tokens in your workspace, this might be because your workspace administrator has disabled tokens or has not given you permission to create or use tokens. See your workspace administrator or the following:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../../../administration-guide/access-control/tokens.html#enable-tokens"><span class="std std-ref">Enable or disable personal access token authentication for the workspace</span></a></p></li>
<li><p><a class="reference internal" href="../../../security/auth-authz/api-access-permissions.html#pat"><span class="std std-ref">Personal access token permissions</span></a></p></li>
</ul>
</div>
</div>
<div class="section" id="step-2-create-the-project">
<span id="create-project"></span><h2>Step 2: Create the project<a class="headerlink" href="#step-2-create-the-project" title="Permalink to this headline"> </a></h2>
<ol class="arabic simple">
<li><p>Start RStudio Desktop.</p></li>
<li><p>On the main menu, click <strong>File &gt; New Project</strong>.</p></li>
<li><p>Select <strong>New Directory</strong>.</p></li>
<li><p>Select <strong>New Project</strong>.</p></li>
<li><p>For <strong>Directory name</strong> and <strong>Create project as subdirectory of</strong>, enter the new project directory’s name and where to create this new project directory.</p></li>
<li><p>Select <strong>Use renv with this project</strong>. If prompted to install an updated version of the <code class="docutils literal notranslate"><span class="pre">renv</span></code> package, click <strong>Yes</strong>.</p></li>
<li><p>Click <strong>Create Project</strong>.</p></li>
</ol>
<div class="figure align-default">
<img alt="Create the RStudio Desktop project" src="../../../_images/create-project-rstudio.png" />
</div>
</div>
<div class="section" id="step-3-add-the-databricks-connect-package-and-other-dependencies">
<span id="add-databricks-connect"></span><h2>Step 3: Add the Databricks Connect package and other dependencies<a class="headerlink" href="#step-3-add-the-databricks-connect-package-and-other-dependencies" title="Permalink to this headline"> </a></h2>
<ol class="arabic">
<li><p>On the RStudio Desktop main menu, click <strong>Tools &gt; Install Packages</strong>.</p></li>
<li><p>Leave <strong>Install from</strong> set to <strong>Repository (CRAN)</strong>.</p></li>
<li><p>For <strong>Packages</strong>, enter the following list of packages that are prerequisites for the Databricks Connect package and this tutorial:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>sparklyr,pysparklyr,reticulate,usethis,dplyr,dbplyr
</pre></div>
</div>
</li>
<li><p>Leave <strong>Install to Library</strong> set to your R virtual environment.</p></li>
<li><p>Make sure that <strong>Install dependencies</strong> is selected.</p></li>
<li><p>Click <strong>Install</strong>.</p></li>
</ol>
<div class="figure align-default">
<img alt="Install the Databricks Connect package dependencies" src="../../../_images/add-pkg-deps-rstudio.png" />
</div>
<ol class="arabic">
<li><p>When you are prompted in the <strong>Console</strong> view (<strong>View &gt; Move Focus to Console</strong>) to proceed with the installation, enter <code class="docutils literal notranslate"><span class="pre">Y</span></code>. The <code class="docutils literal notranslate"><span class="pre">sparklyr</span></code> and <code class="docutils literal notranslate"><span class="pre">pysparklyr</span></code> packages and their dependencies are installed in your R virtual environment.</p></li>
<li><p>In the <strong>Console</strong> pane, use <code class="docutils literal notranslate"><span class="pre">reticulate</span></code> to install Python by running the following command. (Databricks Connect for R requires <code class="docutils literal notranslate"><span class="pre">reticulate</span></code> and Python to be installed first.) In the following command, replace <code class="docutils literal notranslate"><span class="pre">3.10</span></code> with the major and minor version of the Python version that is installed on your Databricks cluster. To find this major and minor version, see the “System environment” section of the release notes for your cluster’s Databricks Runtime version in <a class="reference internal" href="../../../release-notes/runtime/index.html"><span class="doc">Databricks Runtime release notes versions and compatibility</span></a>.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>reticulate::install_python(version = &quot;3.10&quot;)
</pre></div>
</div>
</li>
<li><p>In the <strong>Console</strong> pane, install the Databricks Connect package by running the following command. In the following command, replace <code class="docutils literal notranslate"><span class="pre">13.3</span></code> with the Databricks Runtime version that is installed on your Databricks cluster. To find this version, on your cluster’s details page in your Databricks workspace, on the <strong>Configuration</strong> tab, see the <strong>Databricks Runtime Version</strong> box.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>pysparklyr::install_databricks(version = &quot;13.3&quot;)
</pre></div>
</div>
<p>If you do not know the Databricks Runtime version for your cluster or you do not want to look it up, you can run the following command instead, and <code class="docutils literal notranslate"><span class="pre">pysparklyr</span></code> will query the cluster to determine the correct Databricks Runtime version to use:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>pysparklyr::install_databricks(cluster_id = &quot;&lt;cluster-id&gt;&quot;)
</pre></div>
</div>
<p>If you want your project to connect later to a different cluster that has the same Databricks Runtime version than the one that you just specified, <code class="docutils literal notranslate"><span class="pre">pysparklyr</span></code> will use the same Python environment. If the new cluster has a different Databricks Runtime version, you should run the <code class="docutils literal notranslate"><span class="pre">pysparklyr::install_databricks</span></code> command again with the new Databricks Runtime version or cluster ID.</p>
</li>
</ol>
</div>
<div class="section" id="step-4-set-environment-variables-for-the-workspace-url-access-token-and-cluster-id">
<span id="set-env-vars"></span><h2>Step 4: Set environment variables for the workspace URL, access token, and cluster ID<a class="headerlink" href="#step-4-set-environment-variables-for-the-workspace-url-access-token-and-cluster-id" title="Permalink to this headline"> </a></h2>
<p>Databricks does not recommend that you hard-code sensitive or changing values such as your Databricks workspace URL, Databricks personal access token, or Databricks cluster ID into your R scripts. Instead, store these values separately, for example in local environment variables. This tutorial uses RStudio Desktop’s built-in support for storing environment variables in a <code class="docutils literal notranslate"><span class="pre">.Renviron</span></code> file.</p>
<ol class="arabic">
<li><p>Create an <code class="docutils literal notranslate"><span class="pre">.Renviron</span></code> file to store the environment variables, if this file does not already exist, and then open this file for editing: in the RStudio Desktop <strong>Console</strong>, run the following command:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>usethis::edit_r_environ()
</pre></div>
</div>
</li>
<li><p>In the <code class="docutils literal notranslate"><span class="pre">.Renviron</span></code> file that appears (<strong>View &gt; Move Focus to Source</strong>), enter the following content. In this content, replace the following placeholders:</p>
<ul class="simple">
<li><p>Replace <code class="docutils literal notranslate"><span class="pre">&lt;workspace-url&gt;</span></code> with your <a class="reference internal" href="../../../workspace/workspace-details.html#workspace-url"><span class="std std-ref">workspace instance URL</span></a>, for example <code class="docutils literal notranslate"><span class="pre">https://dbc-a1b2345c-d6e7.cloud.databricks.com</span></code>.</p></li>
<li><p>Replace <code class="docutils literal notranslate"><span class="pre">&lt;personal-access-token&gt;</span></code> with your Databricks personal access token from Step 1.</p></li>
<li><p>Replace <code class="docutils literal notranslate"><span class="pre">&lt;cluster-id&gt;</span></code> with your cluster ID from this tutorial’s requirements.</p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>DATABRICKS_HOST=&lt;workspace-url&gt;
DATABRICKS_TOKEN=&lt;personal-access-token&gt;
DATABRICKS_CLUSTER_ID=&lt;cluster-id&gt;
</pre></div>
</div>
</li>
<li><p>Save the <code class="docutils literal notranslate"><span class="pre">.Renviron</span></code> file.</p></li>
<li><p>Load the environment variables into R: on the main menu, click <strong>Session &gt; Restart R</strong>.</p></li>
</ol>
<div class="figure align-default">
<img alt="Set the environment variables for Databricks Connect" src="../../../_images/set-env-vars-rstudio.png" />
</div>
</div>
<div class="section" id="step-5-add-code">
<span id="add-code"></span><h2>Step 5: Add code<a class="headerlink" href="#step-5-add-code" title="Permalink to this headline"> </a></h2>
<ol class="arabic">
<li><p>On the RStudio Desktop main menu, click <strong>File &gt; New File &gt; R Script</strong>.</p></li>
<li><p>Enter the following code into the file and then save the file (<strong>File &gt; Save</strong>) as <code class="docutils literal notranslate"><span class="pre">demo.R</span></code>:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">sparklyr</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">dplyr</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">dbplyr</span><span class="p">)</span>

<span class="n">sc</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sparklyr</span><span class="o">::</span><span class="nf">spark_connect</span><span class="p">(</span>
<span class="w">  </span><span class="n">master</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="nf">Sys.getenv</span><span class="p">(</span><span class="s">&quot;DATABRICKS_HOST&quot;</span><span class="p">),</span>
<span class="w">  </span><span class="n">cluster_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">Sys.getenv</span><span class="p">(</span><span class="s">&quot;DATABRICKS_CLUSTER_ID&quot;</span><span class="p">),</span>
<span class="w">  </span><span class="n">token</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="nf">Sys.getenv</span><span class="p">(</span><span class="s">&quot;DATABRICKS_TOKEN&quot;</span><span class="p">),</span>
<span class="w">  </span><span class="n">method</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;databricks_connect&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="n">envname</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;r-reticulate&quot;</span>
<span class="p">)</span>

<span class="n">trips</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">dplyr</span><span class="o">::</span><span class="nf">tbl</span><span class="p">(</span>
<span class="w">  </span><span class="n">sc</span><span class="p">,</span>
<span class="w">  </span><span class="n">dbplyr</span><span class="o">::</span><span class="nf">in_catalog</span><span class="p">(</span><span class="s">&quot;samples&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;nyctaxi&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;trips&quot;</span><span class="p">)</span>
<span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="n">trips</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">5</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="step-6-run-the-code">
<h2>Step 6: Run the code<a class="headerlink" href="#step-6-run-the-code" title="Permalink to this headline"> </a></h2>
<ol class="arabic">
<li><p>On the RStudio Desktop, in the toolbar for the <code class="docutils literal notranslate"><span class="pre">demo.R</span></code> file, click <strong>Source</strong>.</p>
<div class="figure align-default">
<img alt="Run the RStudio Desktop project" src="../../../_images/run-file-rstudio.png" />
</div>
</li>
<li><p>In the <strong>Console</strong>, the first five rows of the <code class="docutils literal notranslate"><span class="pre">trips</span></code> table appear.</p></li>
<li><p>In the <strong>Connections</strong> view (<strong>View &gt; Show Connections</strong>), you can explore available catalogs, schemas, tables, and views.</p>
<div class="figure align-default">
<img alt="The Connections view for the project" src="../../../_images/connections-view-rstudio.png" />
</div>
</li>
</ol>
</div>
<div class="section" id="step-7-debug-the-code">
<h2>Step 7: Debug the code<a class="headerlink" href="#step-7-debug-the-code" title="Permalink to this headline"> </a></h2>
<ol class="arabic simple">
<li><p>In the <code class="docutils literal notranslate"><span class="pre">demo.R</span></code> file, click the gutter next to <code class="docutils literal notranslate"><span class="pre">print(trips,</span> <span class="pre">n</span> <span class="pre">=</span> <span class="pre">5)</span></code> to set a breakpoint.</p></li>
<li><p>In the toolbar for the <code class="docutils literal notranslate"><span class="pre">demo.R</span></code> file, click <strong>Source</strong>.</p></li>
<li><p>When the code pauses running at the breakpoint, you can inspect variable in the <strong>Environment</strong> view (<strong>View &gt; Show Environment</strong>).</p></li>
<li><p>On the main menu, click <strong>Debug &gt; Continue</strong>.</p></li>
<li><p>In the <strong>Console</strong>, the first five rows of the <code class="docutils literal notranslate"><span class="pre">trips</span></code> table appear.</p></li>
</ol>
<div class="figure align-default">
<img alt="Debug the RStudio Desktop project" src="../../../_images/debug-project-rstudio.png" />
</div>
<p>
</p>
</div>
</div>


    
          </div>
        </div>
        <div  class="suapp-rating">
  <div id="suPageRateApp">
     <su-app></su-app>
   </div> 
 </div>
<hr> 
<footer>
  <div role="contentinfo">
      <p class="copyright">
          &copy; Databricks 2023. All rights reserved. Apache, Apache Spark, Spark, and the Spark logo are trademarks of the <a href="http://www.apache.org/">Apache Software Foundation</a>.
      </p>
      <p> 
        
          <a id='feedbacklink' href="mailto:doc-feedback@databricks.com?subject=Documentation Feedback">Send us feedback</a>
        
     | <a href="https://databricks.com/privacy-policy">Privacy Policy</a> | <a href="https://databricks.com/terms-of-use">Terms of Use</a></p>

  </div> 

</footer>
      </div>
    </div>
  </section>
</main>

  </page>
  
  <script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
      URL_ROOT: '../../../',
      VERSION: '1.0',
      COLLAPSE_INDEX: false,
      FILE_SUFFIX: '.html',
      HAS_SOURCE: 'false'
    };
  </script>
  <script type="text/javascript" src="../../../_static/jquery.js"></script>
  <script type="text/javascript" src="../../../_static/underscore.js"></script>
  <script type="text/javascript" src="../../../_static/doctools.js"></script>
  <script type="text/javascript" src="../../../_static/language_data.js"></script>
  

  <script type="text/javascript" src="../../../_static/js/clipboard.min.js"></script>
  <script type="text/javascript" src="../../../_static/js/jquery.waypoints.min.js"></script>

  <!-- Select2 (https://select2.org/) -->
  <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
  <!-- End Select2 -->

  
  
  <script type="text/javascript" src="../../../_static/js/localized.js"></script>
  <script type="text/javascript" src="../../../_static/js/custom.js"></script>
  

  
  
  <script type="text/javascript">
    jQuery(function () {
      SphinxRtdTheme.StickyNav.enable();
    });

  </script>
  
 



  <script>
  window.__searchunifyLoaderConfig = JSON.parse('{"clients": {"en": "02c2e804-27e9-11ee-aefb-0242ac120011", "ja": "6a42c3f2-2820-11ee-aefb-0242ac120011", "pt": "6a86badd-2821-11ee-aefb-0242ac120011"}}')
</script>
<script type="text/javascript" src="../../../_static/js/search-loader.js"></script>
</body>
<script type='text/javascript'>
  window.onload = function () {
    var description = document.querySelector('meta[name="description"]').getAttribute("content");
    let titleText = document.querySelector('h1').textContent;
    document.querySelector('meta[property="og:title"]').setAttribute("content", titleText);
    document.querySelector('meta[property="og:description"]').setAttribute("content", description);
    document.querySelector('meta[property="twitter:description"]').setAttribute("content", description);
  };
</script>

</html>