

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en-US" > <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en-US"> <!--<![endif]-->

<head>
  <!-- cookie consent -->
  
    <!-- Combined Onetrust and Rudderstack Implementation Scripts -->
    <!-- Onetrust Initialization -->
    <script type="text/javascript" src="https://cdn.cookielaw.org/consent/92466579-1717-44d3-809d-a05fb02843ed-test/OtAutoBlock.js"></script>
    <script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" data-document-language="true" type="text/javascript" charset="UTF-8" data-domain-script="92466579-1717-44d3-809d-a05fb02843ed-test"></script>
    <link rel="stylesheet" id="db-onetrust-style" href="https://www.databricks.com/wp-content/uploads/db_onetrust.css" media="all" />
    <!-- Setting Rudderstack Write Key -->
    <script>window.rudderstackKey = "2SOR9fvSr5Fi6tN2ihPbVHnX1SZ" </script>
    <!-- Rudderstack Initialization + Onetrust Integration + Rudderstack Custom Events -->
    <script type="text/javascript" src="https://www.databricks.com/sites/default/files/rudderstack/v1/db-rudderstack-events.js"></script>

  <!-- cookie consent -->

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="X-UA-Compatible" content="IE=9" />
  <meta content="Learn how to build and deploy Python wheels in Databricks Asset Bundles. Bundles enable programmatic management of Databricks workflows." name="description" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
  <meta property="og:image" content="https://www.databricks.com/wp-content/uploads/2020/04/og-databricks.png">
  <meta property="og:image:type" content="image/png">
  <meta property="og:title" content="Develop a Python wheel by using Databricks Asset Bundles">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://docs.databricks.com">
  <meta property="og:description" content="" id="og-description">
  <meta name="twitter:image" content="https://www.databricks.com/wp-content/uploads/2020/04/og-databricks.png">
  <meta name="twitter:site" content="@databricks">
  <meta name="twitter:creator" content="@databricks">
  <meta property="twitter:description" content="">
  
  <title>Develop a Python wheel by using Databricks Asset Bundles &#124; Databricks on AWS</title>
  
  
  <link rel="canonical" href="https://docs.databricks.com/en/dev-tools/bundles/python-wheel.html">
  <!-- Start hreflang tag -->
  <link rel="alternate" hreflang="en" href="https://docs.databricks.com/en/dev-tools/bundles/python-wheel.html" />
<link rel="alternate" hreflang="x-default" href="https://docs.databricks.com/en/dev-tools/bundles/python-wheel.html" />
  <!-- End hreflang tag -->
  
  
  <link rel="shortcut icon" href="../../_static/favicon.ico" />
  

  

  

  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;
j.setAttributeNode(d.createAttribute('data-ot-ignore'));
f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-T85FQ33');</script>
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;
j.setAttributeNode(d.createAttribute('data-ot-ignore'));
f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-TWTKQQ');</script>
    
  <!-- End Google Tag Manager -->


  <!-- MaxMind / GEO IP -->
  <script src="//js.maxmind.com/js/apis/geoip2/v2.1/geoip2.js" type="text/javascript"></script>
  <!-- End MaxMind / GEO IP -->

  
  
  <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600&display=swap" rel="stylesheet">
  <link rel="preload" href="../../_static/fonts/DMSans-Bold.ttf" as="font">
  <link rel="preload" href="../../_static/fonts/DMSans-Regular.ttf" as="font">
  <link rel="preload" href="../../_static/fonts/DMMono-Regular.ttf" as="font">
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/cloud-provider-selector.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/translation-selector.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/searchunify/main.css" type="text/css" />

  
  <link rel="index" title="Index" href="../../genindex.html" />
  <link rel="search" title="Search" href="../../search.html" />
  <link rel="top" title="Databricks on AWS" href="../../index.html" /> 
</head>

<body class="wy-body-for-nav" role="document">

  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T85FQ33"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TWTKQQ"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->

  
  <nav class="wy-nav-top header su_header" role="navigation" aria-label="top navigation">
    
<nav class="wy-nav-top header su_header" role="navigation" aria-label="top navigation">
  <div class="container-logo">
    <ul class="mobile-menu-toggle">
        <li class="menu-toggle">
            <i data-toggle="wy-nav-top" class="wy-nav-top-menu-button db-icon db-icon-menu pull-left"></i>
            
            <a href="https://www.databricks.com/" class="wy-nav-top-logo"><img src="../../_static/small-scale-lockup-full-color-rgb.svg" width="137" height="21"
              alt="Databricks" /></a>   
               
              </li>
    </ul>
    <ul class="su_nav-menu">
      <li class="menu-toggle">
        <i data-toggle="wy-nav-top" class="wy-nav-top-menu-button db-icon db-icon-menu pull-left"></i>
        
          
        
        <a href="https://www.databricks.com/" class="wy-nav-top-logo"><img src="../../_static/small-scale-lockup-full-color-rgb.svg" width="137" height="21"
            alt="Databricks" /></a></li>
        <!-- 
<li><a href="https://help.databricks.com/s/">Help Center</a></li>
<li class="active"><a href="https://docs.databricks.com/en/">Documentation</a></li>
<li><a href="https://kb.databricks.com/">Knowledge Base</a></li>
 -->
    </ul>
  </div>
  <div class="su_nav-right">
    <ul class="su_link-mobile">
  <!-- Mobile header code can go here -->
</ul>
<ul class="right-try-list">
   
</ul>
  </div>
</nav>
  </nav>

  <div class="su_sub-header">
    <div class="container">
      <div class="su_sub-header-inner">
        <!-- <div class="su_subnav-menu-right">
  <div id="auto" style="width: 100%;">
    <div ng-controller="SearchautoController">
      <div bind-html-compile="autocompleteHtml">
        <form class="su__search-box-1" disabled="disabled">
          <input class="su__search-input" type="search" name="Search box" id="su__search-b" placeholder="Search Documentation" disabled="disabled"/>
          <button class="su__search-button" type="submit" class="button button-success" disabled="disabled">
            <svg width="24" height="24" viewBox="0 0 24 24">
              <path
                d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"
                fill="#333"></path>
            </svg>
          </button>
        </form>
      </div>
    </div>
  </div>
</div> -->
        <div class="search-lng-gap"></div>
        <div style="margin-left: 16px; margin-right: 16px;">
          <!-- <select name="lng selector" id="lng-selector">
    <option value="../../../en/dev-tools/bundles/python-wheel.html" class="notranslate">English</option>
    <option value="../../../ja/dev-tools/bundles/python-wheel.html" class="notranslate">日本語</option>
    <option value="../../../pt/dev-tools/bundles/python-wheel.html" class="notranslate">Português (Brasil)</option>
</select> -->
        </div>
        <div class="cloud-selector-container">
          <!-- <select name="cloud provider selector" id="cloud-provider-selector">
    <option value="aws" selected class="notranslate">
        Amazon Web Services
    </option>
    <option value="azure"  class="notranslate">
        Microsoft Azure
    </option>
    <option value="gcp"  class="notranslate">
        Google Cloud Platform
    </option>
</select> -->
        </div>
      </div>
    </div>
  </div>
  <page class="js-page-container">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side su_nav-side">
<div class="wy-side-scroll">
  <div class="wy-side-nav-search">
    

    

    

    
  </div>

  <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
    
      <a href="../../index.html" class="main-navigation-home">Databricks on AWS</a>
    

    
      

      
        <p class="caption"><span class="caption-text">Load &amp; manage data</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../rag-temp/index.html">RAG Studio</a></li>
</ul>

      
    
  </div>

  <div role="contentinfo">
    
  <p class="build_info notranslate"data-last-edit="December 23, 2023">
    Updated Jan 11, 2024
  </p>
<script>
  window.addEventListener('DOMContentLoaded',function(){
    var h1=document.querySelector('h1');
    var bi=document.querySelector('[data-last-edit]');
    if(h1 && bi){
      var ver = document.createElement('p');
      ver.className = 'version_info';
      ver.textContent = bi.getAttribute('data-last-edit');
      h1.parentElement.insertBefore(ver, h1.nextElementSibling);
    }
  });
</script>

    <p>
      
        <a id='feedbacklink' href="mailto:doc-feedback@databricks.com?subject=Documentation Feedback">Send us feedback</a>
      
    </p>
  </div>
</div>
</nav>
    
    
<main class="wy-grid-for-nav su_nav-grid">
  <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
    <div class="wy-nav-content su__nav_content">
      <div class="rst-content">
        





<div role="navigation" aria-label="breadcrumbs navigation" class="wy-breadcrumbs-wrapper">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Documentation</a> <span class="db-icon db-icon-chevron-right"></span></li>
    
    
      <li>Develop a Python wheel by using Databricks Asset Bundles</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>
</div>
        
        <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
          <div itemprop="articleBody">
            
    
  <div class="section" id="develop-a-python-wheel-by-using-databricks-asset-bundles">
<h1>Develop a Python wheel by using Databricks Asset Bundles<a class="headerlink" href="#develop-a-python-wheel-by-using-databricks-asset-bundles" title="Permalink to this headline"> </a></h1>
<div class="preview admonition">
<p class="admonition-title">Preview</p>
<p>This feature is in <a class="reference internal" href="../../release-notes/release-types.html"><span class="doc">Public Preview</span></a>.</p>
</div>
<p>This article describes how to build, deploy, and run a Python wheel as part of a <em>Databricks Asset Bundle</em> project. See <a class="reference internal" href="index.html"><span class="doc">What are Databricks Asset Bundles?</span></a></p>
<div class="section" id="requirements">
<h2>Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline"> </a></h2>
<ul class="simple">
<li><p>Databricks CLI version 0.205 or above. To check your installed version of the Databricks CLI, run the command <code class="docutils literal notranslate"><span class="pre">databricks</span> <span class="pre">-v</span></code>. To install Databricks CLI version 0.205 or above, see <a class="reference internal" href="../cli/install.html"><span class="doc">Install or update the Databricks CLI</span></a>.</p></li>
<li><p>The remote workspace must have workspace files enabled. See <a class="reference internal" href="../../files/workspace.html"><span class="doc">What are workspace files?</span></a>.</p></li>
</ul>
</div>
<div class="section" id="decision-create-the-bundle-manually-or-by-using-a-template">
<h2>Decision: Create the bundle manually or by using a template<a class="headerlink" href="#decision-create-the-bundle-manually-or-by-using-a-template" title="Permalink to this headline"> </a></h2>
<p>Decide whether you want to create a starter bundle by using a template or to create the bundle manually. Creating the bundle by using a template is faster and easier, but the bundle might produce content that is not needed, and the bundle’s default settings must be further customized for real applications. Creating the bundle manually gives you full control over the bundle’s settings, but you must be familiar with how bundles work, as you are doing all of the work from the beginning. Choose one of the following sets of steps:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#create-the-bundle-by-using-a-template"><span class="std std-ref">Create the bundle by using a template</span></a></p></li>
<li><p><a class="reference internal" href="#create-the-bundle-manually"><span class="std std-ref">Create the bundle manually</span></a></p></li>
</ul>
</div>
<div class="section" id="create-the-bundle-by-using-a-template">
<h2>Create the bundle by using a template<a class="headerlink" href="#create-the-bundle-by-using-a-template" title="Permalink to this headline"> </a></h2>
<p>In these steps, you create the bundle by using the Databricks default bundle template for Python. These steps guide you to create a bundle that consists of files to build into a Python wheel and the definition of a Databricks job to build this Python wheel. You then validate, deploy, and build the deployed files into a Python wheel from the Python wheel job within your Databricks workspace.</p>
<p>The Databricks default bundle template for Python uses <a class="reference external" href="https://setuptools.pypa.io/en/latest/">setuptools</a> to build the Python wheel. If you want to use <a class="reference external" href="https://python-poetry.org/">Poetry</a> to build the Python wheel instead, follow the instructions later in this section to swap out the <code class="docutils literal notranslate"><span class="pre">setuptools</span></code> implementation for a Poetry implementation instead.</p>
<div class="section" id="step-1-set-up-authentication">
<h3>Step 1: Set up authentication<a class="headerlink" href="#step-1-set-up-authentication" title="Permalink to this headline"> </a></h3>
<p>In this step, you set up authentication between the Databricks CLI on your development machine and your Databricks workspace. This article assumes that you want to use a Databricks configuration profile and a Databricks personal access token for authentication. For additional authentication types you can use instead, see <a class="reference internal" href="../auth/index.html#auth-types"><span class="std std-ref">Supported Databricks authentication types</span></a>.</p>
<p>To create a personal access token:</p>
<ol class="arabic simple">
<li><p>In your Databricks workspace, click your Databricks username in the top bar, and then select <strong>User Settings</strong> from the drop down.</p></li>
<li><p>Click <strong>Developer</strong>.</p></li>
<li><p>Next to <strong>Access tokens</strong>, click <strong>Manage</strong>.</p></li>
<li><p>Click <strong>Generate new token</strong>.</p></li>
<li><p>(Optional) Enter a comment that helps you to identify this token in the future, and change the token’s default lifetime of 90 days. To create a token with no lifetime (not recommended), leave the <strong>Lifetime (days)</strong> box empty (blank).</p></li>
<li><p>Click <strong>Generate</strong>.</p></li>
<li><p>Copy the displayed token to a secure location, and then click <strong>Done</strong>.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Be sure to save the copied token in a secure location. Do not share your copied token with others. If you lose the copied token, you cannot regenerate that exact same token. Instead, you must repeat this procedure to create a new token. If you lose the copied token, or you believe that the token has been compromised, Databricks strongly recommends that you immediately delete that token from your workspace by clicking the trash can (<strong>Revoke</strong>) icon next to the token on the <strong>Access tokens</strong> page.</p>
<p>If you are not able to create or use tokens in your workspace, this might be because your workspace administrator has disabled tokens or has not given you permission to create or use tokens. See your workspace administrator or the following:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../../administration-guide/access-control/tokens.html#enable-tokens"><span class="std std-ref">Enable or disable personal access token authentication for the workspace</span></a></p></li>
<li><p><a class="reference internal" href="../../security/auth-authz/api-access-permissions.html#pat"><span class="std std-ref">Personal access token permissions</span></a></p></li>
</ul>
</div>
<p>To create a configuration profile that uses this personal access token:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The following procedure uses the <a class="reference internal" href="../cli/install.html"><span class="doc">Databricks CLI</span></a> to create a Databricks <a class="reference internal" href="../auth/index.html#config-profiles"><span class="std std-ref">configuration profile</span></a> with the name <code class="docutils literal notranslate"><span class="pre">DEFAULT</span></code>. If you already have a <code class="docutils literal notranslate"><span class="pre">DEFAULT</span></code> configuration profile, this procedure overwrites your existing <code class="docutils literal notranslate"><span class="pre">DEFAULT</span></code> configuration profile.</p>
<p>To check whether you already have a <code class="docutils literal notranslate"><span class="pre">DEFAULT</span></code> configuration profile, and to view this profile’s settings if it exists, use the Databricks CLI to run the command <code class="docutils literal notranslate"><span class="pre">databricks</span> <span class="pre">auth</span> <span class="pre">env</span> <span class="pre">--profile</span> <span class="pre">DEFAULT</span></code>.</p>
<p>To create a configuration profile with a name other than <code class="docutils literal notranslate"><span class="pre">DEFAULT</span></code>, replace the <code class="docutils literal notranslate"><span class="pre">DEFAULT</span></code> part of <code class="docutils literal notranslate"><span class="pre">--profile</span> <span class="pre">DEFAULT</span></code> in the following <code class="docutils literal notranslate"><span class="pre">databricks</span> <span class="pre">configure</span></code> command with a different name for the configuration profile.</p>
</div>
<ol class="arabic">
<li><p>Use the <a class="reference internal" href="../cli/install.html"><span class="doc">Databricks CLI</span></a> to create a Databricks <a class="reference internal" href="../auth/index.html#config-profiles"><span class="std std-ref">configuration profile</span></a> named <code class="docutils literal notranslate"><span class="pre">DEFAULT</span></code> that uses Databricks personal access token authentication. To do this, run the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>databricks<span class="w"> </span>configure<span class="w"> </span>--profile<span class="w"> </span>DEFAULT
</pre></div>
</div>
</li>
<li><p>For the prompt <strong>Databricks Host</strong>, enter your Databricks <a class="reference internal" href="../../workspace/workspace-details.html#workspace-url"><span class="std std-ref">workspace instance URL</span></a>, for example <code class="docutils literal notranslate"><span class="pre">https://dbc-a1b2345c-d6e7.cloud.databricks.com</span></code>.</p></li>
<li><p>For the prompt <strong>Personal Access Token</strong>, enter the Databricks personal access token for your workspace.</p></li>
</ol>
</div>
<div class="section" id="step-2-create-the-bundle">
<span id="create-bundle"></span><h3>Step 2: Create the bundle<a class="headerlink" href="#step-2-create-the-bundle" title="Permalink to this headline"> </a></h3>
<p>A bundle contains the artifacts you want to deploy and the settings for the workflows you want to run.</p>
<ol class="arabic">
<li><p>Use your terminal or command prompt to switch to a directory on your local development machine that will contain the template’s generated bundle.</p></li>
<li><p>Use the Dataricks CLI version to run the <code class="docutils literal notranslate"><span class="pre">bundle</span> <span class="pre">init</span></code> command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>databricks<span class="w"> </span>bundle<span class="w"> </span>init
</pre></div>
</div>
</li>
<li><p>For <code class="docutils literal notranslate"><span class="pre">Template</span> <span class="pre">to</span> <span class="pre">use</span></code>, leave the default value of <code class="docutils literal notranslate"><span class="pre">default-python</span></code> by pressing <code class="docutils literal notranslate"><span class="pre">Enter</span></code>.</p></li>
<li><p>For <code class="docutils literal notranslate"><span class="pre">Unique</span> <span class="pre">name</span> <span class="pre">for</span> <span class="pre">this</span> <span class="pre">project</span></code>, leave the default value of <code class="docutils literal notranslate"><span class="pre">my_project</span></code>, or type a different value, and then press <code class="docutils literal notranslate"><span class="pre">Enter</span></code>. This determines the name of the root directory for this bundle. This root directory is created within your current working directory.</p></li>
<li><p>For <code class="docutils literal notranslate"><span class="pre">Include</span> <span class="pre">a</span> <span class="pre">stub</span> <span class="pre">(sample)</span> <span class="pre">notebook</span></code>, select <code class="docutils literal notranslate"><span class="pre">no</span></code> and press <code class="docutils literal notranslate"><span class="pre">Enter</span></code>. This instructs the Databricks CLI to not add a sample notebook to your bundle.</p></li>
<li><p>For <code class="docutils literal notranslate"><span class="pre">Include</span> <span class="pre">a</span> <span class="pre">stub</span> <span class="pre">(sample)</span> <span class="pre">DLT</span> <span class="pre">pipeline</span></code>, select <code class="docutils literal notranslate"><span class="pre">no</span></code> and press <code class="docutils literal notranslate"><span class="pre">Enter</span></code>. This instructs the Databricks CLI to not define a sample Delta Live Tables pipeline in your bundle.</p></li>
<li><p>For <code class="docutils literal notranslate"><span class="pre">Include</span> <span class="pre">a</span> <span class="pre">stub</span> <span class="pre">(sample)</span> <span class="pre">Python</span> <span class="pre">package</span></code>, leave the default value of <code class="docutils literal notranslate"><span class="pre">yes</span></code> by pressing <code class="docutils literal notranslate"><span class="pre">Enter</span></code>. This instructs the Databricks CLI to add sample Python wheel package files and related build instructions to your bundle.</p></li>
</ol>
</div>
<div class="section" id="step-3-explore-the-bundle">
<h3>Step 3: Explore the bundle<a class="headerlink" href="#step-3-explore-the-bundle" title="Permalink to this headline"> </a></h3>
<p>To view the files that the template generated, switch to the root directory of your newly created bundle and open this directory with your preferred IDE, for example Visual Studio Code. Files of particular interest include the following:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">databricks.yml</span></code>: This file specifies the bundle’s programmatic name, includes a reference to the Python wheel job definition, and specifies settings about the target workspace.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">resources/&lt;project-name&gt;_job.yml</span></code>: This file specifies the Python wheel job’s settings.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">src/&lt;project-name&gt;</span></code>: This directory include the files that the Python wheel job uses to build the Python wheel.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you want to install the Python wheel on a target cluster that has Databricks Runtime 13.0 or below installed, you must add the following top-level mapping to the <code class="docutils literal notranslate"><span class="pre">databricks.yml</span></code> file:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># Applies to all tasks of type python_wheel_task.</span>
<span class="nt">experimental</span><span class="p">:</span>
<span class="w">  </span><span class="nt">python_wheel_wrapper</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</pre></div>
</div>
<p>This mapping instructs the Databricks CLI to do the following:</p>
<ul class="simple">
<li><p>Deploy a copy of the Python wheel in the background. This deployment path is typically <code class="docutils literal notranslate"><span class="pre">${workspace.artifact_path}/.internal/&lt;random-id&gt;/&lt;wheel-filename&gt;.whl</span></code>.</p></li>
<li><p>Create a notebook in the background that contains instructions to install the preceding deployed Python wheel on the target cluster. This notebook’s path is typically <code class="docutils literal notranslate"><span class="pre">${workspace.file_path}/.databricks/bundle/&lt;target-name&gt;/.internal/notebook_&lt;job-name&gt;_&lt;task-key&gt;</span></code>.</p></li>
<li><p>When you run a job that contains a Python wheel task, and that tasks references the preceding Python wheel, a job is created in the background that runs the preceding notebook.</p></li>
</ul>
<p>You do not need to specify this mapping for target clusters with Databricks Runtime 13.1 or above installed, as Python wheel installations from the Databricks workspace file system will install automatically on these target clusters.</p>
</div>
</div>
<div class="section" id="step-4-update-the-projects-bundle-to-use-poetry">
<h3>Step 4: Update the project’s bundle to use Poetry<a class="headerlink" href="#step-4-update-the-projects-bundle-to-use-poetry" title="Permalink to this headline"> </a></h3>
<p>By default, the bundle template specifies building the Python wheel by using <code class="docutils literal notranslate"><span class="pre">setuptools</span></code> along with the files <code class="docutils literal notranslate"><span class="pre">setup.py</span></code> and <code class="docutils literal notranslate"><span class="pre">requirements-dev.txt</span></code>. If you want to keep these defaults, then skip ahead to <a class="reference internal" href="#validate-config"><span class="std std-ref">Step 5: Validate the project’s bundle configuration file</span></a>.</p>
<p>To update the project’s bundle to use <a class="reference external" href="https://python-poetry.org">Poetry</a> instead of <code class="docutils literal notranslate"><span class="pre">setuptools</span></code>, make sure that your local development machine meets the following requirements:</p>
<ul class="simple">
<li><p>Poetry version 1.6 or above. To check your installed version of Poetry, run the command <code class="docutils literal notranslate"><span class="pre">poetry</span> <span class="pre">-V</span></code> or <code class="docutils literal notranslate"><span class="pre">poetry</span> <span class="pre">--version</span></code>. To install or upgrade Poetry, see <a class="reference external" href="https://python-poetry.org/docs/#installation">Installation</a>.</p></li>
<li><p>Python version 3.10 or above. To check your version of Python, run the command <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">-V</span></code> or <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">--version</span></code>.</p></li>
<li><p>Databricks CLI version 0.209.0 or above. To your version of the Databricks CLI, run the command <code class="docutils literal notranslate"><span class="pre">databricks</span> <span class="pre">-v</span></code> or <code class="docutils literal notranslate"><span class="pre">databricks</span> <span class="pre">--version</span></code>. See <a class="reference internal" href="../cli/install.html"><span class="doc">Install or update the Databricks CLI</span></a>.</p></li>
</ul>
<p>Make the following changes to the project’s bundle:</p>
<ol class="arabic">
<li><p>From the bundle’s root directory, instruct <code class="docutils literal notranslate"><span class="pre">poetry</span></code> to initialize the Python wheel builds for Poetry, by running the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>poetry<span class="w"> </span>init
</pre></div>
</div>
</li>
<li><p>Poetry displays several prompts for you to complete. For the Python wheel builds, answer these prompts as follows to match the related default settings in the project’s bundle:</p>
<ol class="arabic simple">
<li><p>For <code class="docutils literal notranslate"><span class="pre">Package</span> <span class="pre">name</span></code>, type the name of the child folder under <code class="docutils literal notranslate"><span class="pre">/src</span></code>, and then press <code class="docutils literal notranslate"><span class="pre">Enter</span></code>. This should also be the package’s <code class="docutils literal notranslate"><span class="pre">name</span></code> value that is defined in the bundle’s <code class="docutils literal notranslate"><span class="pre">setup.py</span></code> file.</p></li>
<li><p>For <code class="docutils literal notranslate"><span class="pre">Version</span></code>, type <code class="docutils literal notranslate"><span class="pre">0.0.1</span></code> and press <code class="docutils literal notranslate"><span class="pre">Enter</span></code>. This matches the version number that is defined in the bundle’s <code class="docutils literal notranslate"><span class="pre">src/&lt;project-name&gt;/__init__.py</span></code> file.</p></li>
<li><p>For <code class="docutils literal notranslate"><span class="pre">Description</span></code>, type <code class="docutils literal notranslate"><span class="pre">wheel</span> <span class="pre">file</span> <span class="pre">based</span> <span class="pre">on</span> <span class="pre">&lt;project-name&gt;/src</span></code> (replacing <code class="docutils literal notranslate"><span class="pre">&lt;project-name&gt;</span></code> with the project’s name), and press <code class="docutils literal notranslate"><span class="pre">Enter</span></code>. This matches the <code class="docutils literal notranslate"><span class="pre">description</span></code> value that is defined in the template’s <code class="docutils literal notranslate"><span class="pre">setup.py</span></code> file.</p></li>
<li><p>For <code class="docutils literal notranslate"><span class="pre">Author</span></code>, press <code class="docutils literal notranslate"><span class="pre">Enter</span></code>. This default value matches the author that is defined in the template’s <code class="docutils literal notranslate"><span class="pre">setup.py</span></code> file.</p></li>
<li><p>For <code class="docutils literal notranslate"><span class="pre">License</span></code>, press <code class="docutils literal notranslate"><span class="pre">Enter</span></code>. There is no license defined in the template.</p></li>
<li><p>For <code class="docutils literal notranslate"><span class="pre">Compatible</span> <span class="pre">Python</span> <span class="pre">versions</span></code>, enter the Python version that matches the one on your target Databricks clusters (for example, <code class="docutils literal notranslate"><span class="pre">^3.10</span></code>), and press <code class="docutils literal notranslate"><span class="pre">Enter</span></code>.</p></li>
<li><p>For <code class="docutils literal notranslate"><span class="pre">Would</span> <span class="pre">you</span> <span class="pre">like</span> <span class="pre">to</span> <span class="pre">define</span> <span class="pre">your</span> <span class="pre">main</span> <span class="pre">dependencies</span> <span class="pre">interactively?</span></code> Type <code class="docutils literal notranslate"><span class="pre">no</span></code> and press <code class="docutils literal notranslate"><span class="pre">Enter</span></code>. You will define your dependencies later.</p></li>
<li><p>For <code class="docutils literal notranslate"><span class="pre">Would</span> <span class="pre">you</span> <span class="pre">like</span> <span class="pre">to</span> <span class="pre">define</span> <span class="pre">your</span> <span class="pre">development</span> <span class="pre">dependencies</span> <span class="pre">interactively?</span></code> Type <code class="docutils literal notranslate"><span class="pre">no</span></code> and press <code class="docutils literal notranslate"><span class="pre">Enter</span></code>. You will define your dependencies later.</p></li>
<li><p>For <code class="docutils literal notranslate"><span class="pre">Do</span> <span class="pre">you</span> <span class="pre">confirm</span> <span class="pre">generation?</span></code> Press <code class="docutils literal notranslate"><span class="pre">Enter</span></code>.</p></li>
</ol>
</li>
<li><p>After you complete the prompts, Poetry adds a <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code> file to the bundle’s project. For information about the <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code> file, see <a class="reference external" href="https://python-poetry.org/docs/pyproject/">The pyproject.toml file</a>.</p></li>
<li><p>From the bundle’s root directory, instruct <code class="docutils literal notranslate"><span class="pre">poetry</span></code> to read the <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code> file, resolve the dependencies and install them, create a <code class="docutils literal notranslate"><span class="pre">poetry.lock</span></code> file to lock the dependencies, and finally to create a virtual environment. To do this, run the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>poetry<span class="w"> </span>install
</pre></div>
</div>
</li>
<li><p>Add the following section at the end of the <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code> file, replacing <code class="docutils literal notranslate"><span class="pre">&lt;project-name&gt;</span></code> with the name of directory that contains the <code class="docutils literal notranslate"><span class="pre">src/&lt;project-name&gt;/main.py</span></code> file (for example, <code class="docutils literal notranslate"><span class="pre">my_project</span></code>):</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>[tool.poetry.scripts]
main = &quot;&lt;project-name&gt;.main:main&quot;
</pre></div>
</div>
<p>The section specifies the Python wheel’s entry point for the Python wheel job.</p>
</li>
<li><p>Add the following mapping at the top level of the bundle’s <code class="docutils literal notranslate"><span class="pre">databricks.yml</span></code> file:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">artifacts</span><span class="p">:</span>
<span class="w">  </span><span class="nt">default</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">whl</span>
<span class="w">    </span><span class="nt">build</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">poetry build</span>
<span class="w">    </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">.</span>
</pre></div>
</div>
<p>This mapping instructs the Databricks CLI to use Poetry to build a Python wheel.</p>
</li>
<li><p>Delete the <code class="docutils literal notranslate"><span class="pre">setup.py</span></code> and <code class="docutils literal notranslate"><span class="pre">requirements-dev.txt</span></code> files from the bundle, as Poetry does not need them.</p></li>
</ol>
</div>
<div class="section" id="step-5-validate-the-projects-bundle-configuration-file">
<span id="validate-config"></span><h3>Step 5: Validate the project’s bundle configuration file<a class="headerlink" href="#step-5-validate-the-projects-bundle-configuration-file" title="Permalink to this headline"> </a></h3>
<p>In this step, you check whether the bundle configuration is valid.</p>
<ol class="arabic">
<li><p>From the root directory, use the Databricks CLI to run the <code class="docutils literal notranslate"><span class="pre">bundle</span> <span class="pre">validate</span></code> command, as follows:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>databricks<span class="w"> </span>bundle<span class="w"> </span>validate
</pre></div>
</div>
</li>
<li><p>If a JSON representation of the bundle configuration is returned, then the validation succeeded. If any errors are returned, fix the errors, and then repeat this step.</p></li>
</ol>
<p>If you make any changes to your bundle after this step, you should repeat this step to check whether your bundle configuration is still valid.</p>
</div>
<div class="section" id="step-6-build-the-python-wheel-and-deploy-the-local-project-to-the-remote-workspace">
<h3>Step 6: Build the Python wheel and deploy the local project to the remote workspace<a class="headerlink" href="#step-6-build-the-python-wheel-and-deploy-the-local-project-to-the-remote-workspace" title="Permalink to this headline"> </a></h3>
<p>In this step, you build the Python wheel, deploy the built Python wheel to your remote Databricks workspace, and create the Databricks job within your workspace.</p>
<ol class="arabic">
<li><p>If you use <code class="docutils literal notranslate"><span class="pre">setuptools</span></code>, install the <code class="docutils literal notranslate"><span class="pre">wheel</span></code> and <code class="docutils literal notranslate"><span class="pre">setuptools</span></code> packages if you have not done so already, by running the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip3<span class="w"> </span>install<span class="w"> </span>--upgrade<span class="w"> </span>wheel<span class="w"> </span>setuptools
</pre></div>
</div>
</li>
<li><p>In the Visual Studio Code terminal, use the Databricks CLI to run the <code class="docutils literal notranslate"><span class="pre">bundle</span> <span class="pre">deploy</span></code> command as follows:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>databricks<span class="w"> </span>bundle<span class="w"> </span>deploy<span class="w"> </span>-t<span class="w"> </span>dev
</pre></div>
</div>
</li>
<li><p>If you want to check whether the locally built Python wheel was deployed:</p>
<ol class="arabic simple">
<li><p>In your Databricks workspace’s sidebar, click <strong>Workspace</strong>.</p></li>
<li><p>Click into the following folder: <strong>Workspace &gt; Users &gt; <code class="docutils literal notranslate"><span class="pre">&lt;your-username&gt;</span></code> &gt; .bundle &gt; <code class="docutils literal notranslate"><span class="pre">&lt;project-name&gt;</span></code> &gt; dev &gt; artifacts &gt; .internal &gt; <code class="docutils literal notranslate"><span class="pre">&lt;random-guid&gt;</span></code></strong>.</p></li>
</ol>
<p>The Python wheel should be in this folder.</p>
</li>
<li><p>If you want to check whether the job was created:</p>
<ol class="arabic simple">
<li><p>In your Databricks workspace’s sidebar, click <strong>Workflows</strong>.</p></li>
<li><p>On the <strong>Jobs</strong> tab, click <strong>[dev <code class="docutils literal notranslate"><span class="pre">&lt;your-username&gt;</span></code>] <code class="docutils literal notranslate"><span class="pre">&lt;project-name&gt;</span></code>_job</strong>.</p></li>
<li><p>Click the <strong>Tasks</strong> tab.</p></li>
</ol>
<p>There should be one task: <strong>main_task</strong>.</p>
</li>
</ol>
<p>If you make any changes to your bundle after this step, you should repeat steps 5-6 to check whether your bundle configuration is still valid and then redeploy the project.</p>
</div>
<div class="section" id="step-7-run-the-deployed-project">
<h3>Step 7: Run the deployed project<a class="headerlink" href="#step-7-run-the-deployed-project" title="Permalink to this headline"> </a></h3>
<p>In this step, you run the Databricks job in your workspace.</p>
<ol class="arabic">
<li><p>From the root directory, use the Databricks CLI to run the <code class="docutils literal notranslate"><span class="pre">bundle</span> <span class="pre">run</span></code> command, as follows, replacing <code class="docutils literal notranslate"><span class="pre">&lt;project-name&gt;</span></code> with the name of your project from Step 2:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>databricks<span class="w"> </span>bundle<span class="w"> </span>run<span class="w"> </span>-t<span class="w"> </span>dev<span class="w"> </span>&lt;project-name&gt;_job
</pre></div>
</div>
</li>
<li><p>Copy the value of <code class="docutils literal notranslate"><span class="pre">Run</span> <span class="pre">URL</span></code> that appears in your terminal and paste this value into your web browser to open your Databricks workspace.</p></li>
<li><p>In your Databricks workspace, after the task completes successfully and shows a green title bar, click the <strong>main_task</strong> task to see the results.</p></li>
</ol>
<p>If you make any changes to your bundle after this step, you should repeat steps 5-7 to check whether your bundle configuration is still valid, redeploy the project, and run the redeployed project.</p>
<p>You have reached the end of the steps for creating a bundle by using a template.</p>
</div>
</div>
<div class="section" id="create-the-bundle-manually">
<h2>Create the bundle manually<a class="headerlink" href="#create-the-bundle-manually" title="Permalink to this headline"> </a></h2>
<p>In these steps, you create the bundle from the beginning by hand. These steps guide you to create a bundle that consists of files to build into a Python wheel and the definition of a Databricks job to build this Python wheel. You then validate, deploy, and build the deployed files into a Python wheel from the Python wheel job within your Databricks workspace.</p>
<p>These steps include adding content to a YAML file. Optionally, you might want to use an integrated development environment (IDE) that provides automatic schema suggestions and actions when working with YAML files. The following steps use <a class="reference external" href="https://code.visualstudio.com/download">Visual Studio Code</a> with the <a class="reference external" href="https://marketplace.visualstudio.com/items?itemName=redhat.vscode-yaml">YAML</a> extension installed from the Visual Studio Code Marketplace.</p>
<p>These steps assume that you already know:</p>
<ul class="simple">
<li><p>How to create, build, and work with Python wheels with Poetry or <code class="docutils literal notranslate"><span class="pre">setuptools</span></code>. For Poetry, see <a class="reference external" href="https://python-poetry.org/docs/basic-usage/">Basic usage</a>. For <code class="docutils literal notranslate"><span class="pre">setuptools</span></code>, see the <a class="reference external" href="https://packaging.python.org/en/latest/">Python Packaging User Guide</a>.</p></li>
<li><p>How to use Python wheels as part of a Databricks job. See <a class="reference internal" href="../../workflows/jobs/how-to/use-python-wheels-in-workflows.html"><span class="doc">Use a Python wheel in a Databricks job</span></a>.</p></li>
</ul>
<p>Follow these instructions to create a sample bundle that builds a Python wheel with Poetry or <code class="docutils literal notranslate"><span class="pre">setuptools</span></code>, deploys the Python wheel, and then runs the deployed Python wheel.</p>
<p>If you have already built a Python wheel and just want to deploy and run it, skip ahead to specifying the Python wheel settings in the bundle configuration file in <a class="reference internal" href="#config-file"><span class="std std-ref">Step 3: Create the bundle’s configuration file</span></a>.</p>
<div class="section" id="step-1-set-up-authentication">
<span id="step-1-set-up-authentication-1"></span><h3>Step 1: Set up authentication<a class="headerlink" href="#step-1-set-up-authentication" title="Permalink to this headline"> </a></h3>
<p>In this step, you set up authentication between the Databricks CLI on your development machine and your Databricks workspace. This article assumes that you want to use a Databricks personal access token and a corresponding Databricks configuration profile for authentication. For additional authentication types you can use instead, see <a class="reference internal" href="../auth/index.html#auth-types"><span class="std std-ref">Supported Databricks authentication types</span></a>.</p>
<p>To create a personal access token, do the following:</p>
<ol class="arabic simple">
<li><p>In your Databricks workspace, click your Databricks username in the top bar, and then select <strong>User Settings</strong> from the drop down.</p></li>
<li><p>Click <strong>Developer</strong>.</p></li>
<li><p>Next to <strong>Access tokens</strong>, click <strong>Manage</strong>.</p></li>
<li><p>Click <strong>Generate new token</strong>.</p></li>
<li><p>(Optional) Enter a comment that helps you to identify this token in the future, and change the token’s default lifetime of 90 days. To create a token with no lifetime (not recommended), leave the <strong>Lifetime (days)</strong> box empty (blank).</p></li>
<li><p>Click <strong>Generate</strong>.</p></li>
<li><p>Copy the displayed token to a secure location, and then click <strong>Done</strong>.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Be sure to save the copied token in a secure location. Do not share your copied token with others. If you lose the copied token, you cannot regenerate that exact same token. Instead, you must repeat this procedure to create a new token. If you lose the copied token, or you believe that the token has been compromised, Databricks strongly recommends that you immediately delete that token from your workspace by clicking the trash can (<strong>Revoke</strong>) icon next to the token on the <strong>Access tokens</strong> page.</p>
<p>If you are not able to create or use tokens in your workspace, this might be because your workspace administrator has disabled tokens or has not given you permission to create or use tokens. See your workspace administrator or the following:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../../administration-guide/access-control/tokens.html#enable-tokens"><span class="std std-ref">Enable or disable personal access token authentication for the workspace</span></a></p></li>
<li><p><a class="reference internal" href="../../security/auth-authz/api-access-permissions.html#pat"><span class="std std-ref">Personal access token permissions</span></a></p></li>
</ul>
</div>
<p>To create a configuration profile that uses this personal access token, do the following:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The following procedure uses the <a class="reference internal" href="../cli/install.html"><span class="doc">Databricks CLI</span></a> to create a Databricks <a class="reference internal" href="../auth/index.html#config-profiles"><span class="std std-ref">configuration profile</span></a> with the name <code class="docutils literal notranslate"><span class="pre">DEFAULT</span></code>. If you already have a <code class="docutils literal notranslate"><span class="pre">DEFAULT</span></code> configuration profile, this procedure overwrites your existing <code class="docutils literal notranslate"><span class="pre">DEFAULT</span></code> configuration profile.</p>
<p>To check whether you already have a <code class="docutils literal notranslate"><span class="pre">DEFAULT</span></code> configuration profile, and to view this profile’s settings if it exists, use the Databricks CLI to run the command <code class="docutils literal notranslate"><span class="pre">databricks</span> <span class="pre">auth</span> <span class="pre">env</span> <span class="pre">--profile</span> <span class="pre">DEFAULT</span></code>.</p>
<p>To create a configuration profile with a name other than <code class="docutils literal notranslate"><span class="pre">DEFAULT</span></code>, replace the <code class="docutils literal notranslate"><span class="pre">DEFAULT</span></code> part of <code class="docutils literal notranslate"><span class="pre">--profile</span> <span class="pre">DEFAULT</span></code> in the following <code class="docutils literal notranslate"><span class="pre">databricks</span> <span class="pre">configure</span></code> command with a different name for the configuration profile.</p>
</div>
<ol class="arabic">
<li><p>Use the <a class="reference internal" href="../cli/install.html"><span class="doc">Databricks CLI</span></a> to create a Databricks <a class="reference internal" href="../auth/index.html#config-profiles"><span class="std std-ref">configuration profile</span></a> named <code class="docutils literal notranslate"><span class="pre">DEFAULT</span></code> that uses Databricks personal access token authentication. To do this, run the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>databricks<span class="w"> </span>configure<span class="w"> </span>--profile<span class="w"> </span>DEFAULT
</pre></div>
</div>
</li>
<li><p>For the prompt <strong>Databricks Host</strong>, enter your Databricks <a class="reference internal" href="../../workspace/workspace-details.html#workspace-url"><span class="std std-ref">workspace instance URL</span></a>, for example <code class="docutils literal notranslate"><span class="pre">https://dbc-a1b2345c-d6e7.cloud.databricks.com</span></code>.</p></li>
<li><p>For the prompt <strong>Personal Access Token</strong>, enter the Databricks personal access token for your workspace.</p></li>
</ol>
</div>
<div class="section" id="step-2-create-the-bundle">
<span id="step-2-create-the-bundle-1"></span><h3>Step 2: Create the bundle<a class="headerlink" href="#step-2-create-the-bundle" title="Permalink to this headline"> </a></h3>
<p>A bundle contains the artifacts you want to deploy and the settings for the workflows you want to run.</p>
<ol class="arabic">
<li><p>In your bundle’s root, create the following folders and files, depending on whether you use Poetry or <code class="docutils literal notranslate"><span class="pre">setuptools</span></code> for building Python wheels:</p>
<div class="js-code-language-tabs compound">
<div class="compound-first compound" lang="Poetry">
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>|-- src
|     `-- my_package
|           |-- __init__.py
|           |-- main.py
|           `-- my_module.py
`-- pyproject.toml
</pre></div>
</div>
</div>
<div class="compound-last compound" lang="setuptools">
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>|-- src
|     `-- my_package
|           |-- __init__.py
|           |-- main.py
|           `-- my_module.py
`-- setup.py
</pre></div>
</div>
</div>
</div>
</li>
<li><p>Leave the <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code> file empty.</p></li>
<li><p>Add the following code to the <code class="docutils literal notranslate"><span class="pre">main.py</span></code> file and then save the file:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">my_package.my_module</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>

  <span class="n">first</span> <span class="o">=</span> <span class="mi">200</span>
  <span class="n">second</span> <span class="o">=</span> <span class="mi">400</span>

  <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">first</span><span class="si">}</span><span class="s2"> + </span><span class="si">{</span><span class="n">second</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">add_two_numbers</span><span class="p">(</span><span class="n">first</span><span class="p">,</span><span class="w"> </span><span class="n">second</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">second</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">first</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">subtract_two_numbers</span><span class="p">(</span><span class="n">second</span><span class="p">,</span><span class="w"> </span><span class="n">first</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">first</span><span class="si">}</span><span class="s2"> * </span><span class="si">{</span><span class="n">second</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">multiply_two_numbers</span><span class="p">(</span><span class="n">first</span><span class="p">,</span><span class="w"> </span><span class="n">second</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">second</span><span class="si">}</span><span class="s2"> / </span><span class="si">{</span><span class="n">first</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">divide_two_numbers</span><span class="p">(</span><span class="n">second</span><span class="p">,</span><span class="w"> </span><span class="n">first</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
  <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p>Add the following code to the <code class="docutils literal notranslate"><span class="pre">my_module.py</span></code> file and then save the file:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">add_two_numbers</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>

<span class="k">def</span> <span class="nf">subtract_two_numbers</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">a</span> <span class="o">-</span> <span class="n">b</span>

<span class="k">def</span> <span class="nf">multiply_two_numbers</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="n">b</span>

<span class="k">def</span> <span class="nf">divide_two_numbers</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">a</span> <span class="o">/</span> <span class="n">b</span>
</pre></div>
</div>
</li>
<li><p>Add the following code to the <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code> or <code class="docutils literal notranslate"><span class="pre">setup.py</span></code> file and then save the file:</p>
<div class="js-code-language-tabs compound">
<div class="compound-first compound" lang="pyproject.toml">
<div class="compound-first highlight-text notranslate"><div class="highlight"><pre><span></span>[tool.poetry]
name = &quot;my_package&quot;
version = &quot;0.0.1&quot;
description = &quot;&lt;my-package-description&gt;&quot;
authors = [&quot;my-author-name &lt;my-author-name&gt;@&lt;my-organization&gt;&quot;]

[tool.poetry.dependencies]
python = &quot;^3.10&quot;

[build-system]
requires = [&quot;poetry-core&quot;]
build-backend = &quot;poetry.core.masonry.api&quot;

[tool.poetry.scripts]
main = &quot;my_package.main:main&quot;
</pre></div>
</div>
<ul class="compound-last simple">
<li><p>Replace <code class="docutils literal notranslate"><span class="pre">my-author-name</span></code> with your organization’s primary contact name.</p></li>
<li><p>Replace <code class="docutils literal notranslate"><span class="pre">my-author-name&gt;&#64;&lt;my-organization</span></code> with your organization’s primary email contact address.</p></li>
<li><p>Replace <code class="docutils literal notranslate"><span class="pre">&lt;my-package-description&gt;</span></code> with a display description for your Python wheel.</p></li>
</ul>
</div>
<div class="compound-last compound" lang="setup.py">
<div class="compound-first highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">setuptools</span> <span class="kn">import</span> <span class="n">setup</span><span class="p">,</span> <span class="n">find_packages</span>

<span class="kn">import</span> <span class="nn">src</span>

<span class="n">setup</span><span class="p">(</span>
  <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;my_package&quot;</span><span class="p">,</span>
  <span class="n">version</span> <span class="o">=</span> <span class="s2">&quot;0.0.1&quot;</span><span class="p">,</span>
  <span class="n">author</span> <span class="o">=</span> <span class="s2">&quot;&lt;my-author-name&gt;&quot;</span><span class="p">,</span>
  <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://&lt;my-url&gt;&quot;</span><span class="p">,</span>
  <span class="n">author_email</span> <span class="o">=</span> <span class="s2">&quot;&lt;my-author-name&gt;@&lt;my-organization&gt;&quot;</span><span class="p">,</span>
  <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;&lt;my-package-description&gt;&quot;</span><span class="p">,</span>
  <span class="n">packages</span><span class="o">=</span><span class="n">find_packages</span><span class="p">(</span><span class="n">where</span><span class="o">=</span><span class="s1">&#39;./src&#39;</span><span class="p">),</span>
  <span class="n">package_dir</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;&#39;</span><span class="p">:</span> <span class="s1">&#39;src&#39;</span><span class="p">},</span>
  <span class="n">entry_points</span><span class="o">=</span><span class="p">{</span>
    <span class="s2">&quot;packages&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="s2">&quot;main=my_package.main:main&quot;</span>
    <span class="p">]</span>
  <span class="p">},</span>
  <span class="n">install_requires</span><span class="o">=</span><span class="p">[</span>
    <span class="s2">&quot;setuptools&quot;</span>
  <span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
<ul class="compound-last simple">
<li><p>Replace <code class="docutils literal notranslate"><span class="pre">https://&lt;my-url&gt;</span></code> with your organization’s URL.</p></li>
<li><p>Replace <code class="docutils literal notranslate"><span class="pre">&lt;my-author-name&gt;</span></code> with your organization’s primary contact name.</p></li>
<li><p>Replace <code class="docutils literal notranslate"><span class="pre">&lt;my-author-name&gt;&#64;&lt;my-organization&gt;</span></code> with your organization’s primary email contact address.</p></li>
<li><p>Replace <code class="docutils literal notranslate"><span class="pre">&lt;my-package-description&gt;</span></code> with a display description for your Python wheel.</p></li>
</ul>
</div>
</div>
</li>
</ol>
</div>
<div class="section" id="step-3-create-the-bundles-configuration-file">
<span id="config-file"></span><h3>Step 3: Create the bundle’s configuration file<a class="headerlink" href="#step-3-create-the-bundles-configuration-file" title="Permalink to this headline"> </a></h3>
<p>A bundle configuration file describes the artifacts you want to deploy and the workflows you want to run.</p>
<ol class="arabic">
<li><p>In your bundle’s root, add a bundle configuration file named <code class="docutils literal notranslate"><span class="pre">databricks.yml</span></code>. Add the following code to this file:</p>
<div class="js-code-language-tabs compound">
<div class="compound-first compound" lang="Poetry">
<div class="compound-first admonition note">
<p class="admonition-title">Note</p>
<p>If you have already built a Python wheel and just want to deploy it, then modify the following bundle configuration file by omitting the <code class="docutils literal notranslate"><span class="pre">artifacts</span></code> mapping. The Databricks CLI will then assume that the Python wheel is already built and will automatically deploy the files that are specified in the <code class="docutils literal notranslate"><span class="pre">libraries</span></code> array’s <code class="docutils literal notranslate"><span class="pre">whl</span></code> entries.</p>
</div>
<div class="compound-last highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">bundle</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my-wheel-bundle</span>

<span class="nt">artifacts</span><span class="p">:</span>
<span class="w">  </span><span class="nt">default</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">whl</span>
<span class="w">    </span><span class="nt">build</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">poetry build</span>
<span class="w">    </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">.</span>

<span class="nt">resources</span><span class="p">:</span>
<span class="w">  </span><span class="nt">jobs</span><span class="p">:</span>
<span class="w">    </span><span class="nt">wheel-job</span><span class="p">:</span>
<span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">wheel-job</span>
<span class="w">      </span><span class="nt">tasks</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">task_key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">wheel-task</span>
<span class="w">          </span><span class="nt">new_cluster</span><span class="p">:</span>
<span class="w">            </span><span class="nt">spark_version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">13.3.x-scala2.12</span>
<span class="w">            </span><span class="nt">node_type_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">i3.xlarge</span>
<span class="w">            </span><span class="nt">data_security_mode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">USER_ISOLATION</span>
<span class="w">            </span><span class="nt">num_workers</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">          </span><span class="nt">python_wheel_task</span><span class="p">:</span>
<span class="w">            </span><span class="nt">entry_point</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">main</span>
<span class="w">            </span><span class="nt">package_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my_package</span>
<span class="w">          </span><span class="nt">libraries</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">whl</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./dist/*.whl</span>

<span class="nt">targets</span><span class="p">:</span>
<span class="w">  </span><span class="nt">dev</span><span class="p">:</span>
<span class="w">    </span><span class="nt">workspace</span><span class="p">:</span>
<span class="w">    </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;workspace-url&gt;</span>
</pre></div>
</div>
</div>
<div class="compound-last compound" lang="setuptools">
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">bundle</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my-wheel-bundle</span>

<span class="nt">resources</span><span class="p">:</span>
<span class="w">  </span><span class="nt">jobs</span><span class="p">:</span>
<span class="w">    </span><span class="nt">wheel-job</span><span class="p">:</span>
<span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">wheel-job</span>
<span class="w">      </span><span class="nt">tasks</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">task_key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">wheel-task</span>
<span class="w">          </span><span class="nt">new_cluster</span><span class="p">:</span>
<span class="w">            </span><span class="nt">spark_version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">13.3.x-scala2.12</span>
<span class="w">            </span><span class="nt">node_type_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">i3.xlarge</span>
<span class="w">            </span><span class="nt">data_security_mode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">USER_ISOLATION</span>
<span class="w">            </span><span class="nt">num_workers</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">          </span><span class="nt">python_wheel_task</span><span class="p">:</span>
<span class="w">            </span><span class="nt">entry_point</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">main</span>
<span class="w">            </span><span class="nt">package_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my_package</span>
<span class="w">          </span><span class="nt">libraries</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">whl</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./dist/*.whl</span>

<span class="nt">targets</span><span class="p">:</span>
<span class="w">  </span><span class="nt">dev</span><span class="p">:</span>
<span class="w">    </span><span class="nt">workspace</span><span class="p">:</span>
<span class="w">    </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;workspace-url&gt;</span>
</pre></div>
</div>
</div>
</div>
<p>Replace <code class="docutils literal notranslate"><span class="pre">&lt;workspace-url&gt;</span></code> with your <a class="reference internal" href="../../workspace/workspace-details.html#workspace-url"><span class="std std-ref">workspace instance URL</span></a>, for example <code class="docutils literal notranslate"><span class="pre">https://dbc-a1b2345c-d6e7.cloud.databricks.com</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">artifacts</span></code> mapping is required to build Python wheels with Poetry and is optional to build Python wheels with <code class="docutils literal notranslate"><span class="pre">setuptools</span></code>. The <code class="docutils literal notranslate"><span class="pre">artifacts</span></code> mapping contains one or more artifact definitions with the following mappings:</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">type</span></code> mapping must be present and set to <code class="docutils literal notranslate"><span class="pre">whl</span></code> to specify that a Python wheel is to be built. For <code class="docutils literal notranslate"><span class="pre">setuptools</span></code>, <code class="docutils literal notranslate"><span class="pre">whl</span></code> is the default if no artifact definitions are specified.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">path</span></code> mapping indicates the path to the <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code> file for Poetry or to the <code class="docutils literal notranslate"><span class="pre">setup.py</span></code> file for <code class="docutils literal notranslate"><span class="pre">setuptools</span></code>. This path is relative to the <code class="docutils literal notranslate"><span class="pre">databricks.yml</span></code> file. For <code class="docutils literal notranslate"><span class="pre">setuptools</span></code>, this path is <code class="docutils literal notranslate"><span class="pre">.</span></code> (the same directory as the <code class="docutils literal notranslate"><span class="pre">databricks.yml</span></code> file) by default.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">build</span></code> mapping indicates any custom build commands to run to build the Python wheel. For <code class="docutils literal notranslate"><span class="pre">setuptools</span></code>, this command is <code class="docutils literal notranslate"><span class="pre">python3</span> <span class="pre">setup.py</span> <span class="pre">bdist</span> <span class="pre">wheel</span></code> by default.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">files</span></code> mapping consists of one or more <code class="docutils literal notranslate"><span class="pre">source</span></code> mappings that specify any additional files to include in the Python wheel build. There is no default.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you want to install the Python wheel on a target cluster that has Databricks Runtime 13.0 or below installed, you must add the following top-level mapping to the <code class="docutils literal notranslate"><span class="pre">databricks.yml</span></code> file:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># Applies to jobs with python_wheel_task and that use</span>
<span class="c1"># clusters with Databricks Runtime 13.0 or below installed.</span>
<span class="nt">experimental</span><span class="p">:</span>
<span class="w">  </span><span class="nt">python_wheel_wrapper</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</pre></div>
</div>
<p>This mapping instructs the Databricks CLI to do the following:</p>
<ul class="simple">
<li><p>Deploys a copy of the Python wheel in the background. This deployment path is typically <code class="docutils literal notranslate"><span class="pre">${workspace.artifact_path}/.internal/&lt;random-id&gt;/&lt;wheel-filename&gt;.whl</span></code>.</p></li>
<li><p>Creates a notebook in the background that contains instructions to install the preceding deployed Python wheel on the target cluster. This notebook’s path is typically <code class="docutils literal notranslate"><span class="pre">${workspace.file_path}/.databricks/bundle/&lt;target-name&gt;/.internal/notebook_&lt;job-name&gt;_&lt;task-key&gt;</span></code>.</p></li>
<li><p>When you run a job that contains a Python wheel task, and that task references the preceding Python wheel, a job is created in the background that runs the preceding notebook.</p></li>
</ul>
<p>You do not need to specify this mapping for target clusters with Databricks Runtime 13.1 or above installed, as Python wheel installations from the Databricks workspace file system will install automatically on these target clusters.</p>
</div>
</li>
<li><p>If you use Poetry, do the following:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://python-poetry.org/docs/#installation">Install Poetry</a>, version 1.6 or above, if it is not already installed. To check your installed version of Poetry, run the command <code class="docutils literal notranslate"><span class="pre">poetry</span> <span class="pre">-V</span></code> or <code class="docutils literal notranslate"><span class="pre">poetry</span> <span class="pre">--version</span></code>.</p></li>
<li><p>Make sure you have Python version 3.10 or above installed. To check your version of Python, run the command <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">-V</span></code> or <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">--version</span></code>.</p></li>
<li><p>Make sure you have Databricks CLI version 0.209.0 or above. To your version of the Databricks CLI, run the command <code class="docutils literal notranslate"><span class="pre">databricks</span> <span class="pre">-v</span></code> or <code class="docutils literal notranslate"><span class="pre">databricks</span> <span class="pre">--version</span></code>. See <a class="reference internal" href="../cli/install.html"><span class="doc">Install or update the Databricks CLI</span></a>.</p></li>
</ul>
</li>
<li><p>If you use <code class="docutils literal notranslate"><span class="pre">setuptools</span></code>, install the <code class="docutils literal notranslate"><span class="pre">wheel</span></code> and <code class="docutils literal notranslate"><span class="pre">setuptools</span></code> packages if they are not already installed, by running the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip3<span class="w"> </span>install<span class="w"> </span>--upgrade<span class="w"> </span>wheel<span class="w"> </span>setuptools
</pre></div>
</div>
</li>
<li><p>If you intend to store this bundle with a Git provider, add a <code class="docutils literal notranslate"><span class="pre">.gitignore</span></code> file in the project’s root, and add the following entries to this file:</p>
<div class="js-code-language-tabs compound">
<div class="compound-first compound" lang="Poetry">
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>.databricks
dist
</pre></div>
</div>
</div>
<div class="compound-last compound" lang="setuptools">
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>.databricks
build
dist
src/my_package/my_package.egg-info
</pre></div>
</div>
</div>
</div>
</li>
</ol>
</div>
<div class="section" id="step-3-validate-the-projects-bundle-configuration-file">
<h3>Step 3: Validate the project’s bundle configuration file<a class="headerlink" href="#step-3-validate-the-projects-bundle-configuration-file" title="Permalink to this headline"> </a></h3>
<p>In this step, you check whether the bundle configuration is valid.</p>
<ol class="arabic">
<li><p>From the root directory, validate the bundle configuration file:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>databricks<span class="w"> </span>bundle<span class="w"> </span>validate
</pre></div>
</div>
</li>
<li><p>If a JSON representation of the bundle configuration is returned, then the validation succeeded. If any errors are returned, fix the errors, and then repeat this step.</p></li>
</ol>
<p>If you make any changes to your bundle after this step, you should repeat this step to check whether your bundle configuration is still valid.</p>
</div>
<div class="section" id="step-4-build-the-python-wheel-and-deploy-the-local-project-to-the-remote-workspace">
<h3>Step 4: Build the Python wheel and deploy the local project to the remote workspace<a class="headerlink" href="#step-4-build-the-python-wheel-and-deploy-the-local-project-to-the-remote-workspace" title="Permalink to this headline"> </a></h3>
<p>Build the Python wheel locally, deploy the built Python wheel to your workspace, deploy the notebook to your workspace, and create the job in your workspace:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>databricks<span class="w"> </span>bundle<span class="w"> </span>deploy<span class="w"> </span>-t<span class="w"> </span>dev
</pre></div>
</div>
</div>
<div class="section" id="step-5-run-the-deployed-project">
<h3>Step 5: Run the deployed project<a class="headerlink" href="#step-5-run-the-deployed-project" title="Permalink to this headline"> </a></h3>
<ol class="arabic">
<li><p>Run the deployed job, which uses the deployed notebook to call the deployed Python wheel:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>databricks<span class="w"> </span>bundle<span class="w"> </span>run<span class="w"> </span>-t<span class="w"> </span>dev<span class="w"> </span>wheel-job
</pre></div>
</div>
</li>
<li><p>In the output, copy the <code class="docutils literal notranslate"><span class="pre">Run</span> <span class="pre">URL</span></code> and paste it into your web browser’s address bar.</p></li>
<li><p>In the job run’s <strong>Output</strong> page, the following results appear:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>200 + 400 = 600
400 - 200 = 200
200 * 400 = 80000
400 / 200 = 2.0
</pre></div>
</div>
</li>
</ol>
<p>If you make any changes to your bundle after this step, you should repeat steps 3-5 to check whether your bundle configuration is still valid, redeploy the project, and run the redeployed project.</p>
</div>
</div>
<div class="section" id="build-and-install-a-python-wheel-for-a-job">
<h2>Build and install a Python wheel for a job<a class="headerlink" href="#build-and-install-a-python-wheel-for-a-job" title="Permalink to this headline"> </a></h2>
<p>To build a Python wheel with Poetry or <code class="docutils literal notranslate"><span class="pre">setuptools</span></code>, and then use that Python wheel in a job, you must add one or two mappings to your <code class="docutils literal notranslate"><span class="pre">databricks.yml</span></code> file.</p>
<p>If you use Poetry, you must include the following <code class="docutils literal notranslate"><span class="pre">artifacts</span></code> mapping in the <code class="docutils literal notranslate"><span class="pre">databricks.yml</span></code> file. This mapping runs the <code class="docutils literal notranslate"><span class="pre">poetry</span> <span class="pre">build</span></code> command and uses the <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code> file that is in the same directory as the <code class="docutils literal notranslate"><span class="pre">databricks.yml</span></code> file:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">artifacts</span><span class="p">:</span>
<span class="w">  </span><span class="nt">default</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">whl</span>
<span class="w">    </span><span class="nt">build</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">poetry build</span>
<span class="w">    </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">.</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">artifacts</span></code> mapping is optional for <code class="docutils literal notranslate"><span class="pre">setuptools</span></code>. By default, for <code class="docutils literal notranslate"><span class="pre">setuptools</span></code> the Databricks CLI runs the command <code class="docutils literal notranslate"><span class="pre">python3</span> <span class="pre">setup.py</span> <span class="pre">bdist_wheel</span></code> and uses the <code class="docutils literal notranslate"><span class="pre">setup.py</span></code> file that is in the same directory as the <code class="docutils literal notranslate"><span class="pre">databricks.yml</span></code> file. The Databricks CLI assumes that you have already run a command such as <code class="docutils literal notranslate"><span class="pre">pip3</span> <span class="pre">install</span> <span class="pre">--upgrade</span> <span class="pre">wheel</span> <span class="pre">setuptools</span></code> to install the <code class="docutils literal notranslate"><span class="pre">wheel</span></code> and <code class="docutils literal notranslate"><span class="pre">setuptools</span></code> packages if they are not already installed.</p>
</div>
<p>Also, the job task’s <code class="docutils literal notranslate"><span class="pre">libraries</span></code> mapping must contain a <code class="docutils literal notranslate"><span class="pre">whl</span></code> value that specifies the path to the built Python wheel relative to the <code class="docutils literal notranslate"><span class="pre">databricks.yml</span></code> file. The following example shows this in a notebook task (the ellipsis indicates omitted content for brevity):</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">resources</span><span class="p">:</span>
<span class="w">  </span><span class="nt">jobs</span><span class="p">:</span>
<span class="w">    </span><span class="nt">my-notebook-job</span><span class="p">:</span>
<span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my-notebook-job</span>
<span class="w">      </span><span class="nt">tasks</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">task_key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my-notebook-job-notebook-task</span>
<span class="w">          </span><span class="nt">notebook_task</span><span class="p">:</span>
<span class="w">            </span><span class="nt">notebook_path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./my_notebook.py</span>
<span class="w">          </span><span class="nt">libraries</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">whl</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./dist/*.whl</span>
<span class="w">          </span><span class="nt">new_cluster</span><span class="p">:</span>
<span class="w">            </span><span class="c1"># ...</span>
</pre></div>
</div>
</div>
<div class="section" id="build-and-install-a-python-wheel-for-a-pipeline">
<h2>Build and install a Python wheel for a pipeline<a class="headerlink" href="#build-and-install-a-python-wheel-for-a-pipeline" title="Permalink to this headline"> </a></h2>
<p>To build a Python wheel with Poetry or <code class="docutils literal notranslate"><span class="pre">setuptools</span></code> and then reference that Python wheel in a Delta Live Tables pipeline, you must add a mapping to your <code class="docutils literal notranslate"><span class="pre">databricks.yml</span></code> file if you use Poetry, and you must add a <code class="docutils literal notranslate"><span class="pre">%pip</span> <span class="pre">install</span></code> command to your pipeline notebook, as follows.</p>
<p>If you use Poetry, you must include the following <code class="docutils literal notranslate"><span class="pre">artifacts</span></code> mapping in the <code class="docutils literal notranslate"><span class="pre">databricks.yml</span></code> file. This mapping runs the <code class="docutils literal notranslate"><span class="pre">poetry</span> <span class="pre">build</span></code> command and uses the <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code> file that is in the same directory as the <code class="docutils literal notranslate"><span class="pre">databricks.yml</span></code> file:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">artifacts</span><span class="p">:</span>
<span class="w">  </span><span class="nt">default</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">whl</span>
<span class="w">    </span><span class="nt">build</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">poetry build</span>
<span class="w">    </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">.</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">artifacts</span></code> mapping is optional for <code class="docutils literal notranslate"><span class="pre">setuptools</span></code>. By default, for <code class="docutils literal notranslate"><span class="pre">setuptools</span></code> the Databricks CLI runs the command <code class="docutils literal notranslate"><span class="pre">python3</span> <span class="pre">setup.py</span> <span class="pre">bdist_wheel</span></code> and uses the <code class="docutils literal notranslate"><span class="pre">setup.py</span></code> file that is in the same directory as the <code class="docutils literal notranslate"><span class="pre">databricks.yml</span></code> file. The Databricks CLI assumes that you have already run a command such as <code class="docutils literal notranslate"><span class="pre">pip3</span> <span class="pre">install</span> <span class="pre">--upgrade</span> <span class="pre">wheel</span> <span class="pre">setuptools</span></code> to install the <code class="docutils literal notranslate"><span class="pre">wheel</span></code> and <code class="docutils literal notranslate"><span class="pre">setuptools</span></code> packages if they are not already installed.</p>
</div>
<p>Also, the related pipeline notebook must include a <code class="docutils literal notranslate"><span class="pre">%pip</span> <span class="pre">install</span></code> command to install the Python wheel that is built. See <a class="reference internal" href="../../delta-live-tables/external-dependencies.html#python-libraries"><span class="std std-ref">Python libraries</span></a>.</p>
</div>
</div>


    
          </div>
        </div>
        <div  class="suapp-rating">
  <div id="suPageRateApp">
     <su-app></su-app>
   </div> 
 </div>
<hr> 
<footer>
  <div role="contentinfo">
      <p class="copyright">
          &copy; Databricks 2023. All rights reserved. Apache, Apache Spark, Spark, and the Spark logo are trademarks of the <a href="http://www.apache.org/">Apache Software Foundation</a>.
      </p>
      <p> 
        
          <a id='feedbacklink' href="mailto:doc-feedback@databricks.com?subject=Documentation Feedback">Send us feedback</a>
        
     | <a href="https://databricks.com/privacy-policy">Privacy Policy</a> | <a href="https://databricks.com/terms-of-use">Terms of Use</a></p>

  </div> 

</footer>
      </div>
    </div>
  </section>
</main>

  </page>
  
  <script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
      URL_ROOT: '../../',
      VERSION: '1.0',
      COLLAPSE_INDEX: false,
      FILE_SUFFIX: '.html',
      HAS_SOURCE: 'false'
    };
  </script>
  <script type="text/javascript" src="../../_static/jquery.js"></script>
  <script type="text/javascript" src="../../_static/underscore.js"></script>
  <script type="text/javascript" src="../../_static/doctools.js"></script>
  <script type="text/javascript" src="../../_static/language_data.js"></script>
  

  <script type="text/javascript" src="../../_static/js/clipboard.min.js"></script>
  <script type="text/javascript" src="../../_static/js/jquery.waypoints.min.js"></script>

  <!-- Select2 (https://select2.org/) -->
  <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
  <!-- End Select2 -->

  
  
  <script type="text/javascript" src="../../_static/js/localized.js"></script>
  <script type="text/javascript" src="../../_static/js/custom.js"></script>
  

  
  
  <script type="text/javascript">
    jQuery(function () {
      SphinxRtdTheme.StickyNav.enable();
    });

  </script>
  
 



  <script>
  window.__searchunifyLoaderConfig = JSON.parse('{"clients": {"en": "02c2e804-27e9-11ee-aefb-0242ac120011", "ja": "6a42c3f2-2820-11ee-aefb-0242ac120011", "pt": "6a86badd-2821-11ee-aefb-0242ac120011"}}')
</script>
<script type="text/javascript" src="../../_static/js/search-loader.js"></script>
</body>
<script type='text/javascript'>
  window.onload = function () {
    var description = document.querySelector('meta[name="description"]').getAttribute("content");
    let titleText = document.querySelector('h1').textContent;
    document.querySelector('meta[property="og:title"]').setAttribute("content", titleText);
    document.querySelector('meta[property="og:description"]').setAttribute("content", description);
    document.querySelector('meta[property="twitter:description"]').setAttribute("content", description);
  };
</script>

</html>