

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en-US" > <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en-US"> <!--<![endif]-->

<head>
  <!-- cookie consent -->
  
    <!-- Combined Onetrust and Rudderstack Implementation Scripts -->
    <!-- Onetrust Initialization -->
    <script type="text/javascript" src="https://cdn.cookielaw.org/consent/92466579-1717-44d3-809d-a05fb02843ed-test/OtAutoBlock.js"></script>
    <script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" data-document-language="true" type="text/javascript" charset="UTF-8" data-domain-script="92466579-1717-44d3-809d-a05fb02843ed-test"></script>
    <link rel="stylesheet" id="db-onetrust-style" href="https://www.databricks.com/wp-content/uploads/db_onetrust.css" media="all" />
    <!-- Setting Rudderstack Write Key -->
    <script>window.rudderstackKey = "2SOR9fvSr5Fi6tN2ihPbVHnX1SZ" </script>
    <!-- Rudderstack Initialization + Onetrust Integration + Rudderstack Custom Events -->
    <script type="text/javascript" src="https://www.databricks.com/sites/default/files/rudderstack/v1/db-rudderstack-events.js"></script>

  <!-- cookie consent -->

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="X-UA-Compatible" content="IE=9" />
  <meta content="Learn about ANSI compliance in the SQL language constructs supported in Databricks Runtime." name="description" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
  <meta property="og:image" content="https://www.databricks.com/wp-content/uploads/2020/04/og-databricks.png">
  <meta property="og:image:type" content="image/png">
  <meta property="og:title" content="ANSI compliance in Databricks Runtime">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://docs.databricks.com">
  <meta property="og:description" content="" id="og-description">
  <meta name="twitter:image" content="https://www.databricks.com/wp-content/uploads/2020/04/og-databricks.png">
  <meta name="twitter:site" content="@databricks">
  <meta name="twitter:creator" content="@databricks">
  <meta property="twitter:description" content="">
  
  <title>ANSI compliance in Databricks Runtime &#124; Databricks on AWS</title>
  
  
  <link rel="canonical" href="https://docs.databricks.com/en/sql/language-manual/sql-ref-ansi-compliance.html">
  <!-- Start hreflang tag -->
  <link rel="alternate" hreflang="en" href="https://docs.databricks.com/en/sql/language-manual/sql-ref-ansi-compliance.html" />
<link rel="alternate" hreflang="x-default" href="https://docs.databricks.com/en/sql/language-manual/sql-ref-ansi-compliance.html" />
  <!-- End hreflang tag -->
  
  
  <link rel="shortcut icon" href="../../_static/favicon.ico" />
  

  

  

  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;
j.setAttributeNode(d.createAttribute('data-ot-ignore'));
f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-T85FQ33');</script>
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;
j.setAttributeNode(d.createAttribute('data-ot-ignore'));
f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-TWTKQQ');</script>
    
  <!-- End Google Tag Manager -->


  <!-- MaxMind / GEO IP -->
  <script src="//js.maxmind.com/js/apis/geoip2/v2.1/geoip2.js" type="text/javascript"></script>
  <!-- End MaxMind / GEO IP -->

  
  
  <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600&display=swap" rel="stylesheet">
  <link rel="preload" href="../../_static/fonts/DMSans-Bold.ttf" as="font">
  <link rel="preload" href="../../_static/fonts/DMSans-Regular.ttf" as="font">
  <link rel="preload" href="../../_static/fonts/DMMono-Regular.ttf" as="font">
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/cloud-provider-selector.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/translation-selector.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/searchunify/main.css" type="text/css" />

  
  <link rel="index" title="Index" href="../../genindex.html" />
  <link rel="search" title="Search" href="../../search.html" />
  <link rel="top" title="Databricks on AWS" href="../../index.html" /> 
</head>

<body class="wy-body-for-nav" role="document">

  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T85FQ33"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TWTKQQ"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->

  
  <nav class="wy-nav-top header su_header" role="navigation" aria-label="top navigation">
    
<nav class="wy-nav-top header su_header" role="navigation" aria-label="top navigation">
  <div class="container-logo">
    <ul class="mobile-menu-toggle">
        <li class="menu-toggle">
            <i data-toggle="wy-nav-top" class="wy-nav-top-menu-button db-icon db-icon-menu pull-left"></i>
            
            <a href="https://www.databricks.com/" class="wy-nav-top-logo"><img src="../../_static/small-scale-lockup-full-color-rgb.svg" width="137" height="21"
              alt="Databricks" /></a>   
               
              </li>
    </ul>
    <ul class="su_nav-menu">
      <li class="menu-toggle">
        <i data-toggle="wy-nav-top" class="wy-nav-top-menu-button db-icon db-icon-menu pull-left"></i>
        
          
        
        <a href="https://www.databricks.com/" class="wy-nav-top-logo"><img src="../../_static/small-scale-lockup-full-color-rgb.svg" width="137" height="21"
            alt="Databricks" /></a></li>
        <!-- 
<li><a href="https://help.databricks.com/s/">Help Center</a></li>
<li class="active"><a href="https://docs.databricks.com/en/">Documentation</a></li>
<li><a href="https://kb.databricks.com/">Knowledge Base</a></li>
 -->
    </ul>
  </div>
  <div class="su_nav-right">
    <ul class="su_link-mobile">
  <!-- Mobile header code can go here -->
</ul>
<ul class="right-try-list">
   
</ul>
  </div>
</nav>
  </nav>

  <div class="su_sub-header">
    <div class="container">
      <div class="su_sub-header-inner">
        <!-- <div class="su_subnav-menu-right">
  <div id="auto" style="width: 100%;">
    <div ng-controller="SearchautoController">
      <div bind-html-compile="autocompleteHtml">
        <form class="su__search-box-1" disabled="disabled">
          <input class="su__search-input" type="search" name="Search box" id="su__search-b" placeholder="Search Documentation" disabled="disabled"/>
          <button class="su__search-button" type="submit" class="button button-success" disabled="disabled">
            <svg width="24" height="24" viewBox="0 0 24 24">
              <path
                d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"
                fill="#333"></path>
            </svg>
          </button>
        </form>
      </div>
    </div>
  </div>
</div> -->
        <div class="search-lng-gap"></div>
        <div style="margin-left: 16px; margin-right: 16px;">
          <!-- <select name="lng selector" id="lng-selector">
    <option value="../../../en/sql/language-manual/sql-ref-ansi-compliance.html" class="notranslate">English</option>
    <option value="../../../ja/sql/language-manual/sql-ref-ansi-compliance.html" class="notranslate">日本語</option>
    <option value="../../../pt/sql/language-manual/sql-ref-ansi-compliance.html" class="notranslate">Português (Brasil)</option>
</select> -->
        </div>
        <div class="cloud-selector-container">
          <!-- <select name="cloud provider selector" id="cloud-provider-selector">
    <option value="aws" selected class="notranslate">
        Amazon Web Services
    </option>
    <option value="azure"  class="notranslate">
        Microsoft Azure
    </option>
    <option value="gcp"  class="notranslate">
        Google Cloud Platform
    </option>
</select> -->
        </div>
      </div>
    </div>
  </div>
  <page class="js-page-container">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side su_nav-side">
<div class="wy-side-scroll">
  <div class="wy-side-nav-search">
    

    

    

    
  </div>

  <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
    
      <a href="../../index.html" class="main-navigation-home">Databricks on AWS</a>
    

    
      

      
        <p class="caption"><span class="caption-text">Load &amp; manage data</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../rag-temp/index.html">RAG Studio</a></li>
</ul>

      
    
  </div>

  <div role="contentinfo">
    
  <p class="build_info notranslate"data-last-edit="December 23, 2023">
    Updated Jan 11, 2024
  </p>
<script>
  window.addEventListener('DOMContentLoaded',function(){
    var h1=document.querySelector('h1');
    var bi=document.querySelector('[data-last-edit]');
    if(h1 && bi){
      var ver = document.createElement('p');
      ver.className = 'version_info';
      ver.textContent = bi.getAttribute('data-last-edit');
      h1.parentElement.insertBefore(ver, h1.nextElementSibling);
    }
  });
</script>

    <p>
      
        <a id='feedbacklink' href="mailto:doc-feedback@databricks.com?subject=Documentation Feedback">Send us feedback</a>
      
    </p>
  </div>
</div>
</nav>
    
    
<main class="wy-grid-for-nav su_nav-grid">
  <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
    <div class="wy-nav-content su__nav_content">
      <div class="rst-content">
        





<div role="navigation" aria-label="breadcrumbs navigation" class="wy-breadcrumbs-wrapper">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Documentation</a> <span class="db-icon db-icon-chevron-right"></span></li>
    
    
      <li>ANSI compliance in Databricks Runtime</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>
</div>
        
        <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
          <div itemprop="articleBody">
            
    
  <div class="section" id="ansi-compliance-in-databricks-runtime">
<span id="ansi-compliance-in-dbr"></span><h1>ANSI compliance in Databricks Runtime<a class="headerlink" href="#ansi-compliance-in-databricks-runtime" title="Permalink to this headline"> </a></h1>
<p><strong>Applies to:</strong> <img alt="check marked yes" src="../../_images/check.png" /> Databricks Runtime</p>
<p>This article describes ANSI compliance in Databricks Runtime. For ANSI mode in Databricks SQL, see <a class="reference internal" href="parameters/ansi_mode.html"><span class="doc">ANSI_MODE</span></a>.</p>
<p>Spark SQL has two options to support compliance with the ANSI SQL standard: <code class="docutils literal notranslate"><span class="pre">spark.sql.ansi.enabled</span></code> and <code class="docutils literal notranslate"><span class="pre">spark.sql.storeAssignmentPolicy</span></code>.</p>
<p>When <code class="docutils literal notranslate"><span class="pre">spark.sql.ansi.enabled</span></code> is set to <code class="docutils literal notranslate"><span class="pre">true</span></code>, Spark SQL uses an ANSI compliant dialect instead of being Hive compliant. For example, Spark will throw an exception at runtime instead of returning null results if the inputs to a SQL operator/function are invalid. Some ANSI dialect features may be not from the ANSI SQL standard directly, but their behaviors align with ANSI SQL’s style.</p>
<p>Moreover, Spark SQL has an independent option to control implicit casting behaviours when storing rows in a table.
The casting behaviours are defined as store assignment rules in the standard.</p>
<p>When <code class="docutils literal notranslate"><span class="pre">spark.sql.storeAssignmentPolicy</span></code> is set to <code class="docutils literal notranslate"><span class="pre">ANSI</span></code>, Spark SQL complies with the ANSI store assignment rules. This is a separate configuration because its default value is <code class="docutils literal notranslate"><span class="pre">ANSI</span></code>, while the configuration <code class="docutils literal notranslate"><span class="pre">spark.sql.ansi.enabled</span></code> is disabled by default.</p>
<p>The following table summarizes the behavior:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Property Name</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">spark.sql.ansi.enabled</span></code></p></td>
<td><p>false</p></td>
<td><p> When true, Spark attempts to conform to the ANSI SQL specification:</p>
<ul class="simple">
<li><p>Throws a runtime exception if an overflow occurs in any operation on an integer or decimal field.</p></li>
<li><p>Forbids using the reserved keywords of ANSI SQL as identifiers in the SQL parser.</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">spark.sql.storeAssignmentPolicy</span></code></p></td>
<td><p>ANSI</p></td>
<td><p> When storing a value into a column with a different data type, Spark performs type conversion. There are three policies for the type coercion rules: <code class="docutils literal notranslate"><span class="pre">ANSI</span></code>, <code class="docutils literal notranslate"><span class="pre">legacy</span></code>, and <code class="docutils literal notranslate"><span class="pre">strict</span></code>.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ANSI</span></code>: Spark performs the type coercion as per ANSI SQL. In practice, the behavior is mostly the same as PostgreSQL.  It disallows certain unreasonable type conversions such as converting string to int or double to boolean.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">legacy</span></code>: Spark allows the type coercion as long as it is a valid Cast, which is very loose.  For example, converting string to int or double to boolean is allowed.  It is also the only behavior in Spark 2.x and it is compatible with Hive.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">strict</span></code>: Spark doesn’t allow any possible precision loss or data truncation in type coercion, for example, converting double to int or decimal to double is not allowed.</p></li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>The following subsections present behavior changes in arithmetic operations, type conversions, and SQL parsing when ANSI mode is enabled.
For type conversions in Spark SQL, there are three kinds of them and this article will introduce them one by one: cast, store assignment and type coercion.</p>
<div class="section" id="arithmetic-operations">
<h2>Arithmetic operations<a class="headerlink" href="#arithmetic-operations" title="Permalink to this headline"> </a></h2>
<p>In Spark SQL, arithmetic operations performed on numeric types (with the exception of decimal) are not checked for overflows by default.
This means that in case an operation causes overflows, the result is the same with the corresponding operation in a Java or Scala program (For example, if the sum of 2 integers is higher than the maximum value representable, the result is a negative number). On the other hand, Spark SQL returns null for decimal overflows.
When <code class="docutils literal notranslate"><span class="pre">spark.sql.ansi.enabled</span></code> is set to <code class="docutils literal notranslate"><span class="pre">true</span></code> and an overflow occurs in numeric and interval arithmetic operations, it throws an arithmetic exception at runtime.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="c1">-- `spark.sql.ansi.enabled=true`</span>
<span class="o">&gt;</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="mi">2147483647</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w"> </span><span class="n">error</span><span class="p">:</span><span class="w"> </span><span class="nb">integer</span><span class="w"> </span><span class="n">overflow</span>

<span class="c1">-- `spark.sql.ansi.enabled=false`</span>
<span class="o">&gt;</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="mi">2147483647</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">  </span><span class="o">-</span><span class="mi">2147483648</span>
</pre></div>
</div>
</div>
<div class="section" id="cast">
<h2>Cast<a class="headerlink" href="#cast" title="Permalink to this headline"> </a></h2>
<p>When <code class="docutils literal notranslate"><span class="pre">spark.sql.ansi.enabled</span></code> is set to <code class="docutils literal notranslate"><span class="pre">true</span></code>, explicit casting by <code class="docutils literal notranslate"><span class="pre">CAST</span></code> syntax throws a runtime exception for illegal cast patterns defined in the standard, such as casts from a string to an integer.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">CAST</span></code> clause of Spark ANSI mode follows the syntax rules of section 6.13 “cast specification” in
<a class="reference external" href="https://www.iso.org/standard/53682.html">ISO/IEC 9075-2:2011 Information technology — Database languages - SQL — Part 2: Foundation (SQL/Foundation)</a>,
except it specially allows the following straightforward type conversions which are disallowed as per the ANSI standard:</p>
<ul class="simple">
<li><p>NumericType &lt;=&gt; BooleanType</p></li>
<li><p>StringType &lt;=&gt; BinaryType</p></li>
</ul>
<p>The valid combinations of source and target data type in a <code class="docutils literal notranslate"><span class="pre">CAST</span></code> expression are given by the following table.
“Y” indicates that the combination is syntactically valid without restriction and “N” indicates that the combination is not valid.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 9%" />
<col style="width: 8%" />
<col style="width: 5%" />
<col style="width: 12%" />
<col style="width: 11%" />
<col style="width: 9%" />
<col style="width: 8%" />
<col style="width: 7%" />
<col style="width: 4%" />
<col style="width: 8%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>SourceTarget</p></th>
<th class="head"><p>Numeric</p></th>
<th class="head"><p>String</p></th>
<th class="head"><p>Date</p></th>
<th class="head"><p>Timestamp</p></th>
<th class="head"><p>Interval</p></th>
<th class="head"><p>Boolean</p></th>
<th class="head"><p>Binary</p></th>
<th class="head"><p>Array</p></th>
<th class="head"><p>Map</p></th>
<th class="head"><p>Struct</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p> Numeric</p></td>
<td><p> Y</p></td>
<td><p> Y</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> Y</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
</tr>
<tr class="row-odd"><td><p> String</p></td>
<td><p> Y</p></td>
<td><p> Y</p></td>
<td><p> Y</p></td>
<td><p> Y</p></td>
<td><p> Y</p></td>
<td><p> Y</p></td>
<td><p> Y</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
</tr>
<tr class="row-even"><td><p> Date</p></td>
<td><p> N</p></td>
<td><p> Y</p></td>
<td><p> Y</p></td>
<td><p> Y</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
</tr>
<tr class="row-odd"><td><p> Timestamp</p></td>
<td><p> N</p></td>
<td><p> Y</p></td>
<td><p> Y</p></td>
<td><p> Y</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
</tr>
<tr class="row-even"><td><p> Interval</p></td>
<td><p> N</p></td>
<td><p> Y</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> Y</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
</tr>
<tr class="row-odd"><td><p> Boolean</p></td>
<td><p> Y</p></td>
<td><p> Y</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> Y</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
</tr>
<tr class="row-even"><td><p> Binary</p></td>
<td><p> Y</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> Y</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
</tr>
<tr class="row-odd"><td><p> Array</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> Y</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
</tr>
<tr class="row-even"><td><p> Map</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> Y</p></td>
<td><p> N</p></td>
</tr>
<tr class="row-odd"><td><p> Struct</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> Y</p></td>
</tr>
</tbody>
</table>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="c1">-- Examples of explicit casting</span>

<span class="c1">-- `spark.sql.ansi.enabled=true`</span>
<span class="o">&gt;</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="k">CAST</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="nb">INT</span><span class="p">);</span>
<span class="w">  </span><span class="n">error</span><span class="p">:</span><span class="w"> </span><span class="n">invalid</span><span class="w"> </span><span class="k">input</span><span class="w"> </span><span class="n">syntax</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="k">type</span><span class="w"> </span><span class="nb">numeric</span><span class="p">:</span><span class="w"> </span><span class="n">a</span>

<span class="o">&gt;</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="k">CAST</span><span class="p">(</span><span class="mi">2147483648</span><span class="n">L</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="nb">INT</span><span class="p">);</span>
<span class="w">  </span><span class="n">error</span><span class="p">:</span><span class="w"> </span><span class="n">Casting</span><span class="w"> </span><span class="mi">2147483648</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="nb">int</span><span class="w"> </span><span class="n">causes</span><span class="w"> </span><span class="n">overflow</span>

<span class="o">&gt;</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="k">CAST</span><span class="p">(</span><span class="nb">DATE</span><span class="s1">&#39;2020-01-01&#39;</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="nb">INT</span><span class="p">)</span>
<span class="w">  </span><span class="n">error</span><span class="p">:</span><span class="w"> </span><span class="n">cannot</span><span class="w"> </span><span class="n">resolve</span><span class="w"> </span><span class="s1">&#39;CAST(DATE &#39;</span><span class="mi">2020</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="s1">&#39; AS INT)&#39;</span><span class="w"> </span><span class="n">due</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="k">data</span><span class="w"> </span><span class="k">type</span><span class="w"> </span><span class="n">mismatch</span><span class="p">:</span><span class="w"> </span><span class="n">cannot</span><span class="w"> </span><span class="k">cast</span><span class="w"> </span><span class="nb">date</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="nb">int</span><span class="p">.</span>
<span class="k">To</span><span class="w"> </span><span class="k">convert</span><span class="w"> </span><span class="k">values</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="nb">date</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="nb">int</span><span class="p">,</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">use</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="n">UNIX_DATE</span><span class="w"> </span><span class="k">instead</span><span class="p">.</span>

<span class="c1">-- `spark.sql.ansi.enabled=false` (This is a default behavior)</span>
<span class="o">&gt;</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="k">cast</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="nb">INT</span><span class="p">);</span>
<span class="w">  </span><span class="k">null</span>

<span class="o">&gt;</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="k">CAST</span><span class="p">(</span><span class="mi">2147483648</span><span class="n">L</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="nb">INT</span><span class="p">);</span>
<span class="w">  </span><span class="o">-</span><span class="mi">2147483648</span>

<span class="o">&gt;</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="k">CAST</span><span class="p">(</span><span class="nb">DATE</span><span class="s1">&#39;2020-01-01&#39;</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="nb">INT</span><span class="p">);</span>
<span class="w">  </span><span class="k">null</span>

<span class="c1">-- Examples of store assignment rules</span>
<span class="o">&gt;</span><span class="w"> </span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="p">(</span><span class="n">v</span><span class="w"> </span><span class="nb">INT</span><span class="p">);</span>

<span class="c1">-- `spark.sql.storeAssignmentPolicy=ANSI`</span>
<span class="o">&gt;</span><span class="w"> </span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="n">error</span><span class="p">:</span><span class="w"> </span><span class="n">Cannot</span><span class="w"> </span><span class="k">write</span><span class="w"> </span><span class="n">incompatible</span><span class="w"> </span><span class="k">data</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="s1">&#39;`default`.`t`&#39;</span><span class="p">:</span>
<span class="o">-</span><span class="w"> </span><span class="n">Cannot</span><span class="w"> </span><span class="n">safely</span><span class="w"> </span><span class="k">cast</span><span class="w"> </span><span class="s1">&#39;v&#39;</span><span class="p">:</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="nb">int</span><span class="p">;</span>

<span class="c1">-- `spark.sql.storeAssignmentPolicy=LEGACY` (This is a legacy behavior until Spark 2.x)</span>
<span class="o">&gt;</span><span class="w"> </span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">);</span>
<span class="o">&gt;</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">t</span><span class="p">;</span>
<span class="w">  </span><span class="mi">1</span>
</pre></div>
</div>
</div>
<div class="section" id="store-assignment">
<h2>Store assignment<a class="headerlink" href="#store-assignment" title="Permalink to this headline"> </a></h2>
<p>As mentioned at the beginning, when <code class="docutils literal notranslate"><span class="pre">spark.sql.storeAssignmentPolicy</span></code> is set to <code class="docutils literal notranslate"><span class="pre">ANSI</span></code>(which is the default value), Spark SQL complies with the ANSI store assignment rules on table insertions. The valid combinations of source and target data type in table insertions are given by the following table.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 9%" />
<col style="width: 8%" />
<col style="width: 5%" />
<col style="width: 12%" />
<col style="width: 11%" />
<col style="width: 9%" />
<col style="width: 8%" />
<col style="width: 7%" />
<col style="width: 4%" />
<col style="width: 8%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>SourceTarget</p></th>
<th class="head"><p>Numeric</p></th>
<th class="head"><p>String</p></th>
<th class="head"><p>Date</p></th>
<th class="head"><p>Timestamp</p></th>
<th class="head"><p>Interval</p></th>
<th class="head"><p>Boolean</p></th>
<th class="head"><p>Binary</p></th>
<th class="head"><p>Array</p></th>
<th class="head"><p>Map</p></th>
<th class="head"><p>Struct</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p> Numeric</p></td>
<td><p> Y</p></td>
<td><p> Y</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
</tr>
<tr class="row-odd"><td><p> String</p></td>
<td><p> N</p></td>
<td><p> Y</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
</tr>
<tr class="row-even"><td><p> Date</p></td>
<td><p> N</p></td>
<td><p> Y</p></td>
<td><p> Y</p></td>
<td><p> Y</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
</tr>
<tr class="row-odd"><td><p> Timestamp</p></td>
<td><p> N</p></td>
<td><p> Y</p></td>
<td><p> Y</p></td>
<td><p> Y</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
</tr>
<tr class="row-even"><td><p> Interval</p></td>
<td><p> N</p></td>
<td><p> Y</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> Y</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
</tr>
<tr class="row-odd"><td><p> Boolean</p></td>
<td><p> N</p></td>
<td><p> Y</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> Y</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
</tr>
<tr class="row-even"><td><p> Binary</p></td>
<td><p> N</p></td>
<td><p> Y</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> Y</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
</tr>
<tr class="row-odd"><td><p> Array</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> Y*</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
</tr>
<tr class="row-even"><td><p> Map</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> Y*</p></td>
<td><p> N</p></td>
</tr>
<tr class="row-odd"><td><p> Struct</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> N</p></td>
<td><p> Y*</p></td>
</tr>
</tbody>
</table>
<p>* For Array/Map/Struct types, the data type check rule applies recursively to its component elements.</p>
<p>During table insertion, Spark will throw exception on numeric value overflow.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span><span class="w"> </span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">test</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="nb">INT</span><span class="p">);</span>
<span class="o">&gt;</span><span class="w"> </span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">2147483648</span><span class="n">L</span><span class="p">);</span>
<span class="w">  </span><span class="n">error</span><span class="p">:</span><span class="w"> </span><span class="n">Casting</span><span class="w"> </span><span class="mi">2147483648</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="nb">int</span><span class="w"> </span><span class="n">causes</span><span class="w"> </span><span class="n">overflow</span>
</pre></div>
</div>
</div>
<div class="section" id="type-coercion">
<h2>Type coercion<a class="headerlink" href="#type-coercion" title="Permalink to this headline"> </a></h2>
<div class="section" id="type-promotion-and-precedence">
<h3>Type Promotion and Precedence<a class="headerlink" href="#type-promotion-and-precedence" title="Permalink to this headline"> </a></h3>
<p>When <code class="docutils literal notranslate"><span class="pre">spark.sql.ansi.enabled</span></code> is set to <code class="docutils literal notranslate"><span class="pre">true</span></code>, Spark SQL uses several rules that govern how conflicts between data types are resolved.
At the heart of this conflict resolution is the Type Precedence List which defines whether values of a given data type can be promoted to another data type implicitly.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 13%" />
<col style="width: 87%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Data type</p></th>
<th class="head"><p>precedence list(from narrowest to widest)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p> Byte</p></td>
<td><p> Byte -&gt; Short -&gt; Int -&gt; Long -&gt; Decimal -&gt; Float* -&gt; Double</p></td>
</tr>
<tr class="row-odd"><td><p> Short</p></td>
<td><p> Short -&gt; Int -&gt; Long -&gt; Decimal-&gt; Float* -&gt; Double</p></td>
</tr>
<tr class="row-even"><td><p> Int</p></td>
<td><p> Int -&gt; Long -&gt; Decimal -&gt; Float* -&gt; Double</p></td>
</tr>
<tr class="row-odd"><td><p> Long</p></td>
<td><p> Long -&gt; Decimal -&gt; Float* -&gt; Double</p></td>
</tr>
<tr class="row-even"><td><p> Decimal</p></td>
<td><p> Decimal -&gt; Float* -&gt; Double</p></td>
</tr>
<tr class="row-odd"><td><p> Float</p></td>
<td><p> Float -&gt; Double</p></td>
</tr>
<tr class="row-even"><td><p> Double</p></td>
<td><p> Double</p></td>
</tr>
<tr class="row-odd"><td><p> Date</p></td>
<td><p> Date -&gt; Timestamp</p></td>
</tr>
<tr class="row-even"><td><p> Timestamp</p></td>
<td><p> Timestamp</p></td>
</tr>
<tr class="row-odd"><td><p> String</p></td>
<td><p> String</p></td>
</tr>
<tr class="row-even"><td><p> Binary</p></td>
<td><p> Binary</p></td>
</tr>
<tr class="row-odd"><td><p> Boolean</p></td>
<td><p> Boolean</p></td>
</tr>
<tr class="row-even"><td><p> Interval</p></td>
<td><p> Interval</p></td>
</tr>
<tr class="row-odd"><td><p> Map</p></td>
<td><p> Map**</p></td>
</tr>
<tr class="row-even"><td><p> Array</p></td>
<td><p> Array**</p></td>
</tr>
<tr class="row-odd"><td><p> Struct</p></td>
<td><p> Struct**</p></td>
</tr>
</tbody>
</table>
<p>* For least common type resolution float is skipped to avoid loss of precision.</p>
<p>** For a complex type, the precedence rule applies recursively to its component elements.</p>
<p>Special rules apply for the String type and untyped NULL.
A NULL can be promoted to any other type, while a String can be promoted to any simple data type.</p>
<p>This is a graphical depiction of the precedence list as a directed tree:
<img alt="Graphical representation of precedence rules" src="../../_images/data-type-precedence.png" /></p>
</div>
<div class="section" id="least-common-type-resolution">
<h3>Least Common Type Resolution<a class="headerlink" href="#least-common-type-resolution" title="Permalink to this headline"> </a></h3>
<p>The least common type from a set of types is the narrowest type reachable from the precedence list by all elements of the set of types.</p>
<p>The least common type resolution is used to:</p>
<ul class="simple">
<li><p>Decide whether a function expecting a parameter of a type can be invoked using an argument of a narrower type.</p></li>
<li><p>Derive the argument type for functions which expect a shared argument type for multiple parameters, such as coalesce, least, or greatest.</p></li>
<li><p>Derive the operand types for operators such as arithmetic operations or comparisons.</p></li>
<li><p>Derive the result type for expressions such as the case expression.</p></li>
<li><p>Derive the element, key, or value types for array and map constructors.</p></li>
</ul>
<p>Special rules are applied if the least common type resolves to FLOAT. With float type values, if any of the types is INT, BIGINT, or DECIMAL the least common type is pushed to DOUBLE to avoid potential loss of digits.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="c1">-- The coalesce function accepts any set of argument types as long as they share a least common type.</span>
<span class="c1">-- The result type is the least common type of the arguments.</span>
<span class="o">&gt;</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="k">sql</span><span class="p">.</span><span class="n">ansi</span><span class="p">.</span><span class="n">enabled</span><span class="o">=</span><span class="k">true</span><span class="p">;</span>

<span class="o">&gt;</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">typeof</span><span class="p">(</span><span class="k">coalesce</span><span class="p">(</span><span class="mi">1</span><span class="n">Y</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">));</span>
<span class="nb">BIGINT</span>

<span class="o">&gt;</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">typeof</span><span class="p">(</span><span class="k">coalesce</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nb">DATE</span><span class="s1">&#39;2020-01-01&#39;</span><span class="p">));</span>
<span class="n">Error</span><span class="p">:</span><span class="w"> </span><span class="n">Incompatible</span><span class="w"> </span><span class="n">types</span><span class="w"> </span><span class="p">[</span><span class="nb">INT</span><span class="p">,</span><span class="w"> </span><span class="nb">DATE</span><span class="p">]</span>

<span class="o">&gt;</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">typeof</span><span class="p">(</span><span class="k">coalesce</span><span class="p">(</span><span class="nb">ARRAY</span><span class="p">(</span><span class="mi">1</span><span class="n">Y</span><span class="p">),</span><span class="w"> </span><span class="nb">ARRAY</span><span class="p">(</span><span class="mi">1</span><span class="n">L</span><span class="p">)));</span>
<span class="nb">ARRAY</span><span class="o">&lt;</span><span class="nb">BIGINT</span><span class="o">&gt;</span>

<span class="o">&gt;</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">typeof</span><span class="p">(</span><span class="k">coalesce</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="n">F</span><span class="p">));</span>
<span class="n">DOUBLE</span>

<span class="o">&gt;</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">typeof</span><span class="p">(</span><span class="k">coalesce</span><span class="p">(</span><span class="mi">1</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="n">F</span><span class="p">));</span>
<span class="n">DOUBLE</span>

<span class="o">&gt;</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="p">(</span><span class="n">typeof</span><span class="p">(</span><span class="k">coalesce</span><span class="p">(</span><span class="mi">1</span><span class="n">BD</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="n">F</span><span class="p">)));</span>
<span class="n">DOUBLE</span>

<span class="c1">-- The substring function expects arguments of type INT for the start and length parameters.</span>
<span class="o">&gt;</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="k">substring</span><span class="p">(</span><span class="s1">&#39;hello&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="n">Y</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
<span class="n">he</span>

<span class="o">&gt;</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="k">substring</span><span class="p">(</span><span class="s1">&#39;hello&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
<span class="n">he</span>

<span class="o">&gt;</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="k">substring</span><span class="p">(</span><span class="s1">&#39;hello&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
<span class="n">Error</span><span class="p">:</span><span class="w"> </span><span class="n">Argument</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="n">requires</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">type</span><span class="p">.</span>

<span class="o">&gt;</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="k">substring</span><span class="p">(</span><span class="s1">&#39;hello&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">VALUES</span><span class="p">(</span><span class="k">CAST</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">STRING</span><span class="p">))</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">T</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>
<span class="n">Error</span><span class="p">:</span><span class="w"> </span><span class="n">Argument</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="n">requires</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">type</span><span class="p">.</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="sql-functions">
<h2>SQL functions<a class="headerlink" href="#sql-functions" title="Permalink to this headline"> </a></h2>
<p>The behavior of some SQL functions can be different under ANSI mode (<code class="docutils literal notranslate"><span class="pre">spark.sql.ansi.enabled=true</span></code>).</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">size</span></code>: This function returns null for null input under ANSI mode.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">element_at</span></code>:</p>
<ul>
<li><p>This function throws <code class="docutils literal notranslate"><span class="pre">ArrayIndexOutOfBoundsException</span></code> if using invalid indices.</p></li>
<li><p>This function throws <code class="docutils literal notranslate"><span class="pre">NoSuchElementException</span></code> if key does not exist in map.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">elt</span></code>: This function throws <code class="docutils literal notranslate"><span class="pre">ArrayIndexOutOfBoundsException</span></code> if using invalid indices.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">make_date</span></code>: This function fails with an exception if the result date is invalid.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">make_timestamp</span></code>: This function fails with an exception if the result timestamp is invalid.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">make_interval</span></code>:  This function fails with an exception if the result interval is invalid.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">next_day</span></code>: This function throws <code class="docutils literal notranslate"><span class="pre">IllegalArgumentException</span></code> if input is not a valid day of week.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">parse_url</span></code>: This function throws <code class="docutils literal notranslate"><span class="pre">IllegalArgumentException</span></code> if an input string is not a valid url.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">to_date</span></code>: This function fails with an exception if the input string can’t be parsed, or the pattern string is invalid.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">to_timestamp</span></code>: This function fails with an exception if the input string can’t be parsed, or the pattern string is invalid.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">to_unix_timestamp</span></code>: This function fails with an exception if the input string can’t be parsed, or the pattern string is invalid.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">unix_timestamp</span></code>: This function fails with an exception if the input string can’t be parsed, or the pattern string is invalid.</p></li>
</ul>
</div>
<div class="section" id="sql-operators">
<h2>SQL operators<a class="headerlink" href="#sql-operators" title="Permalink to this headline"> </a></h2>
<p>The behavior of some SQL operators can be different under ANSI mode (<code class="docutils literal notranslate"><span class="pre">spark.sql.ansi.enabled=true</span></code>).</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">array_col[index]</span></code>: This operator throws <code class="docutils literal notranslate"><span class="pre">ArrayIndexOutOfBoundsException</span></code> if using invalid indices.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">map_col[key]</span></code>: This operator throws <code class="docutils literal notranslate"><span class="pre">NoSuchElementException</span></code> if key does not exist in map.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CAST(string_col</span> <span class="pre">AS</span> <span class="pre">TIMESTAMP)</span></code>: This operator fails with an exception if the input string can’t be parsed.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CAST(string_col</span> <span class="pre">AS</span> <span class="pre">DATE)</span></code>: This operator fails with an exception if the input string can’t be parsed.</p></li>
</ul>
</div>
<div class="section" id="useful-functions-for-ansi-mode">
<h2>Useful Functions for ANSI Mode<a class="headerlink" href="#useful-functions-for-ansi-mode" title="Permalink to this headline"> </a></h2>
<p>When ANSI mode is on, it throws exceptions for invalid operations. You can use the following SQL functions to suppress such exceptions.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">try_cast</span></code>: identical to <code class="docutils literal notranslate"><span class="pre">CAST</span></code>, except that it returns <code class="docutils literal notranslate"><span class="pre">NULL</span></code> result instead of throwing an exception on runtime error.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">try_add</span></code>: identical to the add operator <code class="docutils literal notranslate"><span class="pre">+</span></code>, except that it returns <code class="docutils literal notranslate"><span class="pre">NULL</span></code> result instead of throwing an exception on integral value overflow.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">try_divide</span></code>: identical to the division operator <code class="docutils literal notranslate"><span class="pre">/</span></code>, except that it returns <code class="docutils literal notranslate"><span class="pre">NULL</span></code> result instead of throwing an exception on dividing 0.</p></li>
</ul>
</div>
<div class="section" id="sql-keywords">
<h2>SQL keywords<a class="headerlink" href="#sql-keywords" title="Permalink to this headline"> </a></h2>
<p>When <code class="docutils literal notranslate"><span class="pre">spark.sql.ansi.enabled</span></code> is true, Spark SQL will use the ANSI mode parser.
In this mode, Spark SQL has two kinds of keywords:</p>
<ul class="simple">
<li><p>Reserved keywords: Keywords that are reserved and can’t be used as identifiers for table, view, column, function, alias, etc.</p></li>
<li><p>Non-reserved keywords: Keywords that have a special meaning only in particular contexts and can be used as identifiers in other contexts. For example, <code class="docutils literal notranslate"><span class="pre">EXPLAIN</span> <span class="pre">SELECT</span> <span class="pre">...</span></code> is a command, but EXPLAIN can be used as identifiers in other places.</p></li>
</ul>
<p>When the ANSI mode is disabled, Spark SQL has two kinds of keywords:</p>
<ul class="simple">
<li><p>Non-reserved keywords: Same definition as the one when the ANSI mode enabled.</p></li>
<li><p>Strict-non-reserved keywords: A strict version of non-reserved keywords, which cannot be used as table alias.</p></li>
</ul>
<p>By default <code class="docutils literal notranslate"><span class="pre">spark.sql.ansi.enabled</span></code> is false.</p>
<p>Below is a list of all the keywords in Spark SQL.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 22%" />
<col style="width: 29%" />
<col style="width: 33%" />
<col style="width: 16%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Keyword</p></th>
<th class="head"><p>Spark SQL&lt;br/&gt;ANSI Mode</p></th>
<th class="head"><p>Spark SQL&lt;br/&gt;Default Mode</p></th>
<th class="head"><p>SQL-2016</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ADD</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>AFTER</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>ALL</p></td>
<td><p>reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-odd"><td><p>ALTER</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-even"><td><p>ALWAYS</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>ANALYZE</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>AND</p></td>
<td><p>reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-odd"><td><p>ANTI</p></td>
<td><p>non-reserved</p></td>
<td><p>strict-non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>ANY</p></td>
<td><p>reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-odd"><td><p>ARCHIVE</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>ARRAY</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-odd"><td><p>AS</p></td>
<td><p>reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-even"><td><p>ASC</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>AT</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-even"><td><p>AUTHORIZATION</p></td>
<td><p>reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-odd"><td><p>BETWEEN</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-even"><td><p>BOTH</p></td>
<td><p>reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-odd"><td><p>BUCKET</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>BUCKETS</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>BY</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-even"><td><p>CACHE</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>CASCADE</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>CASE</p></td>
<td><p>reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-odd"><td><p>CAST</p></td>
<td><p>reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-even"><td><p>CHANGE</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>CHECK</p></td>
<td><p>reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-even"><td><p>CLEAR</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>CLUSTER</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>CLUSTERED</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>CODEGEN</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>COLLATE</p></td>
<td><p>reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-odd"><td><p>COLLECTION</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>COLUMN</p></td>
<td><p>reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-odd"><td><p>COLUMNS</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>COMMENT</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>COMMIT</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-even"><td><p>COMPACT</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>COMPACTIONS</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>COMPUTE</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>CONCATENATE</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>CONSTRAINT</p></td>
<td><p>reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-odd"><td><p>COST</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>CREATE</p></td>
<td><p>reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-odd"><td><p>CROSS</p></td>
<td><p>reserved</p></td>
<td><p>strict-non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-even"><td><p>CUBE</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-odd"><td><p>CURRENT</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-even"><td><p>CURRENT_DATE</p></td>
<td><p>reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-odd"><td><p>CURRENT_TIME</p></td>
<td><p>reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-even"><td><p>CURRENT_TIMESTAMP</p></td>
<td><p>reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-odd"><td><p>CURRENT_USER</p></td>
<td><p>reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-even"><td><p>DATA</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>DATABASE</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>DATABASES</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>DAY</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>DBPROPERTIES</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>DEFINED</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>DELETE</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-odd"><td><p>DELIMITED</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>DESC</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>DESCRIBE</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-even"><td><p>DFS</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>DIRECTORIES</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>DIRECTORY</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>DISTINCT</p></td>
<td><p>reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-even"><td><p>DISTRIBUTE</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>DIV</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>not a keyword</p></td>
</tr>
<tr class="row-even"><td><p>DROP</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-odd"><td><p>ELSE</p></td>
<td><p>reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-even"><td><p>END</p></td>
<td><p>reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-odd"><td><p>ESCAPE</p></td>
<td><p>reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-even"><td><p>ESCAPED</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>EXCEPT</p></td>
<td><p>reserved</p></td>
<td><p>strict-non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-even"><td><p>EXCHANGE</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>EXISTS</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-even"><td><p>EXPLAIN</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>EXPORT</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>EXTENDED</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>EXTERNAL</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-even"><td><p>EXTRACT</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-odd"><td><p>FALSE</p></td>
<td><p>reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-even"><td><p>FETCH</p></td>
<td><p>reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-odd"><td><p>FIELDS</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>FILTER</p></td>
<td><p>reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-odd"><td><p>FILEFORMAT</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>FIRST</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>FN</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>FOLLOWING</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>FOR</p></td>
<td><p>reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-even"><td><p>FOREIGN</p></td>
<td><p>reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-odd"><td><p>FORMAT</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>FORMATTED</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>FROM</p></td>
<td><p>reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-even"><td><p>FULL</p></td>
<td><p>reserved</p></td>
<td><p>strict-non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-odd"><td><p>FUNCTION</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-even"><td><p>FUNCTIONS</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>GENERATED</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>GLOBAL</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-odd"><td><p>GRANT</p></td>
<td><p>reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-even"><td><p>GRANTS</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>GROUP</p></td>
<td><p>reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-even"><td><p>GROUPING</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-odd"><td><p>HAVING</p></td>
<td><p>reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-even"><td><p>HOUR</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>IF</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>not a keyword</p></td>
</tr>
<tr class="row-even"><td><p>IGNORE</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>IMPORT</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>IN</p></td>
<td><p>reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-odd"><td><p>INDEX</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>INDEXES</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>INNER</p></td>
<td><p>reserved</p></td>
<td><p>strict-non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-even"><td><p>INPATH</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>INPUTFORMAT</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>INSERT</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-odd"><td><p>INTERSECT</p></td>
<td><p>reserved</p></td>
<td><p>strict-non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-even"><td><p>INTERVAL</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-odd"><td><p>INTO</p></td>
<td><p>reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-even"><td><p>IS</p></td>
<td><p>reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-odd"><td><p>ITEMS</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>JOIN</p></td>
<td><p>reserved</p></td>
<td><p>strict-non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-odd"><td><p>KEY</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>KEYS</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>LAST</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>LATERAL</p></td>
<td><p>reserved</p></td>
<td><p>strict-non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-odd"><td><p>LAZY</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>LEADING</p></td>
<td><p>reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-odd"><td><p>LEFT</p></td>
<td><p>reserved</p></td>
<td><p>strict-non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-even"><td><p>LIKE</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-odd"><td><p>ILIKE</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>LIMIT</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>LINES</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>LIST</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>LOAD</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>LOCAL</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-odd"><td><p>LOCATION</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>LOCK</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>LOCKS</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>LOGICAL</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>MACRO</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>MAP</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>MATCHED</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>MERGE</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>MINUTE</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>MINUS</p></td>
<td><p>non-reserved</p></td>
<td><p>strict-non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>MONTH</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>MSCK</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>NAMESPACE</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>NAMESPACES</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>NATURAL</p></td>
<td><p>reserved</p></td>
<td><p>strict-non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-even"><td><p>NO</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-odd"><td><p>NOT</p></td>
<td><p>reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-even"><td><p>NULL</p></td>
<td><p>reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-odd"><td><p>NULLS</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>OF</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-odd"><td><p>ON</p></td>
<td><p>reserved</p></td>
<td><p>strict-non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-even"><td><p>ONLY</p></td>
<td><p>reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-odd"><td><p>OPTION</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>OPTIONS</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>OR</p></td>
<td><p>reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-even"><td><p>ORDER</p></td>
<td><p>reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-odd"><td><p>OUT</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-even"><td><p>OUTER</p></td>
<td><p>reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-odd"><td><p>OUTPUTFORMAT</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>OVER</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>OVERLAPS</p></td>
<td><p>reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-even"><td><p>OVERLAY</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>OVERWRITE</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>PARTITION</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-odd"><td><p>PARTITIONED</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>PARTITIONS</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>PERCENT</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>PIVOT</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>PLACING</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>POSITION</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-odd"><td><p>PRECEDING</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>PRIMARY</p></td>
<td><p>reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-odd"><td><p>PRINCIPALS</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>PROPERTIES</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>PURGE</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>QUALIFY</p></td>
<td><p>reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-odd"><td><p>QUERY</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>RANGE</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-odd"><td><p>RECIPIENT</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>RECIPIENTS</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>RECORDREADER</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>RECORDWRITER</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>RECOVER</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>REDUCE</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>REFERENCES</p></td>
<td><p>reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-even"><td><p>REFRESH</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>REGEXP</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>not a keyword</p></td>
</tr>
<tr class="row-even"><td><p>REMOVE</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>RENAME</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>REPAIR</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>REPLACE</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>RESET</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>RESPECT</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>RESTRICT</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>REVOKE</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-even"><td><p>RIGHT</p></td>
<td><p>reserved</p></td>
<td><p>strict-non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-odd"><td><p>RLIKE</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>ROLE</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>ROLES</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>ROLLBACK</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-odd"><td><p>ROLLUP</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-even"><td><p>ROW</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-odd"><td><p>ROWS</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-even"><td><p>SCHEMA</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>SCHEMAS</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>not a keyword</p></td>
</tr>
<tr class="row-even"><td><p>SECOND</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>SELECT</p></td>
<td><p>reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-even"><td><p>SEMI</p></td>
<td><p>non-reserved</p></td>
<td><p>strict-non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>SEPARATED</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>SERDE</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>SERDEPROPERTIES</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>SESSION_USER</p></td>
<td><p>reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-odd"><td><p>SET</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-even"><td><p>SETS</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>SHARE</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>SHARES</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>SHOW</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>SKEWED</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>SOME</p></td>
<td><p>reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-even"><td><p>SORT</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>SORTED</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>START</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-odd"><td><p>STATISTICS</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>STORED</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>STRATIFY</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>STRUCT</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>SUBSTR</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>SUBSTRING</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>SYNC</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>TABLE</p></td>
<td><p>reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-odd"><td><p>TABLES</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>TABLESAMPLE</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-odd"><td><p>TBLPROPERTIES</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>TEMP</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>not a keyword</p></td>
</tr>
<tr class="row-odd"><td><p>TEMPORARY</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>TERMINATED</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>THEN</p></td>
<td><p>reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-even"><td><p>TIME</p></td>
<td><p>reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-odd"><td><p>TO</p></td>
<td><p>reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-even"><td><p>TOUCH</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>TRAILING</p></td>
<td><p>reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-even"><td><p>TRANSACTION</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>TRANSACTIONS</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>TRANSFORM</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>TRIM</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>TRUE</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-odd"><td><p>TRUNCATE</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-even"><td><p>TRY_CAST</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>TYPE</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>UNARCHIVE</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>UNBOUNDED</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>UNCACHE</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>UNION</p></td>
<td><p>reserved</p></td>
<td><p>strict-non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-even"><td><p>UNIQUE</p></td>
<td><p>reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-odd"><td><p>UNKNOWN</p></td>
<td><p>reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-even"><td><p>UNLOCK</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>UNSET</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>UPDATE</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-odd"><td><p>USE</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>USER</p></td>
<td><p>reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-odd"><td><p>USING</p></td>
<td><p>reserved</p></td>
<td><p>strict-non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-even"><td><p>VALUES</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-odd"><td><p>VIEW</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>VIEWS</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-odd"><td><p>WHEN</p></td>
<td><p>reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-even"><td><p>WHERE</p></td>
<td><p>reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-odd"><td><p>WINDOW</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-even"><td><p>WITH</p></td>
<td><p>reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>reserved</p></td>
</tr>
<tr class="row-odd"><td><p>YEAR</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
<tr class="row-even"><td><p>ZONE</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
<td><p>non-reserved</p></td>
</tr>
</tbody>
</table>
</div>
</div>


    
          </div>
        </div>
        <div  class="suapp-rating">
  <div id="suPageRateApp">
     <su-app></su-app>
   </div> 
 </div>
<hr> 
<footer>
  <div role="contentinfo">
      <p class="copyright">
          &copy; Databricks 2023. All rights reserved. Apache, Apache Spark, Spark, and the Spark logo are trademarks of the <a href="http://www.apache.org/">Apache Software Foundation</a>.
      </p>
      <p> 
        
          <a id='feedbacklink' href="mailto:doc-feedback@databricks.com?subject=Documentation Feedback">Send us feedback</a>
        
     | <a href="https://databricks.com/privacy-policy">Privacy Policy</a> | <a href="https://databricks.com/terms-of-use">Terms of Use</a></p>

  </div> 

</footer>
      </div>
    </div>
  </section>
</main>

  </page>
  
  <script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
      URL_ROOT: '../../',
      VERSION: '1.0',
      COLLAPSE_INDEX: false,
      FILE_SUFFIX: '.html',
      HAS_SOURCE: 'false'
    };
  </script>
  <script type="text/javascript" src="../../_static/jquery.js"></script>
  <script type="text/javascript" src="../../_static/underscore.js"></script>
  <script type="text/javascript" src="../../_static/doctools.js"></script>
  <script type="text/javascript" src="../../_static/language_data.js"></script>
  

  <script type="text/javascript" src="../../_static/js/clipboard.min.js"></script>
  <script type="text/javascript" src="../../_static/js/jquery.waypoints.min.js"></script>

  <!-- Select2 (https://select2.org/) -->
  <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
  <!-- End Select2 -->

  
  
  <script type="text/javascript" src="../../_static/js/localized.js"></script>
  <script type="text/javascript" src="../../_static/js/custom.js"></script>
  

  
  
  <script type="text/javascript">
    jQuery(function () {
      SphinxRtdTheme.StickyNav.enable();
    });

  </script>
  
 



  <script>
  window.__searchunifyLoaderConfig = JSON.parse('{"clients": {"en": "02c2e804-27e9-11ee-aefb-0242ac120011", "ja": "6a42c3f2-2820-11ee-aefb-0242ac120011", "pt": "6a86badd-2821-11ee-aefb-0242ac120011"}}')
</script>
<script type="text/javascript" src="../../_static/js/search-loader.js"></script>
</body>
<script type='text/javascript'>
  window.onload = function () {
    var description = document.querySelector('meta[name="description"]').getAttribute("content");
    let titleText = document.querySelector('h1').textContent;
    document.querySelector('meta[property="og:title"]').setAttribute("content", titleText);
    document.querySelector('meta[property="og:description"]').setAttribute("content", description);
    document.querySelector('meta[property="twitter:description"]').setAttribute("content", description);
  };
</script>

</html>