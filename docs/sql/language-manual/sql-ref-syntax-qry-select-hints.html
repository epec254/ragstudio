

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en-US" > <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en-US"> <!--<![endif]-->

<head>
  <!-- cookie consent -->
  
    <!-- Combined Onetrust and Rudderstack Implementation Scripts -->
    <!-- Onetrust Initialization -->
    <script type="text/javascript" src="https://cdn.cookielaw.org/consent/92466579-1717-44d3-809d-a05fb02843ed-test/OtAutoBlock.js"></script>
    <script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" data-document-language="true" type="text/javascript" charset="UTF-8" data-domain-script="92466579-1717-44d3-809d-a05fb02843ed-test"></script>
    <link rel="stylesheet" id="db-onetrust-style" href="https://www.databricks.com/wp-content/uploads/db_onetrust.css" media="all" />
    <!-- Setting Rudderstack Write Key -->
    <script>window.rudderstackKey = "2SOR9fvSr5Fi6tN2ihPbVHnX1SZ" </script>
    <!-- Rudderstack Initialization + Onetrust Integration + Rudderstack Custom Events -->
    <script type="text/javascript" src="https://www.databricks.com/sites/default/files/rudderstack/v1/db-rudderstack-events.js"></script>

  <!-- cookie consent -->

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="X-UA-Compatible" content="IE=9" />
  <meta content="Learn how to use hints syntax of the SQL language in Databricks SQL and Databricks Runtime" name="description" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
  <meta property="og:image" content="https://www.databricks.com/wp-content/uploads/2020/04/og-databricks.png">
  <meta property="og:image:type" content="image/png">
  <meta property="og:title" content="Hints">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://docs.databricks.com">
  <meta property="og:description" content="" id="og-description">
  <meta name="twitter:image" content="https://www.databricks.com/wp-content/uploads/2020/04/og-databricks.png">
  <meta name="twitter:site" content="@databricks">
  <meta name="twitter:creator" content="@databricks">
  <meta property="twitter:description" content="">
  
  <title>Hints &#124; Databricks on AWS</title>
  
  
  <link rel="canonical" href="https://docs.databricks.com/en/sql/language-manual/sql-ref-syntax-qry-select-hints.html">
  <!-- Start hreflang tag -->
  <link rel="alternate" hreflang="en" href="https://docs.databricks.com/en/sql/language-manual/sql-ref-syntax-qry-select-hints.html" />
<link rel="alternate" hreflang="x-default" href="https://docs.databricks.com/en/sql/language-manual/sql-ref-syntax-qry-select-hints.html" />
  <!-- End hreflang tag -->
  
  
  <link rel="shortcut icon" href="../../_static/favicon.ico" />
  

  

  

  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;
j.setAttributeNode(d.createAttribute('data-ot-ignore'));
f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-T85FQ33');</script>
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;
j.setAttributeNode(d.createAttribute('data-ot-ignore'));
f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-TWTKQQ');</script>
    
  <!-- End Google Tag Manager -->


  <!-- MaxMind / GEO IP -->
  <script src="//js.maxmind.com/js/apis/geoip2/v2.1/geoip2.js" type="text/javascript"></script>
  <!-- End MaxMind / GEO IP -->

  
  
  <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600&display=swap" rel="stylesheet">
  <link rel="preload" href="../../_static/fonts/DMSans-Bold.ttf" as="font">
  <link rel="preload" href="../../_static/fonts/DMSans-Regular.ttf" as="font">
  <link rel="preload" href="../../_static/fonts/DMMono-Regular.ttf" as="font">
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/cloud-provider-selector.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/translation-selector.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/searchunify/main.css" type="text/css" />

  
  <link rel="index" title="Index" href="../../genindex.html" />
  <link rel="search" title="Search" href="../../search.html" />
  <link rel="top" title="Databricks on AWS" href="../../index.html" /> 
</head>

<body class="wy-body-for-nav" role="document">

  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T85FQ33"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TWTKQQ"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->

  
  <nav class="wy-nav-top header su_header" role="navigation" aria-label="top navigation">
    
<nav class="wy-nav-top header su_header" role="navigation" aria-label="top navigation">
  <div class="container-logo">
    <ul class="mobile-menu-toggle">
        <li class="menu-toggle">
            <i data-toggle="wy-nav-top" class="wy-nav-top-menu-button db-icon db-icon-menu pull-left"></i>
            
            <a href="https://www.databricks.com/" class="wy-nav-top-logo"><img src="../../_static/small-scale-lockup-full-color-rgb.svg" width="137" height="21"
              alt="Databricks" /></a>   
               
              </li>
    </ul>
    <ul class="su_nav-menu">
      <li class="menu-toggle">
        <i data-toggle="wy-nav-top" class="wy-nav-top-menu-button db-icon db-icon-menu pull-left"></i>
        
          
        
        <a href="https://www.databricks.com/" class="wy-nav-top-logo"><img src="../../_static/small-scale-lockup-full-color-rgb.svg" width="137" height="21"
            alt="Databricks" /></a></li>
        <!-- 
<li><a href="https://help.databricks.com/s/">Help Center</a></li>
<li class="active"><a href="https://docs.databricks.com/en/">Documentation</a></li>
<li><a href="https://kb.databricks.com/">Knowledge Base</a></li>
 -->
    </ul>
  </div>
  <div class="su_nav-right">
    <ul class="su_link-mobile">
  <!-- Mobile header code can go here -->
</ul>
<ul class="right-try-list">
   
</ul>
  </div>
</nav>
  </nav>

  <div class="su_sub-header">
    <div class="container">
      <div class="su_sub-header-inner">
        <!-- <div class="su_subnav-menu-right">
  <div id="auto" style="width: 100%;">
    <div ng-controller="SearchautoController">
      <div bind-html-compile="autocompleteHtml">
        <form class="su__search-box-1" disabled="disabled">
          <input class="su__search-input" type="search" name="Search box" id="su__search-b" placeholder="Search Documentation" disabled="disabled"/>
          <button class="su__search-button" type="submit" class="button button-success" disabled="disabled">
            <svg width="24" height="24" viewBox="0 0 24 24">
              <path
                d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"
                fill="#333"></path>
            </svg>
          </button>
        </form>
      </div>
    </div>
  </div>
</div> -->
        <div class="search-lng-gap"></div>
        <div style="margin-left: 16px; margin-right: 16px;">
          <!-- <select name="lng selector" id="lng-selector">
    <option value="../../../en/sql/language-manual/sql-ref-syntax-qry-select-hints.html" class="notranslate">English</option>
    <option value="../../../ja/sql/language-manual/sql-ref-syntax-qry-select-hints.html" class="notranslate">日本語</option>
    <option value="../../../pt/sql/language-manual/sql-ref-syntax-qry-select-hints.html" class="notranslate">Português (Brasil)</option>
</select> -->
        </div>
        <div class="cloud-selector-container">
          <!-- <select name="cloud provider selector" id="cloud-provider-selector">
    <option value="aws" selected class="notranslate">
        Amazon Web Services
    </option>
    <option value="azure"  class="notranslate">
        Microsoft Azure
    </option>
    <option value="gcp"  class="notranslate">
        Google Cloud Platform
    </option>
</select> -->
        </div>
      </div>
    </div>
  </div>
  <page class="js-page-container">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side su_nav-side">
<div class="wy-side-scroll">
  <div class="wy-side-nav-search">
    

    

    

    
  </div>

  <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
    
      <a href="../../index.html" class="main-navigation-home">Databricks on AWS</a>
    

    
      

      
        <p class="caption"><span class="caption-text">Load &amp; manage data</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../rag-temp/index.html">RAG Studio</a></li>
</ul>

      
    
  </div>

  <div role="contentinfo">
    
  <p class="build_info notranslate"data-last-edit="December 23, 2023">
    Updated Jan 11, 2024
  </p>
<script>
  window.addEventListener('DOMContentLoaded',function(){
    var h1=document.querySelector('h1');
    var bi=document.querySelector('[data-last-edit]');
    if(h1 && bi){
      var ver = document.createElement('p');
      ver.className = 'version_info';
      ver.textContent = bi.getAttribute('data-last-edit');
      h1.parentElement.insertBefore(ver, h1.nextElementSibling);
    }
  });
</script>

    <p>
      
        <a id='feedbacklink' href="mailto:doc-feedback@databricks.com?subject=Documentation Feedback">Send us feedback</a>
      
    </p>
  </div>
</div>
</nav>
    
    
<main class="wy-grid-for-nav su_nav-grid">
  <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
    <div class="wy-nav-content su__nav_content">
      <div class="rst-content">
        





<div role="navigation" aria-label="breadcrumbs navigation" class="wy-breadcrumbs-wrapper">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Documentation</a> <span class="db-icon db-icon-chevron-right"></span></li>
    
    
      <li>Hints</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>
</div>
        
        <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
          <div itemprop="articleBody">
            
    
  <div class="section" id="hints">
<h1>Hints<a class="headerlink" href="#hints" title="Permalink to this headline"> </a></h1>
<p><strong>Applies to:</strong> <img alt="check marked yes" src="../../_images/check.png" /> Databricks SQL <img alt="check marked yes" src="../../_images/check.png" /> Databricks Runtime</p>
<p>Suggest specific approaches to generate an execution plan.</p>
<div class="section" id="syntax">
<h2>Syntax<a class="headerlink" href="#syntax" title="Permalink to this headline"> </a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/*+</span> <span class="p">{</span> <span class="n">partition_hint</span> <span class="o">|</span> <span class="n">join_hint</span> <span class="o">|</span> <span class="n">skew_hint</span> <span class="p">}</span> <span class="p">[,</span> <span class="o">...</span><span class="p">]</span> <span class="o">*/</span>
</pre></div>
</div>
</div>
<div class="section" id="partitioning-hints">
<h2>Partitioning hints<a class="headerlink" href="#partitioning-hints" title="Permalink to this headline"> </a></h2>
<p>Partitioning hints allow you to suggest a partitioning strategy that Databricks should follow.
<code class="docutils literal notranslate"><span class="pre">COALESCE</span></code>, <code class="docutils literal notranslate"><span class="pre">REPARTITION</span></code>, and <code class="docutils literal notranslate"><span class="pre">REPARTITION_BY_RANGE</span></code> hints are supported and are equivalent to <code class="docutils literal notranslate"><span class="pre">coalesce</span></code>, <code class="docutils literal notranslate"><span class="pre">repartition</span></code>, and <code class="docutils literal notranslate"><span class="pre">repartitionByRange</span></code> Dataset APIs, respectively.
These hints give you a way to tune performance and control the number of output files.
When multiple partitioning hints are specified, multiple nodes are inserted into the logical plan, but the leftmost hint is picked by the optimizer.</p>
<div class="section" id="syntax">
<span id="syntax-1"></span><h3>Syntax<a class="headerlink" href="#syntax" title="Permalink to this headline"> </a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">partition_hint</span>
  <span class="n">COALESCE</span> <span class="p">(</span> <span class="n">part_num</span> <span class="p">)</span> <span class="o">|</span>
  <span class="n">REPARTITION</span> <span class="p">(</span> <span class="p">{</span> <span class="n">part_num</span> <span class="o">|</span> <span class="p">[</span> <span class="n">part_num</span> <span class="p">,</span> <span class="p">]</span> <span class="n">column_name</span> <span class="p">[</span> <span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="p">}</span> <span class="p">)</span> <span class="o">|</span>
  <span class="n">REPARTITION_BY_RANGE</span> <span class="p">(</span> <span class="n">column_name</span> <span class="p">[,</span> <span class="o">...</span><span class="p">]</span> <span class="p">[,</span> <span class="n">part_num</span><span class="p">]</span> <span class="p">)</span> <span class="o">|</span>
  <span class="n">REBALANCE</span> <span class="p">[</span> <span class="p">(</span> <span class="n">column_name</span> <span class="p">[,</span> <span class="o">...</span><span class="p">]</span> <span class="p">)</span> <span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="partitioning-hint-types">
<h3>Partitioning hint types<a class="headerlink" href="#partitioning-hint-types" title="Permalink to this headline"> </a></h3>
<ul>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">COALESCE</span> <span class="pre">(</span> <span class="pre">part_num</span> <span class="pre">)</span></code></strong></p>
<p>Reduce the number of partitions to the specified number of partitions. It takes a partition number as a parameter.</p>
</li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">REPARTITION</span> <span class="pre">(</span> <span class="pre">{</span> <span class="pre">part_num</span> <span class="pre">|</span> <span class="pre">[</span> <span class="pre">part_num</span> <span class="pre">,</span> <span class="pre">]</span> <span class="pre">column_name</span> <span class="pre">[</span> <span class="pre">,</span> <span class="pre">...]</span> <span class="pre">}</span> <span class="pre">)</span> </code></strong></p>
<p>Repartition to the specified number of partitions using the specified partitioning expressions. It takes a partition number, column names, or both as parameters.</p>
</li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">REPARTITION_BY_RANGE</span> <span class="pre">(</span> <span class="pre">column_name</span> <span class="pre">[,</span> <span class="pre">...]</span> <span class="pre">[,</span> <span class="pre">part_num]</span></code></strong></p>
<p>Repartition to the specified number of partitions using the specified partitioning expressions. It takes column names and an optional partition number as parameters.</p>
</li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">REBALANCE</span> <span class="pre">[</span> <span class="pre">(</span> <span class="pre">column_name</span> <span class="pre">[,</span> <span class="pre">...]</span> <span class="pre">)</span> <span class="pre">]</span></code></strong></p>
<p>The <code class="docutils literal notranslate"><span class="pre">REBALANCE</span></code> hint can be used to rebalance the query result output partitions, so that every partition is of a reasonable size (not too small and not too big). It can take column names as parameters, and try its best to partition the query result by these columns. This is a best-effort: if there are skews, Spark will split the skewed partitions, to make these partitions not too big. This hint is useful when you need to write the result of this query to a table, to avoid too small/big files. This hint is ignored if AQE is not enabled.</p>
</li>
<li><p><strong><a class="reference internal" href="sql-ref-names.html#column-name"><span class="std std-ref">column_name</span></a></strong></p>
<p>The exposed name of a column or alias to repartition or rebalance by.</p>
</li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">part_num</span></code></strong></p>
<p>An integral number literal. The number of partitions to repartition to.</p>
</li>
</ul>
</div>
<div class="section" id="examples">
<h3>Examples<a class="headerlink" href="#examples" title="Permalink to this headline"> </a></h3>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="cm">/*+ COALESCE(3) */</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">t</span><span class="p">;</span>

<span class="o">&gt;</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="cm">/*+ REPARTITION(3) */</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">t</span><span class="p">;</span>

<span class="o">&gt;</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="cm">/*+ REPARTITION(c) */</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">t</span><span class="p">;</span>

<span class="o">&gt;</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="cm">/*+ REPARTITION(3, c) */</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">t</span><span class="p">;</span>

<span class="o">&gt;</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="cm">/*+ REPARTITION_BY_RANGE(c) */</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">t</span><span class="p">;</span>

<span class="o">&gt;</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="cm">/*+ REPARTITION_BY_RANGE(3, c) */</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">t</span><span class="p">;</span>

<span class="o">&gt;</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="cm">/*+ REBALANCE */</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">t</span><span class="p">;</span>

<span class="o">&gt;</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="cm">/*+ REBALANCE(c) */</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">t</span><span class="p">;</span>

<span class="c1">-- When a column name has been occluded by an alias you must refere to it by the alias name.</span>
<span class="o">&gt;</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="cm">/*+ REBALANCE(d) */</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">s</span><span class="p">(</span><span class="n">d</span><span class="p">);</span>

<span class="c1">-- multiple partitioning hints</span>
<span class="o">&gt;</span><span class="w"> </span><span class="k">EXPLAIN</span><span class="w"> </span><span class="n">EXTENDED</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="cm">/*+ REPARTITION(100), COALESCE(500), REPARTITION_BY_RANGE(3, c) */</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">t</span><span class="p">;</span>
<span class="o">==</span><span class="w"> </span><span class="n">Parsed</span><span class="w"> </span><span class="n">Logical</span><span class="w"> </span><span class="n">Plan</span><span class="w"> </span><span class="o">==</span>
<span class="s1">&#39;UnresolvedHint REPARTITION, [100]</span>
<span class="s1">+- &#39;</span><span class="n">UnresolvedHint</span><span class="w"> </span><span class="k">COALESCE</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="mi">500</span><span class="p">]</span>
<span class="w">   </span><span class="o">+-</span><span class="w"> </span><span class="s1">&#39;UnresolvedHint REPARTITION_BY_RANGE, [3, &#39;</span><span class="k">c</span><span class="p">]</span>
<span class="w">      </span><span class="o">+-</span><span class="w"> </span><span class="s1">&#39;Project [*]</span>
<span class="s1">         +- &#39;</span><span class="n">UnresolvedRelation</span><span class="w"> </span><span class="p">[</span><span class="n">t</span><span class="p">]</span>

<span class="o">==</span><span class="w"> </span><span class="n">Analyzed</span><span class="w"> </span><span class="n">Logical</span><span class="w"> </span><span class="n">Plan</span><span class="w"> </span><span class="o">==</span>
<span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="n">string</span><span class="p">,</span><span class="w"> </span><span class="k">c</span><span class="p">:</span><span class="w"> </span><span class="nb">int</span>
<span class="n">Repartition</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="k">true</span>
<span class="o">+-</span><span class="w"> </span><span class="n">Repartition</span><span class="w"> </span><span class="mi">500</span><span class="p">,</span><span class="w"> </span><span class="k">false</span>
<span class="w">   </span><span class="o">+-</span><span class="w"> </span><span class="n">RepartitionByExpression</span><span class="w"> </span><span class="p">[</span><span class="k">c</span><span class="o">#</span><span class="mi">30</span><span class="w"> </span><span class="k">ASC</span><span class="w"> </span><span class="n">NULLS</span><span class="w"> </span><span class="k">FIRST</span><span class="p">],</span><span class="w"> </span><span class="mi">3</span>
<span class="w">      </span><span class="o">+-</span><span class="w"> </span><span class="n">Project</span><span class="w"> </span><span class="p">[</span><span class="n">name</span><span class="o">#</span><span class="mi">29</span><span class="p">,</span><span class="w"> </span><span class="k">c</span><span class="o">#</span><span class="mi">30</span><span class="p">]</span>
<span class="w">         </span><span class="o">+-</span><span class="w"> </span><span class="n">SubqueryAlias</span><span class="w"> </span><span class="n">spark_catalog</span><span class="p">.</span><span class="k">default</span><span class="p">.</span><span class="n">t</span>
<span class="w">            </span><span class="o">+-</span><span class="w"> </span><span class="n">Relation</span><span class="p">[</span><span class="n">name</span><span class="o">#</span><span class="mi">29</span><span class="p">,</span><span class="k">c</span><span class="o">#</span><span class="mi">30</span><span class="p">]</span><span class="w"> </span><span class="n">parquet</span>

<span class="o">==</span><span class="w"> </span><span class="n">Optimized</span><span class="w"> </span><span class="n">Logical</span><span class="w"> </span><span class="n">Plan</span><span class="w"> </span><span class="o">==</span>
<span class="n">Repartition</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="k">true</span>
<span class="o">+-</span><span class="w"> </span><span class="n">Relation</span><span class="p">[</span><span class="n">name</span><span class="o">#</span><span class="mi">29</span><span class="p">,</span><span class="k">c</span><span class="o">#</span><span class="mi">30</span><span class="p">]</span><span class="w"> </span><span class="n">parquet</span>

<span class="o">==</span><span class="w"> </span><span class="n">Physical</span><span class="w"> </span><span class="n">Plan</span><span class="w"> </span><span class="o">==</span>
<span class="n">Exchange</span><span class="w"> </span><span class="n">RoundRobinPartitioning</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span><span class="w"> </span><span class="k">false</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="n">id</span><span class="o">=#</span><span class="mi">121</span><span class="p">]</span>
<span class="o">+-</span><span class="w"> </span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="n">ColumnarToRow</span>
<span class="w">   </span><span class="o">+-</span><span class="w"> </span><span class="n">FileScan</span><span class="w"> </span><span class="n">parquet</span><span class="w"> </span><span class="k">default</span><span class="p">.</span><span class="n">t</span><span class="p">[</span><span class="n">name</span><span class="o">#</span><span class="mi">29</span><span class="p">,</span><span class="k">c</span><span class="o">#</span><span class="mi">30</span><span class="p">]</span><span class="w"> </span><span class="n">Batched</span><span class="p">:</span><span class="w"> </span><span class="k">true</span><span class="p">,</span><span class="w"> </span><span class="n">DataFilters</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w"> </span><span class="n">Format</span><span class="p">:</span><span class="w"> </span><span class="n">Parquet</span><span class="p">,</span>
<span class="w">      </span><span class="k">Location</span><span class="p">:</span><span class="w"> </span><span class="n">CatalogFileIndex</span><span class="p">[</span><span class="n">file</span><span class="p">:</span><span class="o">/</span><span class="n">spark</span><span class="o">/</span><span class="n">spark</span><span class="o">-</span><span class="n">warehouse</span><span class="o">/</span><span class="n">t</span><span class="p">],</span><span class="w"> </span><span class="n">PartitionFilters</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span>
<span class="w">      </span><span class="n">PushedFilters</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w"> </span><span class="n">ReadSchema</span><span class="p">:</span><span class="w"> </span><span class="n">struct</span><span class="o">&lt;</span><span class="n">name</span><span class="p">:</span><span class="n">string</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="join-hints">
<h2>Join hints<a class="headerlink" href="#join-hints" title="Permalink to this headline"> </a></h2>
<p>Join hints allow you to suggest the join strategy that Databricks SQL should use.
When different join strategy hints are specified on both sides of a join, Databricks SQL prioritizes hints in the following order: <code class="docutils literal notranslate"><span class="pre">BROADCAST</span></code> over <code class="docutils literal notranslate"><span class="pre">MERGE</span></code> over <code class="docutils literal notranslate"><span class="pre">SHUFFLE_HASH</span></code> over <code class="docutils literal notranslate"><span class="pre">SHUFFLE_REPLICATE_NL</span></code>.
When both sides are specified with the <code class="docutils literal notranslate"><span class="pre">BROADCAST</span></code> hint or the <code class="docutils literal notranslate"><span class="pre">SHUFFLE_HASH</span></code> hint, Databricks SQL picks the build side based on the join type and the sizes of the relations.
Because a given strategy might not support all join types, Databricks SQL is not guaranteed to use the join strategy suggested by the hint.</p>
<div class="section" id="syntax">
<span id="syntax-2"></span><h3>Syntax<a class="headerlink" href="#syntax" title="Permalink to this headline"> </a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">join_hint</span>
  <span class="n">BROADCAST</span> <span class="p">(</span> <span class="n">table_name</span> <span class="p">)</span> <span class="o">|</span>
  <span class="n">MERGE</span> <span class="p">(</span> <span class="n">table_name</span> <span class="p">)</span> <span class="o">|</span>
  <span class="n">SHUFFLE_HASH</span> <span class="p">(</span> <span class="n">table_name</span> <span class="p">)</span> <span class="o">|</span>
  <span class="n">SHUFFLE_REPLICATE_NL</span> <span class="p">(</span> <span class="n">table_name</span> <span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">BROADCASTJOIN</span></code> and <code class="docutils literal notranslate"><span class="pre">MAPJOIN</span></code> are supported as aliases for <code class="docutils literal notranslate"><span class="pre">BROADCAST</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">SHUFFLE_MERGE</span></code> and <code class="docutils literal notranslate"><span class="pre">MERGEJOIN</span></code> are supported as aliases for <code class="docutils literal notranslate"><span class="pre">MERGE</span></code>.</p>
</div>
<div class="section" id="join-hint-types">
<h3>Join hint types<a class="headerlink" href="#join-hint-types" title="Permalink to this headline"> </a></h3>
<ul>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">BROADCAST</span> <span class="pre">(</span> <span class="pre">table_name</span> <span class="pre">)</span></code></strong></p>
<p>Use broadcast join. The join side with the hint is broadcast regardless of <code class="docutils literal notranslate"><span class="pre">autoBroadcastJoinThreshold</span></code>. If both sides of the join have the broadcast hints, the one with the smaller size (based on stats) is broadcast.</p>
</li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">MERGE</span> <span class="pre">(</span> <span class="pre">table_name</span> <span class="pre">)</span></code></strong></p>
<p>Use shuffle sort merge join.</p>
</li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">SHUFFLE_HASH</span> <span class="pre">(</span> <span class="pre">table_name</span> <span class="pre">)</span></code></strong></p>
<p>Use shuffle hash join. If both sides have the shuffle hash hints, Databricks SQL chooses the smaller side (based on stats) as the build side.</p>
</li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">SHUFFLE_REPLICATE_NL</span> <span class="pre">(</span> <span class="pre">table_name</span> <span class="pre">)</span></code></strong></p>
<p>Use shuffle-and-replicate nested loop join.</p>
</li>
<li><p><strong><a class="reference internal" href="sql-ref-names.html#table-name"><span class="std std-ref">table_name</span></a></strong></p>
<p>The exposed name of a table or table-alias to which the hint applies.</p>
</li>
</ul>
</div>
<div class="section" id="examples">
<span id="examples-1"></span><h3>Examples<a class="headerlink" href="#examples" title="Permalink to this headline"> </a></h3>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="c1">-- Join Hints for broadcast join</span>
<span class="o">&gt;</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="cm">/*+ BROADCAST(t1) */</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">t1</span><span class="w"> </span><span class="k">INNER</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">t2</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">t1</span><span class="p">.</span><span class="k">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t2</span><span class="p">.</span><span class="k">key</span><span class="p">;</span>
<span class="o">&gt;</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="cm">/*+ BROADCASTJOIN (t1) */</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">t1</span><span class="w"> </span><span class="k">left</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">t2</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">t1</span><span class="p">.</span><span class="k">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t2</span><span class="p">.</span><span class="k">key</span><span class="p">;</span>
<span class="o">&gt;</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="cm">/*+ MAPJOIN(t2) */</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">t1</span><span class="w"> </span><span class="k">right</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">t2</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">t1</span><span class="p">.</span><span class="k">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t2</span><span class="p">.</span><span class="k">key</span><span class="p">;</span>

<span class="c1">-- Join Hints for shuffle sort merge join</span>
<span class="o">&gt;</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="cm">/*+ SHUFFLE_MERGE(t1) */</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">t1</span><span class="w"> </span><span class="k">INNER</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">t2</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">t1</span><span class="p">.</span><span class="k">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t2</span><span class="p">.</span><span class="k">key</span><span class="p">;</span>
<span class="o">&gt;</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="cm">/*+ MERGEJOIN(t2) */</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">t1</span><span class="w"> </span><span class="k">INNER</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">t2</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">t1</span><span class="p">.</span><span class="k">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t2</span><span class="p">.</span><span class="k">key</span><span class="p">;</span>
<span class="o">&gt;</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="cm">/*+ MERGE(t1) */</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">t1</span><span class="w"> </span><span class="k">INNER</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">t2</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">t1</span><span class="p">.</span><span class="k">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t2</span><span class="p">.</span><span class="k">key</span><span class="p">;</span>

<span class="c1">-- Join Hints for shuffle hash join</span>
<span class="o">&gt;</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="cm">/*+ SHUFFLE_HASH(t1) */</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">t1</span><span class="w"> </span><span class="k">INNER</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">t2</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">t1</span><span class="p">.</span><span class="k">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t2</span><span class="p">.</span><span class="k">key</span><span class="p">;</span>

<span class="c1">-- Join Hints for shuffle-and-replicate nested loop join</span>
<span class="o">&gt;</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="cm">/*+ SHUFFLE_REPLICATE_NL(t1) */</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">t1</span><span class="w"> </span><span class="k">INNER</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">t2</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">t1</span><span class="p">.</span><span class="k">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t2</span><span class="p">.</span><span class="k">key</span><span class="p">;</span>

<span class="c1">-- When different join strategy hints are specified on both sides of a join, Databricks SQL</span>
<span class="c1">-- prioritizes the BROADCAST hint over the MERGE hint over the SHUFFLE_HASH hint</span>
<span class="c1">-- over the SHUFFLE_REPLICATE_NL hint.</span>
<span class="c1">-- Databricks SQL will issue Warning in the following example</span>
<span class="c1">-- org.apache.spark.sql.catalyst.analysis.HintErrorLogger: Hint (strategy=merge)</span>
<span class="c1">-- is overridden by another hint and will not take effect.</span>
<span class="o">&gt;</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="cm">/*+ BROADCAST(t1), MERGE(t1, t2) */</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">t1</span><span class="w"> </span><span class="k">INNER</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">t2</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">t1</span><span class="p">.</span><span class="k">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t2</span><span class="p">.</span><span class="k">key</span><span class="p">;</span>

<span class="c1">-- When a table name is occluded by an alias you must use the alias name in the hint</span>
<span class="o">&gt;</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="cm">/*+ BROADCAST(t1), MERGE(s1, s2) */</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">t1</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">s1</span><span class="w"> </span><span class="k">INNER</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">t2</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">s2</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">s1</span><span class="p">.</span><span class="k">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s2</span><span class="p">.</span><span class="k">key</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="skew-hints">
<h2>Skew hints<a class="headerlink" href="#skew-hints" title="Permalink to this headline"> </a></h2>
<p>(Delta Lake) See <a class="reference internal" href="../../optimizations/skew-join.html"><span class="doc">Skew join optimization</span></a> for information about the <code class="docutils literal notranslate"><span class="pre">SKEW</span></code> hint.</p>
</div>
<div class="section" id="related-statements">
<h2>Related statements<a class="headerlink" href="#related-statements" title="Permalink to this headline"> </a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="sql-ref-syntax-qry-select.html"><span class="doc">SELECT</span></a></p></li>
</ul>
</div>
</div>


    
          </div>
        </div>
        <div  class="suapp-rating">
  <div id="suPageRateApp">
     <su-app></su-app>
   </div> 
 </div>
<hr> 
<footer>
  <div role="contentinfo">
      <p class="copyright">
          &copy; Databricks 2023. All rights reserved. Apache, Apache Spark, Spark, and the Spark logo are trademarks of the <a href="http://www.apache.org/">Apache Software Foundation</a>.
      </p>
      <p> 
        
          <a id='feedbacklink' href="mailto:doc-feedback@databricks.com?subject=Documentation Feedback">Send us feedback</a>
        
     | <a href="https://databricks.com/privacy-policy">Privacy Policy</a> | <a href="https://databricks.com/terms-of-use">Terms of Use</a></p>

  </div> 

</footer>
      </div>
    </div>
  </section>
</main>

  </page>
  
  <script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
      URL_ROOT: '../../',
      VERSION: '1.0',
      COLLAPSE_INDEX: false,
      FILE_SUFFIX: '.html',
      HAS_SOURCE: 'false'
    };
  </script>
  <script type="text/javascript" src="../../_static/jquery.js"></script>
  <script type="text/javascript" src="../../_static/underscore.js"></script>
  <script type="text/javascript" src="../../_static/doctools.js"></script>
  <script type="text/javascript" src="../../_static/language_data.js"></script>
  

  <script type="text/javascript" src="../../_static/js/clipboard.min.js"></script>
  <script type="text/javascript" src="../../_static/js/jquery.waypoints.min.js"></script>

  <!-- Select2 (https://select2.org/) -->
  <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
  <!-- End Select2 -->

  
  
  <script type="text/javascript" src="../../_static/js/localized.js"></script>
  <script type="text/javascript" src="../../_static/js/custom.js"></script>
  

  
  
  <script type="text/javascript">
    jQuery(function () {
      SphinxRtdTheme.StickyNav.enable();
    });

  </script>
  
 



  <script>
  window.__searchunifyLoaderConfig = JSON.parse('{"clients": {"en": "02c2e804-27e9-11ee-aefb-0242ac120011", "ja": "6a42c3f2-2820-11ee-aefb-0242ac120011", "pt": "6a86badd-2821-11ee-aefb-0242ac120011"}}')
</script>
<script type="text/javascript" src="../../_static/js/search-loader.js"></script>
</body>
<script type='text/javascript'>
  window.onload = function () {
    var description = document.querySelector('meta[name="description"]').getAttribute("content");
    let titleText = document.querySelector('h1').textContent;
    document.querySelector('meta[property="og:title"]').setAttribute("content", titleText);
    document.querySelector('meta[property="og:description"]').setAttribute("content", description);
    document.querySelector('meta[property="twitter:description"]').setAttribute("content", description);
  };
</script>

</html>